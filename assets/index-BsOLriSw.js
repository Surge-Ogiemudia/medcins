function BE(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var zE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _v={exports:{}},Ku={},xv={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Na=Symbol.for("react.element"),$E=Symbol.for("react.portal"),WE=Symbol.for("react.fragment"),qE=Symbol.for("react.strict_mode"),HE=Symbol.for("react.profiler"),KE=Symbol.for("react.provider"),GE=Symbol.for("react.context"),QE=Symbol.for("react.forward_ref"),YE=Symbol.for("react.suspense"),XE=Symbol.for("react.memo"),JE=Symbol.for("react.lazy"),Dg=Symbol.iterator;function ZE(t){return t===null||typeof t!="object"?null:(t=Dg&&t[Dg]||t["@@iterator"],typeof t=="function"?t:null)}var wv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ev=Object.assign,Sv={};function ao(t,e,n){this.props=t,this.context=e,this.refs=Sv,this.updater=n||wv}ao.prototype.isReactComponent={};ao.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ao.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Iv(){}Iv.prototype=ao.prototype;function sf(t,e,n){this.props=t,this.context=e,this.refs=Sv,this.updater=n||wv}var of=sf.prototype=new Iv;of.constructor=sf;Ev(of,ao.prototype);of.isPureReactComponent=!0;var Og=Array.isArray,Tv=Object.prototype.hasOwnProperty,af={current:null},bv={key:!0,ref:!0,__self:!0,__source:!0};function Cv(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Tv.call(e,r)&&!bv.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Na,type:t,key:s,ref:o,props:i,_owner:af.current}}function e1(t,e){return{$$typeof:Na,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Na}function t1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Lg=/\/+/g;function Gc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?t1(""+t.key):e.toString(36)}function Vl(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Na:case $E:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gc(o,0):r,Og(i)?(n="",t!=null&&(n=t.replace(Lg,"$&/")+"/"),Vl(i,e,n,"",function(d){return d})):i!=null&&(lf(i)&&(i=e1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Lg,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Og(t))for(var u=0;u<t.length;u++){s=t[u];var c=r+Gc(s,u);o+=Vl(s,e,n,c,i)}else if(c=ZE(t),typeof c=="function")for(t=c.call(t),u=0;!(s=t.next()).done;)s=s.value,c=r+Gc(s,u++),o+=Vl(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gl(t,e,n){if(t==null)return t;var r=[],i=0;return Vl(t,r,"","",function(s){return e.call(n,s,i++)}),r}function n1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cn={current:null},Fl={transition:null},r1={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:Fl,ReactCurrentOwner:af};function Av(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:gl,forEach:function(t,e,n){gl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gl(t,function(){e++}),e},toArray:function(t){return gl(t,function(e){return e})||[]},only:function(t){if(!lf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=ao;Le.Fragment=WE;Le.Profiler=HE;Le.PureComponent=sf;Le.StrictMode=qE;Le.Suspense=YE;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r1;Le.act=Av;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ev({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=af.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)Tv.call(e,c)&&!bv.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:Na,type:t.type,key:i,ref:s,props:r,_owner:o}};Le.createContext=function(t){return t={$$typeof:GE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KE,_context:t},t.Consumer=t};Le.createElement=Cv;Le.createFactory=function(t){var e=Cv.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:QE,render:t}};Le.isValidElement=lf;Le.lazy=function(t){return{$$typeof:JE,_payload:{_status:-1,_result:t},_init:n1}};Le.memo=function(t,e){return{$$typeof:XE,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Fl.transition;Fl.transition={};try{t()}finally{Fl.transition=e}};Le.unstable_act=Av;Le.useCallback=function(t,e){return cn.current.useCallback(t,e)};Le.useContext=function(t){return cn.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return cn.current.useDeferredValue(t)};Le.useEffect=function(t,e){return cn.current.useEffect(t,e)};Le.useId=function(){return cn.current.useId()};Le.useImperativeHandle=function(t,e,n){return cn.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return cn.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return cn.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return cn.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return cn.current.useReducer(t,e,n)};Le.useRef=function(t){return cn.current.useRef(t)};Le.useState=function(t){return cn.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return cn.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return cn.current.useTransition()};Le.version="18.3.1";xv.exports=Le;var j=xv.exports;const Ue=vv(j),i1=BE({__proto__:null,default:Ue},[j]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1=j,o1=Symbol.for("react.element"),a1=Symbol.for("react.fragment"),l1=Object.prototype.hasOwnProperty,u1=s1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c1={key:!0,ref:!0,__self:!0,__source:!0};function Rv(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)l1.call(e,r)&&!c1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:o1,type:t,key:s,ref:o,props:i,_owner:u1.current}}Ku.Fragment=a1;Ku.jsx=Rv;Ku.jsxs=Rv;_v.exports=Ku;var a=_v.exports,Ld={},kv={exports:{}},An={},Pv={exports:{}},jv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,F){var W=M.length;M.push(F);e:for(;0<W;){var q=W-1>>>1,G=M[q];if(0<i(G,F))M[q]=F,M[W]=G,W=q;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var F=M[0],W=M.pop();if(W!==F){M[0]=W;e:for(var q=0,G=M.length,O=G>>>1;q<O;){var X=2*(q+1)-1,z=M[X],ie=X+1,pe=M[ie];if(0>i(z,W))ie<G&&0>i(pe,z)?(M[q]=pe,M[ie]=W,q=ie):(M[q]=z,M[X]=W,q=X);else if(ie<G&&0>i(pe,W))M[q]=pe,M[ie]=W,q=ie;else break e}}return F}function i(M,F){var W=M.sortIndex-F.sortIndex;return W!==0?W:M.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var c=[],d=[],p=1,y=null,v=3,b=!1,P=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(M){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=M)r(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function D(M){if(k=!1,E(M),!P)if(n(c)!==null)P=!0,te(V);else{var F=n(d);F!==null&&ee(D,F.startTime-M)}}function V(M,F){P=!1,k&&(k=!1,C(f),f=-1),b=!0;var W=v;try{for(E(F),y=n(c);y!==null&&(!(y.expirationTime>F)||M&&!A());){var q=y.callback;if(typeof q=="function"){y.callback=null,v=y.priorityLevel;var G=q(y.expirationTime<=F);F=t.unstable_now(),typeof G=="function"?y.callback=G:y===n(c)&&r(c),E(F)}else r(c);y=n(c)}if(y!==null)var O=!0;else{var X=n(d);X!==null&&ee(D,X.startTime-F),O=!1}return O}finally{y=null,v=W,b=!1}}var L=!1,x=null,f=-1,m=5,w=-1;function A(){return!(t.unstable_now()-w<m)}function R(){if(x!==null){var M=t.unstable_now();w=M;var F=!0;try{F=x(!0,M)}finally{F?T():(L=!1,x=null)}}else L=!1}var T;if(typeof S=="function")T=function(){S(R)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,H=ae.port2;ae.port1.onmessage=R,T=function(){H.postMessage(null)}}else T=function(){N(R,0)};function te(M){x=M,L||(L=!0,T())}function ee(M,F){f=N(function(){M(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){P||b||(P=!0,te(V))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(M){switch(v){case 1:case 2:case 3:var F=3;break;default:F=v}var W=v;v=F;try{return M()}finally{v=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,F){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var W=v;v=M;try{return F()}finally{v=W}},t.unstable_scheduleCallback=function(M,F,W){var q=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?q+W:q):W=q,M){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=W+G,M={id:p++,callback:F,priorityLevel:M,startTime:W,expirationTime:G,sortIndex:-1},W>q?(M.sortIndex=W,e(d,M),n(c)===null&&M===n(d)&&(k?(C(f),f=-1):k=!0,ee(D,W-q))):(M.sortIndex=G,e(c,M),P||b||(P=!0,te(V))),M},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(M){var F=v;return function(){var W=v;v=F;try{return M.apply(this,arguments)}finally{v=W}}}})(jv);Pv.exports=jv;var d1=Pv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1=j,bn=d1;function Z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nv=new Set,oa={};function rs(t,e){Hs(t,e),Hs(t+"Capture",e)}function Hs(t,e){for(oa[t]=e,t=0;t<e.length;t++)Nv.add(e[t])}var Pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Md=Object.prototype.hasOwnProperty,f1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mg={},Vg={};function p1(t){return Md.call(Vg,t)?!0:Md.call(Mg,t)?!1:f1.test(t)?Vg[t]=!0:(Mg[t]=!0,!1)}function g1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function m1(t,e,n,r){if(e===null||typeof e>"u"||g1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wt[t]=new dn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wt[e]=new dn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wt[t]=new dn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wt[t]=new dn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wt[t]=new dn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wt[t]=new dn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wt[t]=new dn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wt[t]=new dn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wt[t]=new dn(t,5,!1,t.toLowerCase(),null,!1,!1)});var uf=/[\-:]([a-z])/g;function cf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(uf,cf);Wt[e]=new dn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(uf,cf);Wt[e]=new dn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(uf,cf);Wt[e]=new dn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wt[t]=new dn(t,1,!1,t.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wt[t]=new dn(t,1,!1,t.toLowerCase(),null,!0,!0)});function df(t,e,n,r){var i=Wt.hasOwnProperty(e)?Wt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(m1(e,n,i,r)&&(n=null),r||i===null?p1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Fr=h1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ml=Symbol.for("react.element"),ws=Symbol.for("react.portal"),Es=Symbol.for("react.fragment"),hf=Symbol.for("react.strict_mode"),Vd=Symbol.for("react.profiler"),Dv=Symbol.for("react.provider"),Ov=Symbol.for("react.context"),ff=Symbol.for("react.forward_ref"),Fd=Symbol.for("react.suspense"),Ud=Symbol.for("react.suspense_list"),pf=Symbol.for("react.memo"),Yr=Symbol.for("react.lazy"),Lv=Symbol.for("react.offscreen"),Fg=Symbol.iterator;function bo(t){return t===null||typeof t!="object"?null:(t=Fg&&t[Fg]||t["@@iterator"],typeof t=="function"?t:null)}var ut=Object.assign,Qc;function Oo(t){if(Qc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qc=e&&e[1]||""}return`
`+Qc+t}var Yc=!1;function Xc(t,e){if(!t||Yc)return"";Yc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,u=s.length-1;1<=o&&0<=u&&i[o]!==s[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==s[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==s[u]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=u);break}}}finally{Yc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oo(t):""}function y1(t){switch(t.tag){case 5:return Oo(t.type);case 16:return Oo("Lazy");case 13:return Oo("Suspense");case 19:return Oo("SuspenseList");case 0:case 2:case 15:return t=Xc(t.type,!1),t;case 11:return t=Xc(t.type.render,!1),t;case 1:return t=Xc(t.type,!0),t;default:return""}}function Bd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Es:return"Fragment";case ws:return"Portal";case Vd:return"Profiler";case hf:return"StrictMode";case Fd:return"Suspense";case Ud:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ov:return(t.displayName||"Context")+".Consumer";case Dv:return(t._context.displayName||"Context")+".Provider";case ff:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pf:return e=t.displayName||null,e!==null?e:Bd(t.type)||"Memo";case Yr:e=t._payload,t=t._init;try{return Bd(t(e))}catch{}}return null}function v1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bd(e);case 8:return e===hf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function mi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Mv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _1(t){var e=Mv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yl(t){t._valueTracker||(t._valueTracker=_1(t))}function Vv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Mv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function iu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zd(t,e){var n=e.checked;return ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ug(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=mi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Fv(t,e){e=e.checked,e!=null&&df(t,"checked",e,!1)}function $d(t,e){Fv(t,e);var n=mi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wd(t,e.type,mi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Bg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wd(t,e,n){(e!=="number"||iu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lo=Array.isArray;function Os(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+mi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function qd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Z(91));return ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Z(92));if(Lo(n)){if(1<n.length)throw Error(Z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:mi(n)}}function Uv(t,e){var n=mi(e.value),r=mi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function $g(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Bv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Bv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vl,zv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vl=vl||document.createElement("div"),vl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function aa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var qo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x1=["Webkit","ms","Moz","O"];Object.keys(qo).forEach(function(t){x1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qo[e]=qo[t]})});function $v(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||qo.hasOwnProperty(t)&&qo[t]?(""+e).trim():e+"px"}function Wv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=$v(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var w1=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kd(t,e){if(e){if(w1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Z(62))}}function Gd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qd=null;function gf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yd=null,Ls=null,Ms=null;function Wg(t){if(t=La(t)){if(typeof Yd!="function")throw Error(Z(280));var e=t.stateNode;e&&(e=Ju(e),Yd(t.stateNode,t.type,e))}}function qv(t){Ls?Ms?Ms.push(t):Ms=[t]:Ls=t}function Hv(){if(Ls){var t=Ls,e=Ms;if(Ms=Ls=null,Wg(t),e)for(t=0;t<e.length;t++)Wg(e[t])}}function Kv(t,e){return t(e)}function Gv(){}var Jc=!1;function Qv(t,e,n){if(Jc)return t(e,n);Jc=!0;try{return Kv(t,e,n)}finally{Jc=!1,(Ls!==null||Ms!==null)&&(Gv(),Hv())}}function la(t,e){var n=t.stateNode;if(n===null)return null;var r=Ju(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Z(231,e,typeof n));return n}var Xd=!1;if(Pr)try{var Co={};Object.defineProperty(Co,"passive",{get:function(){Xd=!0}}),window.addEventListener("test",Co,Co),window.removeEventListener("test",Co,Co)}catch{Xd=!1}function E1(t,e,n,r,i,s,o,u,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(p){this.onError(p)}}var Ho=!1,su=null,ou=!1,Jd=null,S1={onError:function(t){Ho=!0,su=t}};function I1(t,e,n,r,i,s,o,u,c){Ho=!1,su=null,E1.apply(S1,arguments)}function T1(t,e,n,r,i,s,o,u,c){if(I1.apply(this,arguments),Ho){if(Ho){var d=su;Ho=!1,su=null}else throw Error(Z(198));ou||(ou=!0,Jd=d)}}function is(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Yv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function qg(t){if(is(t)!==t)throw Error(Z(188))}function b1(t){var e=t.alternate;if(!e){if(e=is(t),e===null)throw Error(Z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qg(i),t;if(s===r)return qg(i),e;s=s.sibling}throw Error(Z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=s;break}if(u===r){o=!0,r=i,n=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===n){o=!0,n=s,r=i;break}if(u===r){o=!0,r=s,n=i;break}u=u.sibling}if(!o)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?t:e}function Xv(t){return t=b1(t),t!==null?Jv(t):null}function Jv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Jv(t);if(e!==null)return e;t=t.sibling}return null}var Zv=bn.unstable_scheduleCallback,Hg=bn.unstable_cancelCallback,C1=bn.unstable_shouldYield,A1=bn.unstable_requestPaint,mt=bn.unstable_now,R1=bn.unstable_getCurrentPriorityLevel,mf=bn.unstable_ImmediatePriority,e0=bn.unstable_UserBlockingPriority,au=bn.unstable_NormalPriority,k1=bn.unstable_LowPriority,t0=bn.unstable_IdlePriority,Gu=null,ir=null;function P1(t){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(Gu,t,void 0,(t.current.flags&128)===128)}catch{}}var Hn=Math.clz32?Math.clz32:D1,j1=Math.log,N1=Math.LN2;function D1(t){return t>>>=0,t===0?32:31-(j1(t)/N1|0)|0}var _l=64,xl=4194304;function Mo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=Mo(u):(s&=o,s!==0&&(r=Mo(s)))}else o=n&~i,o!==0?r=Mo(o):s!==0&&(r=Mo(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Hn(e),i=1<<n,r|=t[n],e&=~i;return r}function O1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Hn(s),u=1<<o,c=i[o];c===-1?(!(u&n)||u&r)&&(i[o]=O1(u,e)):c<=e&&(t.expiredLanes|=u),s&=~u}}function Zd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function n0(){var t=_l;return _l<<=1,!(_l&4194240)&&(_l=64),t}function Zc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Da(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hn(e),t[e]=n}function M1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Hn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function yf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Hn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ke=0;function r0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var i0,vf,s0,o0,a0,eh=!1,wl=[],ii=null,si=null,oi=null,ua=new Map,ca=new Map,Jr=[],V1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kg(t,e){switch(t){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":si=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":ua.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ca.delete(e.pointerId)}}function Ao(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=La(e),e!==null&&vf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function F1(t,e,n,r,i){switch(e){case"focusin":return ii=Ao(ii,t,e,n,r,i),!0;case"dragenter":return si=Ao(si,t,e,n,r,i),!0;case"mouseover":return oi=Ao(oi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ua.set(s,Ao(ua.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ca.set(s,Ao(ca.get(s)||null,t,e,n,r,i)),!0}return!1}function l0(t){var e=Mi(t.target);if(e!==null){var n=is(e);if(n!==null){if(e=n.tag,e===13){if(e=Yv(n),e!==null){t.blockedOn=e,a0(t.priority,function(){s0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ul(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=th(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qd=r,n.target.dispatchEvent(r),Qd=null}else return e=La(n),e!==null&&vf(e),t.blockedOn=n,!1;e.shift()}return!0}function Gg(t,e,n){Ul(t)&&n.delete(e)}function U1(){eh=!1,ii!==null&&Ul(ii)&&(ii=null),si!==null&&Ul(si)&&(si=null),oi!==null&&Ul(oi)&&(oi=null),ua.forEach(Gg),ca.forEach(Gg)}function Ro(t,e){t.blockedOn===e&&(t.blockedOn=null,eh||(eh=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,U1)))}function da(t){function e(i){return Ro(i,t)}if(0<wl.length){Ro(wl[0],t);for(var n=1;n<wl.length;n++){var r=wl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ii!==null&&Ro(ii,t),si!==null&&Ro(si,t),oi!==null&&Ro(oi,t),ua.forEach(e),ca.forEach(e),n=0;n<Jr.length;n++)r=Jr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jr.length&&(n=Jr[0],n.blockedOn===null);)l0(n),n.blockedOn===null&&Jr.shift()}var Vs=Fr.ReactCurrentBatchConfig,uu=!0;function B1(t,e,n,r){var i=Ke,s=Vs.transition;Vs.transition=null;try{Ke=1,_f(t,e,n,r)}finally{Ke=i,Vs.transition=s}}function z1(t,e,n,r){var i=Ke,s=Vs.transition;Vs.transition=null;try{Ke=4,_f(t,e,n,r)}finally{Ke=i,Vs.transition=s}}function _f(t,e,n,r){if(uu){var i=th(t,e,n,r);if(i===null)ud(t,e,r,cu,n),Kg(t,r);else if(F1(i,t,e,n,r))r.stopPropagation();else if(Kg(t,r),e&4&&-1<V1.indexOf(t)){for(;i!==null;){var s=La(i);if(s!==null&&i0(s),s=th(t,e,n,r),s===null&&ud(t,e,r,cu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ud(t,e,r,null,n)}}var cu=null;function th(t,e,n,r){if(cu=null,t=gf(r),t=Mi(t),t!==null)if(e=is(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Yv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cu=t,null}function u0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(R1()){case mf:return 1;case e0:return 4;case au:case k1:return 16;case t0:return 536870912;default:return 16}default:return 16}}var ei=null,xf=null,Bl=null;function c0(){if(Bl)return Bl;var t,e=xf,n=e.length,r,i="value"in ei?ei.value:ei.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Bl=i.slice(t,1<r?1-r:void 0)}function zl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function El(){return!0}function Qg(){return!1}function Rn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?El:Qg,this.isPropagationStopped=Qg,this}return ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=El)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=El)},persist:function(){},isPersistent:El}),e}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wf=Rn(lo),Oa=ut({},lo,{view:0,detail:0}),$1=Rn(Oa),ed,td,ko,Qu=ut({},Oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ef,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ko&&(ko&&t.type==="mousemove"?(ed=t.screenX-ko.screenX,td=t.screenY-ko.screenY):td=ed=0,ko=t),ed)},movementY:function(t){return"movementY"in t?t.movementY:td}}),Yg=Rn(Qu),W1=ut({},Qu,{dataTransfer:0}),q1=Rn(W1),H1=ut({},Oa,{relatedTarget:0}),nd=Rn(H1),K1=ut({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),G1=Rn(K1),Q1=ut({},lo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Y1=Rn(Q1),X1=ut({},lo,{data:0}),Xg=Rn(X1),J1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eS[t])?!!e[t]:!1}function Ef(){return tS}var nS=ut({},Oa,{key:function(t){if(t.key){var e=J1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Z1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ef,charCode:function(t){return t.type==="keypress"?zl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rS=Rn(nS),iS=ut({},Qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jg=Rn(iS),sS=ut({},Oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ef}),oS=Rn(sS),aS=ut({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),lS=Rn(aS),uS=ut({},Qu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),cS=Rn(uS),dS=[9,13,27,32],Sf=Pr&&"CompositionEvent"in window,Ko=null;Pr&&"documentMode"in document&&(Ko=document.documentMode);var hS=Pr&&"TextEvent"in window&&!Ko,d0=Pr&&(!Sf||Ko&&8<Ko&&11>=Ko),Zg=" ",em=!1;function h0(t,e){switch(t){case"keyup":return dS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function f0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ss=!1;function fS(t,e){switch(t){case"compositionend":return f0(e);case"keypress":return e.which!==32?null:(em=!0,Zg);case"textInput":return t=e.data,t===Zg&&em?null:t;default:return null}}function pS(t,e){if(Ss)return t==="compositionend"||!Sf&&h0(t,e)?(t=c0(),Bl=xf=ei=null,Ss=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return d0&&e.locale!=="ko"?null:e.data;default:return null}}var gS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gS[t.type]:e==="textarea"}function p0(t,e,n,r){qv(r),e=du(e,"onChange"),0<e.length&&(n=new wf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Go=null,ha=null;function mS(t){T0(t,0)}function Yu(t){var e=bs(t);if(Vv(e))return t}function yS(t,e){if(t==="change")return e}var g0=!1;if(Pr){var rd;if(Pr){var id="oninput"in document;if(!id){var nm=document.createElement("div");nm.setAttribute("oninput","return;"),id=typeof nm.oninput=="function"}rd=id}else rd=!1;g0=rd&&(!document.documentMode||9<document.documentMode)}function rm(){Go&&(Go.detachEvent("onpropertychange",m0),ha=Go=null)}function m0(t){if(t.propertyName==="value"&&Yu(ha)){var e=[];p0(e,ha,t,gf(t)),Qv(mS,e)}}function vS(t,e,n){t==="focusin"?(rm(),Go=e,ha=n,Go.attachEvent("onpropertychange",m0)):t==="focusout"&&rm()}function _S(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yu(ha)}function xS(t,e){if(t==="click")return Yu(e)}function wS(t,e){if(t==="input"||t==="change")return Yu(e)}function ES(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Gn=typeof Object.is=="function"?Object.is:ES;function fa(t,e){if(Gn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Md.call(e,i)||!Gn(t[i],e[i]))return!1}return!0}function im(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function sm(t,e){var n=im(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=im(n)}}function y0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?y0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function v0(){for(var t=window,e=iu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=iu(t.document)}return e}function If(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function SS(t){var e=v0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&y0(n.ownerDocument.documentElement,n)){if(r!==null&&If(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=sm(n,s);var o=sm(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var IS=Pr&&"documentMode"in document&&11>=document.documentMode,Is=null,nh=null,Qo=null,rh=!1;function om(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rh||Is==null||Is!==iu(r)||(r=Is,"selectionStart"in r&&If(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Qo&&fa(Qo,r)||(Qo=r,r=du(nh,"onSelect"),0<r.length&&(e=new wf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Is)))}function Sl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ts={animationend:Sl("Animation","AnimationEnd"),animationiteration:Sl("Animation","AnimationIteration"),animationstart:Sl("Animation","AnimationStart"),transitionend:Sl("Transition","TransitionEnd")},sd={},_0={};Pr&&(_0=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function Xu(t){if(sd[t])return sd[t];if(!Ts[t])return t;var e=Ts[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in _0)return sd[t]=e[n];return t}var x0=Xu("animationend"),w0=Xu("animationiteration"),E0=Xu("animationstart"),S0=Xu("transitionend"),I0=new Map,am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(t,e){I0.set(t,e),rs(e,[t])}for(var od=0;od<am.length;od++){var ad=am[od],TS=ad.toLowerCase(),bS=ad[0].toUpperCase()+ad.slice(1);Ei(TS,"on"+bS)}Ei(x0,"onAnimationEnd");Ei(w0,"onAnimationIteration");Ei(E0,"onAnimationStart");Ei("dblclick","onDoubleClick");Ei("focusin","onFocus");Ei("focusout","onBlur");Ei(S0,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vo));function lm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,T1(r,e,void 0,t),t.currentTarget=null}function T0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var u=r[o],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==s&&i.isPropagationStopped())break e;lm(i,u,d),s=c}else for(o=0;o<r.length;o++){if(u=r[o],c=u.instance,d=u.currentTarget,u=u.listener,c!==s&&i.isPropagationStopped())break e;lm(i,u,d),s=c}}}if(ou)throw t=Jd,ou=!1,Jd=null,t}function tt(t,e){var n=e[lh];n===void 0&&(n=e[lh]=new Set);var r=t+"__bubble";n.has(r)||(b0(e,t,2,!1),n.add(r))}function ld(t,e,n){var r=0;e&&(r|=4),b0(n,t,r,e)}var Il="_reactListening"+Math.random().toString(36).slice(2);function pa(t){if(!t[Il]){t[Il]=!0,Nv.forEach(function(n){n!=="selectionchange"&&(CS.has(n)||ld(n,!1,t),ld(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Il]||(e[Il]=!0,ld("selectionchange",!1,e))}}function b0(t,e,n,r){switch(u0(e)){case 1:var i=B1;break;case 4:i=z1;break;default:i=_f}n=i.bind(null,e,n,t),i=void 0,!Xd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ud(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;u!==null;){if(o=Mi(u),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}u=u.parentNode}}r=r.return}Qv(function(){var d=s,p=gf(n),y=[];e:{var v=I0.get(t);if(v!==void 0){var b=wf,P=t;switch(t){case"keypress":if(zl(n)===0)break e;case"keydown":case"keyup":b=rS;break;case"focusin":P="focus",b=nd;break;case"focusout":P="blur",b=nd;break;case"beforeblur":case"afterblur":b=nd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=Yg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=q1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=oS;break;case x0:case w0:case E0:b=G1;break;case S0:b=lS;break;case"scroll":b=$1;break;case"wheel":b=cS;break;case"copy":case"cut":case"paste":b=Y1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=Jg}var k=(e&4)!==0,N=!k&&t==="scroll",C=k?v!==null?v+"Capture":null:v;k=[];for(var S=d,E;S!==null;){E=S;var D=E.stateNode;if(E.tag===5&&D!==null&&(E=D,C!==null&&(D=la(S,C),D!=null&&k.push(ga(S,D,E)))),N)break;S=S.return}0<k.length&&(v=new b(v,P,null,n,p),y.push({event:v,listeners:k}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",b=t==="mouseout"||t==="pointerout",v&&n!==Qd&&(P=n.relatedTarget||n.fromElement)&&(Mi(P)||P[jr]))break e;if((b||v)&&(v=p.window===p?p:(v=p.ownerDocument)?v.defaultView||v.parentWindow:window,b?(P=n.relatedTarget||n.toElement,b=d,P=P?Mi(P):null,P!==null&&(N=is(P),P!==N||P.tag!==5&&P.tag!==6)&&(P=null)):(b=null,P=d),b!==P)){if(k=Yg,D="onMouseLeave",C="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(k=Jg,D="onPointerLeave",C="onPointerEnter",S="pointer"),N=b==null?v:bs(b),E=P==null?v:bs(P),v=new k(D,S+"leave",b,n,p),v.target=N,v.relatedTarget=E,D=null,Mi(p)===d&&(k=new k(C,S+"enter",P,n,p),k.target=E,k.relatedTarget=N,D=k),N=D,b&&P)t:{for(k=b,C=P,S=0,E=k;E;E=gs(E))S++;for(E=0,D=C;D;D=gs(D))E++;for(;0<S-E;)k=gs(k),S--;for(;0<E-S;)C=gs(C),E--;for(;S--;){if(k===C||C!==null&&k===C.alternate)break t;k=gs(k),C=gs(C)}k=null}else k=null;b!==null&&um(y,v,b,k,!1),P!==null&&N!==null&&um(y,N,P,k,!0)}}e:{if(v=d?bs(d):window,b=v.nodeName&&v.nodeName.toLowerCase(),b==="select"||b==="input"&&v.type==="file")var V=yS;else if(tm(v))if(g0)V=wS;else{V=_S;var L=vS}else(b=v.nodeName)&&b.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(V=xS);if(V&&(V=V(t,d))){p0(y,V,n,p);break e}L&&L(t,v,d),t==="focusout"&&(L=v._wrapperState)&&L.controlled&&v.type==="number"&&Wd(v,"number",v.value)}switch(L=d?bs(d):window,t){case"focusin":(tm(L)||L.contentEditable==="true")&&(Is=L,nh=d,Qo=null);break;case"focusout":Qo=nh=Is=null;break;case"mousedown":rh=!0;break;case"contextmenu":case"mouseup":case"dragend":rh=!1,om(y,n,p);break;case"selectionchange":if(IS)break;case"keydown":case"keyup":om(y,n,p)}var x;if(Sf)e:{switch(t){case"compositionstart":var f="onCompositionStart";break e;case"compositionend":f="onCompositionEnd";break e;case"compositionupdate":f="onCompositionUpdate";break e}f=void 0}else Ss?h0(t,n)&&(f="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(f="onCompositionStart");f&&(d0&&n.locale!=="ko"&&(Ss||f!=="onCompositionStart"?f==="onCompositionEnd"&&Ss&&(x=c0()):(ei=p,xf="value"in ei?ei.value:ei.textContent,Ss=!0)),L=du(d,f),0<L.length&&(f=new Xg(f,t,null,n,p),y.push({event:f,listeners:L}),x?f.data=x:(x=f0(n),x!==null&&(f.data=x)))),(x=hS?fS(t,n):pS(t,n))&&(d=du(d,"onBeforeInput"),0<d.length&&(p=new Xg("onBeforeInput","beforeinput",null,n,p),y.push({event:p,listeners:d}),p.data=x))}T0(y,e)})}function ga(t,e,n){return{instance:t,listener:e,currentTarget:n}}function du(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=la(t,n),s!=null&&r.unshift(ga(t,s,i)),s=la(t,e),s!=null&&r.push(ga(t,s,i))),t=t.return}return r}function gs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function um(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var u=n,c=u.alternate,d=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&d!==null&&(u=d,i?(c=la(n,s),c!=null&&o.unshift(ga(n,c,u))):i||(c=la(n,s),c!=null&&o.push(ga(n,c,u)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var AS=/\r\n?/g,RS=/\u0000|\uFFFD/g;function cm(t){return(typeof t=="string"?t:""+t).replace(AS,`
`).replace(RS,"")}function Tl(t,e,n){if(e=cm(e),cm(t)!==e&&n)throw Error(Z(425))}function hu(){}var ih=null,sh=null;function oh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ah=typeof setTimeout=="function"?setTimeout:void 0,kS=typeof clearTimeout=="function"?clearTimeout:void 0,dm=typeof Promise=="function"?Promise:void 0,PS=typeof queueMicrotask=="function"?queueMicrotask:typeof dm<"u"?function(t){return dm.resolve(null).then(t).catch(jS)}:ah;function jS(t){setTimeout(function(){throw t})}function cd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),da(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);da(e)}function ai(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function hm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var uo=Math.random().toString(36).slice(2),nr="__reactFiber$"+uo,ma="__reactProps$"+uo,jr="__reactContainer$"+uo,lh="__reactEvents$"+uo,NS="__reactListeners$"+uo,DS="__reactHandles$"+uo;function Mi(t){var e=t[nr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jr]||n[nr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=hm(t);t!==null;){if(n=t[nr])return n;t=hm(t)}return e}t=n,n=t.parentNode}return null}function La(t){return t=t[nr]||t[jr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function bs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Z(33))}function Ju(t){return t[ma]||null}var uh=[],Cs=-1;function Si(t){return{current:t}}function rt(t){0>Cs||(t.current=uh[Cs],uh[Cs]=null,Cs--)}function Ze(t,e){Cs++,uh[Cs]=t.current,t.current=e}var yi={},nn=Si(yi),yn=Si(!1),Wi=yi;function Ks(t,e){var n=t.type.contextTypes;if(!n)return yi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vn(t){return t=t.childContextTypes,t!=null}function fu(){rt(yn),rt(nn)}function fm(t,e,n){if(nn.current!==yi)throw Error(Z(168));Ze(nn,e),Ze(yn,n)}function C0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Z(108,v1(t)||"Unknown",i));return ut({},n,r)}function pu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yi,Wi=nn.current,Ze(nn,t),Ze(yn,yn.current),!0}function pm(t,e,n){var r=t.stateNode;if(!r)throw Error(Z(169));n?(t=C0(t,e,Wi),r.__reactInternalMemoizedMergedChildContext=t,rt(yn),rt(nn),Ze(nn,t)):rt(yn),Ze(yn,n)}var yr=null,Zu=!1,dd=!1;function A0(t){yr===null?yr=[t]:yr.push(t)}function OS(t){Zu=!0,A0(t)}function Ii(){if(!dd&&yr!==null){dd=!0;var t=0,e=Ke;try{var n=yr;for(Ke=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}yr=null,Zu=!1}catch(i){throw yr!==null&&(yr=yr.slice(t+1)),Zv(mf,Ii),i}finally{Ke=e,dd=!1}}return null}var As=[],Rs=0,gu=null,mu=0,jn=[],Nn=0,qi=null,Er=1,Sr="";function Di(t,e){As[Rs++]=mu,As[Rs++]=gu,gu=t,mu=e}function R0(t,e,n){jn[Nn++]=Er,jn[Nn++]=Sr,jn[Nn++]=qi,qi=t;var r=Er;t=Sr;var i=32-Hn(r)-1;r&=~(1<<i),n+=1;var s=32-Hn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Er=1<<32-Hn(e)+i|n<<i|r,Sr=s+t}else Er=1<<s|n<<i|r,Sr=t}function Tf(t){t.return!==null&&(Di(t,1),R0(t,1,0))}function bf(t){for(;t===gu;)gu=As[--Rs],As[Rs]=null,mu=As[--Rs],As[Rs]=null;for(;t===qi;)qi=jn[--Nn],jn[Nn]=null,Sr=jn[--Nn],jn[Nn]=null,Er=jn[--Nn],jn[Nn]=null}var Tn=null,Sn=null,st=!1,qn=null;function k0(t,e){var n=Dn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function gm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tn=t,Sn=ai(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tn=t,Sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qi!==null?{id:Er,overflow:Sr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Dn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Tn=t,Sn=null,!0):!1;default:return!1}}function ch(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dh(t){if(st){var e=Sn;if(e){var n=e;if(!gm(t,e)){if(ch(t))throw Error(Z(418));e=ai(n.nextSibling);var r=Tn;e&&gm(t,e)?k0(r,n):(t.flags=t.flags&-4097|2,st=!1,Tn=t)}}else{if(ch(t))throw Error(Z(418));t.flags=t.flags&-4097|2,st=!1,Tn=t}}}function mm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tn=t}function bl(t){if(t!==Tn)return!1;if(!st)return mm(t),st=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!oh(t.type,t.memoizedProps)),e&&(e=Sn)){if(ch(t))throw P0(),Error(Z(418));for(;e;)k0(t,e),e=ai(e.nextSibling)}if(mm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sn=ai(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sn=null}}else Sn=Tn?ai(t.stateNode.nextSibling):null;return!0}function P0(){for(var t=Sn;t;)t=ai(t.nextSibling)}function Gs(){Sn=Tn=null,st=!1}function Cf(t){qn===null?qn=[t]:qn.push(t)}var LS=Fr.ReactCurrentBatchConfig;function Po(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var u=i.refs;o===null?delete u[s]:u[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,t))}return t}function Cl(t,e){throw t=Object.prototype.toString.call(e),Error(Z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ym(t){var e=t._init;return e(t._payload)}function j0(t){function e(C,S){if(t){var E=C.deletions;E===null?(C.deletions=[S],C.flags|=16):E.push(S)}}function n(C,S){if(!t)return null;for(;S!==null;)e(C,S),S=S.sibling;return null}function r(C,S){for(C=new Map;S!==null;)S.key!==null?C.set(S.key,S):C.set(S.index,S),S=S.sibling;return C}function i(C,S){return C=di(C,S),C.index=0,C.sibling=null,C}function s(C,S,E){return C.index=E,t?(E=C.alternate,E!==null?(E=E.index,E<S?(C.flags|=2,S):E):(C.flags|=2,S)):(C.flags|=1048576,S)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function u(C,S,E,D){return S===null||S.tag!==6?(S=vd(E,C.mode,D),S.return=C,S):(S=i(S,E),S.return=C,S)}function c(C,S,E,D){var V=E.type;return V===Es?p(C,S,E.props.children,D,E.key):S!==null&&(S.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Yr&&ym(V)===S.type)?(D=i(S,E.props),D.ref=Po(C,S,E),D.return=C,D):(D=Ql(E.type,E.key,E.props,null,C.mode,D),D.ref=Po(C,S,E),D.return=C,D)}function d(C,S,E,D){return S===null||S.tag!==4||S.stateNode.containerInfo!==E.containerInfo||S.stateNode.implementation!==E.implementation?(S=_d(E,C.mode,D),S.return=C,S):(S=i(S,E.children||[]),S.return=C,S)}function p(C,S,E,D,V){return S===null||S.tag!==7?(S=zi(E,C.mode,D,V),S.return=C,S):(S=i(S,E),S.return=C,S)}function y(C,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return S=vd(""+S,C.mode,E),S.return=C,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ml:return E=Ql(S.type,S.key,S.props,null,C.mode,E),E.ref=Po(C,null,S),E.return=C,E;case ws:return S=_d(S,C.mode,E),S.return=C,S;case Yr:var D=S._init;return y(C,D(S._payload),E)}if(Lo(S)||bo(S))return S=zi(S,C.mode,E,null),S.return=C,S;Cl(C,S)}return null}function v(C,S,E,D){var V=S!==null?S.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return V!==null?null:u(C,S,""+E,D);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ml:return E.key===V?c(C,S,E,D):null;case ws:return E.key===V?d(C,S,E,D):null;case Yr:return V=E._init,v(C,S,V(E._payload),D)}if(Lo(E)||bo(E))return V!==null?null:p(C,S,E,D,null);Cl(C,E)}return null}function b(C,S,E,D,V){if(typeof D=="string"&&D!==""||typeof D=="number")return C=C.get(E)||null,u(S,C,""+D,V);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ml:return C=C.get(D.key===null?E:D.key)||null,c(S,C,D,V);case ws:return C=C.get(D.key===null?E:D.key)||null,d(S,C,D,V);case Yr:var L=D._init;return b(C,S,E,L(D._payload),V)}if(Lo(D)||bo(D))return C=C.get(E)||null,p(S,C,D,V,null);Cl(S,D)}return null}function P(C,S,E,D){for(var V=null,L=null,x=S,f=S=0,m=null;x!==null&&f<E.length;f++){x.index>f?(m=x,x=null):m=x.sibling;var w=v(C,x,E[f],D);if(w===null){x===null&&(x=m);break}t&&x&&w.alternate===null&&e(C,x),S=s(w,S,f),L===null?V=w:L.sibling=w,L=w,x=m}if(f===E.length)return n(C,x),st&&Di(C,f),V;if(x===null){for(;f<E.length;f++)x=y(C,E[f],D),x!==null&&(S=s(x,S,f),L===null?V=x:L.sibling=x,L=x);return st&&Di(C,f),V}for(x=r(C,x);f<E.length;f++)m=b(x,C,f,E[f],D),m!==null&&(t&&m.alternate!==null&&x.delete(m.key===null?f:m.key),S=s(m,S,f),L===null?V=m:L.sibling=m,L=m);return t&&x.forEach(function(A){return e(C,A)}),st&&Di(C,f),V}function k(C,S,E,D){var V=bo(E);if(typeof V!="function")throw Error(Z(150));if(E=V.call(E),E==null)throw Error(Z(151));for(var L=V=null,x=S,f=S=0,m=null,w=E.next();x!==null&&!w.done;f++,w=E.next()){x.index>f?(m=x,x=null):m=x.sibling;var A=v(C,x,w.value,D);if(A===null){x===null&&(x=m);break}t&&x&&A.alternate===null&&e(C,x),S=s(A,S,f),L===null?V=A:L.sibling=A,L=A,x=m}if(w.done)return n(C,x),st&&Di(C,f),V;if(x===null){for(;!w.done;f++,w=E.next())w=y(C,w.value,D),w!==null&&(S=s(w,S,f),L===null?V=w:L.sibling=w,L=w);return st&&Di(C,f),V}for(x=r(C,x);!w.done;f++,w=E.next())w=b(x,C,f,w.value,D),w!==null&&(t&&w.alternate!==null&&x.delete(w.key===null?f:w.key),S=s(w,S,f),L===null?V=w:L.sibling=w,L=w);return t&&x.forEach(function(R){return e(C,R)}),st&&Di(C,f),V}function N(C,S,E,D){if(typeof E=="object"&&E!==null&&E.type===Es&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case ml:e:{for(var V=E.key,L=S;L!==null;){if(L.key===V){if(V=E.type,V===Es){if(L.tag===7){n(C,L.sibling),S=i(L,E.props.children),S.return=C,C=S;break e}}else if(L.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Yr&&ym(V)===L.type){n(C,L.sibling),S=i(L,E.props),S.ref=Po(C,L,E),S.return=C,C=S;break e}n(C,L);break}else e(C,L);L=L.sibling}E.type===Es?(S=zi(E.props.children,C.mode,D,E.key),S.return=C,C=S):(D=Ql(E.type,E.key,E.props,null,C.mode,D),D.ref=Po(C,S,E),D.return=C,C=D)}return o(C);case ws:e:{for(L=E.key;S!==null;){if(S.key===L)if(S.tag===4&&S.stateNode.containerInfo===E.containerInfo&&S.stateNode.implementation===E.implementation){n(C,S.sibling),S=i(S,E.children||[]),S.return=C,C=S;break e}else{n(C,S);break}else e(C,S);S=S.sibling}S=_d(E,C.mode,D),S.return=C,C=S}return o(C);case Yr:return L=E._init,N(C,S,L(E._payload),D)}if(Lo(E))return P(C,S,E,D);if(bo(E))return k(C,S,E,D);Cl(C,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,S!==null&&S.tag===6?(n(C,S.sibling),S=i(S,E),S.return=C,C=S):(n(C,S),S=vd(E,C.mode,D),S.return=C,C=S),o(C)):n(C,S)}return N}var Qs=j0(!0),N0=j0(!1),yu=Si(null),vu=null,ks=null,Af=null;function Rf(){Af=ks=vu=null}function kf(t){var e=yu.current;rt(yu),t._currentValue=e}function hh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Fs(t,e){vu=t,Af=ks=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mn=!0),t.firstContext=null)}function Vn(t){var e=t._currentValue;if(Af!==t)if(t={context:t,memoizedValue:e,next:null},ks===null){if(vu===null)throw Error(Z(308));ks=t,vu.dependencies={lanes:0,firstContext:t}}else ks=ks.next=t;return e}var Vi=null;function Pf(t){Vi===null?Vi=[t]:Vi.push(t)}function D0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Pf(e)):(n.next=i.next,i.next=n),e.interleaved=n,Nr(t,r)}function Nr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xr=!1;function jf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function O0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Cr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function li(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Nr(t,n)}return i=r.interleaved,i===null?(e.next=e,Pf(r)):(e.next=i.next,i.next=e),r.interleaved=e,Nr(t,n)}function $l(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yf(t,n)}}function vm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _u(t,e,n,r){var i=t.updateQueue;Xr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var p=t.alternate;p!==null&&(p=p.updateQueue,u=p.lastBaseUpdate,u!==o&&(u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=c))}if(s!==null){var y=i.baseState;o=0,p=d=c=null,u=s;do{var v=u.lane,b=u.eventTime;if((r&v)===v){p!==null&&(p=p.next={eventTime:b,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var P=t,k=u;switch(v=e,b=n,k.tag){case 1:if(P=k.payload,typeof P=="function"){y=P.call(b,y,v);break e}y=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=k.payload,v=typeof P=="function"?P.call(b,y,v):P,v==null)break e;y=ut({},y,v);break e;case 2:Xr=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,v=i.effects,v===null?i.effects=[u]:v.push(u))}else b={eventTime:b,lane:v,tag:u.tag,payload:u.payload,callback:u.callback,next:null},p===null?(d=p=b,c=y):p=p.next=b,o|=v;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;v=u,u=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(p===null&&(c=y),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ki|=o,t.lanes=o,t.memoizedState=y}}function _m(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Z(191,i));i.call(r)}}}var Ma={},sr=Si(Ma),ya=Si(Ma),va=Si(Ma);function Fi(t){if(t===Ma)throw Error(Z(174));return t}function Nf(t,e){switch(Ze(va,e),Ze(ya,t),Ze(sr,Ma),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hd(e,t)}rt(sr),Ze(sr,e)}function Ys(){rt(sr),rt(ya),rt(va)}function L0(t){Fi(va.current);var e=Fi(sr.current),n=Hd(e,t.type);e!==n&&(Ze(ya,t),Ze(sr,n))}function Df(t){ya.current===t&&(rt(sr),rt(ya))}var at=Si(0);function xu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hd=[];function Of(){for(var t=0;t<hd.length;t++)hd[t]._workInProgressVersionPrimary=null;hd.length=0}var Wl=Fr.ReactCurrentDispatcher,fd=Fr.ReactCurrentBatchConfig,Hi=0,lt=null,bt=null,jt=null,wu=!1,Yo=!1,_a=0,MS=0;function Yt(){throw Error(Z(321))}function Lf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Gn(t[n],e[n]))return!1;return!0}function Mf(t,e,n,r,i,s){if(Hi=s,lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wl.current=t===null||t.memoizedState===null?BS:zS,t=n(r,i),Yo){s=0;do{if(Yo=!1,_a=0,25<=s)throw Error(Z(301));s+=1,jt=bt=null,e.updateQueue=null,Wl.current=$S,t=n(r,i)}while(Yo)}if(Wl.current=Eu,e=bt!==null&&bt.next!==null,Hi=0,jt=bt=lt=null,wu=!1,e)throw Error(Z(300));return t}function Vf(){var t=_a!==0;return _a=0,t}function tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?lt.memoizedState=jt=t:jt=jt.next=t,jt}function Fn(){if(bt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=bt.next;var e=jt===null?lt.memoizedState:jt.next;if(e!==null)jt=e,bt=t;else{if(t===null)throw Error(Z(310));bt=t,t={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},jt===null?lt.memoizedState=jt=t:jt=jt.next=t}return jt}function xa(t,e){return typeof e=="function"?e(t):e}function pd(t){var e=Fn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=bt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=o=null,c=null,d=s;do{var p=d.lane;if((Hi&p)===p)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var y={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=y,o=r):c=c.next=y,lt.lanes|=p,Ki|=p}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=u,Gn(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,lt.lanes|=s,Ki|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gd(t){var e=Fn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Gn(s,e.memoizedState)||(mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function M0(){}function V0(t,e){var n=lt,r=Fn(),i=e(),s=!Gn(r.memoizedState,i);if(s&&(r.memoizedState=i,mn=!0),r=r.queue,Ff(B0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,wa(9,U0.bind(null,n,r,i,e),void 0,null),Dt===null)throw Error(Z(349));Hi&30||F0(n,e,i)}return i}function F0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function U0(t,e,n,r){e.value=n,e.getSnapshot=r,z0(e)&&$0(t)}function B0(t,e,n){return n(function(){z0(e)&&$0(t)})}function z0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Gn(t,n)}catch{return!0}}function $0(t){var e=Nr(t,1);e!==null&&Kn(e,t,1,-1)}function xm(t){var e=tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:t},e.queue=t,t=t.dispatch=US.bind(null,lt,t),[e.memoizedState,t]}function wa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function W0(){return Fn().memoizedState}function ql(t,e,n,r){var i=tr();lt.flags|=t,i.memoizedState=wa(1|e,n,void 0,r===void 0?null:r)}function ec(t,e,n,r){var i=Fn();r=r===void 0?null:r;var s=void 0;if(bt!==null){var o=bt.memoizedState;if(s=o.destroy,r!==null&&Lf(r,o.deps)){i.memoizedState=wa(e,n,s,r);return}}lt.flags|=t,i.memoizedState=wa(1|e,n,s,r)}function wm(t,e){return ql(8390656,8,t,e)}function Ff(t,e){return ec(2048,8,t,e)}function q0(t,e){return ec(4,2,t,e)}function H0(t,e){return ec(4,4,t,e)}function K0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function G0(t,e,n){return n=n!=null?n.concat([t]):null,ec(4,4,K0.bind(null,e,t),n)}function Uf(){}function Q0(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Y0(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function X0(t,e,n){return Hi&21?(Gn(n,e)||(n=n0(),lt.lanes|=n,Ki|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=n)}function VS(t,e){var n=Ke;Ke=n!==0&&4>n?n:4,t(!0);var r=fd.transition;fd.transition={};try{t(!1),e()}finally{Ke=n,fd.transition=r}}function J0(){return Fn().memoizedState}function FS(t,e,n){var r=ci(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Z0(t))e_(e,n);else if(n=D0(t,e,n,r),n!==null){var i=an();Kn(n,t,r,i),t_(n,e,r)}}function US(t,e,n){var r=ci(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Z0(t))e_(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,u=s(o,n);if(i.hasEagerState=!0,i.eagerState=u,Gn(u,o)){var c=e.interleaved;c===null?(i.next=i,Pf(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=D0(t,e,i,r),n!==null&&(i=an(),Kn(n,t,r,i),t_(n,e,r))}}function Z0(t){var e=t.alternate;return t===lt||e!==null&&e===lt}function e_(t,e){Yo=wu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function t_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yf(t,n)}}var Eu={readContext:Vn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},BS={readContext:Vn,useCallback:function(t,e){return tr().memoizedState=[t,e===void 0?null:e],t},useContext:Vn,useEffect:wm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ql(4194308,4,K0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ql(4194308,4,t,e)},useInsertionEffect:function(t,e){return ql(4,2,t,e)},useMemo:function(t,e){var n=tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FS.bind(null,lt,t),[r.memoizedState,t]},useRef:function(t){var e=tr();return t={current:t},e.memoizedState=t},useState:xm,useDebugValue:Uf,useDeferredValue:function(t){return tr().memoizedState=t},useTransition:function(){var t=xm(!1),e=t[0];return t=VS.bind(null,t[1]),tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=lt,i=tr();if(st){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=e(),Dt===null)throw Error(Z(349));Hi&30||F0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,wm(B0.bind(null,r,s,t),[t]),r.flags|=2048,wa(9,U0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=tr(),e=Dt.identifierPrefix;if(st){var n=Sr,r=Er;n=(r&~(1<<32-Hn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=_a++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=MS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zS={readContext:Vn,useCallback:Q0,useContext:Vn,useEffect:Ff,useImperativeHandle:G0,useInsertionEffect:q0,useLayoutEffect:H0,useMemo:Y0,useReducer:pd,useRef:W0,useState:function(){return pd(xa)},useDebugValue:Uf,useDeferredValue:function(t){var e=Fn();return X0(e,bt.memoizedState,t)},useTransition:function(){var t=pd(xa)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:M0,useSyncExternalStore:V0,useId:J0,unstable_isNewReconciler:!1},$S={readContext:Vn,useCallback:Q0,useContext:Vn,useEffect:Ff,useImperativeHandle:G0,useInsertionEffect:q0,useLayoutEffect:H0,useMemo:Y0,useReducer:gd,useRef:W0,useState:function(){return gd(xa)},useDebugValue:Uf,useDeferredValue:function(t){var e=Fn();return bt===null?e.memoizedState=t:X0(e,bt.memoizedState,t)},useTransition:function(){var t=gd(xa)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:M0,useSyncExternalStore:V0,useId:J0,unstable_isNewReconciler:!1};function $n(t,e){if(t&&t.defaultProps){e=ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tc={isMounted:function(t){return(t=t._reactInternals)?is(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=an(),i=ci(t),s=Cr(r,i);s.payload=e,n!=null&&(s.callback=n),e=li(t,s,i),e!==null&&(Kn(e,t,i,r),$l(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=an(),i=ci(t),s=Cr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=li(t,s,i),e!==null&&(Kn(e,t,i,r),$l(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=an(),r=ci(t),i=Cr(n,r);i.tag=2,e!=null&&(i.callback=e),e=li(t,i,r),e!==null&&(Kn(e,t,r,n),$l(e,t,r))}};function Em(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!fa(n,r)||!fa(i,s):!0}function n_(t,e,n){var r=!1,i=yi,s=e.contextType;return typeof s=="object"&&s!==null?s=Vn(s):(i=vn(e)?Wi:nn.current,r=e.contextTypes,s=(r=r!=null)?Ks(t,i):yi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Sm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&tc.enqueueReplaceState(e,e.state,null)}function ph(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},jf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Vn(s):(s=vn(e)?Wi:nn.current,i.context=Ks(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(fh(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&tc.enqueueReplaceState(i,i.state,null),_u(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Xs(t,e){try{var n="",r=e;do n+=y1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function md(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function gh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WS=typeof WeakMap=="function"?WeakMap:Map;function r_(t,e,n){n=Cr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Iu||(Iu=!0,Th=r),gh(t,e)},n}function i_(t,e,n){n=Cr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){gh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){gh(t,e),typeof r!="function"&&(ui===null?ui=new Set([this]):ui.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Im(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WS;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=iI.bind(null,t,e,n),e.then(t,t))}function Tm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bm(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Cr(-1,1),e.tag=2,li(n,e,1))),n.lanes|=1),t)}var qS=Fr.ReactCurrentOwner,mn=!1;function on(t,e,n,r){e.child=t===null?N0(e,null,n,r):Qs(e,t.child,n,r)}function Cm(t,e,n,r,i){n=n.render;var s=e.ref;return Fs(e,i),r=Mf(t,e,n,r,s,i),n=Vf(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Dr(t,e,i)):(st&&n&&Tf(e),e.flags|=1,on(t,e,r,i),e.child)}function Am(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Gf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,s_(t,e,s,r,i)):(t=Ql(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:fa,n(o,r)&&t.ref===e.ref)return Dr(t,e,i)}return e.flags|=1,t=di(s,r),t.ref=e.ref,t.return=e,e.child=t}function s_(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(fa(s,r)&&t.ref===e.ref)if(mn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(mn=!0);else return e.lanes=t.lanes,Dr(t,e,i)}return mh(t,e,n,r,i)}function o_(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(js,En),En|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ze(js,En),En|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ze(js,En),En|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ze(js,En),En|=r;return on(t,e,i,n),e.child}function a_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mh(t,e,n,r,i){var s=vn(n)?Wi:nn.current;return s=Ks(e,s),Fs(e,i),n=Mf(t,e,n,r,s,i),r=Vf(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Dr(t,e,i)):(st&&r&&Tf(e),e.flags|=1,on(t,e,n,i),e.child)}function Rm(t,e,n,r,i){if(vn(n)){var s=!0;pu(e)}else s=!1;if(Fs(e,i),e.stateNode===null)Hl(t,e),n_(e,n,r),ph(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,u=e.memoizedProps;o.props=u;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Vn(d):(d=vn(n)?Wi:nn.current,d=Ks(e,d));var p=n.getDerivedStateFromProps,y=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";y||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||c!==d)&&Sm(e,o,r,d),Xr=!1;var v=e.memoizedState;o.state=v,_u(e,r,o,i),c=e.memoizedState,u!==r||v!==c||yn.current||Xr?(typeof p=="function"&&(fh(e,n,p,r),c=e.memoizedState),(u=Xr||Em(e,n,u,r,v,c,d))?(y||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=u):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,O0(t,e),u=e.memoizedProps,d=e.type===e.elementType?u:$n(e.type,u),o.props=d,y=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Vn(c):(c=vn(n)?Wi:nn.current,c=Ks(e,c));var b=n.getDerivedStateFromProps;(p=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==y||v!==c)&&Sm(e,o,r,c),Xr=!1,v=e.memoizedState,o.state=v,_u(e,r,o,i);var P=e.memoizedState;u!==y||v!==P||yn.current||Xr?(typeof b=="function"&&(fh(e,n,b,r),P=e.memoizedState),(d=Xr||Em(e,n,d,r,v,P,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,P,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,P,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=P),o.props=r,o.state=P,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return yh(t,e,n,r,s,i)}function yh(t,e,n,r,i,s){a_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&pm(e,n,!1),Dr(t,e,s);r=e.stateNode,qS.current=e;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Qs(e,t.child,null,s),e.child=Qs(e,null,u,s)):on(t,e,u,s),e.memoizedState=r.state,i&&pm(e,n,!0),e.child}function l_(t){var e=t.stateNode;e.pendingContext?fm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&fm(t,e.context,!1),Nf(t,e.containerInfo)}function km(t,e,n,r,i){return Gs(),Cf(i),e.flags|=256,on(t,e,n,r),e.child}var vh={dehydrated:null,treeContext:null,retryLane:0};function _h(t){return{baseLanes:t,cachePool:null,transitions:null}}function u_(t,e,n){var r=e.pendingProps,i=at.current,s=!1,o=(e.flags&128)!==0,u;if((u=o)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ze(at,i&1),t===null)return dh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ic(o,r,0,null),t=zi(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=_h(n),e.memoizedState=vh,t):Bf(e,o));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return HS(t,e,o,r,u,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=di(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=di(u,s):(s=zi(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?_h(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=vh,r}return s=t.child,t=s.sibling,r=di(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bf(t,e){return e=ic({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Al(t,e,n,r){return r!==null&&Cf(r),Qs(e,t.child,null,n),t=Bf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HS(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=md(Error(Z(422))),Al(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ic({mode:"visible",children:r.children},i,0,null),s=zi(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Qs(e,t.child,null,o),e.child.memoizedState=_h(o),e.memoizedState=vh,s);if(!(e.mode&1))return Al(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(Z(419)),r=md(s,r,void 0),Al(t,e,o,r)}if(u=(o&t.childLanes)!==0,mn||u){if(r=Dt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Nr(t,i),Kn(r,t,i,-1))}return Kf(),r=md(Error(Z(421))),Al(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=sI.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Sn=ai(i.nextSibling),Tn=e,st=!0,qn=null,t!==null&&(jn[Nn++]=Er,jn[Nn++]=Sr,jn[Nn++]=qi,Er=t.id,Sr=t.overflow,qi=e),e=Bf(e,r.children),e.flags|=4096,e)}function Pm(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hh(t.return,e,n)}function yd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function c_(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(on(t,e,r.children,n),r=at.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Pm(t,n,e);else if(t.tag===19)Pm(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ze(at,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&xu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),yd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&xu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}yd(e,!0,n,null,s);break;case"together":yd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Dr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ki|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Z(153));if(e.child!==null){for(t=e.child,n=di(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=di(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KS(t,e,n){switch(e.tag){case 3:l_(e),Gs();break;case 5:L0(e);break;case 1:vn(e.type)&&pu(e);break;case 4:Nf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ze(yu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ze(at,at.current&1),e.flags|=128,null):n&e.child.childLanes?u_(t,e,n):(Ze(at,at.current&1),t=Dr(t,e,n),t!==null?t.sibling:null);Ze(at,at.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return c_(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ze(at,at.current),r)break;return null;case 22:case 23:return e.lanes=0,o_(t,e,n)}return Dr(t,e,n)}var d_,xh,h_,f_;d_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xh=function(){};h_=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Fi(sr.current);var s=null;switch(n){case"input":i=zd(t,i),r=zd(t,r),s=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),s=[];break;case"textarea":i=qd(t,i),r=qd(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hu)}Kd(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var u=i[d];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(oa.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(u=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(oa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&tt("scroll",t),s||u===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};f_=function(t,e,n,r){n!==r&&(e.flags|=4)};function jo(t,e){if(!st)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GS(t,e,n){var r=e.pendingProps;switch(bf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(e),null;case 1:return vn(e.type)&&fu(),Xt(e),null;case 3:return r=e.stateNode,Ys(),rt(yn),rt(nn),Of(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(bl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qn!==null&&(Ah(qn),qn=null))),xh(t,e),Xt(e),null;case 5:Df(e);var i=Fi(va.current);if(n=e.type,t!==null&&e.stateNode!=null)h_(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Z(166));return Xt(e),null}if(t=Fi(sr.current),bl(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[nr]=e,r[ma]=s,t=(e.mode&1)!==0,n){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(i=0;i<Vo.length;i++)tt(Vo[i],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":Ug(r,s),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},tt("invalid",r);break;case"textarea":zg(r,s),tt("invalid",r)}Kd(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&Tl(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&Tl(r.textContent,u,t),i=["children",""+u]):oa.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&tt("scroll",r)}switch(n){case"input":yl(r),Bg(r,s,!0);break;case"textarea":yl(r),$g(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Bv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[nr]=e,t[ma]=r,d_(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gd(n,r),n){case"dialog":tt("cancel",t),tt("close",t),i=r;break;case"iframe":case"object":case"embed":tt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Vo.length;i++)tt(Vo[i],t);i=r;break;case"source":tt("error",t),i=r;break;case"img":case"image":case"link":tt("error",t),tt("load",t),i=r;break;case"details":tt("toggle",t),i=r;break;case"input":Ug(t,r),i=zd(t,r),tt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),tt("invalid",t);break;case"textarea":zg(t,r),i=qd(t,r),tt("invalid",t);break;default:i=r}Kd(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var c=u[s];s==="style"?Wv(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&zv(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&aa(t,c):typeof c=="number"&&aa(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(oa.hasOwnProperty(s)?c!=null&&s==="onScroll"&&tt("scroll",t):c!=null&&df(t,s,c,o))}switch(n){case"input":yl(t),Bg(t,r,!1);break;case"textarea":yl(t),$g(t);break;case"option":r.value!=null&&t.setAttribute("value",""+mi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Os(t,!!r.multiple,s,!1):r.defaultValue!=null&&Os(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xt(e),null;case 6:if(t&&e.stateNode!=null)f_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Z(166));if(n=Fi(va.current),Fi(sr.current),bl(e)){if(r=e.stateNode,n=e.memoizedProps,r[nr]=e,(s=r.nodeValue!==n)&&(t=Tn,t!==null))switch(t.tag){case 3:Tl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Tl(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nr]=e,e.stateNode=r}return Xt(e),null;case 13:if(rt(at),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(st&&Sn!==null&&e.mode&1&&!(e.flags&128))P0(),Gs(),e.flags|=98560,s=!1;else if(s=bl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Z(317));s[nr]=e}else Gs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xt(e),s=!1}else qn!==null&&(Ah(qn),qn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||at.current&1?Ct===0&&(Ct=3):Kf())),e.updateQueue!==null&&(e.flags|=4),Xt(e),null);case 4:return Ys(),xh(t,e),t===null&&pa(e.stateNode.containerInfo),Xt(e),null;case 10:return kf(e.type._context),Xt(e),null;case 17:return vn(e.type)&&fu(),Xt(e),null;case 19:if(rt(at),s=e.memoizedState,s===null)return Xt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)jo(s,!1);else{if(Ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xu(t),o!==null){for(e.flags|=128,jo(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ze(at,at.current&1|2),e.child}t=t.sibling}s.tail!==null&&mt()>Js&&(e.flags|=128,r=!0,jo(s,!1),e.lanes=4194304)}else{if(!r)if(t=xu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),jo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!st)return Xt(e),null}else 2*mt()-s.renderingStartTime>Js&&n!==1073741824&&(e.flags|=128,r=!0,jo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=mt(),e.sibling=null,n=at.current,Ze(at,r?n&1|2:n&1),e):(Xt(e),null);case 22:case 23:return Hf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?En&1073741824&&(Xt(e),e.subtreeFlags&6&&(e.flags|=8192)):Xt(e),null;case 24:return null;case 25:return null}throw Error(Z(156,e.tag))}function QS(t,e){switch(bf(e),e.tag){case 1:return vn(e.type)&&fu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ys(),rt(yn),rt(nn),Of(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Df(e),null;case 13:if(rt(at),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Z(340));Gs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rt(at),null;case 4:return Ys(),null;case 10:return kf(e.type._context),null;case 22:case 23:return Hf(),null;case 24:return null;default:return null}}var Rl=!1,en=!1,YS=typeof WeakSet=="function"?WeakSet:Set,de=null;function Ps(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ft(t,e,r)}else n.current=null}function wh(t,e,n){try{n()}catch(r){ft(t,e,r)}}var jm=!1;function XS(t,e){if(ih=uu,t=v0(),If(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,u=-1,c=-1,d=0,p=0,y=t,v=null;t:for(;;){for(var b;y!==n||i!==0&&y.nodeType!==3||(u=o+i),y!==s||r!==0&&y.nodeType!==3||(c=o+r),y.nodeType===3&&(o+=y.nodeValue.length),(b=y.firstChild)!==null;)v=y,y=b;for(;;){if(y===t)break t;if(v===n&&++d===i&&(u=o),v===s&&++p===r&&(c=o),(b=y.nextSibling)!==null)break;y=v,v=y.parentNode}y=b}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(sh={focusedElem:t,selectionRange:n},uu=!1,de=e;de!==null;)if(e=de,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,de=t;else for(;de!==null;){e=de;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var k=P.memoizedProps,N=P.memoizedState,C=e.stateNode,S=C.getSnapshotBeforeUpdate(e.elementType===e.type?k:$n(e.type,k),N);C.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(D){ft(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}return P=jm,jm=!1,P}function Xo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&wh(e,n,s)}i=i.next}while(i!==r)}}function nc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Eh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function p_(t){var e=t.alternate;e!==null&&(t.alternate=null,p_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nr],delete e[ma],delete e[lh],delete e[NS],delete e[DS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function g_(t){return t.tag===5||t.tag===3||t.tag===4}function Nm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||g_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hu));else if(r!==4&&(t=t.child,t!==null))for(Sh(t,e,n),t=t.sibling;t!==null;)Sh(t,e,n),t=t.sibling}function Ih(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ih(t,e,n),t=t.sibling;t!==null;)Ih(t,e,n),t=t.sibling}var Ft=null,Wn=!1;function Gr(t,e,n){for(n=n.child;n!==null;)m_(t,e,n),n=n.sibling}function m_(t,e,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(Gu,n)}catch{}switch(n.tag){case 5:en||Ps(n,e);case 6:var r=Ft,i=Wn;Ft=null,Gr(t,e,n),Ft=r,Wn=i,Ft!==null&&(Wn?(t=Ft,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ft.removeChild(n.stateNode));break;case 18:Ft!==null&&(Wn?(t=Ft,n=n.stateNode,t.nodeType===8?cd(t.parentNode,n):t.nodeType===1&&cd(t,n),da(t)):cd(Ft,n.stateNode));break;case 4:r=Ft,i=Wn,Ft=n.stateNode.containerInfo,Wn=!0,Gr(t,e,n),Ft=r,Wn=i;break;case 0:case 11:case 14:case 15:if(!en&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&wh(n,e,o),i=i.next}while(i!==r)}Gr(t,e,n);break;case 1:if(!en&&(Ps(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){ft(n,e,u)}Gr(t,e,n);break;case 21:Gr(t,e,n);break;case 22:n.mode&1?(en=(r=en)||n.memoizedState!==null,Gr(t,e,n),en=r):Gr(t,e,n);break;default:Gr(t,e,n)}}function Dm(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YS),e.forEach(function(r){var i=oI.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,u=o;e:for(;u!==null;){switch(u.tag){case 5:Ft=u.stateNode,Wn=!1;break e;case 3:Ft=u.stateNode.containerInfo,Wn=!0;break e;case 4:Ft=u.stateNode.containerInfo,Wn=!0;break e}u=u.return}if(Ft===null)throw Error(Z(160));m_(s,o,i),Ft=null,Wn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){ft(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)y_(e,t),e=e.sibling}function y_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zn(e,t),er(t),r&4){try{Xo(3,t,t.return),nc(3,t)}catch(k){ft(t,t.return,k)}try{Xo(5,t,t.return)}catch(k){ft(t,t.return,k)}}break;case 1:zn(e,t),er(t),r&512&&n!==null&&Ps(n,n.return);break;case 5:if(zn(e,t),er(t),r&512&&n!==null&&Ps(n,n.return),t.flags&32){var i=t.stateNode;try{aa(i,"")}catch(k){ft(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&Fv(i,s),Gd(u,o);var d=Gd(u,s);for(o=0;o<c.length;o+=2){var p=c[o],y=c[o+1];p==="style"?Wv(i,y):p==="dangerouslySetInnerHTML"?zv(i,y):p==="children"?aa(i,y):df(i,p,y,d)}switch(u){case"input":$d(i,s);break;case"textarea":Uv(i,s);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var b=s.value;b!=null?Os(i,!!s.multiple,b,!1):v!==!!s.multiple&&(s.defaultValue!=null?Os(i,!!s.multiple,s.defaultValue,!0):Os(i,!!s.multiple,s.multiple?[]:"",!1))}i[ma]=s}catch(k){ft(t,t.return,k)}}break;case 6:if(zn(e,t),er(t),r&4){if(t.stateNode===null)throw Error(Z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(k){ft(t,t.return,k)}}break;case 3:if(zn(e,t),er(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{da(e.containerInfo)}catch(k){ft(t,t.return,k)}break;case 4:zn(e,t),er(t);break;case 13:zn(e,t),er(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Wf=mt())),r&4&&Dm(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(en=(d=en)||p,zn(e,t),en=d):zn(e,t),er(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!p&&t.mode&1)for(de=t,p=t.child;p!==null;){for(y=de=p;de!==null;){switch(v=de,b=v.child,v.tag){case 0:case 11:case 14:case 15:Xo(4,v,v.return);break;case 1:Ps(v,v.return);var P=v.stateNode;if(typeof P.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(k){ft(r,n,k)}}break;case 5:Ps(v,v.return);break;case 22:if(v.memoizedState!==null){Lm(y);continue}}b!==null?(b.return=v,de=b):Lm(y)}p=p.sibling}e:for(p=null,y=t;;){if(y.tag===5){if(p===null){p=y;try{i=y.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=y.stateNode,c=y.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=$v("display",o))}catch(k){ft(t,t.return,k)}}}else if(y.tag===6){if(p===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(k){ft(t,t.return,k)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;p===y&&(p=null),y=y.return}p===y&&(p=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:zn(e,t),er(t),r&4&&Dm(t);break;case 21:break;default:zn(e,t),er(t)}}function er(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(g_(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(aa(i,""),r.flags&=-33);var s=Nm(t);Ih(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=Nm(t);Sh(t,u,o);break;default:throw Error(Z(161))}}catch(c){ft(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function JS(t,e,n){de=t,v_(t)}function v_(t,e,n){for(var r=(t.mode&1)!==0;de!==null;){var i=de,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Rl;if(!o){var u=i.alternate,c=u!==null&&u.memoizedState!==null||en;u=Rl;var d=en;if(Rl=o,(en=c)&&!d)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?Mm(i):c!==null?(c.return=o,de=c):Mm(i);for(;s!==null;)de=s,v_(s),s=s.sibling;de=i,Rl=u,en=d}Om(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,de=s):Om(t)}}function Om(t){for(;de!==null;){var e=de;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:en||nc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!en)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:$n(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&_m(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}_m(e,o,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var y=p.dehydrated;y!==null&&da(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}en||e.flags&512&&Eh(e)}catch(v){ft(e,e.return,v)}}if(e===t){de=null;break}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}}function Lm(t){for(;de!==null;){var e=de;if(e===t){de=null;break}var n=e.sibling;if(n!==null){n.return=e.return,de=n;break}de=e.return}}function Mm(t){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nc(4,e)}catch(c){ft(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){ft(e,i,c)}}var s=e.return;try{Eh(e)}catch(c){ft(e,s,c)}break;case 5:var o=e.return;try{Eh(e)}catch(c){ft(e,o,c)}}}catch(c){ft(e,e.return,c)}if(e===t){de=null;break}var u=e.sibling;if(u!==null){u.return=e.return,de=u;break}de=e.return}}var ZS=Math.ceil,Su=Fr.ReactCurrentDispatcher,zf=Fr.ReactCurrentOwner,On=Fr.ReactCurrentBatchConfig,Be=0,Dt=null,Et=null,Bt=0,En=0,js=Si(0),Ct=0,Ea=null,Ki=0,rc=0,$f=0,Jo=null,pn=null,Wf=0,Js=1/0,mr=null,Iu=!1,Th=null,ui=null,kl=!1,ti=null,Tu=0,Zo=0,bh=null,Kl=-1,Gl=0;function an(){return Be&6?mt():Kl!==-1?Kl:Kl=mt()}function ci(t){return t.mode&1?Be&2&&Bt!==0?Bt&-Bt:LS.transition!==null?(Gl===0&&(Gl=n0()),Gl):(t=Ke,t!==0||(t=window.event,t=t===void 0?16:u0(t.type)),t):1}function Kn(t,e,n,r){if(50<Zo)throw Zo=0,bh=null,Error(Z(185));Da(t,n,r),(!(Be&2)||t!==Dt)&&(t===Dt&&(!(Be&2)&&(rc|=n),Ct===4&&Zr(t,Bt)),_n(t,r),n===1&&Be===0&&!(e.mode&1)&&(Js=mt()+500,Zu&&Ii()))}function _n(t,e){var n=t.callbackNode;L1(t,e);var r=lu(t,t===Dt?Bt:0);if(r===0)n!==null&&Hg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Hg(n),e===1)t.tag===0?OS(Vm.bind(null,t)):A0(Vm.bind(null,t)),PS(function(){!(Be&6)&&Ii()}),n=null;else{switch(r0(r)){case 1:n=mf;break;case 4:n=e0;break;case 16:n=au;break;case 536870912:n=t0;break;default:n=au}n=b_(n,__.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function __(t,e){if(Kl=-1,Gl=0,Be&6)throw Error(Z(327));var n=t.callbackNode;if(Us()&&t.callbackNode!==n)return null;var r=lu(t,t===Dt?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=bu(t,r);else{e=r;var i=Be;Be|=2;var s=w_();(Dt!==t||Bt!==e)&&(mr=null,Js=mt()+500,Bi(t,e));do try{nI();break}catch(u){x_(t,u)}while(!0);Rf(),Su.current=s,Be=i,Et!==null?e=0:(Dt=null,Bt=0,e=Ct)}if(e!==0){if(e===2&&(i=Zd(t),i!==0&&(r=i,e=Ch(t,i))),e===1)throw n=Ea,Bi(t,0),Zr(t,r),_n(t,mt()),n;if(e===6)Zr(t,r);else{if(i=t.current.alternate,!(r&30)&&!eI(i)&&(e=bu(t,r),e===2&&(s=Zd(t),s!==0&&(r=s,e=Ch(t,s))),e===1))throw n=Ea,Bi(t,0),Zr(t,r),_n(t,mt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Z(345));case 2:Oi(t,pn,mr);break;case 3:if(Zr(t,r),(r&130023424)===r&&(e=Wf+500-mt(),10<e)){if(lu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){an(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ah(Oi.bind(null,t,pn,mr),e);break}Oi(t,pn,mr);break;case 4:if(Zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Hn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZS(r/1960))-r,10<r){t.timeoutHandle=ah(Oi.bind(null,t,pn,mr),r);break}Oi(t,pn,mr);break;case 5:Oi(t,pn,mr);break;default:throw Error(Z(329))}}}return _n(t,mt()),t.callbackNode===n?__.bind(null,t):null}function Ch(t,e){var n=Jo;return t.current.memoizedState.isDehydrated&&(Bi(t,e).flags|=256),t=bu(t,e),t!==2&&(e=pn,pn=n,e!==null&&Ah(e)),t}function Ah(t){pn===null?pn=t:pn.push.apply(pn,t)}function eI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Gn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zr(t,e){for(e&=~$f,e&=~rc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Hn(e),r=1<<n;t[n]=-1,e&=~r}}function Vm(t){if(Be&6)throw Error(Z(327));Us();var e=lu(t,0);if(!(e&1))return _n(t,mt()),null;var n=bu(t,e);if(t.tag!==0&&n===2){var r=Zd(t);r!==0&&(e=r,n=Ch(t,r))}if(n===1)throw n=Ea,Bi(t,0),Zr(t,e),_n(t,mt()),n;if(n===6)throw Error(Z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Oi(t,pn,mr),_n(t,mt()),null}function qf(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Js=mt()+500,Zu&&Ii())}}function Gi(t){ti!==null&&ti.tag===0&&!(Be&6)&&Us();var e=Be;Be|=1;var n=On.transition,r=Ke;try{if(On.transition=null,Ke=1,t)return t()}finally{Ke=r,On.transition=n,Be=e,!(Be&6)&&Ii()}}function Hf(){En=js.current,rt(js)}function Bi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kS(n)),Et!==null)for(n=Et.return;n!==null;){var r=n;switch(bf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fu();break;case 3:Ys(),rt(yn),rt(nn),Of();break;case 5:Df(r);break;case 4:Ys();break;case 13:rt(at);break;case 19:rt(at);break;case 10:kf(r.type._context);break;case 22:case 23:Hf()}n=n.return}if(Dt=t,Et=t=di(t.current,null),Bt=En=e,Ct=0,Ea=null,$f=rc=Ki=0,pn=Jo=null,Vi!==null){for(e=0;e<Vi.length;e++)if(n=Vi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Vi=null}return t}function x_(t,e){do{var n=Et;try{if(Rf(),Wl.current=Eu,wu){for(var r=lt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wu=!1}if(Hi=0,jt=bt=lt=null,Yo=!1,_a=0,zf.current=null,n===null||n.return===null){Ct=1,Ea=e,Et=null;break}e:{var s=t,o=n.return,u=n,c=e;if(e=Bt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,p=u,y=p.tag;if(!(p.mode&1)&&(y===0||y===11||y===15)){var v=p.alternate;v?(p.updateQueue=v.updateQueue,p.memoizedState=v.memoizedState,p.lanes=v.lanes):(p.updateQueue=null,p.memoizedState=null)}var b=Tm(o);if(b!==null){b.flags&=-257,bm(b,o,u,s,e),b.mode&1&&Im(s,d,e),e=b,c=d;var P=e.updateQueue;if(P===null){var k=new Set;k.add(c),e.updateQueue=k}else P.add(c);break e}else{if(!(e&1)){Im(s,d,e),Kf();break e}c=Error(Z(426))}}else if(st&&u.mode&1){var N=Tm(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),bm(N,o,u,s,e),Cf(Xs(c,u));break e}}s=c=Xs(c,u),Ct!==4&&(Ct=2),Jo===null?Jo=[s]:Jo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=r_(s,c,e);vm(s,C);break e;case 1:u=c;var S=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(ui===null||!ui.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var D=i_(s,u,e);vm(s,D);break e}}s=s.return}while(s!==null)}S_(n)}catch(V){e=V,Et===n&&n!==null&&(Et=n=n.return);continue}break}while(!0)}function w_(){var t=Su.current;return Su.current=Eu,t===null?Eu:t}function Kf(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Dt===null||!(Ki&268435455)&&!(rc&268435455)||Zr(Dt,Bt)}function bu(t,e){var n=Be;Be|=2;var r=w_();(Dt!==t||Bt!==e)&&(mr=null,Bi(t,e));do try{tI();break}catch(i){x_(t,i)}while(!0);if(Rf(),Be=n,Su.current=r,Et!==null)throw Error(Z(261));return Dt=null,Bt=0,Ct}function tI(){for(;Et!==null;)E_(Et)}function nI(){for(;Et!==null&&!C1();)E_(Et)}function E_(t){var e=T_(t.alternate,t,En);t.memoizedProps=t.pendingProps,e===null?S_(t):Et=e,zf.current=null}function S_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QS(n,e),n!==null){n.flags&=32767,Et=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ct=6,Et=null;return}}else if(n=GS(n,e,En),n!==null){Et=n;return}if(e=e.sibling,e!==null){Et=e;return}Et=e=t}while(e!==null);Ct===0&&(Ct=5)}function Oi(t,e,n){var r=Ke,i=On.transition;try{On.transition=null,Ke=1,rI(t,e,n,r)}finally{On.transition=i,Ke=r}return null}function rI(t,e,n,r){do Us();while(ti!==null);if(Be&6)throw Error(Z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(M1(t,s),t===Dt&&(Et=Dt=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||kl||(kl=!0,b_(au,function(){return Us(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=On.transition,On.transition=null;var o=Ke;Ke=1;var u=Be;Be|=4,zf.current=null,XS(t,n),y_(n,t),SS(sh),uu=!!ih,sh=ih=null,t.current=n,JS(n),A1(),Be=u,Ke=o,On.transition=s}else t.current=n;if(kl&&(kl=!1,ti=t,Tu=i),s=t.pendingLanes,s===0&&(ui=null),P1(n.stateNode),_n(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Iu)throw Iu=!1,t=Th,Th=null,t;return Tu&1&&t.tag!==0&&Us(),s=t.pendingLanes,s&1?t===bh?Zo++:(Zo=0,bh=t):Zo=0,Ii(),null}function Us(){if(ti!==null){var t=r0(Tu),e=On.transition,n=Ke;try{if(On.transition=null,Ke=16>t?16:t,ti===null)var r=!1;else{if(t=ti,ti=null,Tu=0,Be&6)throw Error(Z(331));var i=Be;for(Be|=4,de=t.current;de!==null;){var s=de,o=s.child;if(de.flags&16){var u=s.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(de=d;de!==null;){var p=de;switch(p.tag){case 0:case 11:case 15:Xo(8,p,s)}var y=p.child;if(y!==null)y.return=p,de=y;else for(;de!==null;){p=de;var v=p.sibling,b=p.return;if(p_(p),p===d){de=null;break}if(v!==null){v.return=b,de=v;break}de=b}}}var P=s.alternate;if(P!==null){var k=P.child;if(k!==null){P.child=null;do{var N=k.sibling;k.sibling=null,k=N}while(k!==null)}}de=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,de=o;else e:for(;de!==null;){if(s=de,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xo(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,de=C;break e}de=s.return}}var S=t.current;for(de=S;de!==null;){o=de;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,de=E;else e:for(o=S;de!==null;){if(u=de,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:nc(9,u)}}catch(V){ft(u,u.return,V)}if(u===o){de=null;break e}var D=u.sibling;if(D!==null){D.return=u.return,de=D;break e}de=u.return}}if(Be=i,Ii(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(Gu,t)}catch{}r=!0}return r}finally{Ke=n,On.transition=e}}return!1}function Fm(t,e,n){e=Xs(n,e),e=r_(t,e,1),t=li(t,e,1),e=an(),t!==null&&(Da(t,1,e),_n(t,e))}function ft(t,e,n){if(t.tag===3)Fm(t,t,n);else for(;e!==null;){if(e.tag===3){Fm(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ui===null||!ui.has(r))){t=Xs(n,t),t=i_(e,t,1),e=li(e,t,1),t=an(),e!==null&&(Da(e,1,t),_n(e,t));break}}e=e.return}}function iI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=an(),t.pingedLanes|=t.suspendedLanes&n,Dt===t&&(Bt&n)===n&&(Ct===4||Ct===3&&(Bt&130023424)===Bt&&500>mt()-Wf?Bi(t,0):$f|=n),_n(t,e)}function I_(t,e){e===0&&(t.mode&1?(e=xl,xl<<=1,!(xl&130023424)&&(xl=4194304)):e=1);var n=an();t=Nr(t,e),t!==null&&(Da(t,e,n),_n(t,n))}function sI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),I_(t,n)}function oI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(e),I_(t,n)}var T_;T_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yn.current)mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return mn=!1,KS(t,e,n);mn=!!(t.flags&131072)}else mn=!1,st&&e.flags&1048576&&R0(e,mu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Hl(t,e),t=e.pendingProps;var i=Ks(e,nn.current);Fs(e,n),i=Mf(null,e,r,t,i,n);var s=Vf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(r)?(s=!0,pu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,jf(e),i.updater=tc,e.stateNode=i,i._reactInternals=e,ph(e,r,t,n),e=yh(null,e,r,!0,s,n)):(e.tag=0,st&&s&&Tf(e),on(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Hl(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=lI(r),t=$n(r,t),i){case 0:e=mh(null,e,r,t,n);break e;case 1:e=Rm(null,e,r,t,n);break e;case 11:e=Cm(null,e,r,t,n);break e;case 14:e=Am(null,e,r,$n(r.type,t),n);break e}throw Error(Z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$n(r,i),mh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$n(r,i),Rm(t,e,r,i,n);case 3:e:{if(l_(e),t===null)throw Error(Z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,O0(t,e),_u(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Xs(Error(Z(423)),e),e=km(t,e,r,n,i);break e}else if(r!==i){i=Xs(Error(Z(424)),e),e=km(t,e,r,n,i);break e}else for(Sn=ai(e.stateNode.containerInfo.firstChild),Tn=e,st=!0,qn=null,n=N0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gs(),r===i){e=Dr(t,e,n);break e}on(t,e,r,n)}e=e.child}return e;case 5:return L0(e),t===null&&dh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,oh(r,i)?o=null:s!==null&&oh(r,s)&&(e.flags|=32),a_(t,e),on(t,e,o,n),e.child;case 6:return t===null&&dh(e),null;case 13:return u_(t,e,n);case 4:return Nf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Qs(e,null,r,n):on(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$n(r,i),Cm(t,e,r,i,n);case 7:return on(t,e,e.pendingProps,n),e.child;case 8:return on(t,e,e.pendingProps.children,n),e.child;case 12:return on(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ze(yu,r._currentValue),r._currentValue=o,s!==null)if(Gn(s.value,o)){if(s.children===i.children&&!yn.current){e=Dr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){o=s.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Cr(-1,n&-n),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?c.next=c:(c.next=p.next,p.next=c),d.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),hh(s.return,n,e),u.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Z(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),hh(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}on(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Fs(e,n),i=Vn(i),r=r(i),e.flags|=1,on(t,e,r,n),e.child;case 14:return r=e.type,i=$n(r,e.pendingProps),i=$n(r.type,i),Am(t,e,r,i,n);case 15:return s_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$n(r,i),Hl(t,e),e.tag=1,vn(r)?(t=!0,pu(e)):t=!1,Fs(e,n),n_(e,r,i),ph(e,r,i,n),yh(null,e,r,!0,t,n);case 19:return c_(t,e,n);case 22:return o_(t,e,n)}throw Error(Z(156,e.tag))};function b_(t,e){return Zv(t,e)}function aI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(t,e,n,r){return new aI(t,e,n,r)}function Gf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lI(t){if(typeof t=="function")return Gf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ff)return 11;if(t===pf)return 14}return 2}function di(t,e){var n=t.alternate;return n===null?(n=Dn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ql(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Gf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Es:return zi(n.children,i,s,e);case hf:o=8,i|=8;break;case Vd:return t=Dn(12,n,e,i|2),t.elementType=Vd,t.lanes=s,t;case Fd:return t=Dn(13,n,e,i),t.elementType=Fd,t.lanes=s,t;case Ud:return t=Dn(19,n,e,i),t.elementType=Ud,t.lanes=s,t;case Lv:return ic(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Dv:o=10;break e;case Ov:o=9;break e;case ff:o=11;break e;case pf:o=14;break e;case Yr:o=16,r=null;break e}throw Error(Z(130,t==null?t:typeof t,""))}return e=Dn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function zi(t,e,n,r){return t=Dn(7,t,r,e),t.lanes=n,t}function ic(t,e,n,r){return t=Dn(22,t,r,e),t.elementType=Lv,t.lanes=n,t.stateNode={isHidden:!1},t}function vd(t,e,n){return t=Dn(6,t,null,e),t.lanes=n,t}function _d(t,e,n){return e=Dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uI(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zc(0),this.expirationTimes=Zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qf(t,e,n,r,i,s,o,u,c){return t=new uI(t,e,n,u,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jf(s),t}function cI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function C_(t){if(!t)return yi;t=t._reactInternals;e:{if(is(t)!==t||t.tag!==1)throw Error(Z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Z(171))}if(t.tag===1){var n=t.type;if(vn(n))return C0(t,n,e)}return e}function A_(t,e,n,r,i,s,o,u,c){return t=Qf(n,r,!0,t,i,s,o,u,c),t.context=C_(null),n=t.current,r=an(),i=ci(n),s=Cr(r,i),s.callback=e??null,li(n,s,i),t.current.lanes=i,Da(t,i,r),_n(t,r),t}function sc(t,e,n,r){var i=e.current,s=an(),o=ci(i);return n=C_(n),e.context===null?e.context=n:e.pendingContext=n,e=Cr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=li(i,e,o),t!==null&&(Kn(t,i,o,s),$l(t,i,o)),o}function Cu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Um(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yf(t,e){Um(t,e),(t=t.alternate)&&Um(t,e)}function dI(){return null}var R_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xf(t){this._internalRoot=t}oc.prototype.render=Xf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Z(409));sc(t,e,null,null)};oc.prototype.unmount=Xf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Gi(function(){sc(null,t,null,null)}),e[jr]=null}};function oc(t){this._internalRoot=t}oc.prototype.unstable_scheduleHydration=function(t){if(t){var e=o0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jr.length&&e!==0&&e<Jr[n].priority;n++);Jr.splice(n,0,t),n===0&&l0(t)}};function Jf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ac(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Bm(){}function hI(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Cu(o);s.call(d)}}var o=A_(e,r,t,0,null,!1,!1,"",Bm);return t._reactRootContainer=o,t[jr]=o.current,pa(t.nodeType===8?t.parentNode:t),Gi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var d=Cu(c);u.call(d)}}var c=Qf(t,0,!1,null,null,!1,!1,"",Bm);return t._reactRootContainer=c,t[jr]=c.current,pa(t.nodeType===8?t.parentNode:t),Gi(function(){sc(e,c,n,r)}),c}function lc(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var u=i;i=function(){var c=Cu(o);u.call(c)}}sc(e,o,t,i)}else o=hI(n,e,t,i,r);return Cu(o)}i0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mo(e.pendingLanes);n!==0&&(yf(e,n|1),_n(e,mt()),!(Be&6)&&(Js=mt()+500,Ii()))}break;case 13:Gi(function(){var r=Nr(t,1);if(r!==null){var i=an();Kn(r,t,1,i)}}),Yf(t,1)}};vf=function(t){if(t.tag===13){var e=Nr(t,134217728);if(e!==null){var n=an();Kn(e,t,134217728,n)}Yf(t,134217728)}};s0=function(t){if(t.tag===13){var e=ci(t),n=Nr(t,e);if(n!==null){var r=an();Kn(n,t,e,r)}Yf(t,e)}};o0=function(){return Ke};a0=function(t,e){var n=Ke;try{return Ke=t,e()}finally{Ke=n}};Yd=function(t,e,n){switch(e){case"input":if($d(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Ju(r);if(!i)throw Error(Z(90));Vv(r),$d(r,i)}}}break;case"textarea":Uv(t,n);break;case"select":e=n.value,e!=null&&Os(t,!!n.multiple,e,!1)}};Kv=qf;Gv=Gi;var fI={usingClientEntryPoint:!1,Events:[La,bs,Ju,qv,Hv,qf]},No={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pI={bundleType:No.bundleType,version:No.version,rendererPackageName:No.rendererPackageName,rendererConfig:No.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Xv(t),t===null?null:t.stateNode},findFiberByHostInstance:No.findFiberByHostInstance||dI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pl.isDisabled&&Pl.supportsFiber)try{Gu=Pl.inject(pI),ir=Pl}catch{}}An.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fI;An.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jf(e))throw Error(Z(200));return cI(t,e,null,n)};An.createRoot=function(t,e){if(!Jf(t))throw Error(Z(299));var n=!1,r="",i=R_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qf(t,1,!1,null,null,n,!1,r,i),t[jr]=e.current,pa(t.nodeType===8?t.parentNode:t),new Xf(e)};An.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Z(188)):(t=Object.keys(t).join(","),Error(Z(268,t)));return t=Xv(e),t=t===null?null:t.stateNode,t};An.flushSync=function(t){return Gi(t)};An.hydrate=function(t,e,n){if(!ac(e))throw Error(Z(200));return lc(null,t,e,!0,n)};An.hydrateRoot=function(t,e,n){if(!Jf(t))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=R_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=A_(e,null,t,1,n??null,i,!1,s,o),t[jr]=e.current,pa(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new oc(e)};An.render=function(t,e,n){if(!ac(e))throw Error(Z(200));return lc(null,t,e,!1,n)};An.unmountComponentAtNode=function(t){if(!ac(t))throw Error(Z(40));return t._reactRootContainer?(Gi(function(){lc(null,null,t,!1,function(){t._reactRootContainer=null,t[jr]=null})}),!0):!1};An.unstable_batchedUpdates=qf;An.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ac(n))throw Error(Z(200));if(t==null||t._reactInternals===void 0)throw Error(Z(38));return lc(t,e,n,!1,r)};An.version="18.3.1-next-f1338f8080-20240426";function k_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k_)}catch(t){console.error(t)}}k_(),kv.exports=An;var gI=kv.exports,zm=gI;Ld.createRoot=zm.createRoot,Ld.hydrateRoot=zm.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sa(){return Sa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sa.apply(this,arguments)}var ni;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ni||(ni={}));const $m="popstate";function mI(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:u}=r.location;return Rh("",{pathname:s,search:o,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Au(i)}return vI(e,n,null,t)}function It(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function P_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yI(){return Math.random().toString(36).substr(2,8)}function Wm(t,e){return{usr:t.state,key:t.key,idx:e}}function Rh(t,e,n,r){return n===void 0&&(n=null),Sa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?co(e):e,{state:n,key:e&&e.key||r||yI()})}function Au(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function co(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function vI(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,u=ni.Pop,c=null,d=p();d==null&&(d=0,o.replaceState(Sa({},o.state,{idx:d}),""));function p(){return(o.state||{idx:null}).idx}function y(){u=ni.Pop;let N=p(),C=N==null?null:N-d;d=N,c&&c({action:u,location:k.location,delta:C})}function v(N,C){u=ni.Push;let S=Rh(k.location,N,C);d=p()+1;let E=Wm(S,d),D=k.createHref(S);try{o.pushState(E,"",D)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;i.location.assign(D)}s&&c&&c({action:u,location:k.location,delta:1})}function b(N,C){u=ni.Replace;let S=Rh(k.location,N,C);d=p();let E=Wm(S,d),D=k.createHref(S);o.replaceState(E,"",D),s&&c&&c({action:u,location:k.location,delta:0})}function P(N){let C=i.location.origin!=="null"?i.location.origin:i.location.href,S=typeof N=="string"?N:Au(N);return S=S.replace(/ $/,"%20"),It(C,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,C)}let k={get action(){return u},get location(){return t(i,o)},listen(N){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener($m,y),c=N,()=>{i.removeEventListener($m,y),c=null}},createHref(N){return e(i,N)},createURL:P,encodeLocation(N){let C=P(N);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:v,replace:b,go(N){return o.go(N)}};return k}var qm;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(qm||(qm={}));function _I(t,e,n){return n===void 0&&(n="/"),xI(t,e,n)}function xI(t,e,n,r){let i=typeof e=="string"?co(e):e,s=Zf(i.pathname||"/",n);if(s==null)return null;let o=j_(t);wI(o);let u=null;for(let c=0;u==null&&c<o.length;++c){let d=NI(s);u=kI(o[c],d)}return u}function j_(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,u)=>{let c={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(It(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=hi([r,c.relativePath]),p=n.concat(c);s.children&&s.children.length>0&&(It(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),j_(s.children,e,p,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:AI(d,s.index),routesMeta:p})};return t.forEach((s,o)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))i(s,o);else for(let c of N_(s.path))i(s,o,c)}),e}function N_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=N_(r.join("/")),u=[];return u.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&u.push(...o),u.map(c=>t.startsWith("/")&&c===""?"/":c)}function wI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:RI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const EI=/^:[\w-]+$/,SI=3,II=2,TI=1,bI=10,CI=-2,Hm=t=>t==="*";function AI(t,e){let n=t.split("/"),r=n.length;return n.some(Hm)&&(r+=CI),e&&(r+=II),n.filter(i=>!Hm(i)).reduce((i,s)=>i+(EI.test(s)?SI:s===""?TI:bI),r)}function RI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function kI(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let u=0;u<r.length;++u){let c=r[u],d=u===r.length-1,p=s==="/"?e:e.slice(s.length)||"/",y=PI({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},p),v=c.route;if(!y)return null;Object.assign(i,y.params),o.push({params:i,pathname:hi([s,y.pathname]),pathnameBase:MI(hi([s,y.pathnameBase])),route:v}),y.pathnameBase!=="/"&&(s=hi([s,y.pathnameBase]))}return o}function PI(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=jI(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:r.reduce((d,p,y)=>{let{paramName:v,isOptional:b}=p;if(v==="*"){let k=u[y]||"";o=s.slice(0,s.length-k.length).replace(/(.)\/+$/,"$1")}const P=u[y];return b&&!P?d[v]=void 0:d[v]=(P||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function jI(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),P_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,c)=>(r.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function NI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return P_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Zf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function DI(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?co(t):t;return{pathname:n?n.startsWith("/")?n:OI(n,e):e,search:VI(r),hash:FI(i)}}function OI(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function xd(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function D_(t,e){let n=LI(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function O_(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=co(t):(i=Sa({},t),It(!i.pathname||!i.pathname.includes("?"),xd("?","pathname","search",i)),It(!i.pathname||!i.pathname.includes("#"),xd("#","pathname","hash",i)),It(!i.search||!i.search.includes("#"),xd("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,u;if(o==null)u=n;else{let y=e.length-1;if(!r&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),y-=1;i.pathname=v.join("/")}u=y>=0?e[y]:"/"}let c=DI(i,u),d=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||p)&&(c.pathname+="/"),c}const hi=t=>t.join("/").replace(/\/\/+/g,"/"),MI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,FI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function UI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const L_=["post","put","patch","delete"];new Set(L_);const BI=["get",...L_];new Set(BI);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ia(){return Ia=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ia.apply(this,arguments)}const ep=j.createContext(null),zI=j.createContext(null),ss=j.createContext(null),uc=j.createContext(null),Ti=j.createContext({outlet:null,matches:[],isDataRoute:!1}),M_=j.createContext(null);function $I(t,e){let{relative:n}=e===void 0?{}:e;Va()||It(!1);let{basename:r,navigator:i}=j.useContext(ss),{hash:s,pathname:o,search:u}=F_(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:hi([r,o])),i.createHref({pathname:c,search:u,hash:s})}function Va(){return j.useContext(uc)!=null}function ho(){return Va()||It(!1),j.useContext(uc).location}function V_(t){j.useContext(ss).static||j.useLayoutEffect(t)}function cc(){let{isDataRoute:t}=j.useContext(Ti);return t?nT():WI()}function WI(){Va()||It(!1);let t=j.useContext(ep),{basename:e,future:n,navigator:r}=j.useContext(ss),{matches:i}=j.useContext(Ti),{pathname:s}=ho(),o=JSON.stringify(D_(i,n.v7_relativeSplatPath)),u=j.useRef(!1);return V_(()=>{u.current=!0}),j.useCallback(function(d,p){if(p===void 0&&(p={}),!u.current)return;if(typeof d=="number"){r.go(d);return}let y=O_(d,JSON.parse(o),s,p.relative==="path");t==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:hi([e,y.pathname])),(p.replace?r.replace:r.push)(y,p.state,p)},[e,r,o,s,t])}function dc(){let{matches:t}=j.useContext(Ti),e=t[t.length-1];return e?e.params:{}}function F_(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=j.useContext(ss),{matches:i}=j.useContext(Ti),{pathname:s}=ho(),o=JSON.stringify(D_(i,r.v7_relativeSplatPath));return j.useMemo(()=>O_(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function qI(t,e){return HI(t,e)}function HI(t,e,n,r){Va()||It(!1);let{navigator:i}=j.useContext(ss),{matches:s}=j.useContext(Ti),o=s[s.length-1],u=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=ho(),p;if(e){var y;let N=typeof e=="string"?co(e):e;c==="/"||(y=N.pathname)!=null&&y.startsWith(c)||It(!1),p=N}else p=d;let v=p.pathname||"/",b=v;if(c!=="/"){let N=c.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(N.length).join("/")}let P=_I(t,{pathname:b}),k=XI(P&&P.map(N=>Object.assign({},N,{params:Object.assign({},u,N.params),pathname:hi([c,i.encodeLocation?i.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?c:hi([c,i.encodeLocation?i.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),s,n,r);return e&&k?j.createElement(uc.Provider,{value:{location:Ia({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:ni.Pop}},k):k}function KI(){let t=tT(),e=UI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),n?j.createElement("pre",{style:i},n):null,null)}const GI=j.createElement(KI,null);class QI extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?j.createElement(Ti.Provider,{value:this.props.routeContext},j.createElement(M_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YI(t){let{routeContext:e,match:n,children:r}=t,i=j.useContext(ep);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),j.createElement(Ti.Provider,{value:e},r)}function XI(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,u=(i=n)==null?void 0:i.errors;if(u!=null){let p=o.findIndex(y=>y.route.id&&(u==null?void 0:u[y.route.id])!==void 0);p>=0||It(!1),o=o.slice(0,Math.min(o.length,p+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let p=0;p<o.length;p++){let y=o[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=p),y.route.id){let{loaderData:v,errors:b}=n,P=y.route.loader&&v[y.route.id]===void 0&&(!b||b[y.route.id]===void 0);if(y.route.lazy||P){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((p,y,v)=>{let b,P=!1,k=null,N=null;n&&(b=u&&y.route.id?u[y.route.id]:void 0,k=y.route.errorElement||GI,c&&(d<0&&v===0?(rT("route-fallback"),P=!0,N=null):d===v&&(P=!0,N=y.route.hydrateFallbackElement||null)));let C=e.concat(o.slice(0,v+1)),S=()=>{let E;return b?E=k:P?E=N:y.route.Component?E=j.createElement(y.route.Component,null):y.route.element?E=y.route.element:E=p,j.createElement(YI,{match:y,routeContext:{outlet:p,matches:C,isDataRoute:n!=null},children:E})};return n&&(y.route.ErrorBoundary||y.route.errorElement||v===0)?j.createElement(QI,{location:n.location,revalidation:n.revalidation,component:k,error:b,children:S(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):S()},null)}var U_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(U_||{}),B_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(B_||{});function JI(t){let e=j.useContext(ep);return e||It(!1),e}function ZI(t){let e=j.useContext(zI);return e||It(!1),e}function eT(t){let e=j.useContext(Ti);return e||It(!1),e}function z_(t){let e=eT(),n=e.matches[e.matches.length-1];return n.route.id||It(!1),n.route.id}function tT(){var t;let e=j.useContext(M_),n=ZI(),r=z_();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function nT(){let{router:t}=JI(U_.UseNavigateStable),e=z_(B_.UseNavigateStable),n=j.useRef(!1);return V_(()=>{n.current=!0}),j.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ia({fromRouteId:e},s)))},[t,e])}const Km={};function rT(t,e,n){Km[t]||(Km[t]=!0)}function iT(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Vt(t){It(!1)}function sT(t){let{basename:e="/",children:n=null,location:r,navigationType:i=ni.Pop,navigator:s,static:o=!1,future:u}=t;Va()&&It(!1);let c=e.replace(/^\/*/,"/"),d=j.useMemo(()=>({basename:c,navigator:s,static:o,future:Ia({v7_relativeSplatPath:!1},u)}),[c,u,s,o]);typeof r=="string"&&(r=co(r));let{pathname:p="/",search:y="",hash:v="",state:b=null,key:P="default"}=r,k=j.useMemo(()=>{let N=Zf(p,c);return N==null?null:{location:{pathname:N,search:y,hash:v,state:b,key:P},navigationType:i}},[c,p,y,v,b,P,i]);return k==null?null:j.createElement(ss.Provider,{value:d},j.createElement(uc.Provider,{children:n,value:k}))}function oT(t){let{children:e,location:n}=t;return qI(kh(e),n)}new Promise(()=>{});function kh(t,e){e===void 0&&(e=[]);let n=[];return j.Children.forEach(t,(r,i)=>{if(!j.isValidElement(r))return;let s=[...e,i];if(r.type===j.Fragment){n.push.apply(n,kh(r.props.children,s));return}r.type!==Vt&&It(!1),!r.props.index||!r.props.children||It(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=kh(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ph(){return Ph=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ph.apply(this,arguments)}function aT(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function lT(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function uT(t,e){return t.button===0&&(!e||e==="_self")&&!lT(t)}const cT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],dT="6";try{window.__reactRouterVersion=dT}catch{}const hT="startTransition",Gm=i1[hT];function fT(t){let{basename:e,children:n,future:r,window:i}=t,s=j.useRef();s.current==null&&(s.current=mI({window:i,v5Compat:!0}));let o=s.current,[u,c]=j.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},p=j.useCallback(y=>{d&&Gm?Gm(()=>c(y)):c(y)},[c,d]);return j.useLayoutEffect(()=>o.listen(p),[o,p]),j.useEffect(()=>iT(r),[r]),j.createElement(sT,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:o,future:r})}const pT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wn=j.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:u,target:c,to:d,preventScrollReset:p,viewTransition:y}=e,v=aT(e,cT),{basename:b}=j.useContext(ss),P,k=!1;if(typeof d=="string"&&gT.test(d)&&(P=d,pT))try{let E=new URL(window.location.href),D=d.startsWith("//")?new URL(E.protocol+d):new URL(d),V=Zf(D.pathname,b);D.origin===E.origin&&V!=null?d=V+D.search+D.hash:k=!0}catch{}let N=$I(d,{relative:i}),C=mT(d,{replace:o,state:u,target:c,preventScrollReset:p,relative:i,viewTransition:y});function S(E){r&&r(E),E.defaultPrevented||C(E)}return j.createElement("a",Ph({},v,{href:P||N,onClick:k||s?r:S,ref:n,target:c}))});var Qm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qm||(Qm={}));var Ym;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ym||(Ym={}));function mT(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:u}=e===void 0?{}:e,c=cc(),d=ho(),p=F_(t,{relative:o});return j.useCallback(y=>{if(uT(y,n)){y.preventDefault();let v=r!==void 0?r:Au(d)===Au(p);c(t,{replace:v,state:i,preventScrollReset:s,relative:o,viewTransition:u})}},[d,c,p,r,i,n,t,s,o,u])}function yT(){const[t,e]=j.useState(null),[n,r]=j.useState("");return j.useEffect(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(i=>{const s={lat:i.coords.latitude,lng:i.coords.longitude};e(s),localStorage.setItem("customerLocation",JSON.stringify(s)),console.log(" Location saved:",s)},i=>{console.error(" Location access denied:",i.message),r("Location access denied. Please enable location services.")}):r("Geolocation not supported by this browser.")},[]),a.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[a.jsx("h2",{children:" Welcome to Medcins"}),a.jsx("p",{children:"Your trusted online pharmacy."}),t?a.jsxs("p",{children:[" Your location: ",a.jsxs("b",{children:[t.lat.toFixed(4),", ",t.lng.toFixed(4)]})]}):a.jsx("p",{style:{color:"gray"},children:n||"Detecting your location..."}),a.jsx("div",{style:{margin:"40px 0"},children:a.jsx("a",{href:"/businesses",style:{display:"inline-block",padding:"18px 36px",background:"linear-gradient(90deg,#7c3aed,#4f46e5)",color:"#fff",fontSize:"1.3em",fontWeight:"bold",borderRadius:"12px",boxShadow:"0 2px 12px rgba(124,58,237,0.12)",textDecoration:"none",transition:"background 0.2s,box-shadow 0.2s"},children:" Find a pharmacy store near you"})})]})}var Xm={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},vT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],u=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},W_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,u=o?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,p=s>>2,y=(s&3)<<4|u>>4;let v=(u&15)<<2|d>>6,b=d&63;c||(b=64,o||(v=64)),r.push(n[p],n[y],n[v],n[b])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):vT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const y=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||u==null||d==null||y==null)throw new _T;const v=s<<2|u>>4;if(r.push(v),d!==64){const b=u<<4&240|d>>2;if(r.push(b),y!==64){const P=d<<6&192|y;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class _T extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xT=function(t){const e=$_(t);return W_.encodeByteArray(e,!0)},Ru=function(t){return xT(t).replace(/\./g,"")},q_=function(t){try{return W_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET=()=>wT().__FIREBASE_DEFAULTS__,ST=()=>{if(typeof process>"u"||typeof Xm>"u")return;const t=Xm.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},IT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&q_(t[1]);return e&&JSON.parse(e)},hc=()=>{try{return ET()||ST()||IT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},H_=t=>{var e,n;return(n=(e=hc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},TT=t=>{const e=H_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},K_=()=>{var t;return(t=hc())===null||t===void 0?void 0:t.config},G_=t=>{var e;return(e=hc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ru(JSON.stringify(n)),Ru(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rn())}function RT(){var t;const e=(t=hc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NT(){const t=rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function DT(){return!RT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OT(){try{return typeof indexedDB=="object"}catch{return!1}}function LT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="FirebaseError";class Ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=MT,Object.setPrototypeOf(this,Ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fa.prototype.create)}}class Fa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?VT(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new Ur(i,u,r)}}function VT(t,e){return t.replace(FT,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const FT=/\{\$([^}]+)}/g;function UT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ku(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Jm(s)&&Jm(o)){if(!ku(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Jm(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Fo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Uo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function BT(t,e){const n=new zT(t,e);return n.subscribe.bind(n)}class zT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");$T(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=wd),i.error===void 0&&(i.error=wd),i.complete===void 0&&(i.complete=wd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $T(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function wd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t){return t&&t._delegate?t._delegate:t}class Qi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new bT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HT(e))try{this.getOrInitializeService({instanceIdentifier:Li})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Li){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Li){return this.instances.has(e)}getOptions(e=Li){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:qT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Li){return this.component?this.component.multipleInstances?e:Li:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qT(t){return t===Li?void 0:t}function HT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new WT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const GT={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},QT=Ve.INFO,YT={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},XT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=YT[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tp{constructor(e){this.name=e,this._logLevel=QT,this._logHandler=XT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const JT=(t,e)=>e.some(n=>t instanceof n);let Zm,ey;function ZT(){return Zm||(Zm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eb(){return ey||(ey=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Q_=new WeakMap,jh=new WeakMap,Y_=new WeakMap,Ed=new WeakMap,np=new WeakMap;function tb(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(fi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Q_.set(n,t)}).catch(()=>{}),np.set(e,t),e}function nb(t){if(jh.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});jh.set(t,e)}let Nh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Y_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return fi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rb(t){Nh=t(Nh)}function ib(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Sd(this),e,...n);return Y_.set(r,e.sort?e.sort():[e]),fi(r)}:eb().includes(t)?function(...e){return t.apply(Sd(this),e),fi(Q_.get(this))}:function(...e){return fi(t.apply(Sd(this),e))}}function sb(t){return typeof t=="function"?ib(t):(t instanceof IDBTransaction&&nb(t),JT(t,ZT())?new Proxy(t,Nh):t)}function fi(t){if(t instanceof IDBRequest)return tb(t);if(Ed.has(t))return Ed.get(t);const e=sb(t);return e!==t&&(Ed.set(t,e),np.set(e,t)),e}const Sd=t=>np.get(t);function ob(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),u=fi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(fi(o.result),c.oldVersion,c.newVersion,fi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const ab=["get","getKey","getAll","getAllKeys","count"],lb=["put","add","delete","clear"],Id=new Map;function ty(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Id.get(e))return Id.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=lb.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ab.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[n](...u),i&&c.done]))[0]};return Id.set(e,s),s}rb(t=>({...t,get:(e,n,r)=>ty(e,n)||t.get(e,n,r),has:(e,n)=>!!ty(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cb(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function cb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Dh="@firebase/app",ny="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new tp("@firebase/app"),db="@firebase/app-compat",hb="@firebase/analytics-compat",fb="@firebase/analytics",pb="@firebase/app-check-compat",gb="@firebase/app-check",mb="@firebase/auth",yb="@firebase/auth-compat",vb="@firebase/database",_b="@firebase/data-connect",xb="@firebase/database-compat",wb="@firebase/functions",Eb="@firebase/functions-compat",Sb="@firebase/installations",Ib="@firebase/installations-compat",Tb="@firebase/messaging",bb="@firebase/messaging-compat",Cb="@firebase/performance",Ab="@firebase/performance-compat",Rb="@firebase/remote-config",kb="@firebase/remote-config-compat",Pb="@firebase/storage",jb="@firebase/storage-compat",Nb="@firebase/firestore",Db="@firebase/vertexai-preview",Ob="@firebase/firestore-compat",Lb="firebase",Mb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh="[DEFAULT]",Vb={[Dh]:"fire-core",[db]:"fire-core-compat",[fb]:"fire-analytics",[hb]:"fire-analytics-compat",[gb]:"fire-app-check",[pb]:"fire-app-check-compat",[mb]:"fire-auth",[yb]:"fire-auth-compat",[vb]:"fire-rtdb",[_b]:"fire-data-connect",[xb]:"fire-rtdb-compat",[wb]:"fire-fn",[Eb]:"fire-fn-compat",[Sb]:"fire-iid",[Ib]:"fire-iid-compat",[Tb]:"fire-fcm",[bb]:"fire-fcm-compat",[Cb]:"fire-perf",[Ab]:"fire-perf-compat",[Rb]:"fire-rc",[kb]:"fire-rc-compat",[Pb]:"fire-gcs",[jb]:"fire-gcs-compat",[Nb]:"fire-fst",[Ob]:"fire-fst-compat",[Db]:"fire-vertex","fire-js":"fire-js",[Lb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=new Map,Fb=new Map,Lh=new Map;function ry(t,e){try{t.container.addComponent(e)}catch(n){Or.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Zs(t){const e=t.name;if(Lh.has(e))return Or.debug(`There were multiple attempts to register component ${e}.`),!1;Lh.set(e,t);for(const n of Pu.values())ry(n,t);for(const n of Fb.values())ry(n,t);return!0}function rp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function rr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pi=new Fa("app","Firebase",Ub);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo=Mb;function X_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Oh,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw pi.create("bad-app-name",{appName:String(i)});if(n||(n=K_()),!n)throw pi.create("no-options");const s=Pu.get(i);if(s){if(ku(n,s.options)&&ku(r,s.config))return s;throw pi.create("duplicate-app",{appName:i})}const o=new KT(i);for(const c of Lh.values())o.addComponent(c);const u=new Bb(n,r,o);return Pu.set(i,u),u}function J_(t=Oh){const e=Pu.get(t);if(!e&&t===Oh&&K_())return X_();if(!e)throw pi.create("no-app",{appName:t});return e}function gi(t,e,n){var r;let i=(r=Vb[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Or.warn(u.join(" "));return}Zs(new Qi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb="firebase-heartbeat-database",$b=1,Ta="firebase-heartbeat-store";let Td=null;function Z_(){return Td||(Td=ob(zb,$b,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ta)}catch(n){console.warn(n)}}}}).catch(t=>{throw pi.create("idb-open",{originalErrorMessage:t.message})})),Td}async function Wb(t){try{const n=(await Z_()).transaction(Ta),r=await n.objectStore(Ta).get(ex(t));return await n.done,r}catch(e){if(e instanceof Ur)Or.warn(e.message);else{const n=pi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Or.warn(n.message)}}}async function iy(t,e){try{const r=(await Z_()).transaction(Ta,"readwrite");await r.objectStore(Ta).put(e,ex(t)),await r.done}catch(n){if(n instanceof Ur)Or.warn(n.message);else{const r=pi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Or.warn(r.message)}}}function ex(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=1024,Hb=30*24*60*60*1e3;class Kb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Qb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=sy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const u=new Date(o.date).valueOf();return Date.now()-u<=Hb}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=sy(),{heartbeatsToSend:r,unsentEntries:i}=Gb(this._heartbeatsCache.heartbeats),s=Ru(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Or.warn(n),""}}}function sy(){return new Date().toISOString().substring(0,10)}function Gb(t,e=qb){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),oy(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),oy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Qb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OT()?LT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Wb(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return iy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return iy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function oy(t){return Ru(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(t){Zs(new Qi("platform-logger",e=>new ub(e),"PRIVATE")),Zs(new Qi("heartbeat",e=>new Kb(e),"PRIVATE")),gi(Dh,ny,t),gi(Dh,ny,"esm2017"),gi("fire-js","")}Yb("");var Xb="firebase",Jb="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gi(Xb,Jb,"app");var ay=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $i,tx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,f){function m(){}m.prototype=f.prototype,x.D=f.prototype,x.prototype=new m,x.prototype.constructor=x,x.C=function(w,A,R){for(var T=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)T[ae-2]=arguments[ae];return f.prototype[A].apply(w,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,f,m){m||(m=0);var w=Array(16);if(typeof f=="string")for(var A=0;16>A;++A)w[A]=f.charCodeAt(m++)|f.charCodeAt(m++)<<8|f.charCodeAt(m++)<<16|f.charCodeAt(m++)<<24;else for(A=0;16>A;++A)w[A]=f[m++]|f[m++]<<8|f[m++]<<16|f[m++]<<24;f=x.g[0],m=x.g[1],A=x.g[2];var R=x.g[3],T=f+(R^m&(A^R))+w[0]+3614090360&4294967295;f=m+(T<<7&4294967295|T>>>25),T=R+(A^f&(m^A))+w[1]+3905402710&4294967295,R=f+(T<<12&4294967295|T>>>20),T=A+(m^R&(f^m))+w[2]+606105819&4294967295,A=R+(T<<17&4294967295|T>>>15),T=m+(f^A&(R^f))+w[3]+3250441966&4294967295,m=A+(T<<22&4294967295|T>>>10),T=f+(R^m&(A^R))+w[4]+4118548399&4294967295,f=m+(T<<7&4294967295|T>>>25),T=R+(A^f&(m^A))+w[5]+1200080426&4294967295,R=f+(T<<12&4294967295|T>>>20),T=A+(m^R&(f^m))+w[6]+2821735955&4294967295,A=R+(T<<17&4294967295|T>>>15),T=m+(f^A&(R^f))+w[7]+4249261313&4294967295,m=A+(T<<22&4294967295|T>>>10),T=f+(R^m&(A^R))+w[8]+1770035416&4294967295,f=m+(T<<7&4294967295|T>>>25),T=R+(A^f&(m^A))+w[9]+2336552879&4294967295,R=f+(T<<12&4294967295|T>>>20),T=A+(m^R&(f^m))+w[10]+4294925233&4294967295,A=R+(T<<17&4294967295|T>>>15),T=m+(f^A&(R^f))+w[11]+2304563134&4294967295,m=A+(T<<22&4294967295|T>>>10),T=f+(R^m&(A^R))+w[12]+1804603682&4294967295,f=m+(T<<7&4294967295|T>>>25),T=R+(A^f&(m^A))+w[13]+4254626195&4294967295,R=f+(T<<12&4294967295|T>>>20),T=A+(m^R&(f^m))+w[14]+2792965006&4294967295,A=R+(T<<17&4294967295|T>>>15),T=m+(f^A&(R^f))+w[15]+1236535329&4294967295,m=A+(T<<22&4294967295|T>>>10),T=f+(A^R&(m^A))+w[1]+4129170786&4294967295,f=m+(T<<5&4294967295|T>>>27),T=R+(m^A&(f^m))+w[6]+3225465664&4294967295,R=f+(T<<9&4294967295|T>>>23),T=A+(f^m&(R^f))+w[11]+643717713&4294967295,A=R+(T<<14&4294967295|T>>>18),T=m+(R^f&(A^R))+w[0]+3921069994&4294967295,m=A+(T<<20&4294967295|T>>>12),T=f+(A^R&(m^A))+w[5]+3593408605&4294967295,f=m+(T<<5&4294967295|T>>>27),T=R+(m^A&(f^m))+w[10]+38016083&4294967295,R=f+(T<<9&4294967295|T>>>23),T=A+(f^m&(R^f))+w[15]+3634488961&4294967295,A=R+(T<<14&4294967295|T>>>18),T=m+(R^f&(A^R))+w[4]+3889429448&4294967295,m=A+(T<<20&4294967295|T>>>12),T=f+(A^R&(m^A))+w[9]+568446438&4294967295,f=m+(T<<5&4294967295|T>>>27),T=R+(m^A&(f^m))+w[14]+3275163606&4294967295,R=f+(T<<9&4294967295|T>>>23),T=A+(f^m&(R^f))+w[3]+4107603335&4294967295,A=R+(T<<14&4294967295|T>>>18),T=m+(R^f&(A^R))+w[8]+1163531501&4294967295,m=A+(T<<20&4294967295|T>>>12),T=f+(A^R&(m^A))+w[13]+2850285829&4294967295,f=m+(T<<5&4294967295|T>>>27),T=R+(m^A&(f^m))+w[2]+4243563512&4294967295,R=f+(T<<9&4294967295|T>>>23),T=A+(f^m&(R^f))+w[7]+1735328473&4294967295,A=R+(T<<14&4294967295|T>>>18),T=m+(R^f&(A^R))+w[12]+2368359562&4294967295,m=A+(T<<20&4294967295|T>>>12),T=f+(m^A^R)+w[5]+4294588738&4294967295,f=m+(T<<4&4294967295|T>>>28),T=R+(f^m^A)+w[8]+2272392833&4294967295,R=f+(T<<11&4294967295|T>>>21),T=A+(R^f^m)+w[11]+1839030562&4294967295,A=R+(T<<16&4294967295|T>>>16),T=m+(A^R^f)+w[14]+4259657740&4294967295,m=A+(T<<23&4294967295|T>>>9),T=f+(m^A^R)+w[1]+2763975236&4294967295,f=m+(T<<4&4294967295|T>>>28),T=R+(f^m^A)+w[4]+1272893353&4294967295,R=f+(T<<11&4294967295|T>>>21),T=A+(R^f^m)+w[7]+4139469664&4294967295,A=R+(T<<16&4294967295|T>>>16),T=m+(A^R^f)+w[10]+3200236656&4294967295,m=A+(T<<23&4294967295|T>>>9),T=f+(m^A^R)+w[13]+681279174&4294967295,f=m+(T<<4&4294967295|T>>>28),T=R+(f^m^A)+w[0]+3936430074&4294967295,R=f+(T<<11&4294967295|T>>>21),T=A+(R^f^m)+w[3]+3572445317&4294967295,A=R+(T<<16&4294967295|T>>>16),T=m+(A^R^f)+w[6]+76029189&4294967295,m=A+(T<<23&4294967295|T>>>9),T=f+(m^A^R)+w[9]+3654602809&4294967295,f=m+(T<<4&4294967295|T>>>28),T=R+(f^m^A)+w[12]+3873151461&4294967295,R=f+(T<<11&4294967295|T>>>21),T=A+(R^f^m)+w[15]+530742520&4294967295,A=R+(T<<16&4294967295|T>>>16),T=m+(A^R^f)+w[2]+3299628645&4294967295,m=A+(T<<23&4294967295|T>>>9),T=f+(A^(m|~R))+w[0]+4096336452&4294967295,f=m+(T<<6&4294967295|T>>>26),T=R+(m^(f|~A))+w[7]+1126891415&4294967295,R=f+(T<<10&4294967295|T>>>22),T=A+(f^(R|~m))+w[14]+2878612391&4294967295,A=R+(T<<15&4294967295|T>>>17),T=m+(R^(A|~f))+w[5]+4237533241&4294967295,m=A+(T<<21&4294967295|T>>>11),T=f+(A^(m|~R))+w[12]+1700485571&4294967295,f=m+(T<<6&4294967295|T>>>26),T=R+(m^(f|~A))+w[3]+2399980690&4294967295,R=f+(T<<10&4294967295|T>>>22),T=A+(f^(R|~m))+w[10]+4293915773&4294967295,A=R+(T<<15&4294967295|T>>>17),T=m+(R^(A|~f))+w[1]+2240044497&4294967295,m=A+(T<<21&4294967295|T>>>11),T=f+(A^(m|~R))+w[8]+1873313359&4294967295,f=m+(T<<6&4294967295|T>>>26),T=R+(m^(f|~A))+w[15]+4264355552&4294967295,R=f+(T<<10&4294967295|T>>>22),T=A+(f^(R|~m))+w[6]+2734768916&4294967295,A=R+(T<<15&4294967295|T>>>17),T=m+(R^(A|~f))+w[13]+1309151649&4294967295,m=A+(T<<21&4294967295|T>>>11),T=f+(A^(m|~R))+w[4]+4149444226&4294967295,f=m+(T<<6&4294967295|T>>>26),T=R+(m^(f|~A))+w[11]+3174756917&4294967295,R=f+(T<<10&4294967295|T>>>22),T=A+(f^(R|~m))+w[2]+718787259&4294967295,A=R+(T<<15&4294967295|T>>>17),T=m+(R^(A|~f))+w[9]+3951481745&4294967295,x.g[0]=x.g[0]+f&4294967295,x.g[1]=x.g[1]+(A+(T<<21&4294967295|T>>>11))&4294967295,x.g[2]=x.g[2]+A&4294967295,x.g[3]=x.g[3]+R&4294967295}r.prototype.u=function(x,f){f===void 0&&(f=x.length);for(var m=f-this.blockSize,w=this.B,A=this.h,R=0;R<f;){if(A==0)for(;R<=m;)i(this,x,R),R+=this.blockSize;if(typeof x=="string"){for(;R<f;)if(w[A++]=x.charCodeAt(R++),A==this.blockSize){i(this,w),A=0;break}}else for(;R<f;)if(w[A++]=x[R++],A==this.blockSize){i(this,w),A=0;break}}this.h=A,this.o+=f},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var f=1;f<x.length-8;++f)x[f]=0;var m=8*this.o;for(f=x.length-8;f<x.length;++f)x[f]=m&255,m/=256;for(this.u(x),x=Array(16),f=m=0;4>f;++f)for(var w=0;32>w;w+=8)x[m++]=this.g[f]>>>w&255;return x};function s(x,f){var m=u;return Object.prototype.hasOwnProperty.call(m,x)?m[x]:m[x]=f(x)}function o(x,f){this.h=f;for(var m=[],w=!0,A=x.length-1;0<=A;A--){var R=x[A]|0;w&&R==f||(m[A]=R,w=!1)}this.g=m}var u={};function c(x){return-128<=x&&128>x?s(x,function(f){return new o([f|0],0>f?-1:0)}):new o([x|0],0>x?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return y;if(0>x)return N(d(-x));for(var f=[],m=1,w=0;x>=m;w++)f[w]=x/m|0,m*=4294967296;return new o(f,0)}function p(x,f){if(x.length==0)throw Error("number format error: empty string");if(f=f||10,2>f||36<f)throw Error("radix out of range: "+f);if(x.charAt(0)=="-")return N(p(x.substring(1),f));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=d(Math.pow(f,8)),w=y,A=0;A<x.length;A+=8){var R=Math.min(8,x.length-A),T=parseInt(x.substring(A,A+R),f);8>R?(R=d(Math.pow(f,R)),w=w.j(R).add(d(T))):(w=w.j(m),w=w.add(d(T)))}return w}var y=c(0),v=c(1),b=c(16777216);t=o.prototype,t.m=function(){if(k(this))return-N(this).m();for(var x=0,f=1,m=0;m<this.g.length;m++){var w=this.i(m);x+=(0<=w?w:4294967296+w)*f,f*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(P(this))return"0";if(k(this))return"-"+N(this).toString(x);for(var f=d(Math.pow(x,6)),m=this,w="";;){var A=D(m,f).g;m=C(m,A.j(f));var R=((0<m.g.length?m.g[0]:m.h)>>>0).toString(x);if(m=A,P(m))return R+w;for(;6>R.length;)R="0"+R;w=R+w}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function P(x){if(x.h!=0)return!1;for(var f=0;f<x.g.length;f++)if(x.g[f]!=0)return!1;return!0}function k(x){return x.h==-1}t.l=function(x){return x=C(this,x),k(x)?-1:P(x)?0:1};function N(x){for(var f=x.g.length,m=[],w=0;w<f;w++)m[w]=~x.g[w];return new o(m,~x.h).add(v)}t.abs=function(){return k(this)?N(this):this},t.add=function(x){for(var f=Math.max(this.g.length,x.g.length),m=[],w=0,A=0;A<=f;A++){var R=w+(this.i(A)&65535)+(x.i(A)&65535),T=(R>>>16)+(this.i(A)>>>16)+(x.i(A)>>>16);w=T>>>16,R&=65535,T&=65535,m[A]=T<<16|R}return new o(m,m[m.length-1]&-2147483648?-1:0)};function C(x,f){return x.add(N(f))}t.j=function(x){if(P(this)||P(x))return y;if(k(this))return k(x)?N(this).j(N(x)):N(N(this).j(x));if(k(x))return N(this.j(N(x)));if(0>this.l(b)&&0>x.l(b))return d(this.m()*x.m());for(var f=this.g.length+x.g.length,m=[],w=0;w<2*f;w++)m[w]=0;for(w=0;w<this.g.length;w++)for(var A=0;A<x.g.length;A++){var R=this.i(w)>>>16,T=this.i(w)&65535,ae=x.i(A)>>>16,H=x.i(A)&65535;m[2*w+2*A]+=T*H,S(m,2*w+2*A),m[2*w+2*A+1]+=R*H,S(m,2*w+2*A+1),m[2*w+2*A+1]+=T*ae,S(m,2*w+2*A+1),m[2*w+2*A+2]+=R*ae,S(m,2*w+2*A+2)}for(w=0;w<f;w++)m[w]=m[2*w+1]<<16|m[2*w];for(w=f;w<2*f;w++)m[w]=0;return new o(m,0)};function S(x,f){for(;(x[f]&65535)!=x[f];)x[f+1]+=x[f]>>>16,x[f]&=65535,f++}function E(x,f){this.g=x,this.h=f}function D(x,f){if(P(f))throw Error("division by zero");if(P(x))return new E(y,y);if(k(x))return f=D(N(x),f),new E(N(f.g),N(f.h));if(k(f))return f=D(x,N(f)),new E(N(f.g),f.h);if(30<x.g.length){if(k(x)||k(f))throw Error("slowDivide_ only works with positive integers.");for(var m=v,w=f;0>=w.l(x);)m=V(m),w=V(w);var A=L(m,1),R=L(w,1);for(w=L(w,2),m=L(m,2);!P(w);){var T=R.add(w);0>=T.l(x)&&(A=A.add(m),R=T),w=L(w,1),m=L(m,1)}return f=C(x,A.j(f)),new E(A,f)}for(A=y;0<=x.l(f);){for(m=Math.max(1,Math.floor(x.m()/f.m())),w=Math.ceil(Math.log(m)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),R=d(m),T=R.j(f);k(T)||0<T.l(x);)m-=w,R=d(m),T=R.j(f);P(R)&&(R=v),A=A.add(R),x=C(x,T)}return new E(A,x)}t.A=function(x){return D(this,x).h},t.and=function(x){for(var f=Math.max(this.g.length,x.g.length),m=[],w=0;w<f;w++)m[w]=this.i(w)&x.i(w);return new o(m,this.h&x.h)},t.or=function(x){for(var f=Math.max(this.g.length,x.g.length),m=[],w=0;w<f;w++)m[w]=this.i(w)|x.i(w);return new o(m,this.h|x.h)},t.xor=function(x){for(var f=Math.max(this.g.length,x.g.length),m=[],w=0;w<f;w++)m[w]=this.i(w)^x.i(w);return new o(m,this.h^x.h)};function V(x){for(var f=x.g.length+1,m=[],w=0;w<f;w++)m[w]=x.i(w)<<1|x.i(w-1)>>>31;return new o(m,x.h)}function L(x,f){var m=f>>5;f%=32;for(var w=x.g.length-m,A=[],R=0;R<w;R++)A[R]=0<f?x.i(R+m)>>>f|x.i(R+m+1)<<32-f:x.i(R+m);return new o(A,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,tx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,$i=o}).apply(typeof ay<"u"?ay:typeof self<"u"?self:typeof window<"u"?window:{});var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nx,Bo,rx,Yl,Mh,ix,sx,ox;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,g){return l==Array.prototype||l==Object.prototype||(l[h]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof jl=="object"&&jl];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(l,h){if(h)e:{var g=r;l=l.split(".");for(var I=0;I<l.length-1;I++){var B=l[I];if(!(B in g))break e;g=g[B]}l=l[l.length-1],I=g[l],h=h(I),h!=I&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var g=0,I=!1,B={next:function(){if(!I&&g<l.length){var $=g++;return{value:h($,l[$]),done:!1}}return I=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function p(l,h,g){return l.call.apply(l.bind,arguments)}function y(l,h,g){if(!l)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,I),l.apply(h,B)}}return function(){return l.apply(h,arguments)}}function v(l,h,g){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,v.apply(null,arguments)}function b(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var I=g.slice();return I.push.apply(I,arguments),l.apply(this,I)}}function P(l,h){function g(){}g.prototype=h.prototype,l.aa=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(I,B,$){for(var re=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)re[Xe-2]=arguments[Xe];return h.prototype[B].apply(I,re)}}function k(l){const h=l.length;if(0<h){const g=Array(h);for(let I=0;I<h;I++)g[I]=l[I];return g}return[]}function N(l,h){for(let g=1;g<arguments.length;g++){const I=arguments[g];if(c(I)){const B=l.length||0,$=I.length||0;l.length=B+$;for(let re=0;re<$;re++)l[B+re]=I[re]}else l.push(I)}}class C{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function S(l){return/^[\s\xa0]*$/.test(l)}function E(){var l=u.navigator;return l&&(l=l.userAgent)?l:""}function D(l){return D[" "](l),l}D[" "]=function(){};var V=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function L(l,h,g){for(const I in l)h.call(g,l[I],I,l)}function x(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function f(l){const h={};for(const g in l)h[g]=l[g];return h}const m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(l,h){let g,I;for(let B=1;B<arguments.length;B++){I=arguments[B];for(g in I)l[g]=I[g];for(let $=0;$<m.length;$++)g=m[$],Object.prototype.hasOwnProperty.call(I,g)&&(l[g]=I[g])}}function A(l){var h=1;l=l.split(":");const g=[];for(;0<h&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function R(l){u.setTimeout(()=>{throw l},0)}function T(){var l=F;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ae{constructor(){this.h=this.g=null}add(h,g){const I=H.get();I.set(h,g),this.h?this.h.next=I:this.g=I,this.h=I}}var H=new C(()=>new te,l=>l.reset());class te{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,M=!1,F=new ae,W=()=>{const l=u.Promise.resolve(void 0);ee=()=>{l.then(q)}};var q=()=>{for(var l;l=T();){try{l.h.call(l.g)}catch(g){R(g)}var h=H;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}M=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};u.addEventListener("test",g,h),u.removeEventListener("test",g,h)}catch{}return l}();function z(l,h){if(O.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,I=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(V){e:{try{D(h.nodeName);var B=!0;break e}catch{}B=!1}B||(h=null)}}else g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement);this.relatedTarget=h,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:ie[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&z.aa.h.call(this)}}P(z,O);var ie={2:"touch",3:"pen",4:"mouse"};z.prototype.h=function(){z.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var pe="closure_listenable_"+(1e6*Math.random()|0),ne=0;function Te(l,h,g,I,B){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!I,this.ha=B,this.key=++ne,this.da=this.fa=!1}function De(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function _e(l){this.src=l,this.g={},this.h=0}_e.prototype.add=function(l,h,g,I,B){var $=l.toString();l=this.g[$],l||(l=this.g[$]=[],this.h++);var re=We(l,h,I,B);return-1<re?(h=l[re],g||(h.fa=!1)):(h=new Te(h,this.src,$,!!I,B),h.fa=g,l.push(h)),h};function be(l,h){var g=h.type;if(g in l.g){var I=l.g[g],B=Array.prototype.indexOf.call(I,h,void 0),$;($=0<=B)&&Array.prototype.splice.call(I,B,1),$&&(De(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function We(l,h,g,I){for(var B=0;B<l.length;++B){var $=l[B];if(!$.da&&$.listener==h&&$.capture==!!g&&$.ha==I)return B}return-1}var Pe="closure_lm_"+(1e6*Math.random()|0),Re={};function ye(l,h,g,I,B){if(Array.isArray(h)){for(var $=0;$<h.length;$++)ye(l,h[$],g,I,B);return null}return g=vt(g),l&&l[pe]?l.K(h,g,d(I)?!!I.capture:!1,B):Je(l,h,g,!1,I,B)}function Je(l,h,g,I,B,$){if(!h)throw Error("Invalid event type");var re=d(B)?!!B.capture:!!B,Xe=Lt(l);if(Xe||(l[Pe]=Xe=new _e(l)),g=Xe.add(h,g,I,re,$),g.proxy)return g;if(I=ve(),g.proxy=I,I.src=l,I.listener=g,l.addEventListener)X||(B=re),B===void 0&&(B=!1),l.addEventListener(h.toString(),I,B);else if(l.attachEvent)l.attachEvent(qt(h.toString()),I);else if(l.addListener&&l.removeListener)l.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ve(){function l(g){return h.call(l.src,l.listener,g)}const h=it;return l}function ke(l,h,g,I,B){if(Array.isArray(h))for(var $=0;$<h.length;$++)ke(l,h[$],g,I,B);else I=d(I)?!!I.capture:!!I,g=vt(g),l&&l[pe]?(l=l.i,h=String(h).toString(),h in l.g&&($=l.g[h],g=We($,g,I,B),-1<g&&(De($[g]),Array.prototype.splice.call($,g,1),$.length==0&&(delete l.g[h],l.h--)))):l&&(l=Lt(l))&&(h=l.g[h.toString()],l=-1,h&&(l=We(h,g,I,B)),(g=-1<l?h[l]:null)&&Ne(g))}function Ne(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[pe])be(h.i,l);else{var g=l.type,I=l.proxy;h.removeEventListener?h.removeEventListener(g,I,l.capture):h.detachEvent?h.detachEvent(qt(g),I):h.addListener&&h.removeListener&&h.removeListener(I),(g=Lt(h))?(be(g,l),g.h==0&&(g.src=null,h[Pe]=null)):De(l)}}}function qt(l){return l in Re?Re[l]:Re[l]="on"+l}function it(l,h){if(l.da)l=!0;else{h=new z(h,this);var g=l.listener,I=l.ha||l.src;l.fa&&Ne(l),l=g.call(I,h)}return l}function Lt(l){return l=l[Pe],l instanceof _e?l:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function vt(l){return typeof l=="function"?l:(l[Qe]||(l[Qe]=function(h){return l.handleEvent(h)}),l[Qe])}function xe(){G.call(this),this.i=new _e(this),this.M=this,this.F=null}P(xe,G),xe.prototype[pe]=!0,xe.prototype.removeEventListener=function(l,h,g,I){ke(this,l,h,g,I)};function Oe(l,h){var g,I=l.F;if(I)for(g=[];I;I=I.F)g.push(I);if(l=l.M,I=h.type||h,typeof h=="string")h=new O(h,l);else if(h instanceof O)h.target=h.target||l;else{var B=h;h=new O(I,l),w(h,B)}if(B=!0,g)for(var $=g.length-1;0<=$;$--){var re=h.g=g[$];B=Ye(re,I,!0,h)&&B}if(re=h.g=l,B=Ye(re,I,!0,h)&&B,B=Ye(re,I,!1,h)&&B,g)for($=0;$<g.length;$++)re=h.g=g[$],B=Ye(re,I,!1,h)&&B}xe.prototype.N=function(){if(xe.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var g=l.g[h],I=0;I<g.length;I++)De(g[I]);delete l.g[h],l.h--}}this.F=null},xe.prototype.K=function(l,h,g,I){return this.i.add(String(l),h,!1,g,I)},xe.prototype.L=function(l,h,g,I){return this.i.add(String(l),h,!0,g,I)};function Ye(l,h,g,I){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var B=!0,$=0;$<h.length;++$){var re=h[$];if(re&&!re.da&&re.capture==g){var Xe=re.listener,Mt=re.ha||re.src;re.fa&&be(l.i,re),B=Xe.call(Mt,I)!==!1&&B}}return B&&!I.defaultPrevented}function Jn(l,h,g){if(typeof l=="function")g&&(l=v(l,g));else if(l&&typeof l.handleEvent=="function")l=v(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(l,h||0)}function Ht(l){l.g=Jn(()=>{l.g=null,l.i&&(l.i=!1,Ht(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class hn extends G{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Ht(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qe(l){G.call(this),this.h=l,this.g={}}P(qe,G);var fn=[];function Zn(l){L(l.g,function(h,g){this.g.hasOwnProperty(g)&&Ne(h)},l),l.g={}}qe.prototype.N=function(){qe.aa.N.call(this),Zn(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var He=u.JSON.stringify,Br=u.JSON.parse,yo=class{stringify(l){return u.JSON.stringify(l,void 0)}parse(l){return u.JSON.parse(l,void 0)}};function ki(){}ki.prototype.h=null;function zr(l){return l.h||(l.h=l.i())}function cs(){}var kn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $r(){O.call(this,"d")}P($r,O);function Wr(){O.call(this,"c")}P(Wr,O);var Kt={},_=null;function J(){return _=_||new xe}Kt.La="serverreachability";function oe(l){O.call(this,Kt.La,l)}P(oe,O);function U(l){const h=J();Oe(h,new oe(h))}Kt.STAT_EVENT="statevent";function se(l,h){O.call(this,Kt.STAT_EVENT,l),this.stat=h}P(se,O);function le(l){const h=J();Oe(h,new se(h,l))}Kt.Ma="timingevent";function Se(l,h){O.call(this,Kt.Ma,l),this.size=h}P(Se,O);function ce(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){l()},h)}function je(){this.g=!0}je.prototype.xa=function(){this.g=!1};function sn(l,h,g,I,B,$){l.info(function(){if(l.g)if($)for(var re="",Xe=$.split("&"),Mt=0;Mt<Xe.length;Mt++){var ze=Xe[Mt].split("=");if(1<ze.length){var Gt=ze[0];ze=ze[1];var Qt=Gt.split("_");re=2<=Qt.length&&Qt[1]=="type"?re+(Gt+"="+ze+"&"):re+(Gt+"=redacted&")}}else re=null;else re=$;return"XMLHTTP REQ ("+I+") [attempt "+B+"]: "+h+`
`+g+`
`+re})}function Pn(l,h,g,I,B,$,re){l.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+B+"]: "+h+`
`+g+`
`+$+" "+re})}function _t(l,h,g,I){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+pt(l,g)+(I?" "+I:"")})}function dt(l,h){l.info(function(){return"TIMEOUT: "+h})}je.prototype.info=function(){};function pt(l,h){if(!l.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var I=g[l];if(!(2>I.length)){var B=I[1];if(Array.isArray(B)&&!(1>B.length)){var $=B[0];if($!="noop"&&$!="stop"&&$!="close")for(var re=1;re<B.length;re++)B[re]=""}}}}return He(g)}catch{return h}}var fr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},me={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ot;function ds(){}P(ds,ki),ds.prototype.g=function(){return new XMLHttpRequest},ds.prototype.i=function(){return{}},ot=new ds;function qr(l,h,g,I){this.j=l,this.i=h,this.l=g,this.R=I||1,this.U=new qe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Yp}function Yp(){this.i=null,this.g="",this.h=!1}var Xp={},Mc={};function Vc(l,h,g){l.L=1,l.v=ol(pr(h)),l.m=g,l.P=!0,Jp(l,null)}function Jp(l,h){l.F=Date.now(),rl(l),l.A=pr(l.v);var g=l.A,I=l.R;Array.isArray(I)||(I=[String(I)]),hg(g.i,"t",I),l.C=0,g=l.j.J,l.h=new Yp,l.g=kg(l.j,g?h:null,!l.m),0<l.O&&(l.M=new hn(v(l.Y,l,l.g),l.O)),h=l.U,g=l.g,I=l.ca;var B="readystatechange";Array.isArray(B)||(B&&(fn[0]=B.toString()),B=fn);for(var $=0;$<B.length;$++){var re=ye(g,B[$],I||h.handleEvent,!1,h.h||h);if(!re)break;h.g[re.key]=re}h=l.H?f(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),U(),sn(l.i,l.u,l.A,l.l,l.R,l.m)}qr.prototype.ca=function(l){l=l.target;const h=this.M;h&&gr(l)==3?h.j():this.Y(l)},qr.prototype.Y=function(l){try{if(l==this.g)e:{const Qt=gr(this.g);var h=this.g.Ba();const ps=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||_g(this.g)))){this.J||Qt!=4||h==7||(h==8||0>=ps?U(3):U(2)),Fc(this);var g=this.g.Z();this.X=g;t:if(Zp(this)){var I=_g(this.g);l="";var B=I.length,$=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Pi(this),vo(this);var re="";break t}this.h.i=new u.TextDecoder}for(h=0;h<B;h++)this.h.h=!0,l+=this.h.i.decode(I[h],{stream:!($&&h==B-1)});I.length=0,this.h.g+=l,this.C=0,re=this.h.g}else re=this.g.oa();if(this.o=g==200,Pn(this.i,this.u,this.A,this.l,this.R,Qt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Xe,Mt=this.g;if((Xe=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Xe)){var ze=Xe;break t}}ze=null}if(g=ze)_t(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Uc(this,g);else{this.o=!1,this.s=3,le(12),Pi(this),vo(this);break e}}if(this.P){g=!0;let Bn;for(;!this.J&&this.C<re.length;)if(Bn=EE(this,re),Bn==Mc){Qt==4&&(this.s=4,le(14),g=!1),_t(this.i,this.l,null,"[Incomplete Response]");break}else if(Bn==Xp){this.s=4,le(15),_t(this.i,this.l,re,"[Invalid Chunk]"),g=!1;break}else _t(this.i,this.l,Bn,null),Uc(this,Bn);if(Zp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||re.length!=0||this.h.h||(this.s=1,le(16),g=!1),this.o=this.o&&g,!g)_t(this.i,this.l,re,"[Invalid Chunked Response]"),Pi(this),vo(this);else if(0<re.length&&!this.W){this.W=!0;var Gt=this.j;Gt.g==this&&Gt.ba&&!Gt.M&&(Gt.j.info("Great, no buffering proxy detected. Bytes received: "+re.length),Hc(Gt),Gt.M=!0,le(11))}}else _t(this.i,this.l,re,null),Uc(this,re);Qt==4&&Pi(this),this.o&&!this.J&&(Qt==4?bg(this.j,this):(this.o=!1,rl(this)))}else FE(this.g),g==400&&0<re.indexOf("Unknown SID")?(this.s=3,le(12)):(this.s=0,le(13)),Pi(this),vo(this)}}}catch{}finally{}};function Zp(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function EE(l,h){var g=l.C,I=h.indexOf(`
`,g);return I==-1?Mc:(g=Number(h.substring(g,I)),isNaN(g)?Xp:(I+=1,I+g>h.length?Mc:(h=h.slice(I,I+g),l.C=I+g,h)))}qr.prototype.cancel=function(){this.J=!0,Pi(this)};function rl(l){l.S=Date.now()+l.I,eg(l,l.I)}function eg(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ce(v(l.ba,l),h)}function Fc(l){l.B&&(u.clearTimeout(l.B),l.B=null)}qr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(dt(this.i,this.A),this.L!=2&&(U(),le(17)),Pi(this),this.s=2,vo(this)):eg(this,this.S-l)};function vo(l){l.j.G==0||l.J||bg(l.j,l)}function Pi(l){Fc(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Zn(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Uc(l,h){try{var g=l.j;if(g.G!=0&&(g.g==l||Bc(g.h,l))){if(!l.K&&Bc(g.h,l)&&g.G==3){try{var I=g.Da.g.parse(h)}catch{I=null}if(Array.isArray(I)&&I.length==3){var B=I;if(B[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)hl(g),cl(g);else break e;qc(g),le(18)}}else g.za=B[1],0<g.za-g.T&&37500>B[2]&&g.F&&g.v==0&&!g.C&&(g.C=ce(v(g.Za,g),6e3));if(1>=rg(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Ni(g,11)}else if((l.K||g.g==l)&&hl(g),!S(h))for(B=g.Da.g.parse(h),h=0;h<B.length;h++){let ze=B[h];if(g.T=ze[0],ze=ze[1],g.G==2)if(ze[0]=="c"){g.K=ze[1],g.ia=ze[2];const Gt=ze[3];Gt!=null&&(g.la=Gt,g.j.info("VER="+g.la));const Qt=ze[4];Qt!=null&&(g.Aa=Qt,g.j.info("SVER="+g.Aa));const ps=ze[5];ps!=null&&typeof ps=="number"&&0<ps&&(I=1.5*ps,g.L=I,g.j.info("backChannelRequestTimeoutMs_="+I)),I=g;const Bn=l.g;if(Bn){const pl=Bn.g?Bn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pl){var $=I.h;$.g||pl.indexOf("spdy")==-1&&pl.indexOf("quic")==-1&&pl.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(zc($,$.h),$.h=null))}if(I.D){const Kc=Bn.g?Bn.g.getResponseHeader("X-HTTP-Session-Id"):null;Kc&&(I.ya=Kc,et(I.I,I.D,Kc))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),I=g;var re=l;if(I.qa=Rg(I,I.J?I.ia:null,I.W),re.K){ig(I.h,re);var Xe=re,Mt=I.L;Mt&&(Xe.I=Mt),Xe.B&&(Fc(Xe),rl(Xe)),I.g=re}else Ig(I);0<g.i.length&&dl(g)}else ze[0]!="stop"&&ze[0]!="close"||Ni(g,7);else g.G==3&&(ze[0]=="stop"||ze[0]=="close"?ze[0]=="stop"?Ni(g,7):Wc(g):ze[0]!="noop"&&g.l&&g.l.ta(ze),g.v=0)}}U(4)}catch{}}var SE=class{constructor(l,h){this.g=l,this.map=h}};function tg(l){this.l=l||10,u.PerformanceNavigationTiming?(l=u.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ng(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function rg(l){return l.h?1:l.g?l.g.size:0}function Bc(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function zc(l,h){l.g?l.g.add(h):l.h=h}function ig(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}tg.prototype.cancel=function(){if(this.i=sg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function sg(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.D);return h}return k(l.i)}function IE(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],g=l.length,I=0;I<g;I++)h.push(l[I]);return h}h=[],g=0;for(I in l)h[g++]=l[I];return h}function TE(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var g=0;g<l;g++)h.push(g);return h}h=[],g=0;for(const I in l)h[g++]=I;return h}}}function og(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var g=TE(l),I=IE(l),B=I.length,$=0;$<B;$++)h.call(void 0,I[$],g&&g[$],l)}var ag=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bE(l,h){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var I=l[g].indexOf("="),B=null;if(0<=I){var $=l[g].substring(0,I);B=l[g].substring(I+1)}else $=l[g];h($,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function ji(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof ji){this.h=l.h,il(this,l.j),this.o=l.o,this.g=l.g,sl(this,l.s),this.l=l.l;var h=l.i,g=new wo;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),lg(this,g),this.m=l.m}else l&&(h=String(l).match(ag))?(this.h=!1,il(this,h[1]||"",!0),this.o=_o(h[2]||""),this.g=_o(h[3]||"",!0),sl(this,h[4]),this.l=_o(h[5]||"",!0),lg(this,h[6]||"",!0),this.m=_o(h[7]||"")):(this.h=!1,this.i=new wo(null,this.h))}ji.prototype.toString=function(){var l=[],h=this.j;h&&l.push(xo(h,ug,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(xo(h,ug,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(xo(g,g.charAt(0)=="/"?RE:AE,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",xo(g,PE)),l.join("")};function pr(l){return new ji(l)}function il(l,h,g){l.j=g?_o(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function sl(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function lg(l,h,g){h instanceof wo?(l.i=h,jE(l.i,l.h)):(g||(h=xo(h,kE)),l.i=new wo(h,l.h))}function et(l,h,g){l.i.set(h,g)}function ol(l){return et(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function _o(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function xo(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,CE),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function CE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ug=/[#\/\?@]/g,AE=/[#\?:]/g,RE=/[#\?]/g,kE=/[#\?@]/g,PE=/#/g;function wo(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Hr(l){l.g||(l.g=new Map,l.h=0,l.i&&bE(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=wo.prototype,t.add=function(l,h){Hr(this),this.i=null,l=hs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function cg(l,h){Hr(l),h=hs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function dg(l,h){return Hr(l),h=hs(l,h),l.g.has(h)}t.forEach=function(l,h){Hr(this),this.g.forEach(function(g,I){g.forEach(function(B){l.call(h,B,I,this)},this)},this)},t.na=function(){Hr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let I=0;I<h.length;I++){const B=l[I];for(let $=0;$<B.length;$++)g.push(h[I])}return g},t.V=function(l){Hr(this);let h=[];if(typeof l=="string")dg(this,l)&&(h=h.concat(this.g.get(hs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)h=h.concat(l[g])}return h},t.set=function(l,h){return Hr(this),this.i=null,l=hs(this,l),dg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function hg(l,h,g){cg(l,h),0<g.length&&(l.i=null,l.g.set(hs(l,h),k(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var I=h[g];const $=encodeURIComponent(String(I)),re=this.V(I);for(I=0;I<re.length;I++){var B=$;re[I]!==""&&(B+="="+encodeURIComponent(String(re[I]))),l.push(B)}}return this.i=l.join("&")};function hs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function jE(l,h){h&&!l.j&&(Hr(l),l.i=null,l.g.forEach(function(g,I){var B=I.toLowerCase();I!=B&&(cg(this,I),hg(this,B,g))},l)),l.j=h}function NE(l,h){const g=new je;if(u.Image){const I=new Image;I.onload=b(Kr,g,"TestLoadImage: loaded",!0,h,I),I.onerror=b(Kr,g,"TestLoadImage: error",!1,h,I),I.onabort=b(Kr,g,"TestLoadImage: abort",!1,h,I),I.ontimeout=b(Kr,g,"TestLoadImage: timeout",!1,h,I),u.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=l}else h(!1)}function DE(l,h){const g=new je,I=new AbortController,B=setTimeout(()=>{I.abort(),Kr(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:I.signal}).then($=>{clearTimeout(B),$.ok?Kr(g,"TestPingServer: ok",!0,h):Kr(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(B),Kr(g,"TestPingServer: error",!1,h)})}function Kr(l,h,g,I,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),I(g)}catch{}}function OE(){this.g=new yo}function LE(l,h,g){const I=g||"";try{og(l,function(B,$){let re=B;d(B)&&(re=He(B)),h.push(I+$+"="+encodeURIComponent(re))})}catch(B){throw h.push(I+"type="+encodeURIComponent("_badmap")),B}}function al(l){this.l=l.Ub||null,this.j=l.eb||!1}P(al,ki),al.prototype.g=function(){return new ll(this.l,this.j)},al.prototype.i=function(l){return function(){return l}}({});function ll(l,h){xe.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(ll,xe),t=ll.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,So(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Eo(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,So(this)),this.g&&(this.readyState=3,So(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fg(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function fg(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Eo(this):So(this),this.readyState==3&&fg(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Eo(this))},t.Qa=function(l){this.g&&(this.response=l,Eo(this))},t.ga=function(){this.g&&Eo(this)};function Eo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,So(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function So(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ll.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function pg(l){let h="";return L(l,function(g,I){h+=I,h+=":",h+=g,h+=`\r
`}),h}function $c(l,h,g){e:{for(I in g){var I=!1;break e}I=!0}I||(g=pg(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):et(l,h,g))}function ht(l){xe.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(ht,xe);var ME=/^https?$/i,VE=["POST","PUT"];t=ht.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,g,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ot.g(),this.v=this.o?zr(this.o):zr(ot),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch($){gg(this,$);return}if(l=g||"",g=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var B in I)g.set(B,I[B]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const $ of I.keys())g.set($,I.get($));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(g.keys()).find($=>$.toLowerCase()=="content-type"),B=u.FormData&&l instanceof u.FormData,!(0<=Array.prototype.indexOf.call(VE,h,void 0))||I||B||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,re]of g)this.g.setRequestHeader($,re);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vg(this),this.u=!0,this.g.send(l),this.u=!1}catch($){gg(this,$)}};function gg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,mg(l),ul(l)}function mg(l){l.A||(l.A=!0,Oe(l,"complete"),Oe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Oe(this,"complete"),Oe(this,"abort"),ul(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ul(this,!0)),ht.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?yg(this):this.bb())},t.bb=function(){yg(this)};function yg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||gr(l)!=4||l.Z()!=2)){if(l.u&&gr(l)==4)Jn(l.Ea,0,l);else if(Oe(l,"readystatechange"),gr(l)==4){l.h=!1;try{const re=l.Z();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var I;if(I=re===0){var B=String(l.D).match(ag)[1]||null;!B&&u.self&&u.self.location&&(B=u.self.location.protocol.slice(0,-1)),I=!ME.test(B?B.toLowerCase():"")}g=I}if(g)Oe(l,"complete"),Oe(l,"success");else{l.m=6;try{var $=2<gr(l)?l.g.statusText:""}catch{$=""}l.l=$+" ["+l.Z()+"]",mg(l)}}finally{ul(l)}}}}function ul(l,h){if(l.g){vg(l);const g=l.g,I=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Oe(l,"ready");try{g.onreadystatechange=I}catch{}}}function vg(l){l.I&&(u.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function gr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Br(h)}};function _g(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function FE(l){const h={};l=(l.g&&2<=gr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<l.length;I++){if(S(l[I]))continue;var g=A(l[I]);const B=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const $=h[B]||[];h[B]=$,$.push(g)}x(h,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Io(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function xg(l){this.Aa=0,this.i=[],this.j=new je,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Io("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Io("baseRetryDelayMs",5e3,l),this.cb=Io("retryDelaySeedMs",1e4,l),this.Wa=Io("forwardChannelMaxRetries",2,l),this.wa=Io("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new tg(l&&l.concurrentRequestLimit),this.Da=new OE,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=xg.prototype,t.la=8,t.G=1,t.connect=function(l,h,g,I){le(0),this.W=l,this.H=h||{},g&&I!==void 0&&(this.H.OSID=g,this.H.OAID=I),this.F=this.X,this.I=Rg(this,null,this.W),dl(this)};function Wc(l){if(wg(l),l.G==3){var h=l.U++,g=pr(l.I);if(et(g,"SID",l.K),et(g,"RID",h),et(g,"TYPE","terminate"),To(l,g),h=new qr(l,l.j,h),h.L=2,h.v=ol(pr(g)),g=!1,u.navigator&&u.navigator.sendBeacon)try{g=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&u.Image&&(new Image().src=h.v,g=!0),g||(h.g=kg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),rl(h)}Ag(l)}function cl(l){l.g&&(Hc(l),l.g.cancel(),l.g=null)}function wg(l){cl(l),l.u&&(u.clearTimeout(l.u),l.u=null),hl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&u.clearTimeout(l.s),l.s=null)}function dl(l){if(!ng(l.h)&&!l.s){l.s=!0;var h=l.Ga;ee||W(),M||(ee(),M=!0),F.add(h,l),l.B=0}}function UE(l,h){return rg(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ce(v(l.Ga,l,h),Cg(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const B=new qr(this,this.j,l);let $=this.o;if(this.S&&($?($=f($),w($,this.S)):$=this.S),this.m!==null||this.O||(B.H=$,$=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var I=this.i[g];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(h+=I,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=Sg(this,B,h),g=pr(this.I),et(g,"RID",l),et(g,"CVER",22),this.D&&et(g,"X-HTTP-Session-Id",this.D),To(this,g),$&&(this.O?h="headers="+encodeURIComponent(String(pg($)))+"&"+h:this.m&&$c(g,this.m,$)),zc(this.h,B),this.Ua&&et(g,"TYPE","init"),this.P?(et(g,"$req",h),et(g,"SID","null"),B.T=!0,Vc(B,g,null)):Vc(B,g,h),this.G=2}}else this.G==3&&(l?Eg(this,l):this.i.length==0||ng(this.h)||Eg(this))};function Eg(l,h){var g;h?g=h.l:g=l.U++;const I=pr(l.I);et(I,"SID",l.K),et(I,"RID",g),et(I,"AID",l.T),To(l,I),l.m&&l.o&&$c(I,l.m,l.o),g=new qr(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Sg(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),zc(l.h,g),Vc(g,I,h)}function To(l,h){l.H&&L(l.H,function(g,I){et(h,I,g)}),l.l&&og({},function(g,I){et(h,I,g)})}function Sg(l,h,g){g=Math.min(l.i.length,g);var I=l.l?v(l.l.Na,l.l,l):null;e:{var B=l.i;let $=-1;for(;;){const re=["count="+g];$==-1?0<g?($=B[0].g,re.push("ofs="+$)):$=0:re.push("ofs="+$);let Xe=!0;for(let Mt=0;Mt<g;Mt++){let ze=B[Mt].g;const Gt=B[Mt].map;if(ze-=$,0>ze)$=Math.max(0,B[Mt].g-100),Xe=!1;else try{LE(Gt,re,"req"+ze+"_")}catch{I&&I(Gt)}}if(Xe){I=re.join("&");break e}}}return l=l.i.splice(0,g),h.D=l,I}function Ig(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ee||W(),M||(ee(),M=!0),F.add(h,l),l.v=0}}function qc(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ce(v(l.Fa,l),Cg(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Tg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ce(v(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,le(10),cl(this),Tg(this))};function Hc(l){l.A!=null&&(u.clearTimeout(l.A),l.A=null)}function Tg(l){l.g=new qr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=pr(l.qa);et(h,"RID","rpc"),et(h,"SID",l.K),et(h,"AID",l.T),et(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&et(h,"TO",l.ja),et(h,"TYPE","xmlhttp"),To(l,h),l.m&&l.o&&$c(h,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=ol(pr(h)),g.m=null,g.P=!0,Jp(g,l)}t.Za=function(){this.C!=null&&(this.C=null,cl(this),qc(this),le(19))};function hl(l){l.C!=null&&(u.clearTimeout(l.C),l.C=null)}function bg(l,h){var g=null;if(l.g==h){hl(l),Hc(l),l.g=null;var I=2}else if(Bc(l.h,h))g=h.D,ig(l.h,h),I=1;else return;if(l.G!=0){if(h.o)if(I==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var B=l.B;I=J(),Oe(I,new Se(I,g)),dl(l)}else Ig(l);else if(B=h.s,B==3||B==0&&0<h.X||!(I==1&&UE(l,h)||I==2&&qc(l)))switch(g&&0<g.length&&(h=l.h,h.i=h.i.concat(g)),B){case 1:Ni(l,5);break;case 4:Ni(l,10);break;case 3:Ni(l,6);break;default:Ni(l,2)}}}function Cg(l,h){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*h}function Ni(l,h){if(l.j.info("Error code "+h),h==2){var g=v(l.fb,l),I=l.Xa;const B=!I;I=new ji(I||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||il(I,"https"),ol(I),B?NE(I.toString(),g):DE(I.toString(),g)}else le(2);l.G=0,l.l&&l.l.sa(h),Ag(l),wg(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),le(2)):(this.j.info("Failed to ping google.com"),le(1))};function Ag(l){if(l.G=0,l.ka=[],l.l){const h=sg(l.h);(h.length!=0||l.i.length!=0)&&(N(l.ka,h),N(l.ka,l.i),l.h.i.length=0,k(l.i),l.i.length=0),l.l.ra()}}function Rg(l,h,g){var I=g instanceof ji?pr(g):new ji(g);if(I.g!="")h&&(I.g=h+"."+I.g),sl(I,I.s);else{var B=u.location;I=B.protocol,h=h?h+"."+B.hostname:B.hostname,B=+B.port;var $=new ji(null);I&&il($,I),h&&($.g=h),B&&sl($,B),g&&($.l=g),I=$}return g=l.D,h=l.ya,g&&h&&et(I,g,h),et(I,"VER",l.la),To(l,I),I}function kg(l,h,g){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new ht(new al({eb:g})):new ht(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pg(){}t=Pg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function fl(){}fl.prototype.g=function(l,h){return new xn(l,h)};function xn(l,h){xe.call(this),this.g=new xg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!S(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!S(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new fs(this)}P(xn,xe),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Wc(this.g)},xn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=He(l),l=g);h.i.push(new SE(h.Ya++,l)),h.G==3&&dl(h)},xn.prototype.N=function(){this.g.l=null,delete this.j,Wc(this.g),delete this.g,xn.aa.N.call(this)};function jg(l){$r.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}P(jg,$r);function Ng(){Wr.call(this),this.status=1}P(Ng,Wr);function fs(l){this.g=l}P(fs,Pg),fs.prototype.ua=function(){Oe(this.g,"a")},fs.prototype.ta=function(l){Oe(this.g,new jg(l))},fs.prototype.sa=function(l){Oe(this.g,new Ng)},fs.prototype.ra=function(){Oe(this.g,"b")},fl.prototype.createWebChannel=fl.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,ox=function(){return new fl},sx=function(){return J()},ix=Kt,Mh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},fr.NO_ERROR=0,fr.TIMEOUT=8,fr.HTTP_ERROR=6,Yl=fr,me.COMPLETE="complete",rx=me,cs.EventType=kn,kn.OPEN="a",kn.CLOSE="b",kn.ERROR="c",kn.MESSAGE="d",xe.prototype.listen=xe.prototype.K,Bo=cs,ht.prototype.listenOnce=ht.prototype.L,ht.prototype.getLastError=ht.prototype.Ka,ht.prototype.getLastErrorCode=ht.prototype.Ba,ht.prototype.getStatus=ht.prototype.Z,ht.prototype.getResponseJson=ht.prototype.Oa,ht.prototype.getResponseText=ht.prototype.oa,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Ha,nx=ht}).apply(typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{});const ly="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zt.UNAUTHENTICATED=new Zt(null),Zt.GOOGLE_CREDENTIALS=new Zt("google-credentials-uid"),Zt.FIRST_PARTY=new Zt("first-party-uid"),Zt.MOCK_USER=new Zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let po="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=new tp("@firebase/firestore");function Do(){return Yi.logLevel}function he(t,...e){if(Yi.logLevel<=Ve.DEBUG){const n=e.map(ip);Yi.debug(`Firestore (${po}): ${t}`,...n)}}function Lr(t,...e){if(Yi.logLevel<=Ve.ERROR){const n=e.map(ip);Yi.error(`Firestore (${po}): ${t}`,...n)}}function Xi(t,...e){if(Yi.logLevel<=Ve.WARN){const n=e.map(ip);Yi.warn(`Firestore (${po}): ${t}`,...n)}}function ip(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(t="Unexpected state"){const e=`FIRESTORE (${po}) INTERNAL ASSERTION FAILED: `+t;throw Lr(e),new Error(e)}function Ge(t,e){t||Ie()}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends Ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Zt.UNAUTHENTICATED))}shutdown(){}}class Zb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class eC{constructor(e){this.t=e,this.currentUser=Zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ge(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new Ar;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ar,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ar)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string"),new ax(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string"),new Zt(e)}}class tC{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Zt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class nC{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new tC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ge(this.o===void 0);const r=s=>{s.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,he("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ge(typeof n.token=="string"),this.R=n.token,new rC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=sC(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function $e(t,e){return t<e?-1:t>e?1:0}function eo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ue(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ue(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ue(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Tt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ce(e)}static min(){return new Ce(new Tt(0,0))}static max(){return new Ce(new Tt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ie(),r===void 0?r=e.length-n:r>e.length-n&&Ie(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ba.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ba?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class nt extends ba{construct(e,n,r){return new nt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new nt(n)}static emptyPath(){return new nt([])}}const oC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nt extends ba{construct(e,n,r){return new Nt(e,n,r)}static isValidIdentifier(e){return oC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ue(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new ue(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ue(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new ue(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nt(n)}static emptyPath(){return new Nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.path=e}static fromPath(e){return new ge(nt.fromString(e))}static fromName(e){return new ge(nt.fromString(e).popFirst(5))}static empty(){return new ge(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return nt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new nt(e.slice()))}}function aC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ce.fromTimestamp(r===1e9?new Tt(n+1,0):new Tt(n,r));return new vi(i,ge.empty(),e)}function lC(t){return new vi(t.readTime,t.key,-1)}class vi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new vi(Ce.min(),ge.empty(),-1)}static max(){return new vi(Ce.max(),ge.empty(),-1)}}function uC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ge.comparator(t.documentKey,e.documentKey),n!==0?n:$e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ba(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==cC)throw t;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ie(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Y((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Y?n:Y.resolve(n)}catch(n){return Y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.reject(n)}static resolve(e){return new Y((n,r)=>{n(e)})}static reject(e){return new Y((n,r)=>{r(e)})}static waitFor(e){return new Y((n,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=Y.resolve(!1);for(const r of e)n=n.next(i=>i?Y.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new Y((r,i)=>{const s=e.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const d=c;n(e[d]).next(p=>{o[d]=p,++u,u===s&&r(o)},p=>i(p))}})}static doWhile(e,n){return new Y((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function hC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function za(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}op.oe=-1;function fc(t){return t==null}function ju(t){return t===0&&1/t==-1/0}function fC(t){return typeof t=="number"&&Number.isInteger(t)&&!ju(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function os(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ux(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){this.comparator=e,this.root=n||Ut.EMPTY}insert(e,n){return new ct(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(e){return new ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nl(this.root,e,this.comparator,!0)}}class Nl{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ut{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ut.RED,this.left=i??Ut.EMPTY,this.right=s??Ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ut(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ut.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ie();const e=this.left.check();if(e!==this.right.check())throw Ie();return e+(this.isRed()?0:1)}}Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1;Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie()}get value(){throw Ie()}get color(){throw Ie()}get left(){throw Ie()}get right(){throw Ie()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ut(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.comparator=e,this.data=new ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cy(this.data.getIterator())}getIteratorFrom(e){return new cy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof zt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new zt(this.comparator);return n.data=e,n}}class cy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.fields=e,e.sort(Nt.comparator)}static empty(){return new In([])}unionWith(e){let n=new zt(Nt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new In(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return eo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new cx("Invalid base64 string: "+s):s}}(e);return new Ot(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ot(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ot.EMPTY_BYTE_STRING=new Ot("");const pC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _i(t){if(Ge(!!t),typeof t=="string"){let e=0;const n=pC.exec(t);if(Ge(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gt(t.seconds),nanos:gt(t.nanos)}}function gt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ji(t){return typeof t=="string"?Ot.fromBase64String(t):Ot.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function lp(t){const e=t.mapValue.fields.__previous_value__;return ap(e)?lp(e):e}function Ca(t){const e=_i(t.mapValue.fields.__local_write_time__.timestampValue);return new Tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n,r,i,s,o,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}}class to{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new to("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof to&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dl={mapValue:{}};function Zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ap(t)?4:yC(t)?9007199254740991:mC(t)?10:11:Ie()}function cr(t,e){if(t===e)return!0;const n=Zi(t);if(n!==Zi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ca(t).isEqual(Ca(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=_i(i.timestampValue),u=_i(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ji(i.bytesValue).isEqual(Ji(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return gt(i.geoPointValue.latitude)===gt(s.geoPointValue.latitude)&&gt(i.geoPointValue.longitude)===gt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return gt(i.integerValue)===gt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=gt(i.doubleValue),u=gt(s.doubleValue);return o===u?ju(o)===ju(u):isNaN(o)&&isNaN(u)}return!1}(t,e);case 9:return eo(t.arrayValue.values||[],e.arrayValue.values||[],cr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(uy(o)!==uy(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!cr(o[c],u[c])))return!1;return!0}(t,e);default:return Ie()}}function Aa(t,e){return(t.values||[]).find(n=>cr(n,e))!==void 0}function no(t,e){if(t===e)return 0;const n=Zi(t),r=Zi(e);if(n!==r)return $e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $e(t.booleanValue,e.booleanValue);case 2:return function(s,o){const u=gt(s.integerValue||s.doubleValue),c=gt(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return dy(t.timestampValue,e.timestampValue);case 4:return dy(Ca(t),Ca(e));case 5:return $e(t.stringValue,e.stringValue);case 6:return function(s,o){const u=Ji(s),c=Ji(o);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let d=0;d<u.length&&d<c.length;d++){const p=$e(u[d],c[d]);if(p!==0)return p}return $e(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const u=$e(gt(s.latitude),gt(o.latitude));return u!==0?u:$e(gt(s.longitude),gt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return hy(t.arrayValue,e.arrayValue);case 10:return function(s,o){var u,c,d,p;const y=s.fields||{},v=o.fields||{},b=(u=y.value)===null||u===void 0?void 0:u.arrayValue,P=(c=v.value)===null||c===void 0?void 0:c.arrayValue,k=$e(((d=b==null?void 0:b.values)===null||d===void 0?void 0:d.length)||0,((p=P==null?void 0:P.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:hy(b,P)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Dl.mapValue&&o===Dl.mapValue)return 0;if(s===Dl.mapValue)return 1;if(o===Dl.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),d=o.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let y=0;y<c.length&&y<p.length;++y){const v=$e(c[y],p[y]);if(v!==0)return v;const b=no(u[c[y]],d[p[y]]);if(b!==0)return b}return $e(c.length,p.length)}(t.mapValue,e.mapValue);default:throw Ie()}}function dy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $e(t,e);const n=_i(t),r=_i(e),i=$e(n.seconds,r.seconds);return i!==0?i:$e(n.nanos,r.nanos)}function hy(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=no(n[i],r[i]);if(s)return s}return $e(n.length,r.length)}function ro(t){return Vh(t)}function Vh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=_i(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ji(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ge.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Vh(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Vh(n.fields[o])}`;return i+"}"}(t.mapValue):Ie()}function fy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Fh(t){return!!t&&"integerValue"in t}function up(t){return!!t&&"arrayValue"in t}function py(t){return!!t&&"nullValue"in t}function gy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xl(t){return!!t&&"mapValue"in t}function mC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ea(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return os(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ea(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ea(t.arrayValue.values[n]);return e}return Object.assign({},t)}function yC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.value=e}static empty(){return new gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Xl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ea(n)}setAll(e){let n=Nt.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=ea(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Xl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return cr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Xl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){os(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new gn(ea(this.value))}}function dx(t){const e=[];return os(t.fields,(n,r)=>{const i=new Nt([n]);if(Xl(r)){const s=dx(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new In(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,n,r,i,s,o,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new tn(e,0,Ce.min(),Ce.min(),Ce.min(),gn.empty(),0)}static newFoundDocument(e,n,r,i){return new tn(e,1,n,Ce.min(),r,i,0)}static newNoDocument(e,n){return new tn(e,2,n,Ce.min(),Ce.min(),gn.empty(),0)}static newUnknownDocument(e,n){return new tn(e,3,n,Ce.min(),Ce.min(),gn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n){this.position=e,this.inclusive=n}}function my(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ge.comparator(ge.fromName(o.referenceValue),n.key):r=no(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function yy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!cr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n="asc"){this.field=e,this.dir=n}}function vC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{}class St extends hx{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new xC(e,n,r):n==="array-contains"?new SC(e,r):n==="in"?new IC(e,r):n==="not-in"?new TC(e,r):n==="array-contains-any"?new bC(e,r):new St(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new wC(e,r):new EC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(no(n,this.value)):n!==null&&Zi(this.value)===Zi(n)&&this.matchesComparison(no(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qn extends hx{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Qn(e,n)}matches(e){return fx(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fx(t){return t.op==="and"}function px(t){return _C(t)&&fx(t)}function _C(t){for(const e of t.filters)if(e instanceof Qn)return!1;return!0}function Uh(t){if(t instanceof St)return t.field.canonicalString()+t.op.toString()+ro(t.value);if(px(t))return t.filters.map(e=>Uh(e)).join(",");{const e=t.filters.map(n=>Uh(n)).join(",");return`${t.op}(${e})`}}function gx(t,e){return t instanceof St?function(r,i){return i instanceof St&&r.op===i.op&&r.field.isEqual(i.field)&&cr(r.value,i.value)}(t,e):t instanceof Qn?function(r,i){return i instanceof Qn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&gx(o,i.filters[u]),!0):!1}(t,e):void Ie()}function mx(t){return t instanceof St?function(n){return`${n.field.canonicalString()} ${n.op} ${ro(n.value)}`}(t):t instanceof Qn?function(n){return n.op.toString()+" {"+n.getFilters().map(mx).join(" ,")+"}"}(t):"Filter"}class xC extends St{constructor(e,n,r){super(e,n,r),this.key=ge.fromName(r.referenceValue)}matches(e){const n=ge.comparator(e.key,this.key);return this.matchesComparison(n)}}class wC extends St{constructor(e,n){super(e,"in",n),this.keys=yx("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class EC extends St{constructor(e,n){super(e,"not-in",n),this.keys=yx("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function yx(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ge.fromName(r.referenceValue))}class SC extends St{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return up(n)&&Aa(n.arrayValue,this.value)}}class IC extends St{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Aa(this.value.arrayValue,n)}}class TC extends St{constructor(e,n){super(e,"not-in",n)}matches(e){if(Aa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Aa(this.value.arrayValue,n)}}class bC extends St{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!up(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Aa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}}function vy(t,e=null,n=[],r=[],i=null,s=null,o=null){return new CC(t,e,n,r,i,s,o)}function cp(t){const e=Ae(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Uh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),fc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ro(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ro(r)).join(",")),e.ue=n}return e.ue}function dp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!vC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!gx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yy(t.startAt,e.startAt)&&yy(t.endAt,e.endAt)}function Bh(t){return ge.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function AC(t,e,n,r,i,s,o,u){return new $a(t,e,n,r,i,s,o,u)}function pc(t){return new $a(t)}function _y(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function vx(t){return t.collectionGroup!==null}function ta(t){const e=Ae(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new zt(Nt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Du(s,r))}),n.has(Nt.keyField().canonicalString())||e.ce.push(new Du(Nt.keyField(),r))}return e.ce}function or(t){const e=Ae(t);return e.le||(e.le=RC(e,ta(t))),e.le}function RC(t,e){if(t.limitType==="F")return vy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Du(i.field,s)});const n=t.endAt?new Nu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nu(t.startAt.position,t.startAt.inclusive):null;return vy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function zh(t,e){const n=t.filters.concat([e]);return new $a(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function $h(t,e,n){return new $a(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gc(t,e){return dp(or(t),or(e))&&t.limitType===e.limitType}function _x(t){return`${cp(or(t))}|lt:${t.limitType}`}function vs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>mx(i)).join(", ")}]`),fc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ro(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ro(i)).join(",")),`Target(${r})`}(or(t))}; limitType=${t.limitType})`}function mc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ge.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ta(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,u,c){const d=my(o,u,c);return o.inclusive?d<=0:d<0}(r.startAt,ta(r),i)||r.endAt&&!function(o,u,c){const d=my(o,u,c);return o.inclusive?d>=0:d>0}(r.endAt,ta(r),i))}(t,e)}function kC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xx(t){return(e,n)=>{let r=!1;for(const i of ta(t)){const s=PC(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function PC(t,e,n){const r=t.field.isKeyField()?ge.comparator(e.key,n.key):function(s,o,u){const c=o.data.field(s),d=u.data.field(s);return c!==null&&d!==null?no(c,d):Ie()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ie()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){os(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return ux(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=new ct(ge.comparator);function Mr(){return jC}const wx=new ct(ge.comparator);function zo(...t){let e=wx;for(const n of t)e=e.insert(n.key,n);return e}function Ex(t){let e=wx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ui(){return na()}function Sx(){return na()}function na(){return new go(t=>t.toString(),(t,e)=>t.isEqual(e))}const NC=new ct(ge.comparator),DC=new zt(ge.comparator);function Me(...t){let e=DC;for(const n of t)e=e.add(n);return e}const OC=new zt($e);function LC(){return OC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ju(e)?"-0":e}}function Ix(t){return{integerValue:""+t}}function MC(t,e){return fC(e)?Ix(e):hp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(){this._=void 0}}function VC(t,e,n){return t instanceof Ou?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ap(s)&&(s=lp(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ra?bx(t,e):t instanceof ka?Cx(t,e):function(i,s){const o=Tx(i,s),u=xy(o)+xy(i.Pe);return Fh(o)&&Fh(i.Pe)?Ix(u):hp(i.serializer,u)}(t,e)}function FC(t,e,n){return t instanceof Ra?bx(t,e):t instanceof ka?Cx(t,e):n}function Tx(t,e){return t instanceof Lu?function(r){return Fh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ou extends yc{}class Ra extends yc{constructor(e){super(),this.elements=e}}function bx(t,e){const n=Ax(e);for(const r of t.elements)n.some(i=>cr(i,r))||n.push(r);return{arrayValue:{values:n}}}class ka extends yc{constructor(e){super(),this.elements=e}}function Cx(t,e){let n=Ax(e);for(const r of t.elements)n=n.filter(i=>!cr(i,r));return{arrayValue:{values:n}}}class Lu extends yc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function xy(t){return gt(t.integerValue||t.doubleValue)}function Ax(t){return up(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function UC(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ra&&i instanceof Ra||r instanceof ka&&i instanceof ka?eo(r.elements,i.elements,cr):r instanceof Lu&&i instanceof Lu?cr(r.Pe,i.Pe):r instanceof Ou&&i instanceof Ou}(t.transform,e.transform)}class BC{constructor(e,n){this.version=e,this.transformResults=n}}class Ln{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ln}static exists(e){return new Ln(void 0,e)}static updateTime(e){return new Ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vc{}function Rx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fp(t.key,Ln.none()):new Wa(t.key,t.data,Ln.none());{const n=t.data,r=gn.empty();let i=new zt(Nt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new bi(t.key,r,new In(i.toArray()),Ln.none())}}function zC(t,e,n){t instanceof Wa?function(i,s,o){const u=i.value.clone(),c=Ey(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):t instanceof bi?function(i,s,o){if(!Jl(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=Ey(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(kx(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ra(t,e,n,r){return t instanceof Wa?function(s,o,u,c){if(!Jl(s.precondition,o))return u;const d=s.value.clone(),p=Sy(s.fieldTransforms,c,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof bi?function(s,o,u,c){if(!Jl(s.precondition,o))return u;const d=Sy(s.fieldTransforms,c,o),p=o.data;return p.setAll(kx(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(s,o,u){return Jl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(t,e,n)}function $C(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Tx(r.transform,i||null);s!=null&&(n===null&&(n=gn.empty()),n.set(r.field,s))}return n||null}function wy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&eo(r,i,(s,o)=>UC(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wa extends vc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bi extends vc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function kx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ey(t,e,n){const r=new Map;Ge(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,FC(o,u,n[i]))}return r}function Sy(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,VC(s,o,e))}return r}class fp extends vc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class WC extends vc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&zC(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ra(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ra(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Sx();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=Rx(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Me())}isEqual(e){return this.batchId===e.batchId&&eo(this.mutations,e.mutations,(n,r)=>wy(n,r))&&eo(this.baseMutations,e.baseMutations,(n,r)=>wy(n,r))}}class pp{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ge(e.mutations.length===r.length);let i=function(){return NC}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new pp(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt,Fe;function GC(t){switch(t){default:return Ie();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function Px(t){if(t===void 0)return Lr("GRPC error has no .code"),K.UNKNOWN;switch(t){case xt.OK:return K.OK;case xt.CANCELLED:return K.CANCELLED;case xt.UNKNOWN:return K.UNKNOWN;case xt.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case xt.INTERNAL:return K.INTERNAL;case xt.UNAVAILABLE:return K.UNAVAILABLE;case xt.UNAUTHENTICATED:return K.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case xt.NOT_FOUND:return K.NOT_FOUND;case xt.ALREADY_EXISTS:return K.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return K.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case xt.ABORTED:return K.ABORTED;case xt.OUT_OF_RANGE:return K.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return K.UNIMPLEMENTED;case xt.DATA_LOSS:return K.DATA_LOSS;default:return Ie()}}(Fe=xt||(xt={}))[Fe.OK=0]="OK",Fe[Fe.CANCELLED=1]="CANCELLED",Fe[Fe.UNKNOWN=2]="UNKNOWN",Fe[Fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fe[Fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fe[Fe.NOT_FOUND=5]="NOT_FOUND",Fe[Fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fe[Fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fe[Fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fe[Fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fe[Fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fe[Fe.ABORTED=10]="ABORTED",Fe[Fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fe[Fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fe[Fe.INTERNAL=13]="INTERNAL",Fe[Fe.UNAVAILABLE=14]="UNAVAILABLE",Fe[Fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new $i([4294967295,4294967295],0);function Iy(t){const e=QC().encode(t),n=new tx;return n.update(e),new Uint8Array(n.digest())}function Ty(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $i([n,r],0),new $i([i,s],0)]}class gp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $o(`Invalid padding: ${n}`);if(r<0)throw new $o(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $o(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $o(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=$i.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply($i.fromNumber(r)));return i.compare(YC)===1&&(i=new $i([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Iy(e),[r,i]=Ty(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new gp(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;const n=Iy(e),[r,i]=Ty(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class $o extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,qa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new _c(Ce.min(),i,new ct($e),Mr(),Me())}}class qa{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new qa(r,n,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class jx{constructor(e,n){this.targetId=e,this.me=n}}class Nx{constructor(e,n,r=Ot.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class by{constructor(){this.fe=0,this.ge=Ay(),this.pe=Ot.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Me(),n=Me(),r=Me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ie()}}),new qa(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Ay()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class XC{constructor(e){this.Le=e,this.Be=new Map,this.ke=Mr(),this.qe=Cy(),this.Qe=new ct($e)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Ie()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Bh(s))if(r===0){const o=new ge(s.path);this.Ue(n,o,tn.newNoDocument(o,Ce.min()))}else Ge(r===1);else{const o=this.Ye(n);if(o!==r){const u=this.Ze(e),c=u?this.Xe(u,e,o):1;if(c!==0){this.je(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=Ji(r).toUint8Array()}catch(c){if(c instanceof cx)return Xi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new gp(o,i,s)}catch(c){return Xi(c instanceof $o?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const u=this.Je(o);if(u){if(s.current&&Bh(u.target)){const c=new ge(u.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,tn.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Me();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new _c(e,n,this.Qe,this.ke,r);return this.ke=Mr(),this.qe=Cy(),this.Qe=new ct($e),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new by,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new zt($e),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||he("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new by),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Cy(){return new ct(ge.comparator)}function Ay(){return new ct(ge.comparator)}const JC={asc:"ASCENDING",desc:"DESCENDING"},ZC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eA={and:"AND",or:"OR"};class tA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wh(t,e){return t.useProto3Json||fc(e)?e:{value:e}}function Mu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function nA(t,e){return Mu(t,e.toTimestamp())}function ar(t){return Ge(!!t),Ce.fromTimestamp(function(n){const r=_i(n);return new Tt(r.seconds,r.nanos)}(t))}function mp(t,e){return qh(t,e).canonicalString()}function qh(t,e){const n=function(i){return new nt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Ox(t){const e=nt.fromString(t);return Ge(Ux(e)),e}function Hh(t,e){return mp(t.databaseId,e.path)}function bd(t,e){const n=Ox(e);if(n.get(1)!==t.databaseId.projectId)throw new ue(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ue(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ge(Mx(n))}function Lx(t,e){return mp(t.databaseId,e)}function rA(t){const e=Ox(t);return e.length===4?nt.emptyPath():Mx(e)}function Kh(t){return new nt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Mx(t){return Ge(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ry(t,e,n){return{name:Hh(t,e),fields:n.value.mapValue.fields}}function iA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ie()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Ge(p===void 0||typeof p=="string"),Ot.fromBase64String(p||"")):(Ge(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ot.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(d){const p=d.code===void 0?K.UNKNOWN:Px(d.code);return new ue(p,d.message||"")}(o);n=new Nx(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=bd(t,r.document.name),s=ar(r.document.updateTime),o=r.document.createTime?ar(r.document.createTime):Ce.min(),u=new gn({mapValue:{fields:r.document.fields}}),c=tn.newFoundDocument(i,s,o,u),d=r.targetIds||[],p=r.removedTargetIds||[];n=new Zl(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=bd(t,r.document),s=r.readTime?ar(r.readTime):Ce.min(),o=tn.newNoDocument(i,s),u=r.removedTargetIds||[];n=new Zl([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=bd(t,r.document),s=r.removedTargetIds||[];n=new Zl([],s,i,null)}else{if(!("filter"in e))return Ie();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new KC(i,s),u=r.targetId;n=new jx(u,o)}}return n}function sA(t,e){let n;if(e instanceof Wa)n={update:Ry(t,e.key,e.value)};else if(e instanceof fp)n={delete:Hh(t,e.key)};else if(e instanceof bi)n={update:Ry(t,e.key,e.data),updateMask:pA(e.fieldMask)};else{if(!(e instanceof WC))return Ie();n={verify:Hh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Ou)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ra)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ka)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Lu)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw Ie()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:nA(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ie()}(t,e.precondition)),n}function oA(t,e){return t&&t.length>0?(Ge(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ar(i.updateTime):ar(s);return o.isEqual(Ce.min())&&(o=ar(s)),new BC(o,i.transformResults||[])}(n,e))):[]}function aA(t,e){return{documents:[Lx(t,e.path)]}}function lA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Lx(t,i);const s=function(d){if(d.length!==0)return Fx(Qn.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(p=>function(v){return{field:_s(v.field),direction:dA(v.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const u=Wh(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:i}}function uA(t){let e=rA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ge(r===1);const p=n.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(y){const v=Vx(y);return v instanceof Qn&&px(v)?v.getFilters():[v]}(n.where));let o=[];n.orderBy&&(o=function(y){return y.map(v=>function(P){return new Du(xs(P.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(v))}(n.orderBy));let u=null;n.limit&&(u=function(y){let v;return v=typeof y=="object"?y.value:y,fc(v)?null:v}(n.limit));let c=null;n.startAt&&(c=function(y){const v=!!y.before,b=y.values||[];return new Nu(b,v)}(n.startAt));let d=null;return n.endAt&&(d=function(y){const v=!y.before,b=y.values||[];return new Nu(b,v)}(n.endAt)),AC(e,i,o,s,u,"F",c,d)}function cA(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Vx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xs(n.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xs(n.unaryFilter.field);return St.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xs(n.unaryFilter.field);return St.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xs(n.unaryFilter.field);return St.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ie()}}(t):t.fieldFilter!==void 0?function(n){return St.create(xs(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ie()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Qn.create(n.compositeFilter.filters.map(r=>Vx(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ie()}}(n.compositeFilter.op))}(t):Ie()}function dA(t){return JC[t]}function hA(t){return ZC[t]}function fA(t){return eA[t]}function _s(t){return{fieldPath:t.canonicalString()}}function xs(t){return Nt.fromServerFormat(t.fieldPath)}function Fx(t){return t instanceof St?function(n){if(n.op==="=="){if(gy(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NAN"}};if(py(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gy(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NOT_NAN"}};if(py(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_s(n.field),op:hA(n.op),value:n.value}}}(t):t instanceof Qn?function(n){const r=n.getFilters().map(i=>Fx(i));return r.length===1?r[0]:{compositeFilter:{op:fA(n.op),filters:r}}}(t):Ie()}function pA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ux(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,n,r,i,s=Ce.min(),o=Ce.min(),u=Ot.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e){this.ct=e}}function mA(t){const e=uA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?$h(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this.un=new vA}addToCollectionParentIndex(e,n){return this.un.add(n),Y.resolve()}getCollectionParents(e,n){return Y.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Y.resolve()}deleteFieldIndex(e,n){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,n){return Y.resolve()}getDocumentsMatchingTarget(e,n){return Y.resolve(null)}getIndexType(e,n){return Y.resolve(0)}getFieldIndexes(e,n){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,n){return Y.resolve(vi.min())}getMinOffsetFromCollectionGroup(e,n){return Y.resolve(vi.min())}updateCollectionGroup(e,n,r){return Y.resolve()}updateIndexEntries(e,n){return Y.resolve()}}class vA{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new zt(nt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new zt(nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new io(0)}static kn(){return new io(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(){this.changes=new go(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&ra(r.mutation,i,In.empty(),Tt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Me()){const i=Ui();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=zo();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ui();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Me()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(e,n,r,i){let s=Mr();const o=na(),u=function(){return na()}();return n.forEach((c,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof bi)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),ra(p.mutation,d,p.mutation.getFieldMask(),Tt.now())):o.set(d.key,In.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>o.set(d,p)),n.forEach((d,p)=>{var y;return u.set(d,new xA(p,(y=o.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,n){const r=na();let i=new ct((o,u)=>o-u),s=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let p=r.get(c)||In.empty();p=u.applyToLocalView(d,p),r.set(c,p);const y=(i.get(u.batchId)||Me()).add(c);i=i.insert(u.batchId,y)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),d=c.key,p=c.value,y=Sx();p.forEach(v=>{if(!s.has(v)){const b=Rx(n.get(v),r.get(v));b!==null&&y.set(v,b),s=s.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,y))}return Y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ge.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):vx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):Y.resolve(Ui());let u=-1,c=s;return o.next(d=>Y.forEach(d,(p,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),s.get(p)?Y.resolve():this.remoteDocumentCache.getEntry(e,p).next(v=>{c=c.insert(p,v)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,Me())).next(p=>({batchId:u,changes:Ex(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ge(n)).next(r=>{let i=zo();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=zo();return this.indexManager.getCollectionParents(e,s).next(u=>Y.forEach(u,c=>{const d=function(y,v){return new $a(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((y,v)=>{o=o.insert(y,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,tn.newInvalidDocument(p)))});let u=zo();return o.forEach((c,d)=>{const p=s.get(c);p!==void 0&&ra(p.mutation,d,In.empty(),Tt.now()),mc(n,d)&&(u=u.insert(c,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Y.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ar(i.createTime)}}(n)),Y.resolve()}getNamedQuery(e,n){return Y.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:mA(i.bundledQuery),readTime:ar(i.readTime)}}(n)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.overlays=new ct(ge.comparator),this.Ir=new Map}getOverlay(e,n){return Y.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ui();return Y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),Y.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),Y.resolve()}getOverlaysForCollection(e,n,r){const i=Ui(),s=n.length+1,o=new ge(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return Y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ct((d,p)=>d-p);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Ui(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=Ui(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return Y.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new HC(n,r));let s=this.Ir.get(n);s===void 0&&(s=Me(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(){this.Tr=new zt(Pt.Er),this.dr=new zt(Pt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Pt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Pt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ge(new nt([])),r=new Pt(n,e),i=new Pt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ge(new nt([])),r=new Pt(n,e),i=new Pt(n,e+1);let s=Me();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Pt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Pt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ge.comparator(e.key,n.key)||$e(e.wr,n.wr)}static Ar(e,n){return $e(e.wr,n.wr)||ge.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new zt(Pt.Er)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qC(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.br=this.br.add(new Pt(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,n){return Y.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return Y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Pt(n,0),i=new Pt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const u=this.Dr(o.wr);s.push(u)}),Y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new zt($e);return n.forEach(i=>{const s=new Pt(i,0),o=new Pt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],u=>{r=r.add(u.wr)})}),Y.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ge.isDocumentKey(s)||(s=s.child(""));const o=new Pt(new ge(s),0);let u=new zt($e);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},o),Y.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ge(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Y.forEach(n.mutations,i=>{const s=new Pt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Pt(n,0),i=this.br.firstAfterOrEqual(r);return Y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e){this.Mr=e,this.docs=function(){return new ct(ge.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Y.resolve(r?r.document.mutableCopy():tn.newInvalidDocument(n))}getEntries(e,n){let r=Mr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():tn.newInvalidDocument(i))}),Y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Mr();const o=n.path,u=new ge(o.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:d,value:{document:p}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||uC(lC(p),r)<=0||(i.has(p.key)||mc(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return Y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ie()}Or(e,n){return Y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new CA(this)}getSize(e){return Y.resolve(this.size)}}class CA extends _A{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),Y.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.persistence=e,this.Nr=new go(n=>cp(n),dp),this.lastRemoteSnapshotVersion=Ce.min(),this.highestTargetId=0,this.Lr=0,this.Br=new yp,this.targetCount=0,this.kr=io.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Y.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new io(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Y.resolve()}updateTargetData(e,n){return this.Kn(n),Y.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),Y.waitFor(s).next(()=>i)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Y.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Y.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),Y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Y.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Y.resolve(r)}containsKey(e,n){return Y.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,n){this.qr={},this.overlays={},this.Qr=new op(0),this.Kr=!1,this.Kr=!0,this.$r=new IA,this.referenceDelegate=e(this),this.Ur=new AA(this),this.indexManager=new yA,this.remoteDocumentCache=function(i){return new bA(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new gA(n),this.Gr=new EA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new SA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new TA(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){he("MemoryPersistence","Starting transaction:",e);const i=new kA(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return Y.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class kA extends dC{constructor(e){super(),this.currentSequenceNumber=e}}class vp{constructor(e){this.persistence=e,this.Jr=new yp,this.Yr=null}static Zr(e){return new vp(e)}get Xr(){if(this.Yr)return this.Yr;throw Ie()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Y.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Y.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Y.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.Xr,r=>{const i=ge.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ce.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Y.or([()=>Y.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Me(),i=Me();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new _p(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return DT()?8:hC(rn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new PA;return this.Xi(e,n,o).next(u=>{if(s.result=u,this.zi)return this.es(e,n,o,u.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Do()<=Ve.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",vs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Y.resolve()):(Do()<=Ve.DEBUG&&he("QueryEngine","Query:",vs(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Do()<=Ve.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",vs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,or(n))):Y.resolve())}Yi(e,n){if(_y(n))return Y.resolve(null);let r=or(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=$h(n,null,"F"),r=or(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Me(...s);return this.Ji.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(n,u);return this.ns(n,d,o,c.readTime)?this.Yi(e,$h(n,null,"F")):this.rs(e,d,n,c)}))})))}Zi(e,n,r,i){return _y(n)||i.isEqual(Ce.min())?Y.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?Y.resolve(null):(Do()<=Ve.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),vs(n)),this.rs(e,o,n,aC(i,-1)).next(u=>u))})}ts(e,n){let r=new zt(xx(e));return n.forEach((i,s)=>{mc(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Do()<=Ve.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",vs(n)),this.Ji.getDocumentsMatchingQuery(e,n,vi.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new ct($e),this._s=new go(s=>cp(s),dp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function DA(t,e,n,r){return new NA(t,e,n,r)}async function Bx(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=Me();for(const d of i){o.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}for(const d of s){u.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:u}))})})}function OA(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,p){const y=d.batch,v=y.keys();let b=Y.resolve();return v.forEach(P=>{b=b.next(()=>p.getEntry(c,P)).next(k=>{const N=d.docVersions.get(P);Ge(N!==null),k.version.compareTo(N)<0&&(y.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),p.addEntry(k)))})}),b.next(()=>u.mutationQueue.removeMutationBatch(c,y))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=Me();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function zx(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function LA(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((p,y)=>{const v=i.get(y);if(!v)return;u.push(n.Ur.removeMatchingKeys(s,p.removedDocuments,y).next(()=>n.Ur.addMatchingKeys(s,p.addedDocuments,y)));let b=v.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?b=b.withResumeToken(Ot.EMPTY_BYTE_STRING,Ce.min()).withLastLimboFreeSnapshotVersion(Ce.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,r)),i=i.insert(y,b),function(k,N,C){return k.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(v,b,p)&&u.push(n.Ur.updateTargetData(s,b))});let c=Mr(),d=Me();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(MA(s,o,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(Ce.min())){const p=n.Ur.getLastRemoteSnapshotVersion(s).next(y=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return Y.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(n.os=i,s))}function MA(t,e,n){let r=Me(),i=Me();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Mr();return n.forEach((u,c)=>{const d=s.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Ce.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):he("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function VA(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function FA(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,Y.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new ri(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Gh(t,e,n){const r=Ae(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!za(o))throw o;he("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function ky(t,e,n){const r=Ae(t);let i=Ce.min(),s=Me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,p){const y=Ae(c),v=y._s.get(p);return v!==void 0?Y.resolve(y.os.get(v)):y.Ur.getTargetData(d,p)}(r,o,or(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:Ce.min(),n?s:Me())).next(u=>(UA(r,kC(e),u),{documents:u,Ts:s})))}function UA(t,e,n){let r=t.us.get(e)||Ce.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Py{constructor(){this.activeTargetIds=LC()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BA{constructor(){this.so=new Py,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Py,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){he("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){he("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ol=null;function Cd(){return Ol===null?Ol=function(){return 268435456+Math.round(2147483648*Math.random())}():Ol++,"0x"+Ol.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class qA extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const u=Cd(),c=this.xo(n,r.toUriEncodedString());he("RestConnection",`Sending RPC '${n}' ${u}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,o),this.No(n,c,d,i).then(p=>(he("RestConnection",`Received RPC '${n}' ${u}: `,p),p),p=>{throw Xi("RestConnection",`RPC '${n}' ${u} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(n,r,i,s,o,u){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+po}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=$A[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Cd();return new Promise((o,u)=>{const c=new nx;c.setWithCredentials(!0),c.listenOnce(rx.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Yl.NO_ERROR:const p=c.getResponseJson();he(Jt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case Yl.TIMEOUT:he(Jt,`RPC '${e}' ${s} timed out`),u(new ue(K.DEADLINE_EXCEEDED,"Request time out"));break;case Yl.HTTP_ERROR:const y=c.getStatus();if(he(Jt,`RPC '${e}' ${s} failed with status:`,y,"response text:",c.getResponseText()),y>0){let v=c.getResponseJson();Array.isArray(v)&&(v=v[0]);const b=v==null?void 0:v.error;if(b&&b.status&&b.message){const P=function(N){const C=N.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(C)>=0?C:K.UNKNOWN}(b.status);u(new ue(P,b.message))}else u(new ue(K.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new ue(K.UNAVAILABLE,"Connection failed."));break;default:Ie()}}finally{he(Jt,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);he(Jt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",d,r,15)})}Bo(e,n,r){const i=Cd(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ox(),u=sx(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=s.join("");he(Jt,`Creating RPC '${e}' stream ${i}: ${p}`,c);const y=o.createWebChannel(p,c);let v=!1,b=!1;const P=new WA({Io:N=>{b?he(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(v||(he(Jt,`Opening RPC '${e}' stream ${i} transport.`),y.open(),v=!0),he(Jt,`RPC '${e}' stream ${i} sending:`,N),y.send(N))},To:()=>y.close()}),k=(N,C,S)=>{N.listen(C,E=>{try{S(E)}catch(D){setTimeout(()=>{throw D},0)}})};return k(y,Bo.EventType.OPEN,()=>{b||(he(Jt,`RPC '${e}' stream ${i} transport opened.`),P.yo())}),k(y,Bo.EventType.CLOSE,()=>{b||(b=!0,he(Jt,`RPC '${e}' stream ${i} transport closed`),P.So())}),k(y,Bo.EventType.ERROR,N=>{b||(b=!0,Xi(Jt,`RPC '${e}' stream ${i} transport errored:`,N),P.So(new ue(K.UNAVAILABLE,"The operation could not be completed")))}),k(y,Bo.EventType.MESSAGE,N=>{var C;if(!b){const S=N.data[0];Ge(!!S);const E=S,D=E.error||((C=E[0])===null||C===void 0?void 0:C.error);if(D){he(Jt,`RPC '${e}' stream ${i} received error:`,D);const V=D.status;let L=function(m){const w=xt[m];if(w!==void 0)return Px(w)}(V),x=D.message;L===void 0&&(L=K.INTERNAL,x="Unknown error status: "+V+" with message "+D.message),b=!0,P.So(new ue(L,x)),y.close()}else he(Jt,`RPC '${e}' stream ${i} received:`,S),P.bo(S)}}),k(u,ix.STAT_EVENT,N=>{N.stat===Mh.PROXY?he(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Mh.NOPROXY&&he(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.wo()},0),P}}function Ad(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){return new tA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&he("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,r,i,s,o,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new $x(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ue(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return he("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(he("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class HA extends Wx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=iA(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ce.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ce.min():o.readTime?ar(o.readTime):Ce.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Kh(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=Bh(c)?{documents:aA(s,c)}:{query:lA(s,c)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=Dx(s,o.resumeToken);const d=Wh(s,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ce.min())>0){u.readTime=Mu(s,o.snapshotVersion.toTimestamp());const d=Wh(s,o.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const r=cA(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Kh(this.serializer),n.removeTarget=e,this.a_(n)}}class KA extends Wx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=oA(e.writeResults,e.commitTime),r=ar(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Kh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>sA(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ue(K.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,qh(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(K.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Lo(e,qh(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(K.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class QA{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Lr(n),this.D_=!1):he("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{as(this)&&(he("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=Ae(c);d.L_.add(4),await Ha(d),d.q_.set("Unknown"),d.L_.delete(4),await wc(d)}(this))})}),this.q_=new QA(r,i)}}async function wc(t){if(as(t))for(const e of t.B_)await e(!0)}async function Ha(t){for(const e of t.B_)await e(!1)}function qx(t,e){const n=Ae(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Sp(n)?Ep(n):mo(n).r_()&&wp(n,e))}function xp(t,e){const n=Ae(t),r=mo(n);n.N_.delete(e),r.r_()&&Hx(n,e),n.N_.size===0&&(r.r_()?r.o_():as(n)&&n.q_.set("Unknown"))}function wp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}mo(t).A_(e)}function Hx(t,e){t.Q_.xe(e),mo(t).R_(e)}function Ep(t){t.Q_=new XC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),mo(t).start(),t.q_.v_()}function Sp(t){return as(t)&&!mo(t).n_()&&t.N_.size>0}function as(t){return Ae(t).L_.size===0}function Kx(t){t.Q_=void 0}async function XA(t){t.q_.set("Online")}async function JA(t){t.N_.forEach((e,n)=>{wp(t,e)})}async function ZA(t,e){Kx(t),Sp(t)?(t.q_.M_(e),Ep(t)):t.q_.set("Unknown")}async function eR(t,e,n){if(t.q_.set("Online"),e instanceof Nx&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){he("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Vu(t,r)}else if(e instanceof Zl?t.Q_.Ke(e):e instanceof jx?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ce.min()))try{const r=await zx(t.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Q_.rt(o);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,d)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Ot.EMPTY_BYTE_STRING,p.snapshotVersion)),Hx(s,c);const y=new ri(p.target,c,d,p.sequenceNumber);wp(s,y)}),s.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){he("RemoteStore","Failed to raise snapshot:",r),await Vu(t,r)}}async function Vu(t,e,n){if(!za(e))throw e;t.L_.add(1),await Ha(t),t.q_.set("Offline"),n||(n=()=>zx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{he("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await wc(t)})}function Gx(t,e){return e().catch(n=>Vu(t,n,e))}async function Ec(t){const e=Ae(t),n=xi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;tR(e);)try{const i=await VA(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,nR(e,i)}catch(i){await Vu(e,i)}Qx(e)&&Yx(e)}function tR(t){return as(t)&&t.O_.length<10}function nR(t,e){t.O_.push(e);const n=xi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Qx(t){return as(t)&&!xi(t).n_()&&t.O_.length>0}function Yx(t){xi(t).start()}async function rR(t){xi(t).p_()}async function iR(t){const e=xi(t);for(const n of t.O_)e.m_(n.mutations)}async function sR(t,e,n){const r=t.O_.shift(),i=pp.from(r,e,n);await Gx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ec(t)}async function oR(t,e){e&&xi(t).V_&&await async function(r,i){if(function(o){return GC(o)&&o!==K.ABORTED}(i.code)){const s=r.O_.shift();xi(r).s_(),await Gx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ec(r)}}(t,e),Qx(t)&&Yx(t)}async function Ny(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),he("RemoteStore","RemoteStore received new credentials");const r=as(n);n.L_.add(3),await Ha(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await wc(n)}async function aR(t,e){const n=Ae(t);e?(n.L_.delete(2),await wc(n)):e||(n.L_.add(2),await Ha(n),n.q_.set("Unknown"))}function mo(t){return t.K_||(t.K_=function(n,r,i){const s=Ae(n);return s.w_(),new HA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:XA.bind(null,t),Ro:JA.bind(null,t),mo:ZA.bind(null,t),d_:eR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Sp(t)?Ep(t):t.q_.set("Unknown")):(await t.K_.stop(),Kx(t))})),t.K_}function xi(t){return t.U_||(t.U_=function(n,r,i){const s=Ae(n);return s.w_(),new KA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:rR.bind(null,t),mo:oR.bind(null,t),f_:iR.bind(null,t),g_:sR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Ec(t)):(await t.U_.stop(),t.O_.length>0&&(he("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,u=new Ip(e,n,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tp(t,e){if(Lr("AsyncQueue",`${e}: ${t}`),za(t))return new ue(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ge.comparator(n.key,r.key):(n,r)=>ge.comparator(n.key,r.key),this.keyedMap=zo(),this.sortedSet=new ct(this.comparator)}static emptySet(e){return new Bs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Bs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Bs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(){this.W_=new ct(ge.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Ie():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class so{constructor(e,n,r,i,s,o,u,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new so(e,n,Bs.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class uR{constructor(){this.queries=Oy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=Oy(),s.forEach((o,u)=>{for(const c of u.j_)c.onError(r)})})(this,new ue(K.ABORTED,"Firestore shutting down"))}}function Oy(){return new go(t=>_x(t),gc)}async function bp(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new lR,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=Tp(o,`Initialization of query '${vs(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Ap(n)}async function Cp(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function cR(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.j_)u.X_(i)&&(r=!0);o.z_=i}}r&&Ap(n)}function dR(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Ap(t){t.Y_.forEach(e=>{e.next()})}var Qh,Ly;(Ly=Qh||(Qh={})).ea="default",Ly.Cache="cache";class Rp{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new so(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=so.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Qh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e){this.key=e}}class Jx{constructor(e){this.key=e}}class hR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Me(),this.mutatedKeys=Me(),this.Aa=xx(e),this.Ra=new Bs(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Dy,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,y)=>{const v=i.get(p),b=mc(this.query,y)?y:null,P=!!v&&this.mutatedKeys.has(v.key),k=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let N=!1;v&&b?v.data.isEqual(b.data)?P!==k&&(r.track({type:3,doc:b}),N=!0):this.ga(v,b)||(r.track({type:2,doc:b}),N=!0,(c&&this.Aa(b,c)>0||d&&this.Aa(b,d)<0)&&(u=!0)):!v&&b?(r.track({type:0,doc:b}),N=!0):v&&!b&&(r.track({type:1,doc:v}),N=!0,(c||d)&&(u=!0)),N&&(b?(o=o.add(b),s=k?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:u,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,y)=>function(b,P){const k=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie()}};return k(b)-k(P)}(p.type,y.type)||this.Aa(p.doc,y.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new so(this.query,e.Ra,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Dy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Jx(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Xx(r))}),n}ba(e){this.Ta=e.Ts,this.da=Me();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return so.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class fR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class pR{constructor(e){this.key=e,this.va=!1}}class gR{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new go(u=>_x(u),gc),this.Ma=new Map,this.xa=new Set,this.Oa=new ct(ge.comparator),this.Na=new Map,this.La=new yp,this.Ba={},this.ka=new Map,this.qa=io.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function mR(t,e,n=!0){const r=iw(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Zx(r,e,n,!0),i}async function yR(t,e){const n=iw(t);await Zx(n,e,!0,!1)}async function Zx(t,e,n,r){const i=await FA(t.localStore,or(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await vR(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&qx(t.remoteStore,i),u}async function vR(t,e,n,r,i){t.Ka=(y,v,b)=>async function(k,N,C,S){let E=N.view.ma(C);E.ns&&(E=await ky(k.localStore,N.query,!1).then(({documents:x})=>N.view.ma(x,E)));const D=S&&S.targetChanges.get(N.targetId),V=S&&S.targetMismatches.get(N.targetId)!=null,L=N.view.applyChanges(E,k.isPrimaryClient,D,V);return Vy(k,N.targetId,L.wa),L.snapshot}(t,y,v,b);const s=await ky(t.localStore,e,!0),o=new hR(e,s.Ts),u=o.ma(s.documents),c=qa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(u,t.isPrimaryClient,c);Vy(t,n,d.wa);const p=new fR(e,n,o);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function _R(t,e,n){const r=Ae(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!gc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Gh(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&xp(r.remoteStore,i.targetId),Yh(r,i.targetId)}).catch(Ba)):(Yh(r,i.targetId),await Gh(r.localStore,i.targetId,!0))}async function xR(t,e){const n=Ae(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),xp(n.remoteStore,r.targetId))}async function wR(t,e,n){const r=AR(t);try{const i=await function(o,u){const c=Ae(o),d=Tt.now(),p=u.reduce((b,P)=>b.add(P.key),Me());let y,v;return c.persistence.runTransaction("Locally write mutations","readwrite",b=>{let P=Mr(),k=Me();return c.cs.getEntries(b,p).next(N=>{P=N,P.forEach((C,S)=>{S.isValidDocument()||(k=k.add(C))})}).next(()=>c.localDocuments.getOverlayedDocuments(b,P)).next(N=>{y=N;const C=[];for(const S of u){const E=$C(S,y.get(S.key).overlayedDocument);E!=null&&C.push(new bi(S.key,E,dx(E.value.mapValue),Ln.exists(!0)))}return c.mutationQueue.addMutationBatch(b,d,C,u)}).next(N=>{v=N;const C=N.applyToLocalDocumentSet(y,k);return c.documentOverlayCache.saveOverlays(b,N.batchId,C)})}).then(()=>({batchId:v.batchId,changes:Ex(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new ct($e)),d=d.insert(u,c),o.Ba[o.currentUser.toKey()]=d}(r,i.batchId,n),await Ka(r,i.changes),await Ec(r.remoteStore)}catch(i){const s=Tp(i,"Failed to persist write");n.reject(s)}}async function ew(t,e){const n=Ae(t);try{const r=await LA(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(Ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ge(o.va):i.removedDocuments.size>0&&(Ge(o.va),o.va=!1))}),await Ka(n,r,e)}catch(r){await Ba(r)}}function My(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const u=o.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=Ae(o);c.onlineState=u;let d=!1;c.queries.forEach((p,y)=>{for(const v of y.j_)v.Z_(u)&&(d=!0)}),d&&Ap(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ER(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new ct(ge.comparator);o=o.insert(s,tn.newNoDocument(s,Ce.min()));const u=Me().add(s),c=new _c(Ce.min(),new Map,new ct($e),o,u);await ew(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),kp(r)}else await Gh(r.localStore,e,!1).then(()=>Yh(r,e,n)).catch(Ba)}async function SR(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await OA(n.localStore,e);nw(n,r,null),tw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ka(n,i)}catch(i){await Ba(i)}}async function IR(t,e,n){const r=Ae(t);try{const i=await function(o,u){const c=Ae(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,u).next(y=>(Ge(y!==null),p=y.keys(),c.mutationQueue.removeMutationBatch(d,y))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);nw(r,e,n),tw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ka(r,i)}catch(i){await Ba(i)}}function tw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function nw(t,e,n){const r=Ae(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Yh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||rw(t,r)})}function rw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(xp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),kp(t))}function Vy(t,e,n){for(const r of n)r instanceof Xx?(t.La.addReference(r.key,e),TR(t,r)):r instanceof Jx?(he("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||rw(t,r.key)):Ie()}function TR(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(he("SyncEngine","New document in limbo: "+n),t.xa.add(r),kp(t))}function kp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ge(nt.fromString(e)),r=t.qa.next();t.Na.set(r,new pR(n)),t.Oa=t.Oa.insert(n,r),qx(t.remoteStore,new ri(or(pc(n.path)),r,"TargetPurposeLimboResolution",op.oe))}}async function Ka(t,e,n){const r=Ae(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{o.push(r.Ka(c,e,n).then(d=>{var p;if((d||n)&&r.isPrimaryClient){const y=d?!d.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,y?"current":"not-current")}if(d){i.push(d);const y=_p.Wi(c.targetId,d);s.push(y)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,d){const p=Ae(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>Y.forEach(d,v=>Y.forEach(v.$i,b=>p.persistence.referenceDelegate.addReference(y,v.targetId,b)).next(()=>Y.forEach(v.Ui,b=>p.persistence.referenceDelegate.removeReference(y,v.targetId,b)))))}catch(y){if(!za(y))throw y;he("LocalStore","Failed to update sequence numbers: "+y)}for(const y of d){const v=y.targetId;if(!y.fromCache){const b=p.os.get(v),P=b.snapshotVersion,k=b.withLastLimboFreeSnapshotVersion(P);p.os=p.os.insert(v,k)}}}(r.localStore,s))}async function bR(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){he("SyncEngine","User change. New user:",e.toKey());const r=await Bx(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(u=>{u.forEach(c=>{c.reject(new ue(K.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ka(n,r.hs)}}function CR(t,e){const n=Ae(t),r=n.Na.get(e);if(r&&r.va)return Me().add(r.key);{let i=Me();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const u=n.Fa.get(o);i=i.unionWith(u.view.Va)}return i}}function iw(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ew.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ER.bind(null,e),e.Ca.d_=cR.bind(null,e.eventManager),e.Ca.$a=dR.bind(null,e.eventManager),e}function AR(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IR.bind(null,e),e}class Fu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return DA(this.persistence,new jA,e.initialUser,this.serializer)}Ga(e){return new RA(vp.Zr,this.serializer)}Wa(e){return new BA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fu.provider={build:()=>new Fu};class Xh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>My(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bR.bind(null,this.syncEngine),await aR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uR}()}createDatastore(e){const n=xc(e.databaseInfo.databaseId),r=function(s){return new qA(s)}(e.databaseInfo);return function(s,o,u,c){return new GA(s,o,u,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,u){return new YA(r,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,n=>My(this.syncEngine,n,0),function(){return jy.D()?new jy:new zA}())}createSyncEngine(e,n){return function(i,s,o,u,c,d,p){const y=new gR(i,s,o,u,c,d);return p&&(y.Qa=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);he("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ha(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Xh.provider={build:()=>new Xh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Lr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Zt.UNAUTHENTICATED,this.clientId=sp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{he("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(he("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Tp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rd(t,e){t.asyncQueue.verifyOperationInProgress(),he("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Bx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Fy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await kR(t);he("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Ny(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Ny(e.remoteStore,i)),t._onlineComponents=e}async function kR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){he("FirestoreClient","Using user provided OfflineComponentProvider");try{await Rd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Xi("Error using user provided cache. Falling back to memory cache: "+n),await Rd(t,new Fu)}}else he("FirestoreClient","Using default OfflineComponentProvider"),await Rd(t,new Fu);return t._offlineComponents}async function sw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(he("FirestoreClient","Using user provided OnlineComponentProvider"),await Fy(t,t._uninitializedComponentsProvider._online)):(he("FirestoreClient","Using default OnlineComponentProvider"),await Fy(t,new Xh))),t._onlineComponents}function PR(t){return sw(t).then(e=>e.syncEngine)}async function Uu(t){const e=await sw(t),n=e.eventManager;return n.onListen=mR.bind(null,e.syncEngine),n.onUnlisten=_R.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=yR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=xR.bind(null,e.syncEngine),n}function jR(t,e,n={}){const r=new Ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,d){const p=new Pp({next:v=>{p.Za(),o.enqueueAndForget(()=>Cp(s,y));const b=v.docs.has(u);!b&&v.fromCache?d.reject(new ue(K.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&v.fromCache&&c&&c.source==="server"?d.reject(new ue(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),y=new Rp(pc(u.path),p,{includeMetadataChanges:!0,_a:!0});return bp(s,y)}(await Uu(t),t.asyncQueue,e,n,r)),r.promise}function NR(t,e,n={}){const r=new Ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,d){const p=new Pp({next:v=>{p.Za(),o.enqueueAndForget(()=>Cp(s,y)),v.fromCache&&c.source==="server"?d.reject(new ue(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),y=new Rp(u,p,{includeMetadataChanges:!0,_a:!0});return bp(s,y)}(await Uu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t,e,n){if(!n)throw new ue(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function lw(t,e,n,r){if(e===!0&&r===!0)throw new ue(K.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function By(t){if(!ge.isDocumentKey(t))throw new ue(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zy(t){if(ge.isDocumentKey(t))throw new ue(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Sc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ie()}function ln(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ue(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sc(t);throw new ue(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ue(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ow((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ic{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $y({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $y(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lx;switch(r.type){case"firstParty":return new nC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Uy.get(n);r&&(he("ComponentProvider","Removing Datastore"),Uy.delete(n),r.terminate())}(this),Promise.resolve()}}function uw(t,e,n,r={}){var i;const s=(t=ln(t,Ic))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Xi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=Zt.MOCK_USER;else{u=CT(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ue(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Zt(d)}t._authCredentials=new Zb(new ax(u,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ci(this.firestore,e,this._query)}}class $t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $t(this.firestore,e,this._key)}}class Rr extends Ci{constructor(e,n,r){super(e,n,pc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $t(this.firestore,null,new ge(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function we(t,e,...n){if(t=kt(t),aw("collection","path",e),t instanceof Ic){const r=nt.fromString(e,...n);return zy(r),new Rr(t,null,r)}{if(!(t instanceof $t||t instanceof Rr))throw new ue(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(nt.fromString(e,...n));return zy(r),new Rr(t.firestore,null,r)}}function fe(t,e,...n){if(t=kt(t),arguments.length===1&&(e=sp.newId()),aw("doc","path",e),t instanceof Ic){const r=nt.fromString(e,...n);return By(r),new $t(t,null,new ge(r))}{if(!(t instanceof $t||t instanceof Rr))throw new ue(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(nt.fromString(e,...n));return By(r),new $t(t.firestore,t instanceof Rr?t.converter:null,new ge(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new $x(this,"async_queue_retry"),this.Vu=()=>{const r=Ad();r&&he("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Ad();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Ad();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ar;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!za(e))throw e;he("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw Lr("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Ip.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ie()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function qy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class dr extends Ic{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Wy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Wy(e),this._firestoreClient=void 0,await e}}}function cw(t,e){const n=typeof t=="object"?t:J_(),r=typeof t=="string"?t:"(default)",i=rp(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=TT("firestore");s&&uw(i,...s)}return i}function Ga(t){if(t._terminated)throw new ue(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||DR(t),t._firestoreClient}function DR(t){var e,n,r;const i=t._freezeSettings(),s=function(u,c,d,p){return new gC(u,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,ow(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new RR(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this._byteString=e}static fromBase64String(e){try{return new es(Ot.fromBase64String(e))}catch(n){throw new ue(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new es(Ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ue(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ue(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ue(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR=/^__.*__$/;class LR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wa(e,this.data,n,this.fieldTransforms)}}class dw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new bi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function hw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie()}}class jp{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new jp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Bu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(hw(this.Cu)&&OR.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class MR{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||xc(e)}Qu(e,n,r,i=!1){return new jp({Cu:e,methodName:n,qu:r,path:Nt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ac(t){const e=t._freezeSettings(),n=xc(t._databaseId);return new MR(t._databaseId,!!e.ignoreUndefinedProperties,n)}function fw(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);Np("Data must be an object, but it was:",o,r);const u=pw(r,o);let c,d;if(s.merge)c=new In(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const y of s.mergeFields){const v=Jh(e,y,n);if(!o.contains(v))throw new ue(K.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);mw(p,v)||p.push(v)}c=new In(p),d=o.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,d=o.fieldTransforms;return new LR(new gn(u),c,d)}class Rc extends Tc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rc}}function VR(t,e,n,r){const i=t.Qu(1,e,n);Np("Data must be an object, but it was:",i,r);const s=[],o=gn.empty();os(r,(c,d)=>{const p=Dp(e,c,n);d=kt(d);const y=i.Nu(p);if(d instanceof Rc)s.push(p);else{const v=Ya(d,y);v!=null&&(s.push(p),o.set(p,v))}});const u=new In(s);return new dw(o,u,i.fieldTransforms)}function FR(t,e,n,r,i,s){const o=t.Qu(1,e,n),u=[Jh(e,r,n)],c=[i];if(s.length%2!=0)throw new ue(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<s.length;v+=2)u.push(Jh(e,s[v])),c.push(s[v+1]);const d=[],p=gn.empty();for(let v=u.length-1;v>=0;--v)if(!mw(d,u[v])){const b=u[v];let P=c[v];P=kt(P);const k=o.Nu(b);if(P instanceof Rc)d.push(b);else{const N=Ya(P,k);N!=null&&(d.push(b),p.set(b,N))}}const y=new In(d);return new dw(p,y,o.fieldTransforms)}function UR(t,e,n,r=!1){return Ya(n,t.Qu(r?4:3,e))}function Ya(t,e){if(gw(t=kt(t)))return Np("Unsupported field value:",e,t),pw(t,e);if(t instanceof Tc)return function(r,i){if(!hw(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=Ya(u,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=kt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return MC(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Tt.fromDate(r);return{timestampValue:Mu(i.serializer,s)}}if(r instanceof Tt){const s=new Tt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Mu(i.serializer,s)}}if(r instanceof bc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof es)return{bytesValue:Dx(i.serializer,r._byteString)};if(r instanceof $t){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:mp(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Cc)return function(o,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return hp(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Sc(r)}`)}(t,e)}function pw(t,e){const n={};return ux(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):os(t,(r,i)=>{const s=Ya(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function gw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof bc||t instanceof es||t instanceof $t||t instanceof Tc||t instanceof Cc)}function Np(t,e,n){if(!gw(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Sc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Jh(t,e,n){if((e=kt(e))instanceof Qa)return e._internalPath;if(typeof e=="string")return Dp(t,e);throw Bu("Field path arguments must be of type string or ",t,!1,void 0,n)}const BR=new RegExp("[~\\*/\\[\\]]");function Dp(t,e,n){if(e.search(BR)>=0)throw Bu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qa(...e.split("."))._internalPath}catch{throw Bu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Bu(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ue(K.INVALID_ARGUMENT,u+t+c)}function mw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Op("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class zR extends yw{data(){return super.data()}}function Op(t,e){return typeof e=="string"?Dp(t,e):e instanceof Qa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ue(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Lp{}class _w extends Lp{}function hr(t,e,...n){let r=[];e instanceof Lp&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof kc).length,u=s.filter(c=>c instanceof Xa).length;if(o>1||o>0&&u>0)throw new ue(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Xa extends _w{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Xa(e,n,r)}_apply(e){const n=this._parse(e);return xw(e._query,n),new Ci(e.firestore,e.converter,zh(e._query,n))}_parse(e){const n=Ac(e.firestore);return function(s,o,u,c,d,p,y){let v;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ue(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Ky(y,p);const b=[];for(const P of y)b.push(Hy(c,s,P));v={arrayValue:{values:b}}}else v=Hy(c,s,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Ky(y,p),v=UR(u,o,y,p==="in"||p==="not-in");return St.create(d,p,v)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Yn(t,e,n){const r=e,i=Op("where",t);return Xa._create(i,r,n)}class kc extends Lp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new kc(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Qn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)xw(o,c),o=zh(o,c)}(e._query,n),new Ci(e.firestore,e.converter,zh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Hy(t,e,n){if(typeof(n=kt(n))=="string"){if(n==="")throw new ue(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vx(e)&&n.indexOf("/")!==-1)throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(nt.fromString(n));if(!ge.isDocumentKey(r))throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fy(t,new ge(r))}if(n instanceof $t)return fy(t,n._key);throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sc(n)}.`)}function Ky(t,e){if(!Array.isArray(t)||t.length===0)throw new ue(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function xw(t,e){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ue(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class ww{convertValue(e,n="none"){switch(Zi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return os(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>gt(o.doubleValue));return new Cc(s)}convertGeoPoint(e){return new bc(gt(e.latitude),gt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=lp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ca(e));default:return null}}convertTimestamp(e){const n=_i(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=nt.fromString(e);Ge(Ux(r));const i=new to(r.get(1),r.get(3)),s=new ge(r.popFirst(5));return i.isEqual(n)||Lr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mp extends yw{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ia(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Op("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ia extends Mp{data(e={}){return super.data(e)}}class Vp{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ns(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ia(this._firestore,this._userDataWriter,r.key,r,new Ns(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ue(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new ia(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ns(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new ia(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ns(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:$R(u.type),doc:c,oldIndex:d,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function $R(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(t){t=ln(t,$t);const e=ln(t.firestore,dr);return jR(Ga(e),t._key).then(n=>Sw(e,t,n))}class Fp extends ww{constructor(e){super(),this.firestore=e}convertBytes(e){return new es(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new $t(this.firestore,null,n)}}function Rt(t){t=ln(t,Ci);const e=ln(t.firestore,dr),n=Ga(e),r=new Fp(e);return vw(t._query),NR(n,t._query).then(i=>new Vp(e,r,t,i))}function Cn(t,e,n){t=ln(t,$t);const r=ln(t.firestore,dr),i=Ew(t.converter,e,n);return Ja(r,[fw(Ac(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ln.none())])}function wt(t,e,n,...r){t=ln(t,$t);const i=ln(t.firestore,dr),s=Ac(i);let o;return o=typeof(e=kt(e))=="string"||e instanceof Qa?FR(s,"updateDoc",t._key,e,n,r):VR(s,"updateDoc",t._key,e),Ja(i,[o.toMutation(t._key,Ln.exists(!0))])}function Mn(t){return Ja(ln(t.firestore,dr),[new fp(t._key,Ln.none())])}function ts(t,e){const n=ln(t.firestore,dr),r=fe(t),i=Ew(t.converter,e);return Ja(n,[fw(Ac(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ln.exists(!1))]).then(()=>r)}function yt(t,...e){var n,r,i;t=kt(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||qy(e[o])||(s=e[o],o++);const u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(qy(e[o])){const y=e[o];e[o]=(n=y.next)===null||n===void 0?void 0:n.bind(y),e[o+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[o+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let c,d,p;if(t instanceof $t)d=ln(t.firestore,dr),p=pc(t._key.path),c={next:y=>{e[o]&&e[o](Sw(d,t,y))},error:e[o+1],complete:e[o+2]};else{const y=ln(t,Ci);d=ln(y.firestore,dr),p=y._query;const v=new Fp(d);c={next:b=>{e[o]&&e[o](new Vp(d,v,y,b))},error:e[o+1],complete:e[o+2]},vw(t._query)}return function(v,b,P,k){const N=new Pp(k),C=new Rp(b,N,P);return v.asyncQueue.enqueueAndForget(async()=>bp(await Uu(v),C)),()=>{N.Za(),v.asyncQueue.enqueueAndForget(async()=>Cp(await Uu(v),C))}}(Ga(d),p,u,c)}function Ja(t,e){return function(r,i){const s=new Ar;return r.asyncQueue.enqueueAndForget(async()=>wR(await PR(r),i,s)),s.promise}(Ga(t),e)}function Sw(t,e,n){const r=n.docs.get(e._key),i=new Fp(t);return new Mp(t,i,e._key,r,new Ns(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){po=i})(fo),Zs(new Qi("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new dr(new eC(r.getProvider("auth-internal")),new iC(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ue(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new to(d.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),gi(ly,"4.7.3",e),gi(ly,"4.7.3","esm2017")})();const Up=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:ww,Bytes:es,CollectionReference:Rr,DocumentReference:$t,DocumentSnapshot:Mp,FieldPath:Qa,FieldValue:Tc,Firestore:dr,FirestoreError:ue,GeoPoint:bc,Query:Ci,QueryCompositeFilterConstraint:kc,QueryConstraint:_w,QueryDocumentSnapshot:ia,QueryFieldFilterConstraint:Xa,QuerySnapshot:Vp,SnapshotMetadata:Ns,Timestamp:Tt,VectorValue:Cc,_AutoId:sp,_ByteString:Ot,_DatabaseId:to,_DocumentKey:ge,_EmptyAuthCredentialsProvider:lx,_FieldPath:Nt,_cast:ln,_logWarn:Xi,_validateIsNotUsedTogether:lw,addDoc:ts,collection:we,connectFirestoreEmulator:uw,deleteDoc:Mn,doc:fe,ensureFirestoreConfigured:Ga,executeWrite:Ja,getDoc:At,getDocs:Rt,getFirestore:cw,onSnapshot:yt,query:hr,setDoc:Cn,updateDoc:wt,where:Yn},Symbol.toStringTag,{value:"Module"}));function Bp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Iw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tw=Iw,bw=new Fa("auth","Firebase",Iw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zu=new tp("@firebase/auth");function WR(t,...e){zu.logLevel<=Ve.WARN&&zu.warn(`Auth (${fo}): ${t}`,...e)}function eu(t,...e){zu.logLevel<=Ve.ERROR&&zu.error(`Auth (${fo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(t,...e){throw zp(t,...e)}function lr(t,...e){return zp(t,...e)}function Cw(t,e,n){const r=Object.assign(Object.assign({},Tw()),{[e]:n});return new Fa("auth","Firebase",r).create(e,{appName:t.name})}function kr(t){return Cw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return bw.create(t,...e)}function Ee(t,e,...n){if(!t)throw zp(e,...n)}function Ir(t){const e="INTERNAL ASSERTION FAILED: "+t;throw eu(e),new Error(e)}function Vr(t,e){t||Ir(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function qR(){return Gy()==="http:"||Gy()==="https:"}function Gy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qR()||PT()||"connection"in navigator)?navigator.onLine:!0}function KR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,n){this.shortDelay=e,this.longDelay=n,Vr(n>e,"Short delay should be less than long delay!"),this.isMobile=AT()||jT()}get(){return HR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t,e){Vr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ir("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ir("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ir("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=new Za(3e4,6e4);function Ai(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ri(t,e,n,r,i={}){return Rw(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const u=Ua(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},s);return kT()||(d.referrerPolicy="no-referrer"),Aw.fetch()(kw(t,t.config.apiHost,n,u),d)})}async function Rw(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},GR),e);try{const i=new XR(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ll(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const u=s.ok?o.errorMessage:o.error.message,[c,d]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ll(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ll(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ll(t,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Cw(t,p,d);Xn(t,p)}}catch(i){if(i instanceof Ur)throw i;Xn(t,"network-request-failed",{message:String(i)})}}async function el(t,e,n,r,i={}){const s=await Ri(t,e,n,r,i);return"mfaPendingCredential"in s&&Xn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function kw(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?$p(t.config,i):`${t.config.apiScheme}://${i}`}function YR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XR{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(lr(this.auth,"network-request-failed")),QR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ll(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=lr(t,e,r);return i.customData._tokenResponse=n,i}function Qy(t){return t!==void 0&&t.enterprise!==void 0}class JR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return YR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function ZR(t,e){return Ri(t,"GET","/v2/recaptchaConfig",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ek(t,e){return Ri(t,"POST","/v1/accounts:delete",e)}async function Pw(t,e){return Ri(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jw(t,e=!1){const n=kt(t),r=await n.getIdToken(e),i=Wp(r);Ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:sa(kd(i.auth_time)),issuedAtTime:sa(kd(i.iat)),expirationTime:sa(kd(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function kd(t){return Number(t)*1e3}function Wp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return eu("JWT malformed, contained fewer than 3 sections"),null;try{const i=q_(n);return i?JSON.parse(i):(eu("Failed to decode base64 JWT payload"),null)}catch(i){return eu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Yy(t){const e=Wp(t);return Ee(e,"internal-error"),Ee(typeof e.exp<"u","internal-error"),Ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ur&&tk(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sa(this.lastLoginAt),this.creationTime=sa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $u(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Pa(t,Pw(n,{idToken:r}));Ee(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Dw(s.providerUserInfo):[],u=rk(t.providerData,o),c=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),p=c?d:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new ef(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(t,y)}async function Nw(t){const e=kt(t);await $u(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rk(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Dw(t){return t.map(e=>{var{providerId:n}=e,r=Bp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ik(t,e){const n=await Rw(t,{},async()=>{const r=Ua({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=kw(t,i,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Aw.fetch()(o,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sk(t,e){return Ri(t,"POST","/v2/accounts:revokeToken",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ee(e.idToken,"internal-error"),Ee(typeof e.idToken<"u","internal-error"),Ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ee(e.length!==0,"internal-error");const n=Yy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await ik(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new zs;return r&&(Ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ee(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ee(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zs,this.toJSON())}_performRefresh(){return Ir("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(t,e){Ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Tr{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Bp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ef(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Pa(this,this.stsTokenManager.getToken(this.auth,e));return Ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return jw(this,e)}reload(){return Nw(this)}_assign(e){this!==e&&(Ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Tr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await $u(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rr(this.auth.app))return Promise.reject(kr(this.auth));const e=await this.getIdToken();return await Pa(this,ek(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,u,c,d,p;const y=(r=n.displayName)!==null&&r!==void 0?r:void 0,v=(i=n.email)!==null&&i!==void 0?i:void 0,b=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,P=(o=n.photoURL)!==null&&o!==void 0?o:void 0,k=(u=n.tenantId)!==null&&u!==void 0?u:void 0,N=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,C=(d=n.createdAt)!==null&&d!==void 0?d:void 0,S=(p=n.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:E,emailVerified:D,isAnonymous:V,providerData:L,stsTokenManager:x}=n;Ee(E&&x,e,"internal-error");const f=zs.fromJSON(this.name,x);Ee(typeof E=="string",e,"internal-error"),Qr(y,e.name),Qr(v,e.name),Ee(typeof D=="boolean",e,"internal-error"),Ee(typeof V=="boolean",e,"internal-error"),Qr(b,e.name),Qr(P,e.name),Qr(k,e.name),Qr(N,e.name),Qr(C,e.name),Qr(S,e.name);const m=new Tr({uid:E,auth:e,email:v,emailVerified:D,displayName:y,isAnonymous:V,photoURL:P,phoneNumber:b,tenantId:k,stsTokenManager:f,createdAt:C,lastLoginAt:S});return L&&Array.isArray(L)&&(m.providerData=L.map(w=>Object.assign({},w))),N&&(m._redirectEventId=N),m}static async _fromIdTokenResponse(e,n,r=!1){const i=new zs;i.updateFromServerResponse(n);const s=new Tr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await $u(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ee(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Dw(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),u=new zs;u.updateFromIdToken(r);const c=new Tr({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ef(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;function br(t){Vr(t instanceof Function,"Expected a class definition");let e=Xy.get(t);return e?(Vr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Xy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Ow.type="NONE";const tf=Ow;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t,e,n){return`firebase:${t}:${e}:${n}`}class $s{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=tu(this.userKey,i.apiKey,s),this.fullPersistenceKey=tu("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Tr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new $s(br(tf),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||br(tf);const o=tu(r,e.config.apiKey,e.name);let u=null;for(const d of n)try{const p=await d._get(o);if(p){const y=Tr._fromJSON(e,p);d!==s&&(u=y),s=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new $s(s,e,r):(s=c[0],u&&await s._set(o,u.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new $s(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bw(e))return"Blackberry";if(zw(e))return"Webos";if(Mw(e))return"Safari";if((e.includes("chrome/")||Vw(e))&&!e.includes("edge/"))return"Chrome";if(Uw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Lw(t=rn()){return/firefox\//i.test(t)}function Mw(t=rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Vw(t=rn()){return/crios\//i.test(t)}function Fw(t=rn()){return/iemobile/i.test(t)}function Uw(t=rn()){return/android/i.test(t)}function Bw(t=rn()){return/blackberry/i.test(t)}function zw(t=rn()){return/webos/i.test(t)}function qp(t=rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ok(t=rn()){var e;return qp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ak(){return NT()&&document.documentMode===10}function $w(t=rn()){return qp(t)||Uw(t)||zw(t)||Bw(t)||/windows phone/i.test(t)||Fw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(t,e=[]){let n;switch(t){case"Browser":n=Jy(rn());break;case"Worker":n=`${Jy(rn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${fo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,u)=>{try{const c=e(s);o(c)}catch(c){u(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uk(t,e={}){return Ri(t,"GET","/v2/passwordPolicy",Ai(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=6;class dk{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:ck,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,u;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zy(this),this.idTokenSubscription=new Zy(this),this.beforeStateQueue=new lk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=br(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await $s.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Pw(this,{idToken:e}),r=await Tr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(rr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===u)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await $u(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=KR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rr(this.app))return Promise.reject(kr(this));const n=e?kt(e):null;return n&&Ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rr(this.app)?Promise.reject(kr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rr(this.app)?Promise.reject(kr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(br(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uk(this),n=new dk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&br(e)||this._popupRedirectResolver;Ee(n,this,"argument-error"),this.redirectPersistenceManager=await $s.create(this,[br(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ee(u,this,"internal-error"),u.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ww(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&WR(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ls(t){return kt(t)}class Zy{constructor(e){this.auth=e,this.observer=null,this.addObserver=BT(n=>this.observer=n)}get next(){return Ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fk(t){Pc=t}function qw(t){return Pc.loadJS(t)}function pk(){return Pc.recaptchaEnterpriseScript}function gk(){return Pc.gapiScript}function mk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const yk="recaptcha-enterprise",vk="NO_RECAPTCHA";class _k{constructor(e){this.type=yk,this.auth=ls(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,u)=>{ZR(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new JR(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{u(c)})})}function i(s,o,u){const c=window.grecaptcha;Qy(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(vk)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(u=>{if(!n&&Qy(window.grecaptcha))i(u,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=pk();c.length!==0&&(c+=u),qw(c).then(()=>{i(u,s,o)}).catch(d=>{o(d)})}}).catch(u=>{o(u)})})}}async function ev(t,e,n,r=!1){const i=new _k(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function nf(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ev(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ev(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t,e){const n=rp(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(ku(s,e??{}))return i;Xn(i,"already-initialized")}return n.initialize({options:e})}function xk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(br);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Kw(t,e,n){const r=ls(t);Ee(r._canInitEmulator,r,"emulator-config-failed"),Ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Gw(e),{host:o,port:u}=wk(e),c=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Ek()}function Gw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wk(t){const e=Gw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:tv(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:tv(o)}}}function tv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ek(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ir("not implemented")}_getIdTokenResponse(e){return Ir("not implemented")}_linkToIdToken(e,n){return Ir("not implemented")}_getReauthenticationResolver(e){return Ir("not implemented")}}async function Sk(t,e){return Ri(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ik(t,e){return el(t,"POST","/v1/accounts:signInWithPassword",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(t,e){return el(t,"POST","/v1/accounts:signInWithEmailLink",Ai(t,e))}async function bk(t,e){return el(t,"POST","/v1/accounts:signInWithEmailLink",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo extends jc{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new oo(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new oo(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nf(e,n,"signInWithPassword",Ik);case"emailLink":return Tk(e,{email:this._email,oobCode:this._password});default:Xn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nf(e,r,"signUpPassword",Sk);case"emailLink":return bk(e,{idToken:n,email:this._email,oobCode:this._password});default:Xn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ws(t,e){return el(t,"POST","/v1/accounts:signInWithIdp",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="http://localhost";class wi extends jc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Xn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Bp(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new wi(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ws(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ws(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ws(e,n)}buildRequest(){const e={requestUri:Ck,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ua(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Rk(t){const e=Fo(Uo(t)).link,n=e?Fo(Uo(e)).deep_link_id:null,r=Fo(Uo(t)).deep_link_id;return(r?Fo(Uo(r)).link:null)||r||n||e||t}class Nc{constructor(e){var n,r,i,s,o,u;const c=Fo(Uo(e)),d=(n=c.apiKey)!==null&&n!==void 0?n:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,y=Ak((i=c.mode)!==null&&i!==void 0?i:null);Ee(d&&p&&y,"argument-error"),this.apiKey=d,this.operation=y,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(u=c.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=Rk(e);try{return new Nc(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(){this.providerId=us.PROVIDER_ID}static credential(e,n){return oo._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Nc.parseLink(n);return Ee(r,"argument-error"),oo._fromEmailAndCode(e,r.code,r.tenantId)}}us.PROVIDER_ID="password";us.EMAIL_PASSWORD_SIGN_IN_METHOD="password";us.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl extends Qw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends tl{constructor(){super("facebook.com")}static credential(e){return wi._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vr.credential(e.oauthAccessToken)}catch{return null}}}vr.FACEBOOK_SIGN_IN_METHOD="facebook.com";vr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends tl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return wi._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return _r.credential(n,r)}catch{return null}}}_r.GOOGLE_SIGN_IN_METHOD="google.com";_r.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends tl{constructor(){super("github.com")}static credential(e){return wi._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xr.credential(e.oauthAccessToken)}catch{return null}}}xr.GITHUB_SIGN_IN_METHOD="github.com";xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends tl{constructor(){super("twitter.com")}static credential(e,n){return wi._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wr.credential(n,r)}catch{return null}}}wr.TWITTER_SIGN_IN_METHOD="twitter.com";wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kk(t,e){return el(t,"POST","/v1/accounts:signUp",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Tr._fromIdTokenResponse(e,r,i),o=nv(r);return new ns({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=nv(r);return new ns({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function nv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends Ur{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Wu.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Wu(e,n,r,i)}}function Yw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Wu._fromErrorAndOperation(t,s,e,r):s})}async function Pk(t,e,n=!1){const r=await Pa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ns._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk(t,e,n=!1){const{auth:r}=t;if(rr(r.app))return Promise.reject(kr(r));const i="reauthenticate";try{const s=await Pa(t,Yw(r,i,e,t),n);Ee(s.idToken,r,"internal-error");const o=Wp(s.idToken);Ee(o,r,"internal-error");const{sub:u}=o;return Ee(t.uid===u,r,"user-mismatch"),ns._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xw(t,e,n=!1){if(rr(t.app))return Promise.reject(kr(t));const r="signIn",i=await Yw(t,r,e),s=await ns._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Jw(t,e){return Xw(ls(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zw(t){const e=ls(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Wo(t,e,n){if(rr(t.app))return Promise.reject(kr(t));const r=ls(t),o=await nf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kk).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Zw(t),c}),u=await ns._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(u.user),u}function eE(t,e,n){return rr(t.app)?Promise.reject(kr(t)):Jw(kt(t),us.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zw(t),r})}function tE(t,e,n,r){return kt(t).onIdTokenChanged(e,n,r)}function nE(t,e,n){return kt(t).beforeAuthStateChanged(e,n)}function Un(t,e,n,r){return kt(t).onAuthStateChanged(e,n,r)}function rE(t){return kt(t).signOut()}const qu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(qu,"1"),this.storage.removeItem(qu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk=1e3,Dk=10;class sE extends iE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$w(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,u,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);ak()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Dk):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Nk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}sE.type="LOCAL";const oE=sE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE extends iE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}aE.type="SESSION";const Hp=aE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Dc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(o).map(async d=>d(n.origin,s)),c=await Ok(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((u,c)=>{const d=Kp("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(y){const v=y;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(v.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(){return window}function Mk(t){ur().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(){return typeof ur().WorkerGlobalScope<"u"&&typeof ur().importScripts=="function"}async function Vk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Fk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Uk(){return lE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="firebaseLocalStorageDb",Bk=1,Hu="firebaseLocalStorage",cE="fbase_key";class nl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Oc(t,e){return t.transaction([Hu],e?"readwrite":"readonly").objectStore(Hu)}function zk(){const t=indexedDB.deleteDatabase(uE);return new nl(t).toPromise()}function rf(){const t=indexedDB.open(uE,Bk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Hu,{keyPath:cE})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Hu)?e(r):(r.close(),await zk(),e(await rf()))})})}async function rv(t,e,n){const r=Oc(t,!0).put({[cE]:e,value:n});return new nl(r).toPromise()}async function $k(t,e){const n=Oc(t,!1).get(e),r=await new nl(n).toPromise();return r===void 0?null:r.value}function iv(t,e){const n=Oc(t,!0).delete(e);return new nl(n).toPromise()}const Wk=800,qk=3;class dE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>qk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dc._getInstance(Uk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Vk(),!this.activeServiceWorker)return;this.sender=new Lk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Fk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rf();return await rv(e,qu,"1"),await iv(e,qu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>rv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$k(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Oc(i,!1).getAll();return new nl(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dE.type="LOCAL";const hE=dE;new Za(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(t,e){return e?br(e):(Ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp extends jc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ws(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ws(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ws(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Kk(t){return Xw(t.auth,new Gp(t),t.bypassAuthState)}function Gk(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),jk(n,new Gp(t),t.bypassAuthState)}async function Qk(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),Pk(n,new Gp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:u}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Kk;case"linkViaPopup":case"linkViaRedirect":return Qk;case"reauthViaPopup":case"reauthViaRedirect":return Gk;default:Xn(this.auth,"internal-error")}}resolve(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=new Za(2e3,1e4);class Ds extends fE{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ds.currentPopupAction&&Ds.currentPopupAction.cancel(),Ds.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ee(e,this.auth,"internal-error"),e}async onExecution(){Vr(this.filter.length===1,"Popup operations only handle one event");const e=Kp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ds.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Yk.get())};e()}}Ds.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk="pendingRedirect",nu=new Map;class Jk extends fE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=nu.get(this.auth._key());if(!e){try{const r=await Zk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}nu.set(this.auth._key(),e)}return this.bypassAuthState||nu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Zk(t,e){const n=nP(e),r=tP(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function eP(t,e){nu.set(t._key(),e)}function tP(t){return br(t._redirectPersistence)}function nP(t){return tu(Xk,t.config.apiKey,t.name)}async function rP(t,e,n=!1){if(rr(t.app))return Promise.reject(kr(t));const r=ls(t),i=Hk(r,e),o=await new Jk(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=10*60*1e3;class sP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!pE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(lr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iP&&this.cachedEventUids.clear(),this.cachedEventUids.has(sv(e))}saveEventToCache(e){this.cachedEventUids.add(sv(e)),this.lastProcessedEventTime=Date.now()}}function sv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function pE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aP(t,e={}){return Ri(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uP=/^https?/;async function cP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await aP(t);for(const n of e)try{if(dP(n))return}catch{}Xn(t,"unauthorized-domain")}function dP(t){const e=Zh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!uP.test(n))return!1;if(lP.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=new Za(3e4,6e4);function ov(){const t=ur().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function fP(t){return new Promise((e,n)=>{var r,i,s;function o(){ov(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ov(),n(lr(t,"network-request-failed"))},timeout:hP.get()})}if(!((i=(r=ur().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ur().gapi)===null||s===void 0)&&s.load)o();else{const u=mk("iframefcb");return ur()[u]=()=>{gapi.load?o():n(lr(t,"network-request-failed"))},qw(`${gk()}?onload=${u}`).catch(c=>n(c))}}).catch(e=>{throw ru=null,e})}let ru=null;function pP(t){return ru=ru||fP(t),ru}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=new Za(5e3,15e3),mP="__/auth/iframe",yP="emulator/auth/iframe",vP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_P=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xP(t){const e=t.config;Ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?$p(e,yP):`https://${t.config.authDomain}/${mP}`,r={apiKey:e.apiKey,appName:t.name,v:fo},i=_P.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ua(r).slice(1)}`}async function wP(t){const e=await pP(t),n=ur().gapi;return Ee(n,t,"internal-error"),e.open({where:document.body,url:xP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vP,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=lr(t,"network-request-failed"),u=ur().setTimeout(()=>{s(o)},gP.get());function c(){ur().clearTimeout(u),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},SP=500,IP=600,TP="_blank",bP="http://localhost";class av{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CP(t,e,n,r=SP,i=IP){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const c=Object.assign(Object.assign({},EP),{width:r.toString(),height:i.toString(),top:s,left:o}),d=rn().toLowerCase();n&&(u=Vw(d)?TP:n),Lw(d)&&(e=e||bP,c.scrollbars="yes");const p=Object.entries(c).reduce((v,[b,P])=>`${v}${b}=${P},`,"");if(ok(d)&&u!=="_self")return AP(e||"",u),new av(null);const y=window.open(e||"",u,p);Ee(y,t,"popup-blocked");try{y.focus()}catch{}return new av(y)}function AP(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP="__/auth/handler",kP="emulator/auth/handler",PP=encodeURIComponent("fac");async function lv(t,e,n,r,i,s){Ee(t.config.authDomain,t,"auth-domain-config-required"),Ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:fo,eventId:i};if(e instanceof Qw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",UT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,y]of Object.entries({}))o[p]=y}if(e instanceof tl){const p=e.getScopes().filter(y=>y!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const c=await t._getAppCheckToken(),d=c?`#${PP}=${encodeURIComponent(c)}`:"";return`${jP(t)}?${Ua(u).slice(1)}${d}`}function jP({config:t}){return t.emulator?$p(t,kP):`https://${t.authDomain}/${RP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd="webStorageSupport";class NP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hp,this._completeRedirectFn=rP,this._overrideRedirectResult=eP}async _openPopup(e,n,r,i){var s;Vr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await lv(e,n,r,Zh(),i);return CP(e,o,Kp())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await lv(e,n,r,Zh(),i);return Mk(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Vr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await wP(e),r=new sP(e);return n.register("authEvent",i=>(Ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Pd,{type:Pd},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Pd];o!==void 0&&n(!!o),Xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return $w()||Mw()||qp()}}const gE=NP;var uv="@firebase/auth",cv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function LP(t){Zs(new Qi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=r.options;Ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ww(t)},d=new hk(r,i,s,c);return xk(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Zs(new Qi("auth-internal",e=>{const n=ls(e.getProvider("auth").getImmediate());return(r=>new DP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),gi(uv,cv,OP(t)),gi(uv,cv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=5*60,VP=G_("authIdTokenMaxAge")||MP;let dv=null;const FP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>VP)return;const i=n==null?void 0:n.token;dv!==i&&(dv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function un(t=J_()){const e=rp(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Hw(t,{popupRedirectResolver:gE,persistence:[hE,oE,Hp]}),r=G_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=FP(s.toString());nE(n,o,()=>o(n.currentUser)),tE(n,u=>o(u))}}const i=H_("auth");return i&&Kw(n,`http://${i}`),n}function UP(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}fk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=lr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",UP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LP("Browser");const mE=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Nc,AuthCredential:jc,EmailAuthCredential:oo,EmailAuthProvider:us,FacebookAuthProvider:vr,GithubAuthProvider:xr,GoogleAuthProvider:_r,OAuthCredential:wi,TwitterAuthProvider:wr,beforeAuthStateChanged:nE,browserLocalPersistence:oE,browserPopupRedirectResolver:gE,browserSessionPersistence:Hp,connectAuthEmulator:Kw,createUserWithEmailAndPassword:Wo,getAuth:un,getIdTokenResult:jw,inMemoryPersistence:tf,indexedDBLocalPersistence:hE,initializeAuth:Hw,onAuthStateChanged:Un,onIdTokenChanged:tE,prodErrorMap:Tw,reload:Nw,signInWithCredential:Jw,signInWithEmailAndPassword:eE,signOut:rE},Symbol.toStringTag,{value:"Module"})),BP={apiKey:"AIzaSyA2u0hxxVQufvInffw5PXhImFsmBRJ2YQQ",authDomain:"medcins.firebaseapp.com",projectId:"medcins",storageBucket:"medcins.firebasestorage.app",messagingSenderId:"474421452339",appId:"1:474421452339:web:22e693522ab3410bea0d46",measurementId:"G-V63YY2N057"},Lc=X_(BP),Q=cw(Lc);un(Lc);const zP=Object.freeze(Object.defineProperty({__proto__:null,app:Lc,db:Q},Symbol.toStringTag,{value:"Module"})),$P="modulepreload",WP=function(t){return"/medcins/"+t},hv={},qs=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=WP(c),c in hv)return;hv[c]=!0;const d=c.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const y=document.createElement("link");if(y.rel=d?"stylesheet":$P,d||(y.as="script"),y.crossOrigin="",y.href=c,u&&y.setAttribute("nonce",u),document.head.appendChild(y),d)return new Promise((v,b)=>{y.addEventListener("load",v),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})},ms=un(Lc),fv={companyName:"",phoneNumber:"",whatsappNumber:"",rcNumber:"",businessAddress:"",email:"",coverageArea:"",operatingHours:"",logoUrl:"",state:"",city:"",landmark:""};function qP(){const[t,e]=j.useState(""),[n,r]=j.useState(""),[i,s]=j.useState(null),[o,u]=j.useState(!1),[c,d]=j.useState(!1),[p,y]=j.useState(!1),[v,b]=j.useState(fv),[P,k]=j.useState(!1),[N,C]=j.useState(""),[S,E]=j.useState(""),[D,V]=j.useState(""),[L,x]=j.useState(""),[f,m]=j.useState(""),[w,A]=j.useState(""),[R,T]=j.useState(""),[ae,H]=j.useState(""),[te,ee]=j.useState(""),[M,F]=j.useState(""),[W,q]=j.useState(""),[G,O]=j.useState(""),[X,z]=j.useState(""),[ie,pe]=j.useState(""),[ne,Te]=j.useState(""),[De,_e]=j.useState(""),[be,We]=j.useState(null),[Pe,Re]=j.useState(!1),[ye,Je]=j.useState(null),[ve,ke]=j.useState(!1),[Ne,qt]=j.useState(""),[it,Lt]=j.useState(""),[Qe,vt]=j.useState(""),[xe,Oe]=j.useState(""),[Ye,Jn]=j.useState(""),[Ht,hn]=j.useState(""),qe=async()=>navigator.geolocation?(ke(!0),new Promise((U,se)=>{navigator.geolocation.getCurrentPosition(le=>{const Se={latitude:le.coords.latitude,longitude:le.coords.longitude};Je(Se),ke(!1),U(Se)},le=>{ke(!1),alert(" Location access denied or unavailable."),se(le)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})):(alert(" Geolocation is not supported by your browser."),null),fn=async()=>{try{if(!te||!M){alert("Please provide distributor name and license number.");return}const U=await qe();if(!U){alert(" Location required to complete distributor signup.");return}const le=(await Wo(ms,t,n)).user,Se=await He(te),ce={email:le.email,role:"distributor",businessName:te,licenseNumber:M,location:U,slug:Se,businessSlug:Se,createdAt:new Date().toISOString()};await Br(le.uid,ce),s({...le,...ce}),alert(` Distributor signup successful!
Your distributor link: medcins.com/store/${Se}`),d(!1),ee(""),F(""),Je(null)}catch(U){console.error("Distributor signup error:",U),alert(U.message||"Distributor signup failed")}},Zn=U=>U.toLowerCase().trim().replace(/[^a-z0-9]+/g,"").replace(/^-+|-+$/g,""),He=async U=>{let se=Zn(U);const le=we(Q,"users");let Se=se,ce=1;for(;;){const je=hr(le,Yn("slug","==",Se));if((await Rt(je)).empty)break;Se=`${se}${ce++}`}return Se},Br=async(U,se)=>{console.log("Writing user doc for:",U,se),await Cn(fe(Q,"users",U),se)},yo=async()=>{try{if(!it||!xe||!Ye){alert("Please provide address, state, and city.");return}const se=(await Wo(ms,t,n)).user,le={email:se.email,role:"customer",address:it,state:xe,city:Ye,landmark:Ht,createdAt:new Date().toISOString()};await Br(se.uid,le),s({...se,...le}),alert(" Customer signup successful!")}catch(U){console.error("Customer signup error:",U),alert(U.message)}},ki=async()=>navigator.geolocation?(Re(!0),new Promise((U,se)=>{navigator.geolocation.getCurrentPosition(le=>{const Se={latitude:le.coords.latitude,longitude:le.coords.longitude};We(Se),Re(!1),U(Se)},le=>{Re(!1),alert(" Location access denied or unavailable."),se(le)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})):(alert(" Geolocation is not supported by your browser."),null),zr=async()=>{try{if(!N||!w||!S){alert("Please provide business name, address, and license number.");return}const U=await ki();if(!U){alert(" Location required to complete business signup.");return}const le=(await Wo(ms,t,n)).user;console.log("Business user created:",le.uid);const Se=await He(N);console.log("Generated unique slug:",Se);const ce={email:le.email,role:"medicine-manager",businessName:N,address:S,city:L,state:D,landmark:f,licenseNumber:w,location:U,lat:U.latitude,lng:U.longitude,slug:Se,businessSlug:Se,businessPhone:R,businessWhatsapp:ae,createdAt:new Date().toISOString()};await Br(le.uid,ce),console.log("Firestore user record created for business:",ce),s({...le,...ce}),alert(` Business signup successful!
Your store link: medcins.com/store/${Se}`),u(!1),C(""),E(""),A(""),We(null)}catch(U){console.error("Business signup error:",U),alert(U.message||"Business signup failed")}},cs=async()=>{try{const se=(await eE(ms,t,n)).user,le=await At(fe(Q,"users",se.uid));le.exists()?(s({...se,...le.data()}),le.data().role==="delivery-agent"&&le.data().slug&&(window.location.href=`/agent/${le.data().slug}`)):(alert(" No Firestore user record found. Please contact admin."),s({...se}))}catch(U){console.error("Login error:",U),alert(U.message||"Login failed")}},kn=async()=>{await rE(ms),s(null)},$r=async()=>{try{k(!0);const U=["companyName","phoneNumber","whatsappNumber","rcNumber","businessAddress","email","coverageArea","operatingHours","logoUrl","state","city"];for(const _t of U)if(!v[_t]){alert(`Please fill the ${_t} field.`),k(!1);return}const le=(await Wo(ms,v.email,n)).user,Se=await He(v.companyName),ce={...v,role:"delivery-agent",slug:Se,createdAt:new Date().toISOString()};await Br(le.uid,ce);const je={companyName:v.companyName,phoneNumber:v.phoneNumber,whatsappNumber:v.whatsappNumber,rcNumber:v.rcNumber,businessAddress:v.businessAddress,email:v.email,coverageArea:v.coverageArea,operatingHours:v.operatingHours,logoUrl:v.logoUrl,state:v.state,city:v.city,landmark:v.landmark,userId:le.uid,createdAt:new Date().toISOString(),slug:Se},{addDoc:sn,collection:Pn}=await qs(async()=>{const{addDoc:_t,collection:dt}=await Promise.resolve().then(()=>Up);return{addDoc:_t,collection:dt}},void 0);await sn(Pn(Q,"deliveryAgents"),je),s({...le,...ce}),alert(" Delivery agent signup successful!"),y(!1),b(fv)}catch(U){console.error("Delivery agent signup error:",U),alert(U.message||"Delivery agent signup failed")}finally{k(!1)}},[Wr,Kt]=j.useState(!1),[_,J]=j.useState("customer"),oe=[{key:"customer",label:"Customer"},{key:"business",label:"Business"},{key:"distributor",label:"Distributor"},{key:"delivery-agent",label:"Delivery Agent"}];return a.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #f4f6fb 100%)",fontFamily:"Inter, Arial, sans-serif",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[a.jsx("h2",{style:{fontWeight:700,color:"#2d3748",marginBottom:24,letterSpacing:1,fontSize:32},children:" Welcome to Medcins"}),i&&a.jsx("button",{style:{position:"absolute",top:20,right:20,background:"#e53e3e",color:"#fff",border:"none",borderRadius:6,padding:"8px 18px",fontWeight:600,cursor:"pointer"},onClick:kn,children:"Logout"}),a.jsx("div",{style:{width:"100%",maxWidth:420,background:"#fff",borderRadius:18,boxShadow:"0 4px 32px #c7d2fe55",padding:36,marginTop:8},children:i?a.jsxs("div",{style:{textAlign:"center"},children:[a.jsxs("p",{style:{fontSize:22,fontWeight:700,color:"#2d3748",marginBottom:8},children:["Welcome, ",i.email," ",i.role?a.jsxs("span",{style:{color:"#6366f1"},children:["(",i.role.replace(/-/g," "),")"]}):""]}),i.role==="medicine-manager"&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{marginBottom:8},children:["Business: ",a.jsx("b",{children:i.businessName})]}),a.jsxs("p",{style:{fontSize:15},children:[" Store link: "," ",a.jsxs("a",{href:`/store/${i.businessSlug}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#6366f1",textDecoration:"underline"},children:["medcins.com/store/",i.businessSlug]})]})]}),i.role==="delivery-agent"&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{marginBottom:8},children:["Delivery Agent: ",a.jsx("b",{children:i.companyName})]}),a.jsxs("p",{style:{fontSize:15},children:["Email: ",i.email]})]})]}):a.jsx(a.Fragment,{children:Wr?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{marginBottom:18},children:a.jsx("select",{value:_,onChange:U=>J(U.target.value),style:{width:"100%",padding:"10px",borderRadius:8,border:"1px solid #cbd5e1",fontSize:16},children:oe.map(U=>a.jsx("option",{value:U.key,children:U.label},U.key))})}),_==="customer"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#2563eb",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Customer Signup"}),a.jsx("input",{type:"text",placeholder:"Full Name",value:Qe,onChange:U=>vt(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Phone Number",value:Ne,onChange:U=>qt(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Address",value:it,onChange:U=>Lt(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:xe,onChange:U=>Oe(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:Ye,onChange:U=>Jn(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:Ht,onChange:U=>hn(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:U=>e(U.target.value),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:U=>r(U.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:yo,style:{padding:"10px 0",background:"#2563eb",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:Pe,children:Pe?"Getting Location...":"Complete Customer Signup"}),a.jsx("button",{onClick:()=>Kt(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]}),be&&a.jsxs("p",{style:{fontSize:"12px",marginTop:"8px"},children:[" Location captured: ",be.latitude.toFixed(5),", ",be.longitude.toFixed(5)]})]}),_==="business"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#059669",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Business Signup"}),a.jsx("input",{type:"text",placeholder:"Business Name",value:N,onChange:U=>C(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Business Address",value:S,onChange:U=>E(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"License Number",value:w,onChange:U=>A(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:D,onChange:U=>V(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:L,onChange:U=>x(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:f,onChange:U=>m(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Phone Number",value:R,onChange:U=>T(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"WhatsApp Number",value:ae,onChange:U=>H(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:U=>e(U.target.value),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:U=>r(U.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:zr,style:{padding:"10px 0",background:"#059669",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:Pe,children:Pe?"Getting Location...":"Complete Business Signup"}),a.jsx("button",{onClick:()=>Kt(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]}),be&&a.jsxs("p",{style:{fontSize:"12px",marginTop:"8px"},children:[" Location captured: ",be.latitude.toFixed(5),", ",be.longitude.toFixed(5)]})]}),_==="distributor"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#d97706",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Distributor Signup"}),a.jsx("input",{type:"text",placeholder:"Distributor Name",value:te,onChange:U=>ee(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"License Number",value:M,onChange:U=>F(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:W,onChange:U=>q(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:G,onChange:U=>O(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:X,onChange:U=>z(U.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:U=>e(U.target.value),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:U=>r(U.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:fn,style:{padding:"10px 0",background:"#d97706",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:ve,children:ve?"Getting Location...":"Complete Distributor Signup"}),a.jsx("button",{onClick:()=>Kt(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]}),ye&&a.jsxs("p",{style:{fontSize:"12px",marginTop:"8px"},children:[" Location captured: ",ye.latitude.toFixed(5),", ",ye.longitude.toFixed(5)]})]}),_==="delivery-agent"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#059669",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Delivery Agent Signup"}),a.jsx("input",{type:"text",placeholder:"Company Name",value:v.companyName,onChange:U=>b(se=>({...se,companyName:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Phone Number",value:v.phoneNumber,onChange:U=>b(se=>({...se,phoneNumber:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"WhatsApp Phone Number",value:v.whatsappNumber,onChange:U=>b(se=>({...se,whatsappNumber:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"RC Number",value:v.rcNumber,onChange:U=>b(se=>({...se,rcNumber:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Business Address",value:v.businessAddress,onChange:U=>b(se=>({...se,businessAddress:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:v.state,onChange:U=>b(se=>({...se,state:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:v.city,onChange:U=>b(se=>({...se,city:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:v.landmark,onChange:U=>b(se=>({...se,landmark:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Coverage Area",value:v.coverageArea,onChange:U=>b(se=>({...se,coverageArea:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Operating Hours (e.g. 8am-6pm)",value:v.operatingHours,onChange:U=>b(se=>({...se,operatingHours:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Business Logo Link: Paste logo image URL here",value:v.logoUrl,onChange:U=>b(se=>({...se,logoUrl:U.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:v.email,onChange:U=>b(se=>({...se,email:U.target.value})),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:U=>r(U.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:$r,style:{padding:"10px 0",background:"#059669",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:P,children:P?"Signing Up...":"Complete Delivery Agent Signup"}),a.jsx("button",{onClick:()=>Kt(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#6366f1",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Login"}),a.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:U=>e(U.target.value),style:{margin:"10px 0",padding:"12px",borderRadius:8,border:"1px solid #cbd5e1",width:"100%",fontSize:16}}),a.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:U=>r(U.target.value),style:{margin:"10px 0",padding:"12px",borderRadius:8,border:"1px solid #cbd5e1",width:"100%",fontSize:16}}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:18},children:[a.jsx("button",{onClick:cs,style:{flex:1,background:"#6366f1",color:"#fff",border:"none",borderRadius:8,padding:"12px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Login"}),a.jsx("button",{onClick:()=>Kt(!0),style:{flex:1,background:"#2d3748",color:"#fff",border:"none",borderRadius:8,padding:"12px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Sign Up"})]})]})})})]})}function HP(){const[t,e]=j.useState(!1),{slug:n}=dc(),[r,i]=j.useState(null),[s,o]=j.useState([]),[u,c]=j.useState([]),[d,p]=j.useState(""),[y,v]=j.useState(null),[b,P]=j.useState(null),k=un(),N=(E,D,V,L)=>{const x=T=>T*Math.PI/180,m=x(V-E),w=x(L-D),A=Math.sin(m/2)**2+Math.cos(x(E))*Math.cos(x(V))*Math.sin(w/2)**2;return 6371*(2*Math.atan2(Math.sqrt(A),Math.sqrt(1-A)))},C=E=>{const L=E*1.64,x=Math.max(1,Math.round(L/25*60));return{drivingKm:L,minutes:x}};j.useEffect(()=>{if(!navigator.geolocation){P("denied");return}navigator.geolocation.getCurrentPosition(E=>{const D={lat:E.coords.latitude,lng:E.coords.longitude};P(D);const V=k.currentUser;if(V){const L=fe(Q,"users",V.uid);At(L).then(x=>{const f=x.data();f&&f.role==="customer"&&Cn(L,{lat:D.lat,lng:D.lng},{merge:!0})})}},()=>P("denied"))},[k]),j.useEffect(()=>{const E=Un(k,D=>{i(D)});return()=>E()},[k]),j.useEffect(()=>{const E=yt(we(Q,"products"),async D=>{const V=await Promise.all(D.docs.map(async L=>{var f,m;const x={id:L.id,...L.data()};if(x.ownerId){const w=fe(Q,"users",x.ownerId),A=await At(w);if(A.exists()){const R=A.data();x.businessName=R.businessName||"Unknown Pharmacy",x.ownerSlug=R.slug||null,x.ownerRole=R.role||null,(f=R.location)!=null&&f.latitude&&((m=R.location)!=null&&m.longitude)&&(x.businessLat=R.location.latitude,x.businessLng=R.location.longitude)}}return x}));o(V.filter(L=>L.ownerRole!=="distributor"))});return()=>E()},[]),j.useEffect(()=>{if(s.length===0)return;let E=n?s.filter(R=>R.ownerSlug===n):s;const D={};for(const R of E){const T=(R.normalizedName||R.name||"").toLowerCase().trim();D[T]||(D[T]=[]),D[T].push(R)}const V=Object.values(D).map(R=>(b&&b!=="denied"&&(R=R.map(T=>{if(T.businessLat&&T.businessLng){const ae=N(b.lat,b.lng,T.businessLat,T.businessLng),{minutes:H}=C(ae);return{...T,minutesAway:H}}return{...T,minutesAway:1/0}}),R.sort((T,ae)=>T.minutesAway-ae.minutesAway)),R)).flat(),L=(R="")=>R.toLowerCase().trim().replace(/\s+/g," "),x={pcm:"paracetamol",flagyl:"metronidazole",vit:"vitamin",ibucap:"ibuprofen",amox:"amoxicillin",diclo:"diclofenac",cipro:"ciprofloxacin",emzor:"paracetamol",fever:"paracetamol antipyretic",pain:"analgesic ibuprofen diclofenac paracetamol",headache:"paracetamol ibuprofen analgesic",infection:"antibiotic amoxicillin ciprofloxacin metronidazole",cough:"cough-suppressant expectorant syrup",cold:"decongestant antihistamine vitamin",flu:"antihistamine decongestant vitamin",malaria:"antimalarial artemether lumefantrine",stomach:"antacid omeprazole metronidazole",ulcer:"omeprazole antacid pantoprazole",diarrhea:"antidiarrheal loperamide",worm:"deworming mebendazole albendazole",allergy:"antihistamine loratadine cetirizine",inflammation:"anti-inflammatory ibuprofen diclofenac",hypertension:"antihypertensive amlodipine lisinopril",diabetes:"metformin insulin antidiabetic"},f=L(d),m=(x[f]||f).split(" "),w=(R,T)=>R.includes(T)||T.length>3&&R.startsWith(T.slice(0,3))||T.length>3&&R.endsWith(T.slice(-3)),A=V.filter(R=>{const T=L(R.name),ae=L(R.ingredient),H=L(R.class);return m.some(te=>T.includes(te)||ae.includes(te)||H.includes(te)||w(T,te)||w(ae,te)||w(H,te))});c(A)},[s,b,d,n]);const S=async E=>{if(!r)return alert("Please log in first");let D={...E};if((!D.businessPhone||!D.businessWhatsapp)&&D.ownerId)try{const m=fe(Q,"users",D.ownerId),w=await At(m);if(w.exists()){const A=w.data();D.businessPhone=A.businessPhone||"",D.businessWhatsapp=A.businessWhatsapp||""}}catch{}const V=fe(Q,"carts",r.uid),L=await At(V);let x=L.exists()?L.data().items||[]:[];const f=x.findIndex(m=>m.name===D.name);f>=0?x[f].quantity+=1:x.push({...D,quantity:1}),await Cn(V,{items:x}),v(E.id),e(!0),setTimeout(()=>e(!1),1800),setTimeout(()=>v(null),1e3)};return console.log("Visible medicines:",u.map(E=>E.businessName)),a.jsxs("div",{style:{padding:"30px",position:"relative"},children:[t&&a.jsxs("div",{style:{position:"fixed",top:"30px",right:"30px",background:"#7c3aed",color:"#fff",padding:"12px 24px",borderRadius:"10px",boxShadow:"0 2px 12px rgba(124,58,237,0.15)",fontWeight:"bold",fontSize:"16px",zIndex:2e3,opacity:.97,transition:"opacity 0.3s"},children:["Added to cart! ",a.jsx("a",{href:"/cart",style:{color:"#fff",textDecoration:"underline",marginLeft:10},children:"View Cart"})]}),a.jsxs("h2",{children:[" ",n?`${n}'s Pharmacy`:"Pharmacy Shop"]}),a.jsx("div",{style:{margin:"15px 0"},children:a.jsx("input",{type:"text",placeholder:"Search medicines, ingredients, or class...",value:d,onChange:E=>p(E.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc"}})}),u.length===0?a.jsx("p",{style:{color:"gray"},children:n?"No medicines found for this pharmacy. Please check the link or select a valid business.":"No medicines found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"20px"},children:u.map(E=>a.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"10px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.1)",position:"relative",minHeight:"220px"},children:[E.registeredOnly&&a.jsx("span",{style:{position:"absolute",top:"10px",left:"10px",background:"#7c3aed",color:"#fff",padding:"2px 10px",borderRadius:"8px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",letterSpacing:"1px"},children:"Registered Only"}),E.isPOM&&a.jsx("span",{style:{position:"absolute",top:E.registeredOnly?"38px":"10px",left:"10px",background:"#e53935",color:"#fff",padding:"2px 10px",borderRadius:"8px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",letterSpacing:"1px"},children:"POM"}),E.image&&a.jsx("img",{src:E.image,alt:E.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"10px"}}),a.jsx("strong",{children:E.name||"Unnamed Drug"}),a.jsx("p",{children:a.jsx("em",{children:E.ingredient||"No ingredient listed"})}),a.jsxs("p",{children:["Class: ",E.class||"No class listed"]}),a.jsxs("p",{children:["Price: ",E.price!==void 0?E.price:"N/A"]}),a.jsxs("p",{style:{fontSize:"0.9em",color:"#555"},children:[" ",E.ownerSlug?a.jsx("a",{href:`/store/${E.ownerSlug}`,style:{color:"#7c3aed",textDecoration:"underline",cursor:"pointer",fontWeight:500},children:E.businessName&&E.businessName.trim()?E.businessName:"Unknown Pharmacy"}):E.businessName&&E.businessName.trim()?E.businessName:"Unknown Pharmacy"]}),a.jsx("button",{onClick:()=>S(E),style:{marginTop:"10px"},disabled:typeof S!="function",children:"Add to Cart"}),E.minutesAway&&E.minutesAway!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500"},children:E.minutesAway<=1?" Right here":` ~${E.minutesAway} mins away`}),y===E.id&&a.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",background:"#4caf50",color:"#fff",padding:"3px 6px",borderRadius:"4px",fontSize:"12px"},children:"Added!"})]},E.id))})]})}function yE(){const[t,e]=j.useState(null),[n,r]=j.useState([]),[i,s]=j.useState(0),[o,u]=j.useState(!1),[c,d]=j.useState({}),[p,y]=j.useState([]),[v,b]=j.useState(null),P=un(),k=cc();j.useEffect(()=>{t&&At(fe(Q,"users",t.uid)).then(L=>{L.exists()&&b(L.data())})},[t]),j.useEffect(()=>{const L=Array.from(new Set(n.filter(x=>x.registeredOnly&&x.ownerId).map(x=>x.ownerId)));y(L),u(L.length>0)},[n]);const N=async L=>{L.preventDefault();for(const x of p)await Cn(fe(Q,"businessRegistrations",`${x}_${t.uid}`),{distributorId:x,businessId:t.uid,businessInfo:v,cart:n.filter(f=>f.ownerId===x),status:"pending",date:new Date().toISOString()});alert("Registration request(s) sent to distributor(s). Await approval before completing your order."),u(!1)};j.useEffect(()=>Un(P,x=>{e(x),x&&C(x.uid)}),[P]);const C=async L=>{try{const x=fe(Q,"carts",L),f=await At(x);f.exists()?r(f.data().items||[]):r([])}catch(x){console.error("Error loading cart:",x)}},S=async(L,x)=>{try{await Cn(fe(Q,"carts",L),{items:x})}catch(f){console.error("Error saving cart:",f)}};j.useEffect(()=>{const L=n.reduce((x,f)=>x+f.price*(f.quantity||1),0);s(L)},[n]);const E=L=>{if(!t)return alert("Please login first");const x=[...n],f=x.findIndex(m=>m.name===L.name);f>=0?x[f].quantity+=1:x.push({...L,quantity:1}),r(x),S(t.uid,x)},D=L=>{if(!t)return alert("Please login first");const x=[...n],f=x.findIndex(m=>m.name===L);f>=0&&(x[f].quantity>1?x[f].quantity-=1:x.splice(f,1)),r(x),S(t.uid,x)},V=()=>{if(!t)return alert("Please login to proceed to payment");if(n.length===0)return alert("Cart is empty");k("/payment",{state:{cart:n,total:i}})};return a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:" Your Cart"}),t?a.jsxs("p",{children:["Logged in as: ",t.email]}):a.jsx("p",{children:"Please log in."}),n.length===0?a.jsx("p",{children:"No items in cart."}):o?a.jsxs("form",{onSubmit:N,style:{background:"#f3f0ff",padding:24,borderRadius:10,margin:"20px 0"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Distributor Registration Required"}),a.jsx("p",{children:"Some items in your cart require registration with the distributor before purchase. Please confirm your business details below for each distributor."}),p.map((L,x)=>a.jsxs("div",{style:{marginBottom:24,padding:16,background:"#fff",borderRadius:8,boxShadow:"0 1px 4px #e0e0e0"},children:[a.jsxs("h4",{style:{color:"#7c3aed"},children:["Distributor ",x+1]}),a.jsxs("label",{children:["Business Name:",a.jsx("br",{}),a.jsx("input",{type:"text",value:(v==null?void 0:v.businessName)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsx("br",{}),a.jsxs("label",{children:["Email:",a.jsx("br",{}),a.jsx("input",{type:"email",value:(v==null?void 0:v.email)||(t==null?void 0:t.email)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsx("br",{}),a.jsxs("label",{children:["Phone:",a.jsx("br",{}),a.jsx("input",{type:"text",value:(v==null?void 0:v.phone)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsx("br",{}),a.jsxs("label",{children:["Address:",a.jsx("br",{}),a.jsx("input",{type:"text",value:(v==null?void 0:v.address)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsxs("p",{style:{fontSize:14,color:"#555"},children:["Products from this distributor: ",n.filter(f=>f.ownerId===L).map(f=>f.name).join(", ")]})]},L)),a.jsx("button",{type:"submit",style:{background:"#7c3aed",color:"#fff",padding:"10px 24px",borderRadius:6,fontWeight:"bold"},children:"Submit Registration"})]}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{style:{listStyle:"none",padding:0},children:n.map((L,x)=>a.jsxs("li",{style:{margin:"8px 0",display:"flex",alignItems:"center",gap:"10px"},children:[L.image&&a.jsx("img",{src:L.image,alt:L.name,style:{width:"50px",height:"50px",objectFit:"cover",borderRadius:"5px"}}),a.jsxs("div",{children:[a.jsx("strong",{children:L.name}),"  ",L.price," x ",L.quantity]}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>E(L),style:{marginLeft:"10px"},children:"+"}),a.jsx("button",{onClick:()=>D(L.name),style:{marginLeft:"5px"},children:"-"})]})]},x))}),n.some(L=>L.isPOM)&&a.jsxs("div",{style:{background:"#fff3e0",color:"#b85c00",borderRadius:"6px",padding:"10px 16px",margin:"18px 0 0 0",fontSize:"15px",boxShadow:"0 1px 4px #f5e0c3"},children:[a.jsx("span",{style:{fontWeight:500},children:"Note:"})," After payment, you will be redirected to a medical professional to verify your prescription."]})]}),a.jsxs("h3",{children:["Total: ",i]}),!o&&a.jsx("button",{onClick:V,style:{marginTop:"20px"},children:"Checkout"})]})}const KP=t=>{if(!t)return"Unknown date";const e=new Date,n=new Date(t),r=e-n,i=Math.floor(r/1e3);if(i<60)return`${i} seconds ago`;const s=Math.floor(i/60);if(s<60)return`${s} minutes ago`;const o=Math.floor(s/60);if(o<24)return`${o} hours ago`;const u=Math.floor(o/24);return u<7?`${u} day${u>1?"s":""} ago`:n.toLocaleString()};function GP(){const[t,e]=j.useState(null),[n,r]=j.useState([]),[i,s]=j.useState("Pending"),[o,u]=j.useState({}),c=un();if(j.useEffect(()=>{const P=Un(c,k=>{if(e(k),k){const N=hr(we(Q,"orders"),Yn("userId","==",k.uid)),C=yt(N,S=>{const E=S.docs.map(D=>({id:D.id,...D.data()}));E.sort((D,V)=>new Date(V.date)-new Date(D.date)),r(E)});return()=>C()}});return()=>P()},[c]),!t)return a.jsx("p",{children:"Please log in to view your orders."});const d=async P=>{if(!window.confirm("Are you sure you want to cancel this order?"))return;const N=fe(Q,"orders",P);await wt(N,{status:"Cancelled"}),alert(" Order cancelled and moved to Cancelled tab")},p=P=>{u(k=>({...k,[P]:!k[P]}))},y=P=>P.reduce((k,N)=>k+N.price*(N.quantity||1),0),v=["Pending","Processing","Completed","Cancelled"],b=v.reduce((P,k)=>(k==="Processing"?P[k]=n.filter(N=>{const C=N.status||"Pending";return C==="Processing"||C==="In-Progress"}):P[k]=n.filter(N=>(N.status||"Pending")===k),P),{});return a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:" Your Orders"}),a.jsx("div",{style:{display:"flex",gap:"20px",marginBottom:"20px"},children:v.map(P=>{var k;return a.jsxs("button",{onClick:()=>s(P),style:{padding:"10px 20px",cursor:"pointer",borderRadius:"5px",border:"none",background:i===P?"#007bff":"#eee",color:i===P?"#fff":"#000",fontWeight:i===P?"bold":"normal"},children:[P," (",((k=b[P])==null?void 0:k.length)||0,")"]},P)})}),b[i].length===0?a.jsxs("p",{children:["No ",i.toLowerCase()," orders."]}):b[i].map(P=>{var k;return a.jsxs("div",{style:{marginBottom:"32px",padding:"0",border:"none",borderRadius:"18px",background:"#fff",boxShadow:"0 4px 24px 0 rgba(124,58,237,0.08)",overflow:"hidden",maxWidth:600,marginLeft:"auto",marginRight:"auto",position:"relative"},children:[a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",background:"linear-gradient(90deg, #ede9fe 0%, #f4f6fb 100%)",padding:"20px 28px 12px 28px",borderBottom:"1px solid #e0e7ff",borderTopLeftRadius:18,borderTopRightRadius:18,minHeight:60},children:[a.jsxs("div",{style:{fontWeight:600,color:"#7c3aed",fontSize:17,letterSpacing:.2},children:[a.jsx("span",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:"Order Date:"})," ",KP(P.date)]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2,minWidth:220},children:[a.jsxs("div",{style:{fontSize:"0.97em",marginBottom:2},children:[a.jsx("strong",{style:{color:"#6366f1"},children:"Medicines provided by:"}),P.items&&P.items.length>0?a.jsx("ul",{style:{margin:"4px 0 0 18px",padding:0},children:Array.from(P.items.reduce((N,C)=>{const S=C.businessName||"Unknown",E=C.businessPhone||C.phoneNumber||"N/A",D=C.businessWhatsapp||C.whatsappNumber||"N/A";return N.set(S+"__"+E+"__"+D,{name:S,phone:E,whatsapp:D}),N},new Map).values()).map(({name:N,phone:C,whatsapp:S})=>a.jsxs("li",{style:{margin:0,padding:0,fontSize:15,color:"#222"},children:[N," (",C&&C!=="N/A"?a.jsxs("a",{href:`tel:${C}`,style:{color:"#007bff",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:C}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M3.654 1.328a.678.678 0 0 1 .58-.326h2.222c.27 0 .513.162.608.41l1.013 2.53a.678.678 0 0 1-.145.72l-1.013 1.013a11.42 11.42 0 0 0 4.292 4.292l1.013-1.013a.678.678 0 0 1 .72-.145l2.53 1.013a.678.678 0 0 1 .41.608v2.222a.678.678 0 0 1-.326.58l-2.222 1.333a2.034 2.034 0 0 1-2.03.06c-2.29-1.19-4.13-3.03-5.32-5.32a2.034 2.034 0 0 1 .06-2.03L3.654 1.328z",stroke:"#007bff",strokeWidth:"1.2",fill:"none"})})})]}):a.jsx("span",{children:"N/A"}),", ",S&&S!=="N/A"?a.jsxs("a",{href:`https://wa.me/${S.replace(/[^\d]/g,"")}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#25D366",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:S}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M16 3C9.373 3 4 8.373 4 15c0 2.385.832 4.584 2.236 6.393L4 29l7.828-2.236A11.96 11.96 0 0 0 16 27c6.627 0 12-5.373 12-12S22.627 3 16 3zm0 21.5c-1.77 0-3.45-.46-4.91-1.26l-.35-.2-4.65 1.33 1.33-4.65-.2-.35A8.97 8.97 0 0 1 7 15c0-4.963 4.037-9 9-9s9 4.037 9 9-4.037 9-9 9zm5.07-6.36c-.28-.14-1.65-.81-1.9-.9-.25-.09-.43-.14-.61.14-.18.28-.7.9-.86 1.08-.16.18-.32.2-.6.07-.28-.14-1.18-.44-2.25-1.4-.83-.74-1.39-1.65-1.55-1.93-.16-.28-.02-.43.12-.57.13-.13.28-.32.42-.48.14-.16.18-.28.28-.46.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01-.18 0-.48.07-.73.34-.25.27-.96.94-.96 2.3 0 1.36.98 2.68 1.12 2.87.14.18 1.93 2.95 4.68 4.02.65.28 1.16.45 1.56.58.66.21 1.26.18 1.73.11.53-.08 1.65-.67 1.88-1.32.23-.65.23-1.21.16-1.32-.07-.11-.25-.18-.53-.32z",fill:"#25D366"})})})]}):a.jsx("span",{children:"N/A"}),")"]},N+C+S))}):a.jsx("span",{children:"Unknown"})]}),a.jsxs("span",{style:{fontSize:"0.97em",marginTop:6},children:[a.jsx("strong",{style:{color:"#6366f1"},children:"Delivery agent:"})," ",P.assignedAgentName||P.riderName||P.riderId||P.assignedAgentId||"Not assigned",(P.assignedAgentName||P.riderName||P.riderId||P.assignedAgentId)&&(P.agentPhoneNumber||P.agentWhatsappNumber)&&a.jsxs(a.Fragment,{children:[" (",P.agentPhoneNumber?a.jsxs("a",{href:`tel:${P.agentPhoneNumber}`,style:{color:"#007bff",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:P.agentPhoneNumber}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M3.654 1.328a.678.678 0 0 1 .58-.326h2.222c.27 0 .513.162.608.41l1.013 2.53a.678.678 0 0 1-.145.72l-1.013 1.013a11.42 11.42 0 0 0 4.292 4.292l1.013-1.013a.678.678 0 0 1 .72-.145l2.53 1.013a.678.678 0 0 1 .41.608v2.222a.678.678 0 0 1-.326.58l-2.222 1.333a2.034 2.034 0 0 1-2.03.06c-2.29-1.19-4.13-3.03-5.32-5.32a2.034 2.034 0 0 1 .06-2.03L3.654 1.328z",stroke:"#007bff",strokeWidth:"1.2",fill:"none"})})})]}):a.jsx("span",{children:"N/A"}),", ",P.agentWhatsappNumber?a.jsxs("a",{href:`https://wa.me/${P.agentWhatsappNumber.replace(/[^\d]/g,"")}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#25D366",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:P.agentWhatsappNumber}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M16 3C9.373 3 4 8.373 4 15c0 2.385.832 4.584 2.236 6.393L4 29l7.828-2.236A11.96 11.96 0 0 0 16 27c6.627 0 12-5.373 12-12S22.627 3 16 3zm0 21.5c-1.77 0-3.45-.46-4.91-1.26l-.35-.2-4.65 1.33 1.33-4.65-.2-.35A8.97 8.97 0 0 1 7 15c0-4.963 4.037-9 9-9s9 4.037 9 9-4.037 9-9 9zm5.07-6.36c-.28-.14-1.65-.81-1.9-.9-.25-.09-.43-.14-.61.14-.18.28-.7.9-.86 1.08-.16.18-.32.2-.6.07-.28-.14-1.18-.44-2.25-1.4-.83-.74-1.39-1.65-1.55-1.93-.16-.28-.02-.43.12-.57.13-.13.28-.32.42-.48.14-.16.18-.28.28-.46.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01-.18 0-.48.07-.73.34-.25.27-.96.94-.96 2.3 0 1.36.98 2.68 1.12 2.87.14.18 1.93 2.95 4.68 4.02.65.28 1.16.45 1.56.58.66.21 1.26.18 1.73.11.53-.08 1.65-.67 1.88-1.32.23-.65.23-1.21.16-1.32-.07-.11-.25-.18-.53-.32z",fill:"#25D366"})})})]}):a.jsx("span",{children:"N/A"}),")"]})]})]})]}),a.jsxs("div",{style:{padding:"18px 28px 18px 28px",background:"#fff"},children:[a.jsx("button",{onClick:()=>p(P.id),style:{padding:"7px 18px",cursor:"pointer",borderRadius:"7px",border:"none",background:o[P.id]?"#ede9fe":"#7c3aed",color:o[P.id]?"#7c3aed":"#fff",fontWeight:600,fontSize:15,marginBottom:10,transition:"all 0.2s",boxShadow:o[P.id]?"0 2px 8px #ede9fe":"none"},children:o[P.id]?"Hide Items":"View Items"}),o[P.id]&&((k=P.items)==null?void 0:k.length)>0&&a.jsx("ul",{style:{marginTop:"10px"},children:P.items.map((N,C)=>a.jsxs("li",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[N.image&&a.jsx("img",{src:N.image,alt:N.name,style:{width:"50px",height:"50px",objectFit:"cover",marginRight:"10px",borderRadius:"5px",border:"1px solid #ccc"}}),a.jsxs("span",{children:[N.name,"  ",N.price," x ",N.quantity||1]})]},C))}),a.jsxs("p",{style:{marginTop:"10px",fontWeight:600,color:"#7c3aed",fontSize:16},children:[a.jsx("strong",{children:"Total:"})," ",y(P.items||[])]}),(P.status||"Pending")==="Pending"&&a.jsx("button",{onClick:()=>d(P.id),style:{marginTop:"10px",padding:"7px 18px",border:"none",borderRadius:"7px",background:"red",color:"#fff",cursor:"pointer",fontWeight:600,fontSize:15},children:"Cancel Order"}),a.jsx("div",{style:{marginTop:18,color:"#6366f1",fontSize:"0.98em",fontWeight:500,textAlign:"center"},children:"You are advised to contact both the pharmacy and the delivery agents to follow up on your order."})]})]},P.id)})]})}function QP(){const[t,e]=j.useState([]),[n,r]=j.useState({code:"",percent:0,removePOM:!1,removeDelivery:!1}),[i,s]=j.useState(null);j.useEffect(()=>{const d=yt(we(Q,"coupons"),p=>{e(p.docs.map(y=>({id:y.id,...y.data()})))});return()=>d()},[]);const o=async d=>{if(d.preventDefault(),!n.code)return alert("Coupon code required");i?(await wt(fe(Q,"coupons",i),n),s(null)):await ts(we(Q,"coupons"),n),r({code:"",percent:0,removePOM:!1,removeDelivery:!1})},u=d=>{r({code:d.code,percent:d.percent,removePOM:!!d.removePOM,removeDelivery:!!d.removeDelivery}),s(d.id)},c=async d=>{window.confirm("Delete coupon?")&&await Mn(fe(Q,"coupons",d))};return a.jsxs("div",{style:{marginTop:30},children:[a.jsx("h3",{children:" Manage Coupons"}),a.jsxs("form",{onSubmit:o,style:{marginBottom:20},children:[a.jsx("input",{placeholder:"Code",value:n.code,onChange:d=>r({...n,code:d.target.value}),style:{marginRight:10}}),a.jsx("input",{type:"number",placeholder:"% Off",value:n.percent,min:0,max:100,onChange:d=>r({...n,percent:parseInt(d.target.value)}),style:{width:80,marginRight:10}}),a.jsxs("label",{style:{marginRight:10},children:[a.jsx("input",{type:"checkbox",checked:n.removePOM,onChange:d=>r({...n,removePOM:d.target.checked})})," Remove POM Fee"]}),a.jsxs("label",{style:{marginRight:10},children:[a.jsx("input",{type:"checkbox",checked:n.removeDelivery,onChange:d=>r({...n,removeDelivery:d.target.checked})})," Remove Delivery Fee"]}),a.jsx("button",{type:"submit",children:i?"Update":"Create"}),i&&a.jsx("button",{type:"button",onClick:()=>{s(null),r({code:"",percent:0,removePOM:!1,removeDelivery:!1})},children:"Cancel"})]}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Code"}),a.jsx("th",{children:"% Off"}),a.jsx("th",{children:"POM Fee"}),a.jsx("th",{children:"Delivery Fee"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:t.map(d=>a.jsxs("tr",{children:[a.jsx("td",{children:d.code}),a.jsxs("td",{children:[d.percent,"%"]}),a.jsx("td",{children:d.removePOM?"Removed":"-"}),a.jsx("td",{children:d.removeDelivery?"Removed":"-"}),a.jsxs("td",{children:[a.jsx("button",{onClick:()=>u(d),style:{marginRight:5},children:"Edit"}),a.jsx("button",{onClick:()=>c(d.id),children:"Delete"})]})]},d.id))})]})]})}function YP(){const[t,e]=j.useState({companyName:"",phoneNumber:"",whatsappNumber:"",rcNumber:"",businessAddress:"",email:"",coverageArea:"",operatingHours:"",logoUrl:"",slug:"",approved:!1}),[n,r]=j.useState([]),[i,s]=j.useState(null),[o,u]=j.useState({}),[c,d]=j.useState(!1),[p,y]=j.useState("");j.useEffect(()=>{const S=yt(we(Q,"deliveryAgents"),E=>{r(E.docs.map(D=>({id:D.id,...D.data()})))});return()=>S()},[]),j.useEffect(()=>{async function S(){const E=hr(we(Q,"deliveryAgents"));(await Rt(E)).forEach(async V=>{typeof V.data().approved>"u"&&await fe(Q,"deliveryAgents",V.id).update({approved:!1})})}S()},[]);const v=S=>{u({...o,[S.target.name]:S.target.value})},b=S=>{s(S.id),u(S)},P=async S=>{await wt(fe(Q,"deliveryAgents",S),o),s(null),u({})},k=async S=>{window.confirm("Delete this delivery agent?")&&await Mn(fe(Q,"deliveryAgents",S))},N=async S=>{d(!0),y(""),await wt(fe(Q,"deliveryAgents",S),{approved:!0}),d(!1),y("Agent approved and now visible to public.")},C=async S=>{d(!0),y(""),await wt(fe(Q,"deliveryAgents",S),{approved:!1}),d(!1),y("Agent taken offline and hidden from public.")};return a.jsx(a.Fragment,{children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"24px",marginTop:"32px"},children:[c&&a.jsx("div",{style:{color:"#7c3aed",fontWeight:"bold",marginBottom:16},children:"Processing..."}),p&&a.jsx("div",{style:{color:"#059669",fontWeight:"bold",marginBottom:16},children:p}),n.map(S=>a.jsx("div",{style:{background:"#fff",borderRadius:"10px",boxShadow:"0 1px 8px rgba(0,0,0,0.08)",padding:"18px",minWidth:"260px",maxWidth:"320px",position:"relative"},children:i===S.id?a.jsxs("form",{onSubmit:E=>{E.preventDefault(),P(S.id)},style:{display:"flex",flexDirection:"column",gap:"8px"},children:[a.jsx("input",{id:"edit-companyName",type:"text",name:"companyName",placeholder:"Company Name",value:o.companyName||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-phoneNumber",type:"text",name:"phoneNumber",placeholder:"Phone Number",value:o.phoneNumber||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-whatsappNumber",type:"text",name:"whatsappNumber",placeholder:"WhatsApp Phone Number",value:o.whatsappNumber||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-rcNumber",type:"text",name:"rcNumber",placeholder:"RC Number",value:o.rcNumber||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-businessAddress",type:"text",name:"businessAddress",placeholder:"Business Address",value:o.businessAddress||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-email",type:"email",name:"email",placeholder:"Email Address",value:o.email||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-coverageArea",type:"text",name:"coverageArea",placeholder:"Coverage Area",value:o.coverageArea||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-operatingHours",type:"text",name:"operatingHours",placeholder:"Operating Hours (e.g. 8am-6pm)",value:o.operatingHours||"",onChange:v,required:!0}),a.jsx("input",{id:"edit-logoUrl",type:"url",name:"logoUrl",placeholder:"Business Logo URL (https://...)",value:o.logoUrl||"",onChange:v,required:!0}),a.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"8px"},children:[a.jsx("button",{type:"submit",style:{background:"#1976d2",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",fontWeight:"bold"},children:"Save"}),a.jsx("button",{type:"button",onClick:()=>s(null),style:{background:"#eee",color:"#333",border:"none",borderRadius:"6px",padding:"6px 14px"},children:"Cancel"})]})]}):a.jsxs(Ue.Fragment,{children:[a.jsx("img",{src:S.logoUrl,alt:S.companyName,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:10}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:"18px",marginBottom:4},children:S.companyName}),a.jsx("div",{style:{color:"#7c3aed",fontWeight:500,marginBottom:4},children:S.businessAddress}),a.jsxs("div",{children:["RC Number: ",S.rcNumber]}),a.jsxs("div",{children:["Phone: ",S.phoneNumber]}),a.jsxs("div",{children:["WhatsApp: ",S.whatsappNumber]}),a.jsxs("div",{children:["Email: ",S.email]}),a.jsxs("div",{children:["Coverage: ",S.coverageArea]}),a.jsxs("div",{children:["Hours: ",S.operatingHours]}),a.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[a.jsx("button",{onClick:()=>b(S),style:{background:"#1976d2",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",fontWeight:"bold"},children:"Edit"}),a.jsx("button",{onClick:()=>k(S.id),style:{background:"#e53935",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",fontWeight:"bold"},children:"Delete"}),!S.approved&&a.jsx("button",{onClick:()=>N(S.id),style:{background:"#10b981",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",cursor:"pointer"},children:"Approve"}),S.approved&&a.jsx("button",{onClick:()=>C(S.id),style:{background:"#f59e42",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",cursor:"pointer"},children:"Take Offline"})]}),S.approved&&a.jsx("div",{style:{color:"#059669",fontWeight:"bold",marginTop:"8px"},children:" Approved"})]})},S.id))]})})}function XP(){const[t,e]=j.useState([]);j.useEffect(()=>{(async()=>{try{const J=await Rt(we(Q,"deliveryAgents"));e(J.docs.map(oe=>({id:oe.id,...oe.data()})))}catch{e([])}})()},[]);const[n,r]=j.useState({}),i=async(_,J)=>{try{const oe=t.find(se=>se.id===J),U=(oe==null?void 0:oe.userId)||"";await wt(fe(Q,"orders",_),{riderId:U,assignedAgentId:U,assignedAgentName:oe?oe.companyName||oe.name||oe.email||oe.id:"",status:"In-Progress",assignedAt:new Date().toISOString()}),r(se=>({...se,[_]:!1}))}catch{alert("Failed to reassign order.")}},s=async _=>{if(window.confirm("Are you sure you want to cancel this order?"))try{await wt(fe(Q,"orders",_.id),{status:"cancelled",cancelledBy:"admin",cancelledAt:new Date().toISOString()})}catch{alert("Failed to cancel order.")}},[o,u]=j.useState({pending:!0,completed:!0,cancelled:!0}),[c,d]=j.useState(""),[p,y]=j.useState(""),[v,b]=j.useState(""),[P,k]=j.useState(""),[N,C]=j.useState({}),[S,E]=j.useState({}),V=window.location.pathname.match(/^\/store\/([^\/]+)/),[L,x]=Ue.useState(null);if(j.useEffect(()=>{qs(async()=>{const{getAuth:_,onAuthStateChanged:J}=await Promise.resolve().then(()=>mE);return{getAuth:_,onAuthStateChanged:J}},void 0).then(({getAuth:_,onAuthStateChanged:J})=>{const oe=_();J(oe,async U=>{if(U){const{getDoc:se,doc:le}=await qs(async()=>{const{getDoc:je,doc:sn}=await Promise.resolve().then(()=>Up);return{getDoc:je,doc:sn}},void 0),{db:Se}=await qs(async()=>{const{db:je}=await Promise.resolve().then(()=>zP);return{db:je}},void 0),ce=await se(le(Se,"users",U.uid));x(ce.exists()?ce.data().role:null)}else x(null)})})},[]),V||L==="customer")return a.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#7c3aed"},children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"This page is only for business/admin users. Please use the store features."})]});const[f,m]=j.useState([]);j.useEffect(()=>{const _=yt(we(Q,"businessRegistrations"),J=>{m(J.docs.map(oe=>({id:oe.id,...oe.data()})))});return()=>_()},[]);const w=async(_,J)=>{if(await wt(fe(Q,"businessRegistrations",_.id),{status:J}),J==="declined"){const oe=hr(we(Q,"orders"),Yn("userId","==",_.businessId),Yn("items","array-contains-any",_.cart)),U=await Rt(oe);for(const se of U.docs)await wt(fe(Q,"orders",se.id),{status:"Canceled",canceledReason:"Distributor declined registration"})}alert(`Registration ${J}`)},[A,R]=j.useState(""),[T,ae]=j.useState(""),[H,te]=j.useState(""),[ee,M]=j.useState(""),[F,W]=j.useState(""),q=()=>{let _=Wr;A&&(_=_.filter(ce=>new Date(ce.completedAt||ce.date)>=new Date(A))),T&&(_=_.filter(ce=>new Date(ce.completedAt||ce.date)<=new Date(T))),H&&(_=_.filter(ce=>ce.medicVerifiedBy===H)),ee&&(_=_.filter(ce=>ce.items&&ce.items.some(je=>je.name&&je.name.toLowerCase().includes(ee.toLowerCase())))),F==="true"&&(_=_.filter(ce=>ce.items&&ce.items.some(je=>je.isPOM))),F==="false"&&(_=_.filter(ce=>ce.items&&!ce.items.some(je=>je.isPOM)));const J=["Order ID","Date","User Email","Medic Verified By","Amount","Products","POM Items"],oe=_.map(ce=>[ce.id,new Date(ce.completedAt||ce.date).toLocaleString(),He[ce.userId]&&He[ce.userId].email?He[ce.userId].email:ce.userId,ce.medicVerifiedBy?(xe.concat(Ye).find(je=>je.id===ce.medicVerifiedBy)||{}).name||ce.medicVerifiedBy:"",ce.total||kn(ce.items||[]),ce.items?ce.items.map(je=>`${je.name} (${je.quantity||1})`).join("; "):"",ce.items?ce.items.filter(je=>je.isPOM).map(je=>je.name).join("; "):""]),U=[J,...oe].map(ce=>ce.map(je=>`"${String(je).replace(/"/g,'""')}"`).join(",")).join(`\r
`),se=new Blob([U],{type:"text/csv"}),le=URL.createObjectURL(se),Se=document.createElement("a");Se.href=le,Se.download=`orders_${Date.now()}.csv`,document.body.appendChild(Se),Se.click(),document.body.removeChild(Se),URL.revokeObjectURL(le)},[G,O]=j.useState(""),[X,z]=j.useState(null),[ie,pe]=j.useState(null),[ne,Te]=j.useState([]),[De,_e]=j.useState([]),[be,We]=j.useState(""),[Pe,Re]=j.useState([]),[ye,Je]=j.useState([]),[ve,ke]=j.useState("products"),[Ne,qt]=j.useState({}),[it,Lt]=j.useState(null),[Qe,vt]=j.useState(!0),[xe,Oe]=j.useState([]),[Ye,Jn]=j.useState([]),[Ht,hn]=j.useState(""),[qe,fn]=j.useState("date-desc"),Zn=un();j.useEffect(()=>{const _=Un(Zn,async J=>{if(J){z(J);const oe=await At(fe(Q,"users",J.uid));pe(oe.exists()?oe.data():{role:"customer"})}else z(null),pe(null)});return()=>_()},[Zn]),j.useEffect(()=>{const _=yt(we(Q,"products"),oe=>Te(oe.docs.map(U=>({id:U.id,...U.data()})))),J=yt(we(Q,"batches"),oe=>{_e(oe.docs.map(U=>({id:U.id,...U.data()}))),vt(!1)});return()=>{_(),J()}},[]),j.useEffect(()=>{if(!ie)return;const _=yt(we(Q,"users"),J=>Re(J.docs.map(oe=>({id:oe.id,...oe.data()}))));return()=>_()},[ie]),j.useEffect(()=>{const _=yt(we(Q,"orders"),J=>{const oe=J.docs.map(U=>({id:U.id,...U.data()}));oe.sort((U,se)=>new Date(se.date)-new Date(U.date)),Je(oe)});return()=>_()},[]);const He={};Pe.forEach(_=>He[_.id]=_);const Br=async _=>{if(window.confirm(`Delete medicine: ${_.name}?`))try{await Mn(fe(Q,"products",_.id))}catch(J){console.error(J),alert("Error deleting medicine")}},yo=async _=>{if(window.confirm(`Delete batch: ${_.name}?`))try{for(let J of _.medicineIds)await Mn(fe(Q,"products",J));await Mn(fe(Q,"batches",_.id))}catch(J){console.error(J),alert("Error deleting batch")}},ki=async(_,J)=>{try{await wt(fe(Q,"users",_),{role:J}),alert("Role updated!")}catch(oe){console.error(oe),alert("Error updating role")}},zr=_=>qt(J=>({...J,[_]:!J[_]}));j.useEffect(()=>{Rt(we(Q,"verifyMedics")).then(_=>{Oe(_.docs.map(J=>({id:J.id,...J.data(),type:"Prescription Verification"})))}),Rt(we(Q,"consultMedics")).then(_=>{Jn(_.docs.map(J=>({id:J.id,...J.data(),type:"Consultation"})))})},[]);const cs=async _=>{var U;const J=(U=_.items)==null?void 0:U.some(se=>se.isPOM);let oe=null;if(J){if(!G)return alert("Select a verifying medic before completing POM order.");oe=G}window.confirm("Mark order as completed?")&&(await wt(fe(Q,"orders",_.id),{status:"Completed",completedBy:X.uid,completedAt:new Date().toISOString(),medicVerifiedBy:oe||null}),alert(" Order marked completed"),O(""))},kn=_=>_.reduce((J,oe)=>J+oe.price*(oe.quantity||1),0);if(!X)return a.jsx("p",{children:"Please log in to access admin."});if(!ie)return a.jsx("p",{children:"Loading user data..."});if(ie.role!=="admin")return a.jsx("p",{children:"Access denied. Admins only."});if(Qe)return a.jsx("p",{children:"Loading dashboard..."});const $r=ye.filter(_=>_.status==="Processing"||_.status==="In-Progress").filter(_=>{var oe,U;if(!Ht)return!0;const J=Ht.toLowerCase();return(((oe=He[_.userId])==null?void 0:oe.email)||_.userId).toLowerCase().includes(J)||((U=_.items)==null?void 0:U.some(se=>se.name.toLowerCase().includes(J)))}).sort((_,J)=>qe==="date-desc"?new Date(J.date)-new Date(_.date):qe==="date-asc"?new Date(_.date)-new Date(J.date):qe==="amount-desc"?(J.total||0)-(_.total||0):qe==="amount-asc"?(_.total||0)-(J.total||0):0),Wr=ye.filter(_=>_.status==="Completed"),Kt=Wr.filter(_=>{var oe,U;if(!Ht)return!0;const J=Ht.toLowerCase();return(((oe=He[_.userId])==null?void 0:oe.email)||_.userId).toLowerCase().includes(J)||((U=_.items)==null?void 0:U.some(se=>se.name.toLowerCase().includes(J)))}).sort((_,J)=>qe==="date-desc"?new Date(J.completedAt||J.date)-new Date(_.completedAt||_.date):qe==="date-asc"?new Date(_.completedAt||_.date)-new Date(J.completedAt||J.date):qe==="amount-desc"?(J.total||0)-(_.total||0):qe==="amount-asc"?(_.total||0)-(J.total||0):0);return a.jsxs("div",{style:{padding:"30px",fontFamily:"sans-serif"},children:[f.length>0&&a.jsxs("div",{style:{background:"#f3f0ff",padding:24,borderRadius:10,marginBottom:30},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Distributor Registration Requests"}),f.map((_,J)=>{var oe,U,se,le,Se;return a.jsxs("div",{style:{marginBottom:24,padding:16,background:"#fff",borderRadius:8,boxShadow:"0 1px 4px #e0e0e0"},children:[a.jsxs("h4",{style:{color:"#7c3aed"},children:["Business: ",((oe=_.businessInfo)==null?void 0:oe.businessName)||_.businessId]}),a.jsxs("p",{children:["Email: ",((U=_.businessInfo)==null?void 0:U.email)||""]}),a.jsxs("p",{children:["Phone: ",((se=_.businessInfo)==null?void 0:se.phone)||""]}),a.jsxs("p",{children:["Address: ",((le=_.businessInfo)==null?void 0:le.address)||""]}),a.jsxs("p",{children:["Products: ",(Se=_.cart)==null?void 0:Se.map(ce=>ce.name).join(", ")]}),a.jsxs("p",{children:["Status: ",a.jsx("b",{children:_.status})]}),_.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>w(_,"approved"),style:{background:"#27c93f",color:"#fff",padding:"8px 18px",borderRadius:6,fontWeight:"bold",marginRight:10},children:"Approve"}),a.jsx("button",{onClick:()=>w(_,"declined"),style:{background:"#e53935",color:"#fff",padding:"8px 18px",borderRadius:6,fontWeight:"bold"},children:"Decline"})]})]},_.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"20px",margin:"20px 0",justifyContent:"center"},children:[a.jsx("button",{onClick:()=>ke("products"),style:ys(ve==="products"),children:"Manage Products"}),a.jsx("button",{onClick:()=>ke("users"),style:ys(ve==="users"),children:"Manage Users"}),a.jsx("button",{onClick:()=>ke("orders"),style:ys(ve==="orders"),children:"Manage Orders"}),a.jsx("button",{onClick:()=>ke("medics"),style:ys(ve==="medics"),children:"Manage Medics"}),a.jsx("button",{onClick:()=>ke("deliveryagents"),style:ys(ve==="deliveryagents"),children:"Manage DeliveryAgents"}),a.jsx("button",{onClick:()=>ke("coupons"),style:ys(ve==="coupons"),children:"Manage Coupons"})]}),a.jsxs("div",{style:{padding:"0 30px"},children:[a.jsx("h2",{children:" Admin Dashboard"}),a.jsxs("p",{children:["Logged in as: ",X.email]}),ve==="deliveryagents"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:" Manage Delivery Agents"}),a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("p",{children:"Here you can add, view, and manage delivery agents for your platform."}),a.jsx(YP,{})]})]})]}),ve==="products"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:" CSV Batches"}),a.jsx("input",{type:"text",placeholder:"Search by pharmacy name...",value:be,onChange:_=>We(_.target.value),style:{marginBottom:12,padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:260}}),De.length===0?a.jsx("p",{children:"No batches yet."}):a.jsxs("table",{style:jd,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Batch Name"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Uploaded By"}),a.jsx("th",{children:"Medicines Count"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:De.filter(_=>{var oe;return be?(((oe=He[_.uploadedBy])==null?void 0:oe.businessName)||"").toLowerCase().includes(be.toLowerCase()):!0}).map(_=>{var J,oe;return a.jsxs("tr",{style:Nd,children:[a.jsx("td",{children:_.name}),a.jsx("td",{children:new Date(_.date).toLocaleString()}),a.jsx("td",{children:((J=He[_.uploadedBy])==null?void 0:J.businessName)||_.uploadedBy}),a.jsx("td",{children:((oe=_.medicineIds)==null?void 0:oe.length)||0}),a.jsx("td",{children:a.jsx("button",{onClick:()=>yo(_),children:"Delete"})})]},_.id)})})]}),a.jsx("h3",{style:{marginTop:"30px"},children:" Medicines"}),a.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("input",{type:"text",placeholder:"Filter by name...",value:c||"",onChange:_=>d(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:160}}),a.jsx("input",{type:"text",placeholder:"Filter by ingredient...",value:p||"",onChange:_=>y(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:160}}),a.jsxs("select",{value:v||"",onChange:_=>b(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:140},children:[a.jsx("option",{value:"",children:"All Classes"}),[...new Set(ne.map(_=>_.class).filter(Boolean))].sort().map(_=>a.jsx("option",{value:_,children:_},_))]}),a.jsxs("select",{value:P||"",onChange:_=>k(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:180},children:[a.jsx("option",{value:"",children:"All Pharmacies"}),[...new Set(ne.map(_=>_.ownerId).filter(Boolean))].map(_=>{var J;return a.jsx("option",{value:_,children:((J=He[_])==null?void 0:J.businessName)||_},_)})]})]}),ne.length===0?a.jsx("p",{children:"No medicines yet."}):a.jsxs("table",{style:jd,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Ingredient"}),a.jsx("th",{children:"Class"}),a.jsx("th",{children:"Price ()"}),a.jsx("th",{children:"Uploaded By"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:ne.filter(_=>{var J,oe;return!(c&&!((J=_.name)!=null&&J.toLowerCase().includes(c.toLowerCase()))||p&&!((oe=_.ingredient)!=null&&oe.toLowerCase().includes(p.toLowerCase()))||v&&_.class!==v||P&&_.ownerId!==P)}).map(_=>{var J;return a.jsxs("tr",{style:Nd,children:[a.jsx("td",{children:_.name}),a.jsx("td",{children:_.ingredient}),a.jsx("td",{children:_.class}),a.jsx("td",{children:_.price}),a.jsx("td",{children:((J=He[_.ownerId])==null?void 0:J.businessName)||_.ownerId}),a.jsx("td",{children:a.jsx("button",{onClick:()=>Br(_),children:"Delete"})})]},_.id)})})]})]}),ve==="users"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:" All Users"}),Pe.length===0?a.jsx("p",{children:"No users found."}):a.jsxs("table",{style:jd,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Change Role"}),a.jsx("th",{children:"Activity"})]})}),a.jsx("tbody",{children:Pe.map(_=>a.jsxs("tr",{style:Nd,children:[a.jsx("td",{children:_.email}),a.jsx("td",{children:_.role}),a.jsx("td",{children:a.jsxs("select",{value:_.role||"customer",onChange:J=>ki(_.id,J.target.value),children:[a.jsx("option",{value:"customer",children:"Customer"}),a.jsx("option",{value:"medicine-manager",children:"Medicine Manager"}),a.jsx("option",{value:"orders-only",children:"Orders Only"}),a.jsx("option",{value:"admin",children:"Admin"})]})}),a.jsx("td",{children:a.jsx("button",{onClick:()=>Lt(_),children:"View Details"})})]},_.id))})]}),it&&a.jsx(JP,{user:it,medicines:ne.filter(_=>_.ownerId===it.id),orders:ye.filter(_=>_.userId===it.id),onClose:()=>Lt(null)})]}),ve==="orders"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{marginBottom:"18px",border:"1px solid #ddd",borderRadius:8,background:"#fafbfc"},children:[a.jsxs("div",{style:{cursor:"pointer",padding:"14px 18px",fontWeight:"bold",fontSize:18,display:"flex",alignItems:"center",userSelect:"none"},onClick:()=>u(_=>({..._,pending:!_.pending})),children:[a.jsx("span",{style:{marginRight:8},children:o.pending?"":""})," Pending / Processing Orders"]}),o.pending&&a.jsxs("div",{style:{padding:"0 18px 18px 18px"},children:[a.jsxs("div",{style:{margin:"20px 0",display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by user or drug name...",value:Ht,onChange:_=>hn(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:220}}),a.jsxs("select",{value:qe,onChange:_=>fn(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"date-desc",children:"Newest First"}),a.jsx("option",{value:"date-asc",children:"Oldest First"}),a.jsx("option",{value:"amount-desc",children:"Highest Amount"}),a.jsx("option",{value:"amount-asc",children:"Lowest Amount"})]}),a.jsx("input",{type:"date",value:A,onChange:_=>R(_.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"date",value:T,onChange:_=>ae(_.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:H,onChange:_=>te(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Medics"}),[...xe,...Ye].map(_=>a.jsxs("option",{value:_.id,children:[_.name," (",_.profession,")"]},_.id))]}),a.jsx("input",{type:"text",value:ee,onChange:_=>M(_.target.value),placeholder:"Product name",style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:F,onChange:_=>W(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Orders"}),a.jsx("option",{value:"true",children:"POM Only"}),a.jsx("option",{value:"false",children:"Non-POM Only"})]}),a.jsx("button",{onClick:q,style:{padding:"8px 18px",borderRadius:6,background:"#007bff",color:"#fff",fontWeight:"bold"},children:"Download CSV"})]}),$r.length===0?a.jsx("p",{children:"No pending orders."}):$r.map(_=>{var Pn,_t,dt,pt,fr;const J=(Pn=_.items)==null?void 0:Pn.some(me=>me.isPOM),oe=_.deliveryInfo?`${_.deliveryInfo.address||""}, ${_.deliveryInfo.city||""}, ${_.deliveryInfo.state||""}`:"N/A",U=_.deliveryInfo&&_.deliveryInfo.lat?_.deliveryInfo.lat:null,se=_.deliveryInfo&&_.deliveryInfo.lng?_.deliveryInfo.lng:null;let le="N/A",Se=null,ce=null;if(_.businessId&&He[_.businessId]){const me=He[_.businessId];le=`${me.address||""}, ${me.city||""}, ${me.state||""}`,Se=me.lat||null,ce=me.lng||null}const je=Ne[_.id]?N[_.id]?_.items:(_t=_.items)==null?void 0:_t.slice(0,3):[],sn=_.items&&_.items.length>3;return a.jsxs("div",{style:Dd,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order Date:"})," ",new Date(_.date).toLocaleString()]}),a.jsx("button",{onClick:()=>zr(_.id),children:Ne[_.id]?"Hide Items":"Show Items"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User Email:"})," ",((dt=He[_.userId])==null?void 0:dt.email)||_.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Address:"})," ",!_.deliveryInfo||!_.deliveryInfo.address&&!_.deliveryInfo.city&&!_.deliveryInfo.state?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):oe]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Coordinates:"})," ",U&&se?`${U}, ${se}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Address:"})," ",le]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Coordinates:"})," ",Se&&ce?`${Se}, ${ce}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Rider assigned:"})," ",a.jsxs("span",{style:{display:"inline-flex",alignItems:"center"},children:[(()=>{const me=_.riderId||_.assignedAgentId;let ot=null;return me&&He[me]?(ot=He[me],`${ot.companyName||ot.name||ot.email||me}${ot.phoneNumber||ot.whatsappNumber?` (${[ot.phoneNumber,ot.whatsappNumber].filter(Boolean).join(" / ")})`:""}`):me&&t.length?(ot=t.find(ds=>ds.id===me),ot?`${ot.companyName||ot.name||ot.id}${ot.phoneNumber||ot.whatsappNumber?` (${[ot.phoneNumber,ot.whatsappNumber].filter(Boolean).join(" / ")})`:""}`:me):me||a.jsx("span",{style:{color:"#e53935"},children:"No rider assigned"})})(),a.jsxs("button",{style:{marginLeft:10,background:"none",border:"none",color:"#007bff",cursor:"pointer",display:"inline-flex",alignItems:"center",fontWeight:"bold"},onClick:()=>r(me=>({...me,[_.id]:!me[_.id]})),children:[a.jsx("span",{style:{fontSize:18,marginRight:4},children:""})," reassign order"]}),n[_.id]&&a.jsxs("select",{style:{marginLeft:10,padding:"6px 12px",borderRadius:6},defaultValue:"",onChange:me=>{me.target.value&&i(_.id,me.target.value)},children:[a.jsx("option",{value:"",children:"Select new rider"}),t.map(me=>a.jsxs("option",{value:me.id,children:[me.companyName||me.name||me.email||me.id,me.phoneNumber||me.whatsappNumber?` (${[me.phoneNumber,me.whatsappNumber].filter(Boolean).join(" / ")})`:""]},me.id))]})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Order Status:"})," ",!_.riderId&&!_.assignedAgentId?a.jsx("span",{style:{color:"#e53935"},children:"Processing (no rider accepted)"}):_.status==="cancelled"&&_.cancelledBy==="rider"?a.jsx("span",{style:{color:"#e53935"},children:"Canceled by rider"}):_.deliveredByRider?a.jsx("span",{style:{color:"#27c93f"},children:"Delivered by rider"}):_.status==="Completed"?a.jsx("span",{style:{color:"#27c93f"},children:"Completed (admin)"}):(_.riderId||_.assignedAgentId)&&_.status!=="Completed"&&_.status!=="cancelled"?a.jsx("span",{style:{color:"#007bff"},children:"Progressing (rider accepted)"}):_.status]})]}),Ne[_.id]&&((pt=_.items)==null?void 0:pt.length)>0&&a.jsxs("div",{children:[a.jsx("ul",{style:{maxHeight:N[_.id]?"none":120,overflowY:sn&&!N[_.id]?"hidden":"auto",marginBottom:4},children:je.map((me,ot)=>a.jsxs("li",{children:[me.name," - ",me.price," x ",me.quantity||1]},ot))}),sn&&a.jsx("button",{style:{fontSize:12,marginBottom:8},onClick:()=>C(me=>({...me,[_.id]:!me[_.id]})),children:N[_.id]?"Show Less":`Show All (${_.items.length})`})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ",kn(_.items||[]),J&&a.jsx("span",{style:{color:"#e53935",marginLeft:10},children:"[POM]"})]}),J&&a.jsxs("div",{style:{margin:"10px 0"},children:[a.jsx("label",{children:a.jsx("strong",{children:"Medic Verified By:"})}),a.jsxs("select",{value:G,onChange:me=>O(me.target.value),style:{marginLeft:10},children:[a.jsx("option",{value:"",children:"Select Medic"}),[...xe,...Ye].map(me=>a.jsxs("option",{value:me.id,children:[me.name," (",me.profession,") - ",me.type]},me.id))]})]}),a.jsx("button",{onClick:()=>cs(_),children:"Mark as Completed"}),a.jsx("button",{style:{marginLeft:8,background:"#e53935",color:"#fff",borderRadius:6,padding:"6px 14px",border:"none",fontWeight:"bold"},onClick:()=>s(_),children:"Cancel Order"}),_.completedAt&&a.jsxs("p",{style:{fontSize:13,color:"#555",marginTop:6},children:["Completed: ",new Date(_.completedAt).toLocaleString(),a.jsx("br",{}),_.medicVerifiedBy&&a.jsxs("span",{children:["Verified by: ",((fr=xe.find(me=>me.id===_.medicVerifiedBy))==null?void 0:fr.name)||_.medicVerifiedBy]})]})]},_.id)})]})]}),a.jsxs("div",{style:{marginBottom:"18px",border:"1px solid #ddd",borderRadius:8,background:"#fafbfc"},children:[a.jsxs("div",{style:{cursor:"pointer",padding:"14px 18px",fontWeight:"bold",fontSize:18,display:"flex",alignItems:"center",userSelect:"none"},onClick:()=>u(_=>({..._,completed:!_.completed})),children:[a.jsx("span",{style:{marginRight:8},children:o.completed?"":""})," Completed Orders (You)"]}),o.completed&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{margin:"20px 0",display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by user or drug name...",value:Ht,onChange:_=>hn(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:220}}),a.jsxs("select",{value:qe,onChange:_=>fn(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"date-desc",children:"Newest First"}),a.jsx("option",{value:"date-asc",children:"Oldest First"}),a.jsx("option",{value:"amount-desc",children:"Highest Amount"}),a.jsx("option",{value:"amount-asc",children:"Lowest Amount"})]}),a.jsx("input",{type:"date",value:A,onChange:_=>R(_.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"date",value:T,onChange:_=>ae(_.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:H,onChange:_=>te(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Medics"}),[...xe,...Ye].map(_=>a.jsxs("option",{value:_.id,children:[_.name," (",_.profession,")"]},_.id))]}),a.jsx("input",{type:"text",value:ee,onChange:_=>M(_.target.value),placeholder:"Product name",style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:F,onChange:_=>W(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Orders"}),a.jsx("option",{value:"true",children:"POM Only"}),a.jsx("option",{value:"false",children:"Non-POM Only"})]}),a.jsx("button",{onClick:q,style:{padding:"8px 18px",borderRadius:6,background:"#007bff",color:"#fff",fontWeight:"bold"},children:"Download CSV"})]}),Kt.length===0?a.jsx("p",{children:"No completed orders found."}):Kt.map(_=>{var sn,Pn,_t,dt;const J=_.deliveryInfo?`${_.deliveryInfo.address||""}, ${_.deliveryInfo.city||""}, ${_.deliveryInfo.state||""}`:"N/A",oe=_.deliveryInfo&&_.deliveryInfo.lat?_.deliveryInfo.lat:null,U=_.deliveryInfo&&_.deliveryInfo.lng?_.deliveryInfo.lng:null;let se="N/A",le=null,Se=null;if(_.businessId&&He[_.businessId]){const pt=He[_.businessId];se=`${pt.address||""}, ${pt.city||""}, ${pt.state||""}`,le=pt.lat||null,Se=pt.lng||null}const ce=Ne[_.id]?S[_.id]?_.items:(sn=_.items)==null?void 0:sn.slice(0,3):[],je=_.items&&_.items.length>3;return a.jsxs("div",{style:Dd,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order Date:"})," ",new Date(_.completedAt||_.date).toLocaleString()]}),a.jsx("button",{onClick:()=>zr(_.id),children:Ne[_.id]?"Hide Details":"Show Details"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User Email:"})," ",((Pn=He[_.userId])==null?void 0:Pn.email)||_.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Address:"})," ",!_.deliveryInfo||!_.deliveryInfo.address&&!_.deliveryInfo.city&&!_.deliveryInfo.state?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):J]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Coordinates:"})," ",oe&&U?`${oe}, ${U}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Address:"})," ",se]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Coordinates:"})," ",le&&Se?`${le}, ${Se}`:"N/A"]}),Ne[_.id]&&((_t=_.items)==null?void 0:_t.length)>0&&a.jsxs("div",{children:[a.jsx("ul",{style:{maxHeight:S[_.id]?"none":120,overflowY:je&&!S[_.id]?"hidden":"auto",marginBottom:4},children:ce.map((pt,fr)=>a.jsxs("li",{children:[pt.name," - ",pt.price," x ",pt.quantity||1]},fr))}),je&&a.jsx("button",{style:{fontSize:12,marginBottom:8},onClick:()=>E(pt=>({...pt,[_.id]:!pt[_.id]})),children:S[_.id]?"Show Less":`Show All (${_.items.length})`})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ",_.total||kn(_.items||[])]}),_.medicVerifiedBy&&a.jsxs("p",{children:[a.jsx("strong",{children:"Verified by:"})," ",((dt=xe.concat(Ye).find(pt=>pt.id===_.medicVerifiedBy))==null?void 0:dt.name)||_.medicVerifiedBy]}),_.completedAt&&a.jsxs("p",{style:{fontSize:13,color:"#555",marginTop:6},children:["Completed: ",new Date(_.completedAt).toLocaleString()]})]},_.id)})]})]}),a.jsxs("div",{style:{marginBottom:"18px",border:"1px solid #ddd",borderRadius:8,background:"#fafbfc"},children:[a.jsxs("div",{style:{cursor:"pointer",padding:"14px 18px",fontWeight:"bold",fontSize:18,display:"flex",alignItems:"center",userSelect:"none"},onClick:()=>u(_=>({..._,cancelled:!_.cancelled})),children:[a.jsx("span",{style:{marginRight:8},children:o.cancelled?"":""})," Cancelled Orders"]}),o.cancelled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{margin:"20px 0",display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by user or drug name...",value:Ht,onChange:_=>hn(_.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:220}}),a.jsxs("select",{value:qe,onChange:_=>fn(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"date-desc",children:"Newest First"}),a.jsx("option",{value:"date-asc",children:"Oldest First"}),a.jsx("option",{value:"amount-desc",children:"Highest Amount"}),a.jsx("option",{value:"amount-asc",children:"Lowest Amount"})]}),a.jsx("input",{type:"date",value:A,onChange:_=>R(_.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"date",value:T,onChange:_=>ae(_.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:H,onChange:_=>te(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Medics"}),[...xe,...Ye].map(_=>a.jsxs("option",{value:_.id,children:[_.name," (",_.profession,")"]},_.id))]}),a.jsx("input",{type:"text",value:ee,onChange:_=>M(_.target.value),placeholder:"Product name",style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:F,onChange:_=>W(_.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Orders"}),a.jsx("option",{value:"true",children:"POM Only"}),a.jsx("option",{value:"false",children:"Non-POM Only"})]}),a.jsx("button",{onClick:q,style:{padding:"8px 18px",borderRadius:6,background:"#007bff",color:"#fff",fontWeight:"bold"},children:"Download CSV"})]}),ye.filter(_=>_.status==="cancelled"&&_.cancelledBy==="admin").length===0?a.jsx("p",{children:"No cancelled orders found."}):ye.filter(_=>_.status==="cancelled"&&_.cancelledBy==="admin").map(_=>{var sn,Pn,_t;const J=_.deliveryInfo?`${_.deliveryInfo.address||""}, ${_.deliveryInfo.city||""}, ${_.deliveryInfo.state||""}`:"N/A",oe=_.deliveryInfo&&_.deliveryInfo.lat?_.deliveryInfo.lat:null,U=_.deliveryInfo&&_.deliveryInfo.lng?_.deliveryInfo.lng:null;let se="N/A",le=null,Se=null;if(_.businessId&&He[_.businessId]){const dt=He[_.businessId];se=`${dt.address||""}, ${dt.city||""}, ${dt.state||""}`,le=dt.lat||null,Se=dt.lng||null}const ce=Ne[_.id]?S[_.id]?_.items:(sn=_.items)==null?void 0:sn.slice(0,3):[],je=_.items&&_.items.length>3;return a.jsxs("div",{style:Dd,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order Date:"})," ",new Date(_.cancelledAt||_.date).toLocaleString()]}),a.jsx("button",{onClick:()=>zr(_.id),children:Ne[_.id]?"Hide Details":"Show Details"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User Email:"})," ",((Pn=He[_.userId])==null?void 0:Pn.email)||_.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Address:"})," ",!_.deliveryInfo||!_.deliveryInfo.address&&!_.deliveryInfo.city&&!_.deliveryInfo.state?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):J]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Coordinates:"})," ",oe&&U?`${oe}, ${U}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Address:"})," ",se]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Coordinates:"})," ",le&&Se?`${le}, ${Se}`:"N/A"]}),Ne[_.id]&&((_t=_.items)==null?void 0:_t.length)>0&&a.jsxs("div",{children:[a.jsx("ul",{style:{maxHeight:S[_.id]?"none":120,overflowY:je&&!S[_.id]?"hidden":"auto",marginBottom:4},children:ce.map((dt,pt)=>a.jsxs("li",{children:[dt.name," - ",dt.price," x ",dt.quantity||1]},pt))}),je&&a.jsx("button",{style:{fontSize:12,marginBottom:8},onClick:()=>E(dt=>({...dt,[_.id]:!dt[_.id]})),children:S[_.id]?"Show Less":`Show All (${_.items.length})`})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ",_.total||kn(_.items||[])]}),_.cancelledAt&&a.jsxs("p",{style:{fontSize:13,color:"#e53935",marginTop:6},children:["Cancelled: ",new Date(_.cancelledAt).toLocaleString()]})]},_.id)})]})]})]}),ve==="medics"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:" Medical Interface Profiles"}),a.jsx(ZP,{})]}),ve==="coupons"&&a.jsx(QP,{})]})}const ys=t=>({padding:"10px 20px",border:"none",borderRadius:"5px",cursor:"pointer",background:t?"#007bff":"#eee",color:t?"#fff":"#000",fontWeight:t?"bold":"normal"}),jd={width:"100%",borderCollapse:"collapse",marginBottom:"20px"},Nd={borderBottom:"1px solid #eee"},Dd={marginBottom:"20px",padding:"15px",border:"1px solid #ccc",borderRadius:"10px",background:"#f9f9f9"};function JP({user:t,medicines:e,orders:n,onClose:r}){return a.jsxs("div",{style:{padding:"20px",border:"1px solid #ccc",borderRadius:"10px",marginTop:"20px",background:"#f0f0f0"},children:[a.jsxs("h4",{children:[" ",t.email," Details"]}),a.jsx("button",{onClick:r,style:{marginBottom:"10px"},children:"Close"}),a.jsx("h5",{children:" Products"}),e.length===0?a.jsx("p",{children:"No products."}):a.jsx("ul",{children:e.map(i=>a.jsxs("li",{children:[i.name," - ",i.price]},i.id))}),a.jsx("h5",{children:" Purchase History"}),n.length===0?a.jsx("p",{children:"No orders."}):a.jsx("ul",{children:n.map(i=>a.jsxs("li",{children:[i.items.map(s=>s.name).join(", ")," - ",i.items.reduce((s,o)=>s+o.price*(o.quantity||1),0)]},i.id))})]})}function ZP(){const[t,e]=Ue.useState([]),[n,r]=Ue.useState([]),[i,s]=Ue.useState([]),[o,u]=Ue.useState({section:"verify",photo:"",name:"",profession:"",license:"",languages:"",whatsapp:""}),[c,d]=Ue.useState(!1),[p,y]=Ue.useState(null);Ue.useEffect(()=>{(async()=>{const N=await Rt(we(Q,"verifyMedics"));e(N.docs.map(D=>({id:D.id,...D.data()})));const C=await Rt(we(Q,"consultMedics"));r(C.docs.map(D=>({id:D.id,...D.data()})));const S=await Rt(we(Q,"users")),E=[];S.docs.forEach(D=>{const V=D.data();V.role==="medicine-manager"&&V.pharmacist&&E.push({...V.pharmacist,id:D.id,online:!0})}),s(E)})()},[]);const v=async(k,N)=>{await wt(fe(Q,k==="verify"?"verifyMedics":"consultMedics",N.id),{online:!N.online}),k==="verify"?e(S=>S.map(E=>E.id===N.id?{...E,online:!N.online}:E)):r(S=>S.map(E=>E.id===N.id?{...E,online:!N.online}:E))},b=k=>{u({...o,[k.target.name]:k.target.value})},P=async k=>{k.preventDefault(),d(!0);const N={photo:o.photo,name:o.name,profession:o.profession,license:o.license,pharmacyName:o.pharmacyName,languages:o.languages.split(",").map(S=>S.trim()),whatsapp:o.whatsapp},C=o.section==="verify"?"verifyMedics":"consultMedics";p?await wt(fe(Q,C,p.id),N):await ts(we(Q,C),N),u({section:"verify",photo:"",name:"",profession:"",license:"",pharmacyName:"",languages:"",whatsapp:""}),y(null),d(!1),window.location.reload()};return a.jsxs("div",{style:{padding:24},children:[a.jsxs("form",{onSubmit:P,style:{marginBottom:32,background:"#f7f7f7",padding:16,borderRadius:8},children:[a.jsx("h4",{children:"Add Medic Profile"}),a.jsxs("select",{name:"section",value:o.section,onChange:b,children:[a.jsx("option",{value:"verify",children:"Verify Prescription"}),a.jsx("option",{value:"consult",children:"Get Consultation"})]}),a.jsx("input",{name:"photo",value:o.photo,onChange:b,placeholder:"Photo URL",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"name",value:o.name,onChange:b,placeholder:"Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"profession",value:o.profession,onChange:b,placeholder:"Profession",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"license",value:o.license,onChange:b,placeholder:"License Number",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"pharmacyName",value:o.pharmacyName||"",onChange:b,placeholder:"Pharmacy Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"languages",value:o.languages,onChange:b,placeholder:"Languages (comma separated)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"whatsapp",value:o.whatsapp,onChange:b,placeholder:"WhatsApp Number (e.g. 2348012345678)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("button",{type:"submit",disabled:c,style:{marginTop:10},children:"Add Medic"})]}),a.jsx("h4",{children:"Verify Prescription Medics"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[...t,...i].sort((k,N)=>(N.online===!0)-(k.online===!0)).map(k=>{let N=[];return Array.isArray(k.languages)?N=k.languages:typeof k.languages=="string"&&(N=k.languages.split(",").map(C=>C.trim()).filter(Boolean)),a.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:12,width:220,background:"#fff",position:"relative"},children:[a.jsx("span",{onClick:()=>v("verify",k),title:k.online?"Online":"Offline",style:{position:"absolute",top:8,right:32,width:14,height:14,borderRadius:"50%",background:k.online?"#27c93f":"#bbb",border:"2px solid #fff",boxShadow:"0 0 2px #888",cursor:"pointer"}}),a.jsx("img",{src:k.photo,alt:k.name,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:8}}),a.jsx("div",{children:a.jsx("b",{children:k.name})}),a.jsx("div",{children:k.profession}),a.jsxs("div",{children:["Pharmacy: ",k.pharmacyName||a.jsx("span",{style:{color:"#888"},children:"N/A"})]}),a.jsxs("div",{children:["License: ",k.license]}),a.jsxs("div",{children:["Languages: ",N.join(", ")]}),a.jsx("div",{children:a.jsx("a",{href:`https://wa.me/${k.whatsapp}`,target:"_blank",rel:"noopener noreferrer",children:"Chat on WhatsApp"})}),a.jsx("button",{style:{position:"absolute",bottom:8,right:8,fontSize:12},onClick:()=>{y({id:k.id,section:"verify"}),u({section:"verify",photo:k.photo,name:k.name,profession:k.profession,license:k.license,pharmacyName:k.pharmacyName,languages:Array.isArray(k.languages)?k.languages.join(", "):k.languages,whatsapp:k.whatsapp})},children:"Edit"})]},k.id)})}),a.jsx("h4",{style:{marginTop:24},children:"Consultation Medics"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[...n].sort((k,N)=>(N.online===!0)-(k.online===!0)).map(k=>{let N=[];return Array.isArray(k.languages)?N=k.languages:typeof k.languages=="string"&&(N=k.languages.split(",").map(C=>C.trim()).filter(Boolean)),a.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:12,width:220,background:"#fff",position:"relative"},children:[a.jsx("span",{onClick:()=>v("consult",k),title:k.online?"Online":"Offline",style:{position:"absolute",top:8,right:32,width:14,height:14,borderRadius:"50%",background:k.online?"#27c93f":"#bbb",border:"2px solid #fff",boxShadow:"0 0 2px #888",cursor:"pointer"}}),a.jsx("img",{src:k.photo,alt:k.name,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:8}}),a.jsx("div",{children:a.jsx("b",{children:k.name})}),a.jsx("div",{children:k.profession}),a.jsxs("div",{children:["License: ",k.license]}),a.jsxs("div",{children:["Languages: ",N.join(", ")]}),a.jsx("div",{children:a.jsx("a",{href:`https://wa.me/${k.whatsapp}`,target:"_blank",rel:"noopener noreferrer",children:"Chat on WhatsApp"})}),a.jsx("button",{style:{position:"absolute",bottom:8,right:8,fontSize:12},onClick:()=>{y({id:k.id,section:"consult"}),u({section:"consult",photo:k.photo,name:k.name,profession:k.profession,license:k.license,languages:Array.isArray(k.languages)?k.languages.join(", "):k.languages,whatsapp:k.whatsapp})},children:"Edit"})]},k.id)})})]})}function ej(){const[t,e]=j.useState(!1),n=()=>{if(!(d!=null&&d.pharmacist))return null;const{name:V,photo:L,whatsapp:x}=d.pharmacist;return a.jsxs("button",{onClick:()=>{x&&window.open(`https://wa.me/${x}`,"_blank")},style:{position:"fixed",top:"80px",right:"32px",background:"#fff",color:"#7c3aed",border:"1px solid #7c3aed",borderRadius:"50px",boxShadow:"0 2px 8px rgba(0,0,0,0.10)",padding:"4px 10px 4px 8px",fontWeight:"bold",fontSize:"13px",zIndex:1e3,cursor:"pointer",transition:"box-shadow 0.2s",opacity:.96,display:"flex",alignItems:"center",gap:"6px"},onMouseOver:f=>f.currentTarget.style.boxShadow="0 4px 16px rgba(124,58,237,0.18)",onMouseOut:f=>f.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",children:[L&&a.jsx("img",{src:L,alt:V,style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",marginRight:6}}),"Talk to ",V]})},[r,i]=j.useState(null),[s,o]=j.useState(null),u=un(),{slug:c}=dc(),[d,p]=j.useState(null),[y,v]=j.useState([]),[b,P]=j.useState([]),[k,N]=j.useState(""),[C,S]=j.useState(null),E=(V,L,x,f)=>{const m=H=>H*Math.PI/180,A=m(x-V),R=m(f-L),T=Math.sin(A/2)**2+Math.cos(m(V))*Math.cos(m(x))*Math.sin(R/2)**2;return 6371*(2*Math.atan2(Math.sqrt(T),Math.sqrt(1-T)))},D=V=>{const f=V*1.64,m=Math.max(1,Math.round(f/25*60));return{drivingKm:f,minutes:m}};return j.useEffect(()=>{const V=Un(u,L=>{i(L)});return()=>V()},[u]),j.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(V=>S({lat:V.coords.latitude,lng:V.coords.longitude}),()=>S(null))},[]),j.useEffect(()=>{if(!c)return;(async()=>{const L=hr(we(Q,"users"),Yn("slug","==",c)),x=await Rt(L);if(x.empty)console.warn("Business not found for slug:",c),p(null);else{const f=x.docs[0];p({uid:f.id,...f.data()})}})()},[c]),j.useEffect(()=>{if(!d)return;const V=hr(we(Q,"products"),Yn("ownerId","==",d.uid)),L=yt(V,x=>{const f=x.docs.map(m=>({id:m.id,...m.data()}));v(f)});return()=>L()},[d]),j.useEffect(()=>{if(!y)return;const V=(w="")=>w.toLowerCase().trim().replace(/\s+/g," "),L={pcm:"paracetamol",flagyl:"metronidazole",vit:"vitamin",ibucap:"ibuprofen",amox:"amoxicillin",diclo:"diclofenac",cipro:"ciprofloxacin",emzor:"paracetamol",fever:"paracetamol antipyretic",pain:"analgesic ibuprofen diclofenac paracetamol",headache:"paracetamol ibuprofen analgesic",infection:"antibiotic amoxicillin ciprofloxacin metronidazole",cough:"cough-suppressant expectorant syrup",cold:"decongestant antihistamine vitamin",flu:"antihistamine decongestant vitamin",malaria:"antimalarial artemether lumefantrine",stomach:"antacid omeprazole metronidazole",ulcer:"omeprazole antacid pantoprazole",diarrhea:"antidiarrheal loperamide",worm:"deworming mebendazole albendazole",allergy:"antihistamine loratadine cetirizine",inflammation:"anti-inflammatory ibuprofen diclofenac",hypertension:"antihypertensive amlodipine lisinopril",diabetes:"metformin insulin antidiabetic"},x=V(k),f=(L[x]||x).split(" "),m=y.map(w=>{var A,R;if(C&&((A=d.location)!=null&&A.latitude)&&((R=d.location)!=null&&R.longitude)){const T=E(C.lat,C.lng,d.location.latitude,d.location.longitude),{minutes:ae}=D(T);return{...w,minutesAway:ae}}return{...w,minutesAway:1/0}}).filter(w=>{const A=V(w.name),R=V(w.ingredient),T=V(w.class);return f.some(ae=>A.includes(ae)||R.includes(ae)||T.includes(ae))}).sort((w,A)=>w.minutesAway-A.minutesAway);P(m)},[y,k,C,d]),a.jsxs("div",{style:{padding:"30px"},children:[t&&a.jsxs("div",{style:{position:"fixed",top:"30px",right:"30px",background:"#7c3aed",color:"#fff",padding:"12px 24px",borderRadius:"10px",boxShadow:"0 2px 12px rgba(124,58,237,0.15)",fontWeight:"bold",fontSize:"16px",zIndex:2e3,opacity:.97,transition:"opacity 0.3s"},children:["Added to cart! ",a.jsx("a",{href:"/cart",style:{color:"#fff",textDecoration:"underline",marginLeft:10},children:"View Cart"})]}),a.jsx(n,{}),a.jsxs("h2",{children:[" ",(d==null?void 0:d.businessName)||"Pharmacy"," Shop"]}),a.jsx("p",{children:"Browse medicines below. Login only required for purchase."}),a.jsx("div",{style:{margin:"15px 0"},children:a.jsx("input",{type:"text",placeholder:"Search by medicine name, ingredient, or class...",value:k,onChange:V=>N(V.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc"}})}),b.length===0?a.jsx("p",{children:"No medicines found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"20px"},children:b.map(V=>a.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"10px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.1)",position:"relative",minHeight:"220px"},children:[V.image&&a.jsx("img",{src:V.image,alt:V.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"10px"}}),a.jsx("strong",{children:V.name||"Unnamed Drug"}),a.jsx("p",{children:a.jsx("em",{children:V.ingredient||"No ingredient listed"})}),a.jsxs("p",{children:["Class: ",V.class||"No class listed"]}),a.jsxs("p",{children:["Price: ",V.price!==void 0?V.price:"N/A"]}),a.jsxs("p",{style:{fontSize:"0.9em",color:"#555"},children:[" ",d!=null&&d.businessName&&d.businessName.trim()?d.businessName:"Unknown Pharmacy"]}),a.jsx("button",{onClick:async()=>{if(!r)return alert("Please log in first");const L=fe(Q,"carts",r.uid),x=await At(L);let f=x.exists()?x.data().items||[]:[];const m=f.findIndex(w=>w.name===V.name);m>=0?f[m].quantity+=1:f.push({...V,quantity:1}),await Cn(L,{items:f}),o(V.id),e(!0),setTimeout(()=>e(!1),1800),setTimeout(()=>o(null),1e3)},style:{marginTop:"10px"},children:"Add to Cart"}),s===V.id&&a.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",background:"#4caf50",color:"#fff",padding:"3px 6px",borderRadius:"4px",fontSize:"12px"},children:"Added!"}),V.minutesAway!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500",fontSize:"0.9em"},children:V.minutesAway<=1?" Right here":` ~${V.minutesAway} mins away`})]},V.id))})]})}function tj(t,e,n,r){const i=p=>p*Math.PI/180,o=i(n-t),u=i(r-e),c=Math.sin(o/2)**2+Math.cos(i(t))*Math.cos(i(n))*Math.sin(u/2)**2;return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function nj(){const[t,e]=j.useState([]),[n,r]=j.useState(null),[i,s]=j.useState(""),o=cc();j.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(d=>r({lat:d.coords.latitude,lng:d.coords.longitude}),()=>r(null))},[]),j.useEffect(()=>{async function d(){const y=(await Rt(we(Q,"users"))).docs.map(v=>({id:v.id,...v.data()})).filter(v=>v.role==="medicine-manager");e(y)}d()},[]);const c=t.map(d=>{let p=1/0;return n&&d.location&&d.location.latitude&&d.location.longitude&&(p=tj(n.lat,n.lng,d.location.latitude,d.location.longitude)),{...d,distance:p}}).sort((d,p)=>d.distance-p.distance).filter(d=>{var p;return(p=d.businessName)==null?void 0:p.toLowerCase().includes(i.toLowerCase())});return a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:"Registered Medicine Retailers"}),a.jsx("p",{style:{color:"#7c3aed",fontWeight:"bold",marginBottom:"10px"},children:t.length>0?`${t.length} businesses found`:"No businesses loaded yet."}),a.jsx("input",{type:"text",placeholder:"Search by business name...",value:i,onChange:d=>s(d.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc",marginBottom:"20px"}}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:"24px"},children:c.map(d=>a.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"12px",padding:"18px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.08)",cursor:d.slug?"pointer":"not-allowed",opacity:d.slug?1:.6,transition:"box-shadow 0.2s"},onClick:()=>d.slug&&o(`/store/${d.slug}`),children:[a.jsx("h3",{style:{marginBottom:"8px",color:"#7c3aed"},children:d.businessName||a.jsx("span",{style:{color:"#e53935"},children:"No name"})}),a.jsx("p",{style:{marginBottom:"6px",color:"#555"},children:d.address||a.jsx("span",{style:{color:"#888"},children:"No address provided"})}),d.distance!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500"},children:d.distance<1?" Very close":`~${d.distance.toFixed(1)} km away`}),a.jsxs("p",{style:{fontSize:"0.9em",color:"#888"},children:["Role: ",d.role||a.jsx("span",{style:{color:"#e53935"},children:"No role"})]}),!d.slug&&a.jsx("p",{style:{color:"#e53935",fontSize:"0.9em",marginTop:"8px"},children:"No store link available"})]},d.id))}),c.length===0&&a.jsxs("p",{style:{color:"gray",marginTop:"30px"},children:["No businesses match your search.",a.jsx("br",{}),t.length===0&&a.jsx("span",{children:"Check if any businesses are registered in Firestore."})]})]})}var vE={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(zE,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,s=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,u={},c=0,d={};function p(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var w=V(m);w.chunkSize=parseInt(w.chunkSize),m.step||m.chunk||(w.chunkSize=null),this._handle=new k(w),(this._handle.streamer=this)._config=w}).call(this,f),this.parseChunk=function(m,w){var A=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<A){let T=this._config.newline;T||(R=this._config.quoteChar||'"',T=this._handle.guessLineEndings(m,R)),m=[...m.split(T).slice(A)].join(T)}this.isFirstChunk&&x(this._config.beforeFirstChunk)&&(R=this._config.beforeFirstChunk(m))!==void 0&&(m=R),this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+m,R=(this._partialLine="",this._handle.parse(A,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(m=R.meta.cursor,A=(this._finished||(this._partialLine=A.substring(m-this._baseIndex),this._baseIndex=m),R&&R.data&&(this._rowCount+=R.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:R,workerId:d.WORKER_ID,finished:A});else if(x(this._config.chunk)&&!w){if(this._config.chunk(R,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=R=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(R.data),this._completeResults.errors=this._completeResults.errors.concat(R.errors),this._completeResults.meta=R.meta),this._completed||!A||!x(this._config.complete)||R&&R.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||R&&R.meta.paused||this._nextChunk(),R}this._halted=!0},this._sendError=function(m){x(this._config.error)?this._config.error(m):o&&this._config.error&&r.postMessage({workerId:d.WORKER_ID,error:m,finished:!1})}}function y(f){var m;(f=f||{}).chunkSize||(f.chunkSize=d.RemoteChunkSize),p.call(this,f),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(w){this._input=w,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),s||(m.onload=L(this._chunkLoaded,this),m.onerror=L(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var w,A=this._config.downloadRequestHeaders;for(w in A)m.setRequestHeader(w,A[w])}var R;this._config.chunkSize&&(R=this._start+this._config.chunkSize-1,m.setRequestHeader("Range","bytes="+this._start+"-"+R));try{m.send(this._config.downloadRequestBody)}catch(T){this._chunkError(T.message)}s&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize||m.responseText.length,this._finished=!this._config.chunkSize||this._start>=(w=>(w=w.getResponseHeader("Content-Range"))!==null?parseInt(w.substring(w.lastIndexOf("/")+1)):-1)(m),this.parseChunk(m.responseText)))},this._chunkError=function(w){w=m.statusText||w,this._sendError(new Error(w))}}function v(f){(f=f||{}).chunkSize||(f.chunkSize=d.LocalChunkSize),p.call(this,f);var m,w,A=typeof FileReader<"u";this.stream=function(R){this._input=R,w=R.slice||R.webkitSlice||R.mozSlice,A?((m=new FileReader).onload=L(this._chunkLoaded,this),m.onerror=L(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var R=this._input,T=(this._config.chunkSize&&(T=Math.min(this._start+this._config.chunkSize,this._input.size),R=w.call(R,this._start,T)),m.readAsText(R,this._config.encoding));A||this._chunkLoaded({target:{result:T}})},this._chunkLoaded=function(R){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(R.target.result)},this._chunkError=function(){this._sendError(m.error)}}function b(f){var m;p.call(this,f=f||{}),this.stream=function(w){return m=w,this._nextChunk()},this._nextChunk=function(){var w,A;if(!this._finished)return w=this._config.chunkSize,m=w?(A=m.substring(0,w),m.substring(w)):(A=m,""),this._finished=!m,this.parseChunk(A)}}function P(f){p.call(this,f=f||{});var m=[],w=!0,A=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(R){this._input=R,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):w=!0},this._streamData=L(function(R){try{m.push(typeof R=="string"?R:R.toString(this._config.encoding)),w&&(w=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(T){this._streamError(T)}},this),this._streamError=L(function(R){this._streamCleanUp(),this._sendError(R)},this),this._streamEnd=L(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(f){var m,w,A,R,T=Math.pow(2,53),ae=-T,H=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,te=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ee=this,M=0,F=0,W=!1,q=!1,G=[],O={data:[],errors:[],meta:{}};function X(ne){return f.skipEmptyLines==="greedy"?ne.join("").trim()==="":ne.length===1&&ne[0].length===0}function z(){if(O&&A&&(pe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),A=!1),f.skipEmptyLines&&(O.data=O.data.filter(function(be){return!X(be)})),ie()){let be=function(We,Pe){x(f.transformHeader)&&(We=f.transformHeader(We,Pe)),G.push(We)};var _e=be;if(O)if(Array.isArray(O.data[0])){for(var ne=0;ie()&&ne<O.data.length;ne++)O.data[ne].forEach(be);O.data.splice(0,1)}else O.data.forEach(be)}function Te(be,We){for(var Pe=f.header?{}:[],Re=0;Re<be.length;Re++){var ye=Re,Je=be[Re],Je=((ve,ke)=>(Ne=>(f.dynamicTypingFunction&&f.dynamicTyping[Ne]===void 0&&(f.dynamicTyping[Ne]=f.dynamicTypingFunction(Ne)),(f.dynamicTyping[Ne]||f.dynamicTyping)===!0))(ve)?ke==="true"||ke==="TRUE"||ke!=="false"&&ke!=="FALSE"&&((Ne=>{if(H.test(Ne)&&(Ne=parseFloat(Ne),ae<Ne&&Ne<T))return 1})(ke)?parseFloat(ke):te.test(ke)?new Date(ke):ke===""?null:ke):ke)(ye=f.header?Re>=G.length?"__parsed_extra":G[Re]:ye,Je=f.transform?f.transform(Je,ye):Je);ye==="__parsed_extra"?(Pe[ye]=Pe[ye]||[],Pe[ye].push(Je)):Pe[ye]=Je}return f.header&&(Re>G.length?pe("FieldMismatch","TooManyFields","Too many fields: expected "+G.length+" fields but parsed "+Re,F+We):Re<G.length&&pe("FieldMismatch","TooFewFields","Too few fields: expected "+G.length+" fields but parsed "+Re,F+We)),Pe}var De;O&&(f.header||f.dynamicTyping||f.transform)&&(De=1,!O.data.length||Array.isArray(O.data[0])?(O.data=O.data.map(Te),De=O.data.length):O.data=Te(O.data,0),f.header&&O.meta&&(O.meta.fields=G),F+=De)}function ie(){return f.header&&G.length===0}function pe(ne,Te,De,_e){ne={type:ne,code:Te,message:De},_e!==void 0&&(ne.row=_e),O.errors.push(ne)}x(f.step)&&(R=f.step,f.step=function(ne){O=ne,ie()?z():(z(),O.data.length!==0&&(M+=ne.data.length,f.preview&&M>f.preview?w.abort():(O.data=O.data[0],R(O,ee))))}),this.parse=function(ne,Te,De){var _e=f.quoteChar||'"',_e=(f.newline||(f.newline=this.guessLineEndings(ne,_e)),A=!1,f.delimiter?x(f.delimiter)&&(f.delimiter=f.delimiter(ne),O.meta.delimiter=f.delimiter):((_e=((be,We,Pe,Re,ye)=>{var Je,ve,ke,Ne;ye=ye||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var qt=0;qt<ye.length;qt++){for(var it,Lt=ye[qt],Qe=0,vt=0,xe=0,Oe=(ke=void 0,new C({comments:Re,delimiter:Lt,newline:We,preview:10}).parse(be)),Ye=0;Ye<Oe.data.length;Ye++)Pe&&X(Oe.data[Ye])?xe++:(it=Oe.data[Ye].length,vt+=it,ke===void 0?ke=it:0<it&&(Qe+=Math.abs(it-ke),ke=it));0<Oe.data.length&&(vt/=Oe.data.length-xe),(ve===void 0||Qe<=ve)&&(Ne===void 0||Ne<vt)&&1.99<vt&&(ve=Qe,Je=Lt,Ne=vt)}return{successful:!!(f.delimiter=Je),bestDelimiter:Je}})(ne,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess)).successful?f.delimiter=_e.bestDelimiter:(A=!0,f.delimiter=d.DefaultDelimiter),O.meta.delimiter=f.delimiter),V(f));return f.preview&&f.header&&_e.preview++,m=ne,w=new C(_e),O=w.parse(m,Te,De),z(),W?{meta:{paused:!0}}:O||{meta:{paused:!1}}},this.paused=function(){return W},this.pause=function(){W=!0,w.abort(),m=x(f.chunk)?"":m.substring(w.getCharIndex())},this.resume=function(){ee.streamer._halted?(W=!1,ee.streamer.parseChunk(m,!0)):setTimeout(ee.resume,3)},this.aborted=function(){return q},this.abort=function(){q=!0,w.abort(),O.meta.aborted=!0,x(f.complete)&&f.complete(O),m=""},this.guessLineEndings=function(be,_e){be=be.substring(0,1048576);var _e=new RegExp(N(_e)+"([^]*?)"+N(_e),"gm"),De=(be=be.replace(_e,"")).split("\r"),_e=be.split(`
`),be=1<_e.length&&_e[0].length<De[0].length;if(De.length===1||be)return`
`;for(var We=0,Pe=0;Pe<De.length;Pe++)De[Pe][0]===`
`&&We++;return We>=De.length/2?`\r
`:"\r"}}function N(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(f){var m=(f=f||{}).delimiter,w=f.newline,A=f.comments,R=f.step,T=f.preview,ae=f.fastMode,H=null,te=!1,ee=f.quoteChar==null?'"':f.quoteChar,M=ee;if(f.escapeChar!==void 0&&(M=f.escapeChar),(typeof m!="string"||-1<d.BAD_DELIMITERS.indexOf(m))&&(m=","),A===m)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<d.BAD_DELIMITERS.indexOf(A))&&(A=!1),w!==`
`&&w!=="\r"&&w!==`\r
`&&(w=`
`);var F=0,W=!1;this.parse=function(q,G,O){if(typeof q!="string")throw new Error("Input must be a string");var X=q.length,z=m.length,ie=w.length,pe=A.length,ne=x(R),Te=[],De=[],_e=[],be=F=0;if(!q)return Qe();if(ae||ae!==!1&&q.indexOf(ee)===-1){for(var We=q.split(w),Pe=0;Pe<We.length;Pe++){if(_e=We[Pe],F+=_e.length,Pe!==We.length-1)F+=w.length;else if(O)return Qe();if(!A||_e.substring(0,pe)!==A){if(ne){if(Te=[],Ne(_e.split(m)),vt(),W)return Qe()}else Ne(_e.split(m));if(T&&T<=Pe)return Te=Te.slice(0,T),Qe(!0)}}return Qe()}for(var Re=q.indexOf(m,F),ye=q.indexOf(w,F),Je=new RegExp(N(M)+N(ee),"g"),ve=q.indexOf(ee,F);;)if(q[F]===ee)for(ve=F,F++;;){if((ve=q.indexOf(ee,ve+1))===-1)return O||De.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Te.length,index:F}),it();if(ve===X-1)return it(q.substring(F,ve).replace(Je,ee));if(ee===M&&q[ve+1]===M)ve++;else if(ee===M||ve===0||q[ve-1]!==M){Re!==-1&&Re<ve+1&&(Re=q.indexOf(m,ve+1));var ke=qt((ye=ye!==-1&&ye<ve+1?q.indexOf(w,ve+1):ye)===-1?Re:Math.min(Re,ye));if(q.substr(ve+1+ke,z)===m){_e.push(q.substring(F,ve).replace(Je,ee)),q[F=ve+1+ke+z]!==ee&&(ve=q.indexOf(ee,F)),Re=q.indexOf(m,F),ye=q.indexOf(w,F);break}if(ke=qt(ye),q.substring(ve+1+ke,ve+1+ke+ie)===w){if(_e.push(q.substring(F,ve).replace(Je,ee)),Lt(ve+1+ke+ie),Re=q.indexOf(m,F),ve=q.indexOf(ee,F),ne&&(vt(),W))return Qe();if(T&&Te.length>=T)return Qe(!0);break}De.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Te.length,index:F}),ve++}}else if(A&&_e.length===0&&q.substring(F,F+pe)===A){if(ye===-1)return Qe();F=ye+ie,ye=q.indexOf(w,F),Re=q.indexOf(m,F)}else if(Re!==-1&&(Re<ye||ye===-1))_e.push(q.substring(F,Re)),F=Re+z,Re=q.indexOf(m,F);else{if(ye===-1)break;if(_e.push(q.substring(F,ye)),Lt(ye+ie),ne&&(vt(),W))return Qe();if(T&&Te.length>=T)return Qe(!0)}return it();function Ne(xe){Te.push(xe),be=F}function qt(xe){var Oe=0;return Oe=xe!==-1&&(xe=q.substring(ve+1,xe))&&xe.trim()===""?xe.length:Oe}function it(xe){return O||(xe===void 0&&(xe=q.substring(F)),_e.push(xe),F=X,Ne(_e),ne&&vt()),Qe()}function Lt(xe){F=xe,Ne(_e),_e=[],ye=q.indexOf(w,F)}function Qe(xe){if(f.header&&!G&&Te.length&&!te){var Oe=Te[0],Ye=Object.create(null),Jn=new Set(Oe);let Ht=!1;for(let hn=0;hn<Oe.length;hn++){let qe=Oe[hn];if(Ye[qe=x(f.transformHeader)?f.transformHeader(qe,hn):qe]){let fn,Zn=Ye[qe];for(;fn=qe+"_"+Zn,Zn++,Jn.has(fn););Jn.add(fn),Oe[hn]=fn,Ye[qe]++,Ht=!0,(H=H===null?{}:H)[fn]=qe}else Ye[qe]=1,Oe[hn]=qe;Jn.add(qe)}Ht&&console.warn("Duplicate headers found and renamed."),te=!0}return{data:Te,errors:De,meta:{delimiter:m,linebreak:w,aborted:W,truncated:!!xe,cursor:be+(G||0),renamedHeaders:H}}}function vt(){R(Qe()),Te=[],De=[]}},this.abort=function(){W=!0},this.getCharIndex=function(){return F}}function S(f){var m=f.data,w=u[m.workerId],A=!1;if(m.error)w.userError(m.error,m.file);else if(m.results&&m.results.data){var R={abort:function(){A=!0,E(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:D,resume:D};if(x(w.userStep)){for(var T=0;T<m.results.data.length&&(w.userStep({data:m.results.data[T],errors:m.results.errors,meta:m.results.meta},R),!A);T++);delete m.results}else x(w.userChunk)&&(w.userChunk(m.results,R,m.file),delete m.results)}m.finished&&!A&&E(m.workerId,m.results)}function E(f,m){var w=u[f];x(w.userComplete)&&w.userComplete(m),w.terminate(),delete u[f]}function D(){throw new Error("Not implemented.")}function V(f){if(typeof f!="object"||f===null)return f;var m,w=Array.isArray(f)?[]:{};for(m in f)w[m]=V(f[m]);return w}function L(f,m){return function(){f.apply(m,arguments)}}function x(f){return typeof f=="function"}return d.parse=function(f,m){var w=(m=m||{}).dynamicTyping||!1;if(x(w)&&(m.dynamicTypingFunction=w,w={}),m.dynamicTyping=w,m.transform=!!x(m.transform)&&m.transform,!m.worker||!d.WORKERS_SUPPORTED)return w=null,d.NODE_STREAM_INPUT,typeof f=="string"?(f=(A=>A.charCodeAt(0)!==65279?A:A.slice(1))(f),w=new(m.download?y:b)(m)):f.readable===!0&&x(f.read)&&x(f.on)?w=new P(m):(r.File&&f instanceof File||f instanceof Object)&&(w=new v(m)),w.stream(f);(w=(()=>{var A;return!!d.WORKERS_SUPPORTED&&(A=(()=>{var R=r.URL||r.webkitURL||null,T=n.toString();return d.BLOB_URL||(d.BLOB_URL=R.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",T,")();"],{type:"text/javascript"})))})(),(A=new r.Worker(A)).onmessage=S,A.id=c++,u[A.id]=A)})()).userStep=m.step,w.userChunk=m.chunk,w.userComplete=m.complete,w.userError=m.error,m.step=x(m.step),m.chunk=x(m.chunk),m.complete=x(m.complete),m.error=x(m.error),delete m.worker,w.postMessage({input:f,config:m,workerId:w.id})},d.unparse=function(f,m){var w=!1,A=!0,R=",",T=`\r
`,ae='"',H=ae+ae,te=!1,ee=null,M=!1,F=((()=>{if(typeof m=="object"){if(typeof m.delimiter!="string"||d.BAD_DELIMITERS.filter(function(G){return m.delimiter.indexOf(G)!==-1}).length||(R=m.delimiter),typeof m.quotes!="boolean"&&typeof m.quotes!="function"&&!Array.isArray(m.quotes)||(w=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(te=m.skipEmptyLines),typeof m.newline=="string"&&(T=m.newline),typeof m.quoteChar=="string"&&(ae=m.quoteChar),typeof m.header=="boolean"&&(A=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");ee=m.columns}m.escapeChar!==void 0&&(H=m.escapeChar+ae),m.escapeFormulae instanceof RegExp?M=m.escapeFormulae:typeof m.escapeFormulae=="boolean"&&m.escapeFormulae&&(M=/^[=+\-@\t\r].*$/)}})(),new RegExp(N(ae),"g"));if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return W(null,f,te);if(typeof f[0]=="object")return W(ee||Object.keys(f[0]),f,te)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||ee),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),W(f.fields||[],f.data||[],te);throw new Error("Unable to serialize unrecognized input");function W(G,O,X){var z="",ie=(typeof G=="string"&&(G=JSON.parse(G)),typeof O=="string"&&(O=JSON.parse(O)),Array.isArray(G)&&0<G.length),pe=!Array.isArray(O[0]);if(ie&&A){for(var ne=0;ne<G.length;ne++)0<ne&&(z+=R),z+=q(G[ne],ne);0<O.length&&(z+=T)}for(var Te=0;Te<O.length;Te++){var De=(ie?G:O[Te]).length,_e=!1,be=ie?Object.keys(O[Te]).length===0:O[Te].length===0;if(X&&!ie&&(_e=X==="greedy"?O[Te].join("").trim()==="":O[Te].length===1&&O[Te][0].length===0),X==="greedy"&&ie){for(var We=[],Pe=0;Pe<De;Pe++){var Re=pe?G[Pe]:Pe;We.push(O[Te][Re])}_e=We.join("").trim()===""}if(!_e){for(var ye=0;ye<De;ye++){0<ye&&!be&&(z+=R);var Je=ie&&pe?G[ye]:ye;z+=q(O[Te][Je],ye)}Te<O.length-1&&(!X||0<De&&!be)&&(z+=T)}}return z}function q(G,O){var X,z;return G==null?"":G.constructor===Date?JSON.stringify(G).slice(1,25):(z=!1,M&&typeof G=="string"&&M.test(G)&&(G="'"+G,z=!0),X=G.toString().replace(F,H),(z=z||w===!0||typeof w=="function"&&w(G,O)||Array.isArray(w)&&w[O]||((ie,pe)=>{for(var ne=0;ne<pe.length;ne++)if(-1<ie.indexOf(pe[ne]))return!0;return!1})(X,d.BAD_DELIMITERS)||-1<X.indexOf(R)||X.charAt(0)===" "||X.charAt(X.length-1)===" ")?ae+X+ae:X)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!s&&!!r.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=C,d.ParserHandle=k,d.NetworkStreamer=y,d.FileStreamer=v,d.StringStreamer=b,d.ReadableStreamStreamer=P,r.jQuery&&((i=r.jQuery).fn.parse=function(f){var m=f.config||{},w=[];return this.each(function(T){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var ae=0;ae<this.files.length;ae++)w.push({file:this.files[ae],inputElem:this,instanceConfig:i.extend({},m)})}),A(),this;function A(){if(w.length===0)x(f.complete)&&f.complete();else{var T,ae,H,te,ee=w[0];if(x(f.before)){var M=f.before(ee.file,ee.inputElem);if(typeof M=="object"){if(M.action==="abort")return T="AbortError",ae=ee.file,H=ee.inputElem,te=M.reason,void(x(f.error)&&f.error({name:T},ae,H,te));if(M.action==="skip")return void R();typeof M.config=="object"&&(ee.instanceConfig=i.extend(ee.instanceConfig,M.config))}else if(M==="skip")return void R()}var F=ee.instanceConfig.complete;ee.instanceConfig.complete=function(W){x(F)&&F(W,ee.file,ee.inputElem),R()},d.parse(ee.file,ee.instanceConfig)}}function R(){w.splice(0,1),A()}}),o&&(r.onmessage=function(f){f=f.data,d.WORKER_ID===void 0&&f&&(d.WORKER_ID=f.workerId),typeof f.input=="string"?r.postMessage({workerId:d.WORKER_ID,results:d.parse(f.input,f.config),finished:!0}):(r.File&&f.input instanceof File||f.input instanceof Object)&&(f=d.parse(f.input,f.config))&&r.postMessage({workerId:d.WORKER_ID,results:f,finished:!0})}),(y.prototype=Object.create(p.prototype)).constructor=y,(v.prototype=Object.create(p.prototype)).constructor=v,(b.prototype=Object.create(b.prototype)).constructor=b,(P.prototype=Object.create(p.prototype)).constructor=P,d})})(vE);var rj=vE.exports;const _E=vv(rj),Od=["name","ingredient","class","price","image"];function ij(){const[t,e]=j.useState(""),[n,r]=j.useState("add"),s=window.location.pathname.match(/^\/store\/([^\/]+)/),[o,u]=j.useState(null);if(j.useEffect(()=>{qs(async()=>{const{getAuth:H,onAuthStateChanged:te}=await Promise.resolve().then(()=>mE);return{getAuth:H,onAuthStateChanged:te}},void 0).then(({getAuth:H,onAuthStateChanged:te})=>{const ee=H();te(ee,async M=>{if(M){const{getDoc:F,doc:W}=await qs(async()=>{const{getDoc:G,doc:O}=await Promise.resolve().then(()=>Up);return{getDoc:G,doc:O}},void 0),q=await F(W(Q,"users",M.uid));u(q.exists()?q.data().role:null)}else u(null)})})},[]),s||o==="customer")return a.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#7c3aed"},children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"This page is only for business/admin users. Please use the store features."})]});const[c,d]=j.useState(null),[p,y]=j.useState(null),[v,b]=j.useState([]),[P,k]=j.useState({name:"",ingredient:"",class:"",price:"",image:"",isPOM:!1,registeredOnly:!1}),[N,C]=j.useState(null),[S,E]=j.useState([]),[D,V]=j.useState([]),L=v.filter(H=>{var ee,M,F;const te=t.toLowerCase();return((ee=H.name)==null?void 0:ee.toLowerCase().includes(te))||((M=H.ingredient)==null?void 0:M.toLowerCase().includes(te))||((F=H.class)==null?void 0:F.toLowerCase().includes(te))}),x=un();j.useEffect(()=>{const H=Un(x,async te=>{if(te){d(te);try{const ee=await At(fe(Q,"users",te.uid));ee.exists()?y(ee.data()):y({role:"customer"})}catch(ee){console.error("Error fetching user doc:",ee),y({role:"customer"})}}else d(null),y(null)});return()=>H()},[x]),j.useEffect(()=>{if(!c)return;const H=yt(we(Q,"products"),te=>{const ee=te.docs.map(M=>({id:M.id,...M.data()})).filter(M=>M.ownerId===c.uid);b(ee)});return()=>H()},[c]),j.useEffect(()=>{if(!c)return;const H=yt(we(Q,"batches"),te=>{const ee=te.docs.map(M=>({id:M.id,...M.data()})).filter(M=>M.uploadedBy===c.uid);V(ee)});return()=>H()},[c]);const f=()=>({ownerSlug:(p==null?void 0:p.slug)||null,businessName:(p==null?void 0:p.businessName)||null}),m=async H=>{if(H.preventDefault(),!c)return alert("Please log in first");if(!p)return alert("Loading user data...");const{name:te,ingredient:ee,class:M,price:F,image:W}=P;if(!te||!ee||!M||!F)return alert("Please fill all required fields");const q=parseInt(F,10);if(isNaN(q)||q<0)return alert("Price must be a positive number");const{ownerSlug:G,businessName:O}=f(),X=(p==null?void 0:p.pharmacist)||null;try{N?(await wt(fe(Q,"products",N),{name:te,ingredient:ee,class:M,price:q,image:W||"",ownerSlug:G||"",businessName:O||"",isPOM:!!P.isPOM,registeredOnly:!!P.registeredOnly,pharmacist:X||null}),C(null)):await ts(we(Q,"products"),{name:te,ingredient:ee,class:M,price:q,image:W||"",ownerId:c.uid,ownerSlug:G||"",businessName:O||"",isPOM:!!P.isPOM,registeredOnly:!!P.registeredOnly,pharmacist:X||null}),k({name:"",ingredient:"",class:"",price:"",image:"",isPOM:!1,registeredOnly:!1})}catch(z){console.error(z),alert("Error saving medicine")}},w=H=>{const te=H.target.files[0];te&&_E.parse(te,{header:!0,skipEmptyLines:!0,complete:ee=>{const M=ee.data.map(F=>{const W={};return Od.forEach(q=>W[q]=F[q]||(q==="price"?0:"N/A")),W});E(M)}})},A=async()=>{if(!S.length)return alert("No CSV data to upload");if(!c)return alert("Please log in first");if(!p)return alert("Loading user data...");const H=fe(we(Q,"batches")),te=[],{ownerSlug:ee,businessName:M}=f(),F=(p==null?void 0:p.pharmacist)||null;for(let W of S)try{const q=await ts(we(Q,"products"),{name:W.name,ingredient:W.ingredient,class:W.class,price:parseInt(W.price,10)||0,image:W.image==="N/A"?"":W.image,batchId:H.id,ownerId:c.uid,ownerSlug:ee||"",businessName:M||"",isPOM:!!W.isPOM,pharmacist:F||null});te.push(q.id)}catch(q){console.error("CSV upload error for row:",W,q)}try{await Cn(H,{name:`CSV Upload - ${new Date().toLocaleString()}`,uploadedBy:c.uid,date:new Date().toISOString(),medicineIds:te})}catch(W){console.error("Failed to create batch doc:",W)}alert(` ${te.length} medicines uploaded`),E([])},R=H=>{k({name:H.name,ingredient:H.ingredient,class:H.class,price:H.price,image:H.image||"",isPOM:!!H.isPOM}),C(H.id),r("add")},T=async H=>{if(window.confirm("Delete this medicine?"))try{await Mn(fe(Q,"products",H.id))}catch(te){console.error(te),alert("Error deleting medicine")}},ae=async H=>{if(window.confirm("Delete this batch and its medicines?"))try{for(let te of H.medicineIds)await Mn(fe(Q,"products",te));await Mn(fe(Q,"batches",H.id))}catch(te){console.error(te),alert("Error deleting batch")}};return c?p?p.role!=="medicine-manager"&&p.role!=="admin"?a.jsx("p",{children:"Access denied. Medicine managers only."}):a.jsxs("div",{style:{padding:"30px",maxWidth:"1200px",margin:"auto"},children:[a.jsx("h2",{children:"Medicine Management"}),a.jsxs("p",{children:["Logged in as: ",c.email]}),a.jsxs("div",{style:{display:"flex",marginTop:30,gap:20},children:[a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:n==="add"?"2px solid #1976d2":"1px solid #ccc",background:n==="add"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>r("add"),children:"Add Medicines"}),a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:n==="manage"?"2px solid #1976d2":"1px solid #ccc",background:n==="manage"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>r("manage"),children:"Manage Products"}),a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:n==="pharmacist"?"2px solid #1976d2":"1px solid #ccc",background:n==="pharmacist"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>r("pharmacist"),children:"Pharmacist Management"})]}),a.jsxs("div",{style:{marginTop:30},children:[n==="add"&&a.jsxs("div",{style:{background:"#f8f8ff",padding:"24px",borderRadius:"12px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Add Medicines"}),a.jsxs("form",{onSubmit:m,style:{marginBottom:"20px"},children:[a.jsx("h4",{children:N?"Edit Medicine":"Add Medicine"}),a.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Name",value:P.name,onChange:H=>k({...P,name:H.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"text",placeholder:"Ingredient",value:P.ingredient,onChange:H=>k({...P,ingredient:H.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"text",placeholder:"Class",value:P.class,onChange:H=>k({...P,class:H.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"number",placeholder:"Price ()",value:P.price,onChange:H=>k({...P,price:H.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"text",placeholder:"Image URL",value:P.image,onChange:H=>k({...P,image:H.target.value}),style:{flex:1}})]}),a.jsx("div",{style:{marginTop:"10px"},children:a.jsxs("label",{style:{marginRight:"20px"},children:[a.jsx("input",{type:"checkbox",checked:P.isPOM,onChange:H=>k({...P,isPOM:H.target.checked})})," Prescription Only (POM)"]})}),a.jsx("button",{type:"submit",style:{marginTop:"15px",background:"#7c3aed",color:"#fff",padding:"8px 16px",borderRadius:"6px"},children:N?"Update Medicine":"Add Medicine"}),N&&a.jsx("button",{type:"button",style:{marginLeft:"10px"},onClick:()=>{C(null),k({name:"",ingredient:"",class:"",price:"",image:"",isPOM:!1,registeredOnly:!1})},children:"Cancel"})]}),a.jsxs("div",{children:[a.jsx("h4",{children:"Bulk Add Medicines via CSV"}),a.jsx("input",{type:"file",accept:".csv",onChange:w,style:{marginBottom:"10px"}}),S.length>0&&a.jsxs("div",{children:[a.jsx("h5",{children:"CSV Preview"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"10px"},children:[a.jsx("thead",{children:a.jsx("tr",{children:Od.map(H=>a.jsx("th",{children:H},H))})}),a.jsx("tbody",{children:S.map((H,te)=>a.jsx("tr",{children:Od.map(ee=>a.jsx("td",{children:H[ee]},ee))},te))})]}),a.jsx("button",{onClick:A,style:{background:"#7c3aed",color:"#fff",padding:"8px 16px",borderRadius:"6px"},children:"Upload Medicines"})]})]})]}),n==="manage"&&a.jsxs("div",{style:{background:"#f4f4fa",padding:"24px",borderRadius:"12px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Manage Products"}),a.jsx("h4",{children:"Uploaded CSV Batches"}),D.length===0?a.jsx("p",{children:"No CSV batches uploaded yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Batch Name"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Medicines Count"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:D.map(H=>{var te;return a.jsxs("tr",{children:[a.jsx("td",{children:H.name}),a.jsx("td",{children:new Date(H.date).toLocaleString()}),a.jsx("td",{children:((te=H.medicineIds)==null?void 0:te.length)||0}),a.jsx("td",{children:a.jsx("button",{onClick:()=>ae(H),style:{background:"#e53935",color:"#fff",padding:"6px 12px",borderRadius:"6px"},children:"Delete Batch"})})]},H.id)})})]}),a.jsx("h4",{style:{marginTop:"32px"},children:"Your Medicines"}),a.jsx("input",{type:"text",placeholder:"Search by name, ingredient, or class...",style:{width:"100%",marginBottom:16,padding:8,borderRadius:6,border:"1px solid #ccc"},value:t,onChange:H=>e(H.target.value)}),L.length===0?a.jsx("p",{children:"No medicines found."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{borderBottom:"1px solid #ccc"},children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Ingredient"}),a.jsx("th",{children:"Class"}),a.jsx("th",{children:"Price ()"}),a.jsx("th",{children:"POM"}),a.jsx("th",{children:"Image"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:L.map(H=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{children:H.name}),a.jsx("td",{children:H.ingredient}),a.jsx("td",{children:H.class}),a.jsx("td",{children:H.price}),a.jsx("td",{children:H.isPOM?a.jsx("span",{style:{background:"#e53935",color:"#fff",padding:"2px 8px",borderRadius:"6px",fontSize:"12px"},children:"POM"}):null}),a.jsx("td",{children:H.image&&a.jsx("img",{src:H.image,alt:H.name,style:{width:"50px",height:"50px",objectFit:"cover"}})}),a.jsxs("td",{children:[a.jsx("button",{onClick:()=>R(H),style:{marginRight:"5px"},children:"Edit"}),a.jsx("button",{onClick:()=>T(H),children:"Delete"})]})]},H.id))})]})]}),n==="pharmacist"&&a.jsxs("div",{style:{background:"#f8f8ff",padding:"24px",borderRadius:"12px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Pharmacist Management"}),(p==null?void 0:p.role)==="medicine-manager"&&a.jsx(sj,{userId:c.uid})]})]})]}):a.jsx("p",{children:"Loading user data..."}):a.jsx("p",{children:"Please log in to access this page."})}function sj({userId:t}){const[e,n]=Ue.useState(null),[r,i]=Ue.useState({photo:"",name:"",profession:"Pharmacist",license:"",pharmacyName:"",languages:"",whatsapp:""}),[s,o]=Ue.useState(!1),[u,c]=Ue.useState(!1);Ue.useEffect(()=>{const y=fe(Q,"users",t);At(y).then(v=>{const b=v.data();b&&b.pharmacist&&(n(b.pharmacist),i({...b.pharmacist}),o(!0))})},[t]);const d=y=>{i({...r,[y.target.name]:y.target.value})},p=async y=>{y.preventDefault(),c(!0),await wt(fe(Q,"users",t),{pharmacist:{...r}}),n({...r}),o(!0),c(!1),alert("Pharmacist info saved!")};return a.jsxs("div",{style:{marginTop:40,background:"#f7f7f7",padding:24,borderRadius:10},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Manage Pharmacist"}),a.jsxs("form",{onSubmit:p,style:{marginBottom:16},children:[a.jsx("input",{name:"photo",value:r.photo,onChange:d,placeholder:"Photo URL",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"name",value:r.name,onChange:d,placeholder:"Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"profession",value:r.profession,onChange:d,placeholder:"Profession",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"license",value:r.license,onChange:d,placeholder:"License Number",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"pharmacyName",value:r.pharmacyName,onChange:d,placeholder:"Pharmacy Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"languages",value:r.languages,onChange:d,placeholder:"Languages (comma separated)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"whatsapp",value:r.whatsapp,onChange:d,placeholder:"WhatsApp Number (e.g. 2348012345678)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("button",{type:"submit",disabled:u,style:{marginTop:10},children:s?"Update Pharmacist":"Add Pharmacist"})]}),e&&a.jsxs("div",{style:{marginTop:16,background:"#fff",padding:16,borderRadius:8,boxShadow:"0 1px 4px #e0e0e0"},children:[a.jsx("img",{src:e.photo,alt:e.name,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:8}}),a.jsx("div",{children:a.jsx("b",{children:e.name})}),a.jsx("div",{children:e.profession}),a.jsxs("div",{children:["Pharmacy: ",e.pharmacyName]}),a.jsxs("div",{children:["License: ",e.license]}),a.jsxs("div",{children:["Languages: ",e.languages]}),a.jsx("div",{children:a.jsx("a",{href:`https://wa.me/${e.whatsapp}`,target:"_blank",rel:"noopener noreferrer",children:"Chat on WhatsApp"})})]})]})}var ja=function(){return ja=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ja.apply(this,arguments)};function Qp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}var Ml=[];function oj(){var t="https://js.paystack.co/v1/inline.js",e=j.useState({loaded:!1,error:!1}),n=e[0],r=e[1];return j.useEffect(function(){if(Ml.includes(t))r({loaded:!0,error:!1});else{Ml.push(t);var i=document.createElement("script");i.src=t,i.async=!0;var s=function(){r({loaded:!0,error:!1})},o=function(){var u=Ml.indexOf(t);u>=0&&Ml.splice(u,1),i.remove(),r({loaded:!0,error:!0})};return i.addEventListener("load",s),i.addEventListener("complete",s),i.addEventListener("error",o),document.body.appendChild(i),function(){i.removeEventListener("load",s),i.removeEventListener("error",o)}}},[t]),[n.loaded,n.error]}var aj=function(t){var e=window.PaystackPop&&window.PaystackPop.setup(t);e&&e.openIframe()};function xE(t){var e=oj(),n=e[0],r=e[1];function i(s){var o=s.config,u=s.onSuccess,c=s.onClose;if(r)throw new Error("Unable to load paystack inline script");var d=ja(ja({},t),o),p=d.publicKey,y=d.firstname,v=d.lastname,b=d.phone,P=d.email,k=d.amount,N=d.reference,C=d.metadata,S=C===void 0?{}:C,E=d.currency,D=E===void 0?"NGN":E,V=d.channels,L=d.label,x=L===void 0?"":L,f=d.plan,m=f===void 0?"":f,w=d.quantity,A=w===void 0?"":w,R=d.subaccount,T=R===void 0?"":R,ae=d.transaction_charge,H=ae===void 0?0:ae,te=d.bearer,ee=te===void 0?"account":te,M=d.split,F=d.split_code;if(n){var W={callback:u||function(){return null},onClose:c||function(){return null},key:p,ref:N,email:P,firstname:y,lastname:v,phone:b,amount:k,currency:D,plan:m,quantity:A,channels:V,subaccount:T,transaction_charge:H,bearer:ee,label:x,metadata:S,split:M,split_code:F,"data-custom-button":d["data-custom-button"]||""};aj(W)}}return j.useEffect(function(){if(r)throw new Error("Unable to load paystack inline script")},[r]),i}var lj=function(t){var e=t.text,n=t.className,r=t.children,i=t.onSuccess,s=t.onClose,o=Qp(t,["text","className","children","onSuccess","onClose"]),u=xE(o);return Ue.createElement("button",{className:n,onClick:function(){return u({config:o,onSuccess:i,onClose:s})}},e||r)},wE=j.createContext({config:{},initializePayment:function(){return null},onSuccess:function(){return null},onClose:function(){return null}}),uj=function(t){var e=t.children,n=t.onSuccess,r=t.onClose,i=Qp(t,["children","onSuccess","onClose"]),s=xE(i);return Ue.createElement(wE.Provider,{value:{config:i,initializePayment:s,onSuccess:n,onClose:r}},e)},cj=function(t){var e=t.children,n=t.ref,r=j.useContext(wE),i=r.config,s=r.initializePayment,o=r.onSuccess,u=r.onClose,c=function(){return s({config:i,onSuccess:o,onClose:u})};return e({initializePayment:c,ref:n})};j.forwardRef(function(t,e){var n=t.children,r=t.onSuccess,i=t.onClose,s=Qp(t,["children","onSuccess","onClose"]),o=r||function(){return null},u=i||function(){return null};return Ue.createElement(uj,ja({},s,{onSuccess:o,onClose:u}),Ue.createElement(cj,{ref:e},n))});async function dj(t){if(!t)return null;const e=hr(we(Q,"coupons"),Yn("code","==",t)),n=await Rt(e);return n.empty?null:n.docs[0].data()}function hj(){var ee,M;const[t,e]=j.useState(""),[n,r]=j.useState(null),[i,s]=j.useState(""),o=un(),u=cc(),c=ho(),[d,p]=j.useState(null),[y,v]=j.useState(((ee=c.state)==null?void 0:ee.cart)||[]),[b,P]=j.useState(((M=c.state)==null?void 0:M.total)||0),[k,N]=j.useState("standard"),[C,S]=j.useState(500),[E,D]=j.useState(1e3),[V,L]=j.useState(b+C),[x,f]=j.useState({name:"",phone:"",address:"",city:"",state:"",instructions:""}),m="pk_live_2d4df84806ccc14243f39a9df0bb0a38373ffcc8";j.useEffect(()=>Un(o,async W=>{if(!W)return u("/auth");if(p(W),y.length===0){const q=fe(Q,"carts",W.uid),G=await At(q);if(G.exists()){const O=G.data().items||[];v(O);const X=O.reduce((z,ie)=>z+ie.price*(ie.quantity||1),0);P(X),L(X+C)}}}),[o,y.length,C,u]),j.useEffect(()=>{let F=y.some(O=>O.isPOM)?500:0,W=C,q=b,G=0;n&&(n.removePOM&&(F=0),n.removeDelivery&&(W=0),n.percent>0&&(G=Math.round((q+F+W)*(n.percent/100)))),D(F),L(q+F+W-G)},[b,C,y,n]),j.useEffect(()=>{S(k==="standard"?500:3e3)},[k]);const w=async()=>{s("");const F=await dj(t.trim().toUpperCase());F?(r(F),s("")):(r(null),s("Invalid coupon code"))},A=()=>["name","phone","address","city","state"].every(W=>{var q;return(q=x[W])==null?void 0:q.trim()}),R={reference:new Date().getTime().toString(),email:d==null?void 0:d.email,amount:V*100,publicKey:m},T=async F=>{if(!d||y.length===0)return;const W=fe(we(Q,"orders"));await Cn(W,{userId:d.uid,items:y,subtotal:b,deliveryFee:C,pomFee:E,total:V,status:"Processing",date:new Date().toISOString(),paymentReference:(F==null?void 0:F.reference)||"COUPON_FREE",deliveryInfo:x,coupon:n||null}),await Cn(fe(Q,"carts",d.uid),{items:[]}),v([]),P(0),L(0),alert(" Payment successful! Order created."),y.some(q=>q.isPOM)?u("/medinterface"):u("/orders")},ae=()=>{alert("Payment cancelled.")},H=F=>{f({...x,[F.target.name]:F.target.value})},te=()=>{alert(" Please complete all delivery information before proceeding.")};return d?a.jsxs("div",{style:{padding:"30px",maxWidth:"600px",margin:"auto"},children:[a.jsx("h2",{children:" Checkout"}),y.length===0?a.jsx("p",{children:"No items in cart."}):a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:" Order Summary"}),a.jsx("ul",{style:{listStyle:"none",padding:0},children:y.map((F,W)=>a.jsxs("li",{style:{marginBottom:"8px"},children:[F.name,"  ",F.price," x ",F.quantity||1," = ",F.price*(F.quantity||1)]},W))}),a.jsxs("p",{children:["Subtotal: ",b]}),a.jsxs("div",{style:{marginBottom:10},children:[a.jsx("label",{style:{fontWeight:500},children:"Delivery Type:"}),a.jsxs("select",{value:k,onChange:F=>N(F.target.value),style:{marginLeft:10,padding:"6px",borderRadius:"5px"},children:[a.jsx("option",{value:"standard",children:"Standard Delivery (1-2 days) - 500"}),a.jsx("option",{value:"express",children:"Express Delivery (30mins-3hrs) - 3000"})]})]}),a.jsxs("p",{children:["Delivery Fee: ",n!=null&&n.removeDelivery?0:C]}),a.jsxs("p",{style:{color:E>0?"#e53935":void 0,fontWeight:E>0?500:void 0},children:["POM Fee: ",n!=null&&n.removePOM?0:E]}),(n==null?void 0:n.percent)>0&&a.jsxs("p",{style:{color:"#007bff"},children:["Discount: -",Math.round((b+E+(n!=null&&n.removeDelivery?0:C))*(n.percent/100))]}),a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("input",{type:"text",placeholder:"Coupon code",value:t,onChange:F=>e(F.target.value),style:{marginRight:10}}),a.jsx("button",{type:"button",onClick:w,children:"Apply Coupon"}),i&&a.jsx("span",{style:{color:"#e53935",marginLeft:10},children:i}),n&&a.jsxs("span",{style:{color:"#007bff",marginLeft:10},children:["Applied: ",n.code," (",n.percent,"% off",n.removePOM?", no POM fee":"",n.removeDelivery?", no delivery fee":"",")"]})]}),a.jsx("p",{children:a.jsxs("strong",{children:["Grand Total: ",V]})}),a.jsx("h3",{children:" Delivery Information"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsx("input",{type:"text",name:"name",placeholder:"Full Name",value:x.name,onChange:H}),a.jsx("input",{type:"text",name:"phone",placeholder:"Phone Number",value:x.phone,onChange:H}),a.jsx("input",{type:"text",name:"address",placeholder:"Street Address",value:x.address,onChange:H}),a.jsx("input",{type:"text",name:"city",placeholder:"City",value:x.city,onChange:H}),a.jsx("input",{type:"text",name:"state",placeholder:"State",value:x.state,onChange:H}),a.jsx("textarea",{name:"instructions",placeholder:"Delivery Instructions (optional)",value:x.instructions,onChange:H})]}),A()?V>0?a.jsx(lj,{text:"Pay Now ",className:"paystack-button",...R,callback:T,close:ae,style:{marginTop:"20px"}}):a.jsx("button",{onClick:()=>T({reference:"COUPON_FREE"}),style:{marginTop:"20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",padding:"10px 20px",fontWeight:"bold"},children:"Complete Order (Free)"}):a.jsx("button",{onClick:te,style:{marginTop:"20px",cursor:"not-allowed"},children:"Pay Now "})]})]}):a.jsx("p",{children:"Loading..."})}function fj(){const{slug:t}=dc();return a.jsxs("div",{children:[a.jsxs("h2",{children:["Cart for ",t||"this store"]}),a.jsx(yE,{storeSlug:t})]})}const pj=(t,e,n,r)=>{const i=p=>p*Math.PI/180,o=i(n-t),u=i(r-e),c=Math.sin(o/2)**2+Math.cos(i(t))*Math.cos(i(n))*Math.sin(u/2)**2;return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},gj=t=>{const r=t*1.64,i=Math.max(1,Math.round(r/25*60));return{drivingKm:r,minutes:i}},pv=["admin","medicine-manager","distributor"],gv=["admin","distributor"];function mj(){const[t,e]=j.useState(null),[n,r]=j.useState(null),[i,s]=j.useState("shop"),[o,u]=j.useState([]),[c,d]=j.useState([]),[p,y]=j.useState(""),[v,b]=j.useState(null),[P,k]=j.useState(null);j.useEffect(()=>{if(!navigator.geolocation){b("denied");return}navigator.geolocation.getCurrentPosition(E=>b({lat:E.coords.latitude,lng:E.coords.longitude}),()=>b("denied"))},[]),j.useEffect(()=>{const E=yt(we(Q,"products"),async D=>{const V=await Promise.all(D.docs.map(async L=>{var f,m;const x={id:L.id,...L.data()};if(x.ownerId){const w=fe(Q,"users",x.ownerId),A=await At(w);if(A.exists()){const R=A.data();x.businessName=R.businessName||"Unknown Distributor",x.ownerSlug=R.slug||null,x.ownerRole=R.role||null,(f=R.location)!=null&&f.latitude&&((m=R.location)!=null&&m.longitude)&&(x.businessLat=R.location.latitude,x.businessLng=R.location.longitude)}}return x}));u(V.filter(L=>L.ownerRole==="distributor"))});return()=>E()},[]),j.useEffect(()=>{if(o.length===0)return;let E=o;if(p.trim()){const D=p.toLowerCase();E=o.filter(V=>V.name&&V.name.toLowerCase().includes(D)||V.ingredient&&V.ingredient.toLowerCase().includes(D)||V.class&&V.class.toLowerCase().includes(D))}v&&v!=="denied"&&(E=E.map(D=>{if(D.businessLat&&D.businessLng){const V=pj(v.lat,v.lng,D.businessLat,D.businessLng),{minutes:L}=gj(V);return{...D,minutesAway:L}}return{...D,minutesAway:1/0}}),E.sort((D,V)=>D.minutesAway-V.minutesAway)),d(E)},[o,p,v]);const N=async E=>{if(!t)return alert("Please login first");try{const D=fe(Q,"carts",t.uid),V=await At(D);let L=[];V.exists()&&(L=V.data().items||[]);const x=L.findIndex(f=>f.id===E.id);x>=0?L[x].quantity+=1:L.push({...E,quantity:1}),await Cn(D,{items:L}),k(`Added ${E.name} to cart!`),setTimeout(()=>k(null),1500)}catch{alert("Error adding to cart")}};if(j.useEffect(()=>{const E=un(),D=Un(E,async V=>{if(!V){e(null),r(null);return}e(V);const L=fe(Q,"users",V.uid),x=await At(L);r(x.exists()?x.data().role:null)});return()=>D()},[]),!t)return a.jsx("div",{children:"Please log in to access this page."});if(!pv.includes(n)&&!gv.includes(n))return a.jsx("div",{style:{background:"#fff",minHeight:"100vh"}});const C=pv.includes(n),S=gv.includes(n);return i==="shop"&&!C||i==="add"&&!S?a.jsx("div",{style:{background:"#fff",minHeight:"100vh"}}):a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:"Restock"}),a.jsxs("div",{style:{marginBottom:"24px",display:"flex",gap:"16px"},children:[C&&a.jsx("button",{style:{padding:"10px 24px",borderRadius:"6px",border:i==="shop"?"2px solid #1976d2":"1px solid #ccc",background:i==="shop"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("shop"),children:"Shop Stock"}),S&&a.jsx("button",{style:{padding:"10px 24px",borderRadius:"6px",border:i==="add"?"2px solid #1976d2":"1px solid #ccc",background:i==="add"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("add"),children:"Add Stock"})]}),i==="shop"&&C&&a.jsxs("section",{style:{marginBottom:"40px"},children:[a.jsx("h3",{children:"Shop Stock"}),a.jsx("div",{style:{margin:"15px 0"},children:a.jsx("input",{type:"text",placeholder:"Search by medicine name, ingredient, or class...",value:p,onChange:E=>y(E.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc"}})}),P&&a.jsx("div",{style:{color:"green",marginBottom:10},children:P}),c.length===0?a.jsx("p",{children:"No medicines found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"20px"},children:c.map(E=>a.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"10px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.1)",position:"relative"},children:[E.registeredOnly&&E.registeredUniqueId&&a.jsx("span",{style:{position:"absolute",top:"10px",left:"10px",background:"#7c3aed",color:"#fff",padding:"2px 10px",borderRadius:"8px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",letterSpacing:"1px"},children:"Registered Only"}),E.image&&a.jsx("img",{src:E.image,alt:E.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"10px"}}),a.jsx("strong",{children:E.name}),a.jsx("p",{children:a.jsx("em",{children:E.ingredient})}),a.jsxs("p",{children:["Class: ",E.class]}),a.jsxs("p",{children:["Price: ",E.price]}),Array.isArray(E.moqs)&&E.moqs.length>0&&a.jsxs("div",{style:{margin:"8px 0"},children:[a.jsx("strong",{children:"MOQ:"})," ",E.moqs.map((D,V)=>a.jsx("span",{style:{marginRight:8},children:D.type},V))]}),a.jsxs("p",{style:{fontSize:"0.95em",color:"#555"},children:["Distributor: ",E.businessName]}),E.minutesAway!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500",fontSize:"0.9em"},children:E.minutesAway<=1?" Right here":` ~${E.minutesAway} mins away`}),a.jsx("button",{style:{marginTop:10,padding:"8px 16px",borderRadius:"6px",background:"#1976d2",color:"#fff",border:"none",cursor:"pointer",fontWeight:"bold"},onClick:()=>N(E),children:"Add to Cart"})]},E.id))})]}),i==="add"&&S&&a.jsx(yj,{user:t,role:n})]})}function yj({user:t,role:e}){const[n,r]=Ue.useState({name:"",ingredient:"",class:"",price:"",image:"",moqs:[{type:"sachet"}],registeredOnly:!1}),[i,s]=Ue.useState([]),[o,u]=Ue.useState(!1);Ue.useEffect(()=>{if(e!=="distributor")return;const M=yt(we(Q,"businessRegistrations"),F=>{s(F.docs.filter(W=>W.data().distributorId===t.uid&&W.data().status==="approved").map(W=>W.data()))});return()=>M()},[t,e]);const c=(M,F)=>{const W=n.moqs.map((q,G)=>G===M?{type:F.target.value}:q);r({...n,moqs:W})},d=()=>{r({...n,moqs:[...n.moqs,{type:"sachet"}]})},p=M=>{r({...n,moqs:n.moqs.filter((F,W)=>W!==M)})},[y,v]=Ue.useState(null),[b,P]=Ue.useState([]),[k,N]=Ue.useState([]),[C,S]=Ue.useState([]),[E,D]=Ue.useState(!1),[V,L]=Ue.useState(null),[x,f]=Ue.useState(null);Ue.useEffect(()=>{if(!t)return;const M=yt(we(Q,"products"),F=>{let W=F.docs.map(q=>({id:q.id,...q.data()}));m()||(W=W.filter(q=>q.ownerId===t.uid)),P(W)});return()=>M()},[t]),Ue.useEffect(()=>{if(!t)return;const M=yt(we(Q,"batches"),F=>{let W=F.docs.map(q=>({id:q.id,...q.data()}));m()||(W=W.filter(q=>q.uploadedBy===t.uid)),N(W)});return()=>M()},[t]);function m(){var M;return(M=t==null?void 0:t.email)==null?void 0:M.includes("admin")}const w=M=>r({...n,[M.target.name]:M.target.value}),A=async()=>{const M=!n.registeredOnly;if(r({...n,registeredOnly:M}),e==="distributor"&&(t!=null&&t.uid)){const F=we(Q,"products"),W=await getDocs(F),q=[];W.docs.forEach(G=>{if(G.data().ownerId===t.uid){const X={registeredOnly:M};M?X.registeredUniqueId=`${t.uid}_${Date.now()}_${Math.floor(Math.random()*1e4)}`:X.registeredUniqueId=null,q.push(updateDoc(fe(Q,"products",G.id),X))}}),await Promise.all(q),window.location.reload()}},R=async M=>{M.preventDefault(),D(!0),f(null),L(null);try{let F=e,W=null,q=null;if(e==="distributor"){const O=fe(Q,"users",t.uid),X=await At(O);X.exists()&&(W=X.data().slug||X.data().businessSlug||null),n.registeredOnly&&(q=`${t.uid}_${Date.now()}`)}const G={...n,ownerId:t.uid,ownerRole:F,ownerSlug:W};q&&(G.registeredUniqueId=q),y?(await Cn(fe(Q,"products",y),G,{merge:!0}),v(null),L("Medicine updated!")):(await ts(we(Q,"products"),G),L("Medicine added!")),r({name:"",ingredient:"",class:"",price:"",image:"",moqs:[{type:"sachet",value:"",price:""}],registeredOnly:!1})}catch{f("Error saving medicine")}D(!1)},T=M=>{r({name:M.name,ingredient:M.ingredient,class:M.class,price:M.price,image:M.image||"",moqs:M.moqs||[{type:"sachet",value:"",price:""}]}),v(M.id)},ae=async M=>{if(window.confirm("Delete this medicine?")){D(!0);try{await Mn(fe(Q,"products",M.id)),L("Medicine deleted")}catch{f("Error deleting medicine")}D(!1)}},H=M=>{const F=M.target.files[0];F&&_E.parse(F,{header:!0,skipEmptyLines:!0,complete:W=>{S(W.data)},error:()=>f("Failed to parse CSV")})},te=async()=>{if(console.log("handleCsvUpload called. user:",t,"role:",e),!C.length)return;if(!t||!e){f("User or role not loaded. Please log in again."),D(!1);return}D(!0),f(null),L(null);const M=fe(we(Q,"batches")),F=[];let W=e,q=null;if(e==="distributor"){const G=fe(Q,"users",t.uid),O=await At(G);O.exists()&&(q=O.data().slug||O.data().businessSlug||null)}for(let G of C)try{let O=[];if(G.moqs)try{O=JSON.parse(G.moqs)}catch{}let X=null;e==="distributor"&&G.registeredOnly===!0&&(X=`${t.uid}_${Date.now()}_${Math.floor(Math.random()*1e4)}`);const z=await ts(we(Q,"products"),{name:G.name,ingredient:G.ingredient,class:G.class,price:parseInt(G.price,10)||0,image:G.image||"",batchId:M.id,ownerId:t.uid,ownerRole:W,ownerSlug:q,moqs:O,registeredOnly:!!G.registeredOnly,...X?{registeredUniqueId:X}:{}});F.push(z.id)}catch{}await Cn(M,{name:`CSV Upload - ${new Date().toLocaleString()}`,uploadedBy:t.uid,date:new Date().toISOString(),medicineIds:F}),L(`${F.length} medicines uploaded`),S([]),D(!1)},ee=async M=>{if(window.confirm("Delete this batch and its medicines?")){D(!0);try{for(let F of M.medicineIds)await Mn(fe(Q,"products",F));await Mn(fe(Q,"batches",M.id)),L("Batch deleted")}catch{f("Error deleting batch")}D(!1)}};return a.jsxs("section",{style:{maxWidth:900,margin:"0 auto",background:"#fff",padding:24,borderRadius:10},children:[e==="distributor"&&a.jsxs("section",{style:{marginBottom:32,border:"1px solid #e0e0e0",borderRadius:10,background:"#f8f6ff",padding:18},children:[a.jsx("button",{type:"button",onClick:()=>u(M=>!M),style:{background:o?"#7c3aed":"#ede9fe",color:o?"#fff":"#7c3aed",border:"none",borderRadius:6,padding:"10px 18px",fontWeight:"bold",marginBottom:10,cursor:"pointer"},children:o?"Hide Registered Businesses":"Show Registered Businesses"}),o&&a.jsxs("div",{children:[a.jsx("h3",{style:{color:"#7c3aed",marginBottom:10},children:"Registered Businesses"}),a.jsx("p",{style:{fontSize:15,color:"#555",marginBottom:16},children:"These are businesses that have registered and been approved to buy from you. You can use this list to manage your relationships and track registrations."}),i.length===0?a.jsx("p",{style:{color:"#888"},children:"No businesses registered yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"#fff",borderRadius:8},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#ede9fe"},children:[a.jsx("th",{style:{padding:"8px 12px",textAlign:"left"},children:"Business Name"}),a.jsx("th",{style:{padding:"8px 12px",textAlign:"left"},children:"Email"}),a.jsx("th",{style:{padding:"8px 12px",textAlign:"left"},children:"Phone"})]})}),a.jsx("tbody",{children:i.map((M,F)=>{var W,q,G;return a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"8px 12px"},children:a.jsx("b",{children:((W=M.businessInfo)==null?void 0:W.businessName)||M.businessId})}),a.jsx("td",{style:{padding:"8px 12px"},children:((q=M.businessInfo)==null?void 0:q.email)||""}),a.jsx("td",{style:{padding:"8px 12px"},children:((G=M.businessInfo)==null?void 0:G.phone)||""})]},F)})})]})]})]}),a.jsx("h3",{children:"Add Stock"}),a.jsxs("form",{onSubmit:R,style:{marginBottom:24},children:[a.jsx("input",{name:"name",value:n.name,onChange:w,placeholder:"Medicine Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"ingredient",value:n.ingredient,onChange:w,placeholder:"Ingredient",style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"class",value:n.class,onChange:w,placeholder:"Class",style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"price",value:n.price,onChange:w,placeholder:"Default Price",type:"number",min:"0",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"image",value:n.image,onChange:w,placeholder:"Image URL",style:{width:"100%",marginBottom:8}}),e==="distributor"&&a.jsx("div",{style:{marginBottom:"10px"},children:a.jsx("button",{type:"button",onClick:A,style:{background:n.registeredOnly?"#7c3aed":"#ede9fe",color:n.registeredOnly?"#fff":"#7c3aed",border:"none",borderRadius:6,padding:"10px 18px",fontWeight:"bold",cursor:"pointer"},children:n.registeredOnly?"Disable 'Only registered businesses can buy'":"Enable 'Only registered businesses can buy'"})}),a.jsxs("div",{style:{margin:"16px 0"},children:[a.jsx("strong",{children:"MOQ:"}),n.moqs.map((M,F)=>a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:6},children:[a.jsxs("select",{value:M.type,onChange:W=>c(F,W),style:{width:120},children:[a.jsx("option",{value:"sachet",children:"Sachet"}),a.jsx("option",{value:"pack",children:"Pack"}),a.jsx("option",{value:"carton",children:"Carton"})]}),n.moqs.length>1&&a.jsx("button",{type:"button",onClick:()=>p(F),style:{color:"red"},children:""})]},F)),a.jsx("button",{type:"button",onClick:d,style:{marginTop:4},children:"+ Add MOQ"})]}),a.jsx("button",{type:"submit",disabled:E,style:{marginTop:10},children:y?"Update Medicine":"Add Medicine"})]}),a.jsx("h4",{children:"Bulk Add via CSV"}),a.jsx("input",{type:"file",accept:".csv",onChange:H}),C.length>0&&a.jsx("div",{style:{marginTop:10},children:a.jsxs("button",{onClick:te,disabled:E,children:["Submit CSV (",C.length," rows)"]})}),a.jsxs("h4",{style:{marginTop:32},children:["My Medicines ",m()&&"(All Users)"]}),b.length===0?a.jsx("p",{children:"No medicines added yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{borderBottom:"1px solid #ccc"},children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Ingredient"}),a.jsx("th",{children:"Class"}),a.jsx("th",{children:"Price"}),a.jsx("th",{children:"MOQ"}),a.jsx("th",{children:"Image"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:b.map(M=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{children:M.name}),a.jsx("td",{children:M.ingredient}),a.jsx("td",{children:M.class}),a.jsx("td",{children:M.price}),a.jsx("td",{children:Array.isArray(M.moqs)&&M.moqs.length>0?M.moqs.map((F,W)=>a.jsx("span",{style:{marginRight:8},children:F.type},W)):"-"}),a.jsx("td",{children:M.image&&a.jsx("img",{src:M.image,alt:M.name,style:{width:"50px",height:"50px",objectFit:"cover"}})}),a.jsxs("td",{children:[a.jsx("button",{onClick:()=>T(M),style:{marginRight:"5px"},children:"Edit"}),a.jsx("button",{onClick:()=>ae(M),children:"Delete"})]})]},M.id))})]}),a.jsxs("h4",{style:{marginTop:32},children:["My CSV Batches ",m()&&"(All Users)"]}),k.length===0?a.jsx("p",{children:"No batches uploaded yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"20px"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{borderBottom:"1px solid #ccc"},children:[a.jsx("th",{children:"Batch Name"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Medicines Count"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:k.map(M=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{children:M.name}),a.jsx("td",{children:new Date(M.date).toLocaleString()}),a.jsx("td",{children:M.medicineIds.length}),a.jsx("td",{children:a.jsx("button",{onClick:()=>ee(M),children:"Delete Batch"})})]},M.id))})]}),V&&a.jsx("div",{style:{color:"green",marginTop:10},children:V}),x&&a.jsx("div",{style:{color:"red",marginTop:10},children:x})]})}function mv({medics:t}){return a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:24,marginTop:24},children:[...t].sort((e,n)=>(n.online===!0)-(e.online===!0)).map(e=>{let n=[];return Array.isArray(e.languages)?n=e.languages:typeof e.languages=="string"&&(n=e.languages.split(",").map(r=>r.trim()).filter(Boolean)),a.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",width:220,padding:16,border:"1px solid #ccc",borderRadius:12,background:"#f9f9f9",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",cursor:"pointer"},onClick:()=>window.open(`https://wa.me/${e.whatsapp}`,"_blank"),children:[a.jsx("span",{title:e.online?"Online":"Offline",style:{position:"absolute",top:8,right:12,width:14,height:14,borderRadius:"50%",background:e.online?"#27c93f":"#bbb",border:"2px solid #fff",boxShadow:"0 0 2px #888"}}),a.jsx("img",{src:e.photo,alt:e.name,style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",marginBottom:12}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:18},children:e.name}),a.jsx("div",{children:e.profession}),e.pharmacyName&&a.jsx("div",{style:{color:"#7c3aed",fontWeight:500},children:e.pharmacyName}),a.jsxs("div",{children:["License: ",e.license]}),a.jsxs("div",{children:["Languages: ",n.join(", ")]})]},e.id)})})}function vj(){const[t,e]=j.useState([]),[n,r]=j.useState([]),[i,s]=j.useState("verify"),[o,u]=j.useState("");return j.useEffect(()=>{(async()=>{let p=(await Rt(we(Q,"verifyMedics"))).docs.map(b=>({id:b.id,...b.data()}));(await Rt(we(Q,"users"))).docs.forEach(b=>{const P=b.data();P.role==="medicine-manager"&&P.pharmacist&&p.push({...P.pharmacist,id:b.id,online:!0})}),e(p);const v=await Rt(we(Q,"consultMedics"));r(v.docs.map(b=>({id:b.id,...b.data()})))})()},[]),a.jsxs("div",{style:{padding:32,maxWidth:900,margin:"0 auto"},children:[a.jsx("h2",{children:" Medical Interface"}),a.jsx("input",{type:"text",placeholder:"Search by name or pharmacy...",value:o,onChange:c=>u(c.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc",marginBottom:"18px"}}),a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:32},children:[a.jsx("button",{style:{padding:"10px 24px",borderRadius:6,border:i==="verify"?"2px solid #1976d2":"1px solid #ccc",background:i==="verify"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("verify"),children:"Verify Prescription"}),a.jsx("button",{style:{padding:"10px 24px",borderRadius:6,border:i==="consult"?"2px solid #1976d2":"1px solid #ccc",background:i==="consult"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("consult"),children:"Get Consultation"})]}),i==="verify"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Verify Prescription Medics"}),a.jsx(mv,{medics:t.filter(c=>{var v,b;const d=((v=c.name)==null?void 0:v.toLowerCase())||"",p=((b=c.pharmacyName)==null?void 0:b.toLowerCase())||"",y=o.toLowerCase();return d.includes(y)||p.includes(y)})})]}),i==="consult"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Consultation Medics"}),a.jsx(mv,{medics:n.filter(c=>{var v,b;const d=((v=c.name)==null?void 0:v.toLowerCase())||"",p=((b=c.pharmacyName)==null?void 0:b.toLowerCase())||"",y=o.toLowerCase();return d.includes(y)||p.includes(y)})})]})]})}function _j(){const[t,e]=j.useState(0);j.useEffect(()=>{const c=un();let d=null;const p=Un(c,y=>{if(d&&d(),y){const v=fe(Q,"carts",y.uid);d=yt(v,b=>{if(b.exists()){const P=b.data().items||[];e(P.length)}else e(0)})}else e(0)});return()=>{p(),d&&d()}},[]);const i=ho().pathname.match(/^\/store\/([^\/]+)/),s=i?i[1]:null,[o,u]=j.useState(null);return j.useEffect(()=>{const c=un(),d=Un(c,async p=>{if(p){const y=await At(fe(Q,"users",p.uid));u(y.exists()?y.data().role:null)}else u(null)});return()=>d()},[]),a.jsx("nav",{style:{display:"flex",gap:"20px",padding:"20px",background:"#f8f8f8",borderBottom:"1px solid #ddd"},children:o==="delivery-agent"?a.jsxs(a.Fragment,{children:[a.jsx(wn,{to:"/auth",children:"Auth"}),a.jsx("button",{onClick:()=>{un().signOut(),window.location.href="/auth"},style:{marginLeft:12},children:"Logout"})]}):a.jsxs(a.Fragment,{children:[a.jsx(wn,{to:"/",children:"Home"}),s?a.jsxs(a.Fragment,{children:[a.jsx(wn,{to:`/store/${s}`,children:"Shop"}),a.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[a.jsx(wn,{to:`/store/${s}/cart`,children:"Cart"}),t>0&&a.jsx("span",{style:{position:"absolute",top:"-8px",right:"-16px",background:"#e53935",color:"#fff",borderRadius:"50%",padding:"2px 7px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.10)",zIndex:10},children:t})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(wn,{to:"/shop",children:"Shop"}),a.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[a.jsx(wn,{to:"/cart",children:"Cart"}),t>0&&a.jsx("span",{style:{position:"absolute",top:"-8px",right:"-16px",background:"#e53935",color:"#fff",borderRadius:"50%",padding:"2px 7px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.10)",zIndex:10},children:t})]})]}),a.jsx(wn,{to:"/auth",children:"Auth"}),a.jsx(wn,{to:"/orders",children:"Orders"}),!s&&o!=="customer"&&a.jsxs(a.Fragment,{children:[a.jsx(wn,{to:"/add-medicine",children:"Add Medicine"}),a.jsx(wn,{to:"/admin",children:"Admin"}),(o==="delivery-agent"||o==="admin")&&a.jsx(a.Fragment,{children:a.jsx(wn,{to:"/agents",children:"All Agents"})})]}),a.jsx(wn,{to:"/medinterface",children:"Medinterface"})]})})}function xj(){const[t,e]=j.useState("");function n(O){if(!t.trim())return O;const X=t.trim().toLowerCase();return O.filter(z=>{var be,We,Pe,Re,ye,Je,ve,ke,Ne,qt,it,Lt,Qe,vt,xe,Oe;const ie=(((be=u[z.userId])==null?void 0:be.email)||"").toLowerCase(),pe=(z.items&&z.items[0]&&((We=s[z.items[0].ownerId])==null?void 0:We.name)||"").toLowerCase(),ne=((((Pe=z.deliveryInfo)==null?void 0:Pe.address)||"")+" "+(((Re=z.deliveryInfo)==null?void 0:Re.city)||"")+" "+(((ye=z.deliveryInfo)==null?void 0:ye.state)||"")).toLowerCase(),Te=z.items&&z.items[0]&&((((Je=s[z.items[0].ownerId])==null?void 0:Je.address)||"")+" "+(((ve=s[z.items[0].ownerId])==null?void 0:ve.city)||"")+" "+(((ke=s[z.items[0].ownerId])==null?void 0:ke.state)||"")).toLowerCase()||"",De=[(Ne=z.deliveryInfo)==null?void 0:Ne.lat,(qt=z.deliveryInfo)==null?void 0:qt.lng,(Qe=s[(Lt=(it=z.items)==null?void 0:it[0])==null?void 0:Lt.ownerId])==null?void 0:Qe.lat,(Oe=s[(xe=(vt=z.items)==null?void 0:vt[0])==null?void 0:xe.ownerId])==null?void 0:Oe.lng].filter(Boolean).join(",").toLowerCase(),_e=(z.items||[]).map(Ye=>Ye.name).join(", ").toLowerCase();return ie.includes(X)||pe.includes(X)||ne.includes(X)||Te.includes(X)||De.includes(X)||_e.includes(X)})}const[r,i]=Ue.useState("processing"),[s,o]=j.useState({});j.useEffect(()=>{const O=yt(we(Q,"users"),X=>{const z={};X.docs.forEach(ie=>{const pe=ie.data();pe.role==="medicine-manager"&&(z[ie.id]={name:pe.businessName||ie.id,address:pe.businessAddress||pe.address||"-",lat:pe.lat||pe.latitude||null,lng:pe.lng||pe.longitude||null})}),o(z)});return()=>O()},[]);const[u,c]=j.useState({});j.useEffect(()=>{const O=yt(we(Q,"users"),X=>{const z={};X.docs.forEach(ie=>{const pe=ie.data();z[ie.id]=pe.email||ie.id}),c(z)});return()=>O()},[]);const[d,p]=j.useState([]),[y,v]=j.useState([]),[b,P]=j.useState([]),[k,N]=j.useState(()=>{const O=localStorage.getItem("agentCanceledOrders");return O?JSON.parse(O):[]}),[C,S]=j.useState({}),[E,D]=j.useState({}),[V,L]=j.useState(null),{slug:x}=dc(),[f,m]=j.useState(null),[w,A]=j.useState(!1),[R,T]=j.useState(!0),[ae,H]=j.useState(null),[te,ee]=j.useState("availability");j.useEffect(()=>{if(!ae)return;const O=yt(we(Q,"orders"),X=>{const z=X.docs.map(ie=>({id:ie.id,...ie.data()}));p(z.filter(ie=>ie.status==="Completed"&&ie.assignedAgentId===ae.uid)),P(z.filter(ie=>ie.status==="In-Progress"&&ie.assignedAgentId===ae.uid)),v(z.filter(ie=>ie.status==="Processing"&&!ie.assignedAgentId&&!k.some(pe=>pe.id===ie.id)))});return()=>O()},[ae,k]);const M=async O=>{L(O);try{await wt(fe(Q,"orders",O),{assignedAgentId:ae.uid,riderId:ae.uid,assignedAgentSlug:f.slug,assignedAgentName:f.companyName,companyName:f.companyName,agentPhoneNumber:f.phoneNumber||"",agentWhatsappNumber:f.whatsappNumber||"",assignedAt:new Date().toISOString(),status:"In-Progress"})}catch{alert("Failed to accept order")}L(null)},F=async O=>{try{await wt(fe(Q,"orders",O),{deliveredByRider:!0,riderCompletedAt:new Date().toISOString()})}catch{alert("Failed to mark as delivered")}},W=async O=>{try{await wt(fe(Q,"orders",O),{status:"Processing",assignedAgentId:null,assignedAgentSlug:null,assignedAgentName:null,assignedAt:null})}catch{alert("Failed to move order back to processing")}},q=O=>{const X=y.find(z=>z.id===O)||b.find(z=>z.id===O);X&&(N(z=>{const ie=[...z,X];return localStorage.setItem("agentCanceledOrders",JSON.stringify(ie)),ie}),i("canceled"))};j.useEffect(()=>{const O=X=>{X.key==="agentCanceledOrders"&&N(X.newValue?JSON.parse(X.newValue):[])};return window.addEventListener("storage",O),()=>window.removeEventListener("storage",O)},[]);const G=async()=>{if(f){A(!0);try{const O=fe(Q,"deliveryAgents",f.id);await wt(O,{available:!f.available}),m({...f,available:!f.available})}catch{alert("Failed to update availability")}A(!1)}};return j.useEffect(()=>{const O=un(),X=Un(O,z=>{H(z)});return()=>X()},[]),j.useEffect(()=>{async function O(){T(!0);const z=(await Rt(we(Q,"deliveryAgents"))).docs.map(ne=>ne.data());console.log("All agent slugs:",z.map(ne=>ne.slug));const ie=hr(we(Q,"deliveryAgents"),Yn("slug","==",x),Yn("approved","==",!0)),pe=await Rt(ie);pe.empty?m(null):m({id:pe.docs[0].id,...pe.docs[0].data()}),T(!1)}O()},[x]),R?a.jsx("div",{style:{padding:40},children:"Loading..."}):f?!ae||ae.uid!==f.userId?a.jsx("div",{style:{padding:40,color:"#e53935"},children:"Access denied. You can only view your own profile."}):a.jsxs("div",{style:{padding:"30px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h2",{children:" Delivery Agent Profile"}),a.jsx("img",{src:f.logoUrl||"https://via.placeholder.com/80x80?text=Logo",alt:"Business Logo",style:{width:80,height:80,borderRadius:"10px",objectFit:"cover",marginBottom:10}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:18},children:f.companyName}),a.jsxs("div",{children:["Phone: ",f.phoneNumber]}),a.jsxs("div",{children:["WhatsApp: ",f.whatsappNumber]}),a.jsxs("div",{children:["RC Number: ",f.rcNumber]}),a.jsxs("div",{children:["Address: ",f.businessAddress]}),a.jsxs("div",{children:["Email: ",f.email]}),a.jsxs("div",{children:["Coverage: ",f.coverageArea]}),a.jsxs("div",{children:["Hours: ",f.operatingHours]}),a.jsxs("div",{style:{display:"flex",marginTop:30,gap:20},children:[a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:te==="availability"?"2px solid #1976d2":"1px solid #ccc",background:te==="availability"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>ee("availability"),children:"Agent Availability"}),a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:te==="orders"?"2px solid #1976d2":"1px solid #ccc",background:te==="orders"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>ee("orders"),children:"Agent Orders"})]}),a.jsxs("div",{style:{display:"flex",marginTop:30,gap:40},children:[te==="availability"&&a.jsxs("div",{style:{flex:1,minWidth:320},children:[a.jsx("h3",{children:"Agent Availability"}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("span",{style:{fontWeight:"bold"},children:"Status:"})," ",f.available?" Available":" Not Available",a.jsx("button",{style:{marginLeft:16,padding:"6px 18px",fontWeight:"bold"},onClick:G,disabled:w,children:f.available?"Set Not Available":"Set Available"})]})]}),te==="orders"&&(f.available?a.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",width:"100%"},children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10,minWidth:160},children:[a.jsx("div",{style:{flex:1,marginLeft:24,marginBottom:16},children:a.jsx("input",{type:"text",value:t,onChange:O=>e(O.target.value),placeholder:"Search orders by customer email, pharmacy, address, coordinates, items...",style:{width:"100%",padding:"8px 12px",border:"1px solid #bbb",borderRadius:6,fontSize:15,outline:"none",boxShadow:"0 1px 2px #0001"}})}),a.jsx("button",{onClick:()=>i("processing"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="processing"?"2px solid #1976d2":"1px solid #ccc",background:r==="processing"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:" Orders (Processing)"}),a.jsx("button",{onClick:()=>i("progression"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="progression"?"2px solid #1976d2":"1px solid #ccc",background:r==="progression"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:" Order Progression"}),a.jsx("button",{onClick:()=>i("completed"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="completed"?"2px solid #1976d2":"1px solid #ccc",background:r==="completed"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:" Completed Orders (You)"}),a.jsx("button",{onClick:()=>i("canceled"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="canceled"?"2px solid #1976d2":"1px solid #ccc",background:r==="canceled"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:" Canceled Orders"})]}),r==="canceled"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(k).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No canceled orders found."}):n(k).map(O=>{var X;return a.jsxs("div",{style:{border:"1px solid #b91c1c",borderRadius:8,padding:16,marginBottom:16,background:"#fff0f0"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{position:"relative",width:24,display:"flex",flexDirection:"column",alignItems:"center",marginRight:12},children:[a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1976d2",marginBottom:8,marginTop:2}}),a.jsx("div",{style:{flex:1,width:2,background:"#b91c1c",minHeight:32}}),a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#b91c1c",marginTop:8}})]}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const z=s[O.items[0].ownerId],ie=`${z.address||""}, ${z.city||""}, ${z.state||""}`,pe=!z.address&&!z.city&&!z.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:z.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:pe?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this business"}):ie}),z.lat&&z.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const z=O.deliveryInfo||{},ie=`${z.address||""}, ${z.city||""}, ${z.state||""}`,pe=!z.address&&!z.city&&!z.state;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:pe?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):ie}),z.lat&&z.lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(X=O.items)==null?void 0:X.map(z=>`${z.name} x${z.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#b91c1c"},children:"Canceled (local)"})]}),a.jsx("div",{style:{marginTop:10,fontSize:13,color:"#555"},children:"Canceled (local, not global)"})]},O.id)})}),a.jsxs("div",{style:{flex:1,marginLeft:24},children:[r==="processing"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(y).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No processing orders found."}):n(y).map(O=>{var X;return a.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:16,marginBottom:16,background:"#fcfcfc"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{position:"relative",width:24,display:"flex",flexDirection:"column",alignItems:"center",marginRight:12},children:[a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1976d2",marginBottom:8,marginTop:2}}),a.jsx("div",{style:{flex:1,width:2,background:"#d1d5db",minHeight:32}}),a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#059669",marginTop:8}})]}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const z=s[O.items[0].ownerId],ie=`${z.address||""}, ${z.city||""}, ${z.state||""}`,pe=!z.address&&!z.city&&!z.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:z.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:pe?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this business"}):ie}),z.lat&&z.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const z=O.deliveryInfo||{},ie=`${z.address||""}, ${z.city||""}, ${z.state||""}`,pe=!z.address&&!z.city&&!z.state;let ne=z.lat,Te=z.lng;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:pe?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):ie}),ne&&Te?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",ne,", ",Te]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(X=O.items)==null?void 0:X.map(z=>`${z.name} x${z.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#e53935"},children:O.status})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12},children:[a.jsx("button",{style:{fontWeight:"bold",background:"#1976d2",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:"pointer"},onClick:()=>M(O.id),disabled:V===O.id,children:V===O.id?"Accepting...":"Accept Order"}),a.jsx("button",{style:{fontWeight:"bold",background:"#b91c1c",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:"pointer"},onClick:()=>q(O.id),children:"Cancel Order"})]})]},O.id)})}),r==="progression"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(b).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No in-progress orders found."}):n(b).map(O=>{var pe;const X=!!C[O.id],z=!!E[O.id],ie=async()=>{await F(O.id),S(ne=>({...ne,[O.id]:!0})),D(ne=>({...ne,[O.id]:!0})),setTimeout(()=>D(ne=>({...ne,[O.id]:!1})),2e3)};return a.jsxs("div",{style:{border:"1px solid #f59e42",borderRadius:8,padding:16,marginBottom:16,background:"#fffbe6"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const ne=s[O.items[0].ownerId],Te=`${ne.address||""}, ${ne.city||""}, ${ne.state||""}`,De=!ne.address&&!ne.city&&!ne.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:ne.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:De?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this business"}):Te}),ne.lat&&ne.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",ne.lat,", ",ne.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const ne=O.deliveryInfo||{},Te=`${ne.address||""}, ${ne.city||""}, ${ne.state||""}`,De=!ne.address&&!ne.city&&!ne.state;let _e=ne.lat,be=ne.lng;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:De?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):Te}),_e&&be?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",_e,", ",be]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(pe=O.items)==null?void 0:pe.map(ne=>`${ne.name} x${ne.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#f59e42"},children:O.status})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12},children:[a.jsx("button",{style:{fontWeight:"bold",background:"#059669",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:X?"not-allowed":"pointer",opacity:X?.5:1},onClick:ie,disabled:X,children:"Success"}),a.jsx("button",{style:{fontWeight:"bold",background:"#e53935",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:X?"not-allowed":"pointer",opacity:X?.5:1},onClick:()=>W(O.id),disabled:X,children:"Failed"})]}),z&&a.jsx("div",{style:{marginTop:8,color:"#059669",fontWeight:"bold"},children:"Order successful!"}),X&&a.jsx("div",{style:{marginTop:8,color:"#1976d2",fontSize:13},children:"Successful order: to be confirmed by admin"})]},O.id)})}),r==="completed"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(d).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No completed orders found."}):n(d).map(O=>{var X;return a.jsxs("div",{style:{border:"1px solid #4caf50",borderRadius:8,padding:16,marginBottom:16,background:"#e8f5e9"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{position:"relative",width:24,display:"flex",flexDirection:"column",alignItems:"center",marginRight:12},children:[a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1976d2",marginBottom:8,marginTop:2}}),a.jsx("div",{style:{flex:1,width:2,background:"#b2dfdb",minHeight:32}}),a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#059669",marginTop:8}})]}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const z=s[O.items[0].ownerId],ie=`${z.address||""}, ${z.city||""}, ${z.state||""}`,pe=!z.address&&!z.city&&!z.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:z.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:pe?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this business"}):ie}),z.lat&&z.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const z=O.deliveryInfo||{},ie=`${z.address||""}, ${z.city||""}, ${z.state||""}`,pe=!z.address&&!z.city&&!z.state;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:pe?a.jsx("span",{style:{color:"red",fontWeight:600},children:" Address missing for this order"}):ie}),z.lat&&z.lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(X=O.items)==null?void 0:X.map(z=>`${z.name} x${z.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#388e3c"},children:O.status})]}),a.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#555"},children:["Completed: ",O.completedAt?new Date(O.completedAt).toLocaleString():"-"]})]},O.id)})})]})]}):a.jsxs("div",{style:{padding:40,color:"#e53935",width:"100%"},children:["You must be ",a.jsx("b",{children:"Available"})," to view and accept orders."]}))]})]}):a.jsx("div",{style:{padding:40,color:"#e53935"},children:"No delivery agent found for this slug."})}function yv(){const[t,e]=j.useState([]),[n,r]=j.useState(!0);return j.useEffect(()=>{async function i(){r(!0);const s=hr(we(Q,"deliveryAgents"),Yn("approved","==",!0)),o=await Rt(s);e(o.docs.map(u=>({id:u.id,...u.data()}))),r(!1)}i()},[]),n?a.jsx("div",{style:{padding:40},children:"Loading..."}):a.jsxs("div",{style:{padding:"30px",maxWidth:"1200px",margin:"auto"},children:[a.jsx("h2",{children:" All Approved Delivery Agents"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"18px",marginTop:"40px"},children:t.length===0?a.jsx("p",{children:"No delivery agents found."}):t.map(i=>a.jsx(wn,{to:`/agent/${i.slug}`,style:{textDecoration:"none",color:"inherit"},children:a.jsxs("div",{style:{background:"#fff",border:"1px solid #eee",borderRadius:"10px",boxShadow:"0 1px 8px rgba(0,0,0,0.06)",padding:"18px",minWidth:"260px",maxWidth:"320px",position:"relative"},children:[a.jsx("img",{src:i.logoUrl||"https://via.placeholder.com/80x80?text=Logo",alt:"Business Logo",style:{width:80,height:80,borderRadius:"10px",objectFit:"cover",marginBottom:10}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:18},children:i.companyName}),a.jsxs("div",{children:["Phone: ",i.phoneNumber]}),a.jsxs("div",{children:["Coverage: ",i.coverageArea]}),a.jsxs("div",{children:["Hours: ",i.operatingHours]})]})},i.id))})]})}Ld.createRoot(document.getElementById("root")).render(a.jsx(Ue.StrictMode,{children:a.jsx(fT,{children:a.jsxs(a.Fragment,{children:[a.jsx(_j,{}),a.jsx(wj,{}),a.jsxs(oT,{children:[a.jsx(Vt,{path:"/agent/:slug",element:a.jsx(xj,{})}),a.jsx(Vt,{path:"/agents",element:a.jsx(yv,{})}),a.jsx(Vt,{path:"/",element:a.jsx(yT,{})}),a.jsx(Vt,{path:"/shop",element:a.jsx(HP,{})}),a.jsx(Vt,{path:"/cart",element:a.jsx(yE,{})}),a.jsx(Vt,{path:"/auth",element:a.jsx(qP,{})}),a.jsx(Vt,{path:"/orders",element:a.jsx(GP,{})}),a.jsx(Vt,{path:"/add-medicine",element:a.jsx(ij,{})}),a.jsx(Vt,{path:"/payment",element:a.jsx(hj,{})}),a.jsx(Vt,{path:"/admin",element:a.jsx(XP,{})}),a.jsx(Vt,{path:"/store/:slug",element:a.jsx(ej,{})}),a.jsx(Vt,{path:"/store/:slug/cart",element:a.jsx(fj,{})}),a.jsx(Vt,{path:"/restock",element:a.jsx(mj,{})}),a.jsx(Vt,{path:"/medinterface",element:a.jsx(vj,{})}),a.jsx(Vt,{path:"/businesses",element:a.jsx(nj,{})}),a.jsx(Vt,{path:"/agents",element:a.jsx(yv,{})})]})]})})}));function wj(){const e=window.location.pathname.match(/^\/store\/([^\/]+)/);return(e?e[1]:null)?a.jsx("button",{onClick:()=>window.location.href="/shop",style:{position:"fixed",top:"80px",left:"32px",background:"#fff",color:"#7c3aed",border:"1px solid #7c3aed",borderRadius:"50px",boxShadow:"0 2px 8px rgba(0,0,0,0.10)",padding:"4px 10px",fontWeight:"bold",fontSize:"13px",zIndex:1e3,cursor:"pointer",transition:"box-shadow 0.2s",opacity:.96},onMouseOver:r=>r.currentTarget.style.boxShadow="0 4px 16px rgba(124,58,237,0.18)",onMouseOut:r=>r.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",children:"Leave Store"}):null}
