function BE(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var zE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xv={exports:{}},Gu={},wv={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Da=Symbol.for("react.element"),$E=Symbol.for("react.portal"),WE=Symbol.for("react.fragment"),qE=Symbol.for("react.strict_mode"),HE=Symbol.for("react.profiler"),KE=Symbol.for("react.provider"),GE=Symbol.for("react.context"),QE=Symbol.for("react.forward_ref"),YE=Symbol.for("react.suspense"),JE=Symbol.for("react.memo"),XE=Symbol.for("react.lazy"),Og=Symbol.iterator;function ZE(t){return t===null||typeof t!="object"?null:(t=Og&&t[Og]||t["@@iterator"],typeof t=="function"?t:null)}var Ev={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sv=Object.assign,Iv={};function co(t,e,n){this.props=t,this.context=e,this.refs=Iv,this.updater=n||Ev}co.prototype.isReactComponent={};co.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};co.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Tv(){}Tv.prototype=co.prototype;function sf(t,e,n){this.props=t,this.context=e,this.refs=Iv,this.updater=n||Ev}var of=sf.prototype=new Tv;of.constructor=sf;Sv(of,co.prototype);of.isPureReactComponent=!0;var Lg=Array.isArray,bv=Object.prototype.hasOwnProperty,af={current:null},Cv={key:!0,ref:!0,__self:!0,__source:!0};function Av(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)bv.call(e,r)&&!Cv.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Da,type:t,key:s,ref:o,props:i,_owner:af.current}}function e1(t,e){return{$$typeof:Da,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Da}function t1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Mg=/\/+/g;function Gc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?t1(""+t.key):e.toString(36)}function Fl(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Da:case $E:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gc(o,0):r,Lg(i)?(n="",t!=null&&(n=t.replace(Mg,"$&/")+"/"),Fl(i,e,n,"",function(d){return d})):i!=null&&(lf(i)&&(i=e1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Mg,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Lg(t))for(var u=0;u<t.length;u++){s=t[u];var c=r+Gc(s,u);o+=Fl(s,e,n,c,i)}else if(c=ZE(t),typeof c=="function")for(t=c.call(t),u=0;!(s=t.next()).done;)s=s.value,c=r+Gc(s,u++),o+=Fl(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ml(t,e,n){if(t==null)return t;var r=[],i=0;return Fl(t,r,"","",function(s){return e.call(n,s,i++)}),r}function n1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dn={current:null},Ul={transition:null},r1={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:Ul,ReactCurrentOwner:af};function Rv(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:ml,forEach:function(t,e,n){ml(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ml(t,function(){e++}),e},toArray:function(t){return ml(t,function(e){return e})||[]},only:function(t){if(!lf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=co;Le.Fragment=WE;Le.Profiler=HE;Le.PureComponent=sf;Le.StrictMode=qE;Le.Suspense=YE;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r1;Le.act=Rv;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Sv({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=af.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)bv.call(e,c)&&!Cv.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:Da,type:t.type,key:i,ref:s,props:r,_owner:o}};Le.createContext=function(t){return t={$$typeof:GE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KE,_context:t},t.Consumer=t};Le.createElement=Av;Le.createFactory=function(t){var e=Av.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:QE,render:t}};Le.isValidElement=lf;Le.lazy=function(t){return{$$typeof:XE,_payload:{_status:-1,_result:t},_init:n1}};Le.memo=function(t,e){return{$$typeof:JE,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Ul.transition;Ul.transition={};try{t()}finally{Ul.transition=e}};Le.unstable_act=Rv;Le.useCallback=function(t,e){return dn.current.useCallback(t,e)};Le.useContext=function(t){return dn.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return dn.current.useDeferredValue(t)};Le.useEffect=function(t,e){return dn.current.useEffect(t,e)};Le.useId=function(){return dn.current.useId()};Le.useImperativeHandle=function(t,e,n){return dn.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return dn.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return dn.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return dn.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return dn.current.useReducer(t,e,n)};Le.useRef=function(t){return dn.current.useRef(t)};Le.useState=function(t){return dn.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return dn.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return dn.current.useTransition()};Le.version="18.3.1";wv.exports=Le;var P=wv.exports;const Be=_v(P),i1=BE({__proto__:null,default:Be},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1=P,o1=Symbol.for("react.element"),a1=Symbol.for("react.fragment"),l1=Object.prototype.hasOwnProperty,u1=s1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c1={key:!0,ref:!0,__self:!0,__source:!0};function kv(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)l1.call(e,r)&&!c1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:o1,type:t,key:s,ref:o,props:i,_owner:u1.current}}Gu.Fragment=a1;Gu.jsx=kv;Gu.jsxs=kv;xv.exports=Gu;var a=xv.exports,Ld={},Pv={exports:{}},An={},jv={exports:{}},Nv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,F){var W=L.length;L.push(F);e:for(;0<W;){var H=W-1>>>1,Q=L[H];if(0<i(Q,F))L[H]=F,L[W]=Q,W=H;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var F=L[0],W=L.pop();if(W!==F){L[0]=W;e:for(var H=0,Q=L.length,O=Q>>>1;H<O;){var Z=2*(H+1)-1,z=L[Z],se=Z+1,fe=L[se];if(0>i(z,W))se<Q&&0>i(fe,z)?(L[H]=fe,L[se]=W,H=se):(L[H]=z,L[Z]=W,H=Z);else if(se<Q&&0>i(fe,W))L[H]=fe,L[se]=W,H=se;else break e}}return F}function i(L,F){var W=L.sortIndex-F.sortIndex;return W!==0?W:L.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var c=[],d=[],p=1,y=null,_=3,S=!1,C=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(L){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=L)r(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function V(L){if(k=!1,T(L),!C)if(n(c)!==null)C=!0,ne(N);else{var F=n(d);F!==null&&X(V,F.startTime-L)}}function N(L,F){C=!1,k&&(k=!1,b(f),f=-1),S=!0;var W=_;try{for(T(F),y=n(c);y!==null&&(!(y.expirationTime>F)||L&&!R());){var H=y.callback;if(typeof H=="function"){y.callback=null,_=y.priorityLevel;var Q=H(y.expirationTime<=F);F=t.unstable_now(),typeof Q=="function"?y.callback=Q:y===n(c)&&r(c),T(F)}else r(c);y=n(c)}if(y!==null)var O=!0;else{var Z=n(d);Z!==null&&X(V,Z.startTime-F),O=!1}return O}finally{y=null,_=W,S=!1}}var M=!1,w=null,f=-1,m=5,x=-1;function R(){return!(t.unstable_now()-x<m)}function j(){if(w!==null){var L=t.unstable_now();x=L;var F=!0;try{F=w(!0,L)}finally{F?A():(M=!1,w=null)}}else M=!1}var A;if(typeof E=="function")A=function(){E(j)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,$=te.port2;te.port1.onmessage=j,A=function(){$.postMessage(null)}}else A=function(){D(j,0)};function ne(L){w=L,M||(M=!0,A())}function X(L,F){f=D(function(){L(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){C||S||(C=!0,ne(N))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(L){switch(_){case 1:case 2:case 3:var F=3;break;default:F=_}var W=_;_=F;try{return L()}finally{_=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,F){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var W=_;_=L;try{return F()}finally{_=W}},t.unstable_scheduleCallback=function(L,F,W){var H=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?H+W:H):W=H,L){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=W+Q,L={id:p++,callback:F,priorityLevel:L,startTime:W,expirationTime:Q,sortIndex:-1},W>H?(L.sortIndex=W,e(d,L),n(c)===null&&L===n(d)&&(k?(b(f),f=-1):k=!0,X(V,W-H))):(L.sortIndex=Q,e(c,L),C||S||(C=!0,ne(N))),L},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(L){var F=_;return function(){var W=_;_=F;try{return L.apply(this,arguments)}finally{_=W}}}})(Nv);jv.exports=Nv;var d1=jv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1=P,bn=d1;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dv=new Set,aa={};function is(t,e){Qs(t,e),Qs(t+"Capture",e)}function Qs(t,e){for(aa[t]=e,t=0;t<e.length;t++)Dv.add(e[t])}var Pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Md=Object.prototype.hasOwnProperty,f1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vg={},Fg={};function p1(t){return Md.call(Fg,t)?!0:Md.call(Vg,t)?!1:f1.test(t)?Fg[t]=!0:(Vg[t]=!0,!1)}function g1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function m1(t,e,n,r){if(e===null||typeof e>"u"||g1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wt[t]=new hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wt[e]=new hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wt[t]=new hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wt[t]=new hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wt[t]=new hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wt[t]=new hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wt[t]=new hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wt[t]=new hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wt[t]=new hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var uf=/[\-:]([a-z])/g;function cf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(uf,cf);Wt[e]=new hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(uf,cf);Wt[e]=new hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(uf,cf);Wt[e]=new hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wt[t]=new hn(t,1,!1,t.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wt[t]=new hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function df(t,e,n,r){var i=Wt.hasOwnProperty(e)?Wt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(m1(e,n,i,r)&&(n=null),r||i===null?p1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Fr=h1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yl=Symbol.for("react.element"),Is=Symbol.for("react.portal"),Ts=Symbol.for("react.fragment"),hf=Symbol.for("react.strict_mode"),Vd=Symbol.for("react.profiler"),Ov=Symbol.for("react.provider"),Lv=Symbol.for("react.context"),ff=Symbol.for("react.forward_ref"),Fd=Symbol.for("react.suspense"),Ud=Symbol.for("react.suspense_list"),pf=Symbol.for("react.memo"),Yr=Symbol.for("react.lazy"),Mv=Symbol.for("react.offscreen"),Ug=Symbol.iterator;function Co(t){return t===null||typeof t!="object"?null:(t=Ug&&t[Ug]||t["@@iterator"],typeof t=="function"?t:null)}var ct=Object.assign,Qc;function Lo(t){if(Qc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qc=e&&e[1]||""}return`
`+Qc+t}var Yc=!1;function Jc(t,e){if(!t||Yc)return"";Yc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,u=s.length-1;1<=o&&0<=u&&i[o]!==s[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==s[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==s[u]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=u);break}}}finally{Yc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Lo(t):""}function y1(t){switch(t.tag){case 5:return Lo(t.type);case 16:return Lo("Lazy");case 13:return Lo("Suspense");case 19:return Lo("SuspenseList");case 0:case 2:case 15:return t=Jc(t.type,!1),t;case 11:return t=Jc(t.type.render,!1),t;case 1:return t=Jc(t.type,!0),t;default:return""}}function Bd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ts:return"Fragment";case Is:return"Portal";case Vd:return"Profiler";case hf:return"StrictMode";case Fd:return"Suspense";case Ud:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Lv:return(t.displayName||"Context")+".Consumer";case Ov:return(t._context.displayName||"Context")+".Provider";case ff:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pf:return e=t.displayName||null,e!==null?e:Bd(t.type)||"Memo";case Yr:e=t._payload,t=t._init;try{return Bd(t(e))}catch{}}return null}function v1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bd(e);case 8:return e===hf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function mi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Vv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _1(t){var e=Vv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vl(t){t._valueTracker||(t._valueTracker=_1(t))}function Fv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Vv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function su(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zd(t,e){var n=e.checked;return ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Bg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=mi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uv(t,e){e=e.checked,e!=null&&df(t,"checked",e,!1)}function $d(t,e){Uv(t,e);var n=mi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wd(t,e.type,mi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wd(t,e,n){(e!=="number"||su(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Mo=Array.isArray;function Vs(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+mi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function qd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $g(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ee(92));if(Mo(n)){if(1<n.length)throw Error(ee(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:mi(n)}}function Bv(t,e){var n=mi(e.value),r=mi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Wg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _l,$v=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_l.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function la(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ho={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x1=["Webkit","ms","Moz","O"];Object.keys(Ho).forEach(function(t){x1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ho[e]=Ho[t]})});function Wv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ho.hasOwnProperty(t)&&Ho[t]?(""+e).trim():e+"px"}function qv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Wv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var w1=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kd(t,e){if(e){if(w1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function Gd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qd=null;function gf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yd=null,Fs=null,Us=null;function qg(t){if(t=Ma(t)){if(typeof Yd!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=Zu(e),Yd(t.stateNode,t.type,e))}}function Hv(t){Fs?Us?Us.push(t):Us=[t]:Fs=t}function Kv(){if(Fs){var t=Fs,e=Us;if(Us=Fs=null,qg(t),e)for(t=0;t<e.length;t++)qg(e[t])}}function Gv(t,e){return t(e)}function Qv(){}var Xc=!1;function Yv(t,e,n){if(Xc)return t(e,n);Xc=!0;try{return Gv(t,e,n)}finally{Xc=!1,(Fs!==null||Us!==null)&&(Qv(),Kv())}}function ua(t,e){var n=t.stateNode;if(n===null)return null;var r=Zu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ee(231,e,typeof n));return n}var Jd=!1;if(Pr)try{var Ao={};Object.defineProperty(Ao,"passive",{get:function(){Jd=!0}}),window.addEventListener("test",Ao,Ao),window.removeEventListener("test",Ao,Ao)}catch{Jd=!1}function E1(t,e,n,r,i,s,o,u,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(p){this.onError(p)}}var Ko=!1,ou=null,au=!1,Xd=null,S1={onError:function(t){Ko=!0,ou=t}};function I1(t,e,n,r,i,s,o,u,c){Ko=!1,ou=null,E1.apply(S1,arguments)}function T1(t,e,n,r,i,s,o,u,c){if(I1.apply(this,arguments),Ko){if(Ko){var d=ou;Ko=!1,ou=null}else throw Error(ee(198));au||(au=!0,Xd=d)}}function ss(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Jv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Hg(t){if(ss(t)!==t)throw Error(ee(188))}function b1(t){var e=t.alternate;if(!e){if(e=ss(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Hg(i),t;if(s===r)return Hg(i),e;s=s.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=s;break}if(u===r){o=!0,r=i,n=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===n){o=!0,n=s,r=i;break}if(u===r){o=!0,r=s,n=i;break}u=u.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?t:e}function Xv(t){return t=b1(t),t!==null?Zv(t):null}function Zv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Zv(t);if(e!==null)return e;t=t.sibling}return null}var e0=bn.unstable_scheduleCallback,Kg=bn.unstable_cancelCallback,C1=bn.unstable_shouldYield,A1=bn.unstable_requestPaint,mt=bn.unstable_now,R1=bn.unstable_getCurrentPriorityLevel,mf=bn.unstable_ImmediatePriority,t0=bn.unstable_UserBlockingPriority,lu=bn.unstable_NormalPriority,k1=bn.unstable_LowPriority,n0=bn.unstable_IdlePriority,Qu=null,ir=null;function P1(t){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(Qu,t,void 0,(t.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:D1,j1=Math.log,N1=Math.LN2;function D1(t){return t>>>=0,t===0?32:31-(j1(t)/N1|0)|0}var xl=64,wl=4194304;function Vo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function uu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=Vo(u):(s&=o,s!==0&&(r=Vo(s)))}else o=n&~i,o!==0?r=Vo(o):s!==0&&(r=Vo(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Kn(e),i=1<<n,r|=t[n],e&=~i;return r}function O1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Kn(s),u=1<<o,c=i[o];c===-1?(!(u&n)||u&r)&&(i[o]=O1(u,e)):c<=e&&(t.expiredLanes|=u),s&=~u}}function Zd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function r0(){var t=xl;return xl<<=1,!(xl&4194240)&&(xl=64),t}function Zc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Oa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kn(e),t[e]=n}function M1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Kn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function yf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Kn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var He=0;function i0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var s0,vf,o0,a0,l0,eh=!1,El=[],ii=null,si=null,oi=null,ca=new Map,da=new Map,Xr=[],V1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gg(t,e){switch(t){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":si=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":ca.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":da.delete(e.pointerId)}}function Ro(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ma(e),e!==null&&vf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function F1(t,e,n,r,i){switch(e){case"focusin":return ii=Ro(ii,t,e,n,r,i),!0;case"dragenter":return si=Ro(si,t,e,n,r,i),!0;case"mouseover":return oi=Ro(oi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ca.set(s,Ro(ca.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,da.set(s,Ro(da.get(s)||null,t,e,n,r,i)),!0}return!1}function u0(t){var e=Vi(t.target);if(e!==null){var n=ss(e);if(n!==null){if(e=n.tag,e===13){if(e=Jv(n),e!==null){t.blockedOn=e,l0(t.priority,function(){o0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Bl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=th(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qd=r,n.target.dispatchEvent(r),Qd=null}else return e=Ma(n),e!==null&&vf(e),t.blockedOn=n,!1;e.shift()}return!0}function Qg(t,e,n){Bl(t)&&n.delete(e)}function U1(){eh=!1,ii!==null&&Bl(ii)&&(ii=null),si!==null&&Bl(si)&&(si=null),oi!==null&&Bl(oi)&&(oi=null),ca.forEach(Qg),da.forEach(Qg)}function ko(t,e){t.blockedOn===e&&(t.blockedOn=null,eh||(eh=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,U1)))}function ha(t){function e(i){return ko(i,t)}if(0<El.length){ko(El[0],t);for(var n=1;n<El.length;n++){var r=El[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ii!==null&&ko(ii,t),si!==null&&ko(si,t),oi!==null&&ko(oi,t),ca.forEach(e),da.forEach(e),n=0;n<Xr.length;n++)r=Xr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Xr.length&&(n=Xr[0],n.blockedOn===null);)u0(n),n.blockedOn===null&&Xr.shift()}var Bs=Fr.ReactCurrentBatchConfig,cu=!0;function B1(t,e,n,r){var i=He,s=Bs.transition;Bs.transition=null;try{He=1,_f(t,e,n,r)}finally{He=i,Bs.transition=s}}function z1(t,e,n,r){var i=He,s=Bs.transition;Bs.transition=null;try{He=4,_f(t,e,n,r)}finally{He=i,Bs.transition=s}}function _f(t,e,n,r){if(cu){var i=th(t,e,n,r);if(i===null)ud(t,e,r,du,n),Gg(t,r);else if(F1(i,t,e,n,r))r.stopPropagation();else if(Gg(t,r),e&4&&-1<V1.indexOf(t)){for(;i!==null;){var s=Ma(i);if(s!==null&&s0(s),s=th(t,e,n,r),s===null&&ud(t,e,r,du,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ud(t,e,r,null,n)}}var du=null;function th(t,e,n,r){if(du=null,t=gf(r),t=Vi(t),t!==null)if(e=ss(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Jv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return du=t,null}function c0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(R1()){case mf:return 1;case t0:return 4;case lu:case k1:return 16;case n0:return 536870912;default:return 16}default:return 16}}var ei=null,xf=null,zl=null;function d0(){if(zl)return zl;var t,e=xf,n=e.length,r,i="value"in ei?ei.value:ei.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return zl=i.slice(t,1<r?1-r:void 0)}function $l(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sl(){return!0}function Yg(){return!1}function Rn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Sl:Yg,this.isPropagationStopped=Yg,this}return ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sl)},persist:function(){},isPersistent:Sl}),e}var ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wf=Rn(ho),La=ct({},ho,{view:0,detail:0}),$1=Rn(La),ed,td,Po,Yu=ct({},La,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ef,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Po&&(Po&&t.type==="mousemove"?(ed=t.screenX-Po.screenX,td=t.screenY-Po.screenY):td=ed=0,Po=t),ed)},movementY:function(t){return"movementY"in t?t.movementY:td}}),Jg=Rn(Yu),W1=ct({},Yu,{dataTransfer:0}),q1=Rn(W1),H1=ct({},La,{relatedTarget:0}),nd=Rn(H1),K1=ct({},ho,{animationName:0,elapsedTime:0,pseudoElement:0}),G1=Rn(K1),Q1=ct({},ho,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Y1=Rn(Q1),J1=ct({},ho,{data:0}),Xg=Rn(J1),X1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eS[t])?!!e[t]:!1}function Ef(){return tS}var nS=ct({},La,{key:function(t){if(t.key){var e=X1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$l(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Z1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ef,charCode:function(t){return t.type==="keypress"?$l(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$l(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rS=Rn(nS),iS=ct({},Yu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zg=Rn(iS),sS=ct({},La,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ef}),oS=Rn(sS),aS=ct({},ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),lS=Rn(aS),uS=ct({},Yu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),cS=Rn(uS),dS=[9,13,27,32],Sf=Pr&&"CompositionEvent"in window,Go=null;Pr&&"documentMode"in document&&(Go=document.documentMode);var hS=Pr&&"TextEvent"in window&&!Go,h0=Pr&&(!Sf||Go&&8<Go&&11>=Go),em=" ",tm=!1;function f0(t,e){switch(t){case"keyup":return dS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var bs=!1;function fS(t,e){switch(t){case"compositionend":return p0(e);case"keypress":return e.which!==32?null:(tm=!0,em);case"textInput":return t=e.data,t===em&&tm?null:t;default:return null}}function pS(t,e){if(bs)return t==="compositionend"||!Sf&&f0(t,e)?(t=d0(),zl=xf=ei=null,bs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return h0&&e.locale!=="ko"?null:e.data;default:return null}}var gS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gS[t.type]:e==="textarea"}function g0(t,e,n,r){Hv(r),e=hu(e,"onChange"),0<e.length&&(n=new wf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Qo=null,fa=null;function mS(t){b0(t,0)}function Ju(t){var e=Rs(t);if(Fv(e))return t}function yS(t,e){if(t==="change")return e}var m0=!1;if(Pr){var rd;if(Pr){var id="oninput"in document;if(!id){var rm=document.createElement("div");rm.setAttribute("oninput","return;"),id=typeof rm.oninput=="function"}rd=id}else rd=!1;m0=rd&&(!document.documentMode||9<document.documentMode)}function im(){Qo&&(Qo.detachEvent("onpropertychange",y0),fa=Qo=null)}function y0(t){if(t.propertyName==="value"&&Ju(fa)){var e=[];g0(e,fa,t,gf(t)),Yv(mS,e)}}function vS(t,e,n){t==="focusin"?(im(),Qo=e,fa=n,Qo.attachEvent("onpropertychange",y0)):t==="focusout"&&im()}function _S(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ju(fa)}function xS(t,e){if(t==="click")return Ju(e)}function wS(t,e){if(t==="input"||t==="change")return Ju(e)}function ES(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qn=typeof Object.is=="function"?Object.is:ES;function pa(t,e){if(Qn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Md.call(e,i)||!Qn(t[i],e[i]))return!1}return!0}function sm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function om(t,e){var n=sm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sm(n)}}function v0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function _0(){for(var t=window,e=su();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=su(t.document)}return e}function If(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function SS(t){var e=_0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&v0(n.ownerDocument.documentElement,n)){if(r!==null&&If(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=om(n,s);var o=om(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var IS=Pr&&"documentMode"in document&&11>=document.documentMode,Cs=null,nh=null,Yo=null,rh=!1;function am(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rh||Cs==null||Cs!==su(r)||(r=Cs,"selectionStart"in r&&If(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yo&&pa(Yo,r)||(Yo=r,r=hu(nh,"onSelect"),0<r.length&&(e=new wf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Cs)))}function Il(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var As={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionend:Il("Transition","TransitionEnd")},sd={},x0={};Pr&&(x0=document.createElement("div").style,"AnimationEvent"in window||(delete As.animationend.animation,delete As.animationiteration.animation,delete As.animationstart.animation),"TransitionEvent"in window||delete As.transitionend.transition);function Xu(t){if(sd[t])return sd[t];if(!As[t])return t;var e=As[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in x0)return sd[t]=e[n];return t}var w0=Xu("animationend"),E0=Xu("animationiteration"),S0=Xu("animationstart"),I0=Xu("transitionend"),T0=new Map,lm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(t,e){T0.set(t,e),is(e,[t])}for(var od=0;od<lm.length;od++){var ad=lm[od],TS=ad.toLowerCase(),bS=ad[0].toUpperCase()+ad.slice(1);Ei(TS,"on"+bS)}Ei(w0,"onAnimationEnd");Ei(E0,"onAnimationIteration");Ei(S0,"onAnimationStart");Ei("dblclick","onDoubleClick");Ei("focusin","onFocus");Ei("focusout","onBlur");Ei(I0,"onTransitionEnd");Qs("onMouseEnter",["mouseout","mouseover"]);Qs("onMouseLeave",["mouseout","mouseover"]);Qs("onPointerEnter",["pointerout","pointerover"]);Qs("onPointerLeave",["pointerout","pointerover"]);is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));is("onBeforeInput",["compositionend","keypress","textInput","paste"]);is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fo));function um(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,T1(r,e,void 0,t),t.currentTarget=null}function b0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var u=r[o],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==s&&i.isPropagationStopped())break e;um(i,u,d),s=c}else for(o=0;o<r.length;o++){if(u=r[o],c=u.instance,d=u.currentTarget,u=u.listener,c!==s&&i.isPropagationStopped())break e;um(i,u,d),s=c}}}if(au)throw t=Xd,au=!1,Xd=null,t}function nt(t,e){var n=e[lh];n===void 0&&(n=e[lh]=new Set);var r=t+"__bubble";n.has(r)||(C0(e,t,2,!1),n.add(r))}function ld(t,e,n){var r=0;e&&(r|=4),C0(n,t,r,e)}var Tl="_reactListening"+Math.random().toString(36).slice(2);function ga(t){if(!t[Tl]){t[Tl]=!0,Dv.forEach(function(n){n!=="selectionchange"&&(CS.has(n)||ld(n,!1,t),ld(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Tl]||(e[Tl]=!0,ld("selectionchange",!1,e))}}function C0(t,e,n,r){switch(c0(e)){case 1:var i=B1;break;case 4:i=z1;break;default:i=_f}n=i.bind(null,e,n,t),i=void 0,!Jd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ud(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;u!==null;){if(o=Vi(u),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}u=u.parentNode}}r=r.return}Yv(function(){var d=s,p=gf(n),y=[];e:{var _=T0.get(t);if(_!==void 0){var S=wf,C=t;switch(t){case"keypress":if($l(n)===0)break e;case"keydown":case"keyup":S=rS;break;case"focusin":C="focus",S=nd;break;case"focusout":C="blur",S=nd;break;case"beforeblur":case"afterblur":S=nd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=Jg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=q1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=oS;break;case w0:case E0:case S0:S=G1;break;case I0:S=lS;break;case"scroll":S=$1;break;case"wheel":S=cS;break;case"copy":case"cut":case"paste":S=Y1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=Zg}var k=(e&4)!==0,D=!k&&t==="scroll",b=k?_!==null?_+"Capture":null:_;k=[];for(var E=d,T;E!==null;){T=E;var V=T.stateNode;if(T.tag===5&&V!==null&&(T=V,b!==null&&(V=ua(E,b),V!=null&&k.push(ma(E,V,T)))),D)break;E=E.return}0<k.length&&(_=new S(_,C,null,n,p),y.push({event:_,listeners:k}))}}if(!(e&7)){e:{if(_=t==="mouseover"||t==="pointerover",S=t==="mouseout"||t==="pointerout",_&&n!==Qd&&(C=n.relatedTarget||n.fromElement)&&(Vi(C)||C[jr]))break e;if((S||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,S?(C=n.relatedTarget||n.toElement,S=d,C=C?Vi(C):null,C!==null&&(D=ss(C),C!==D||C.tag!==5&&C.tag!==6)&&(C=null)):(S=null,C=d),S!==C)){if(k=Jg,V="onMouseLeave",b="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(k=Zg,V="onPointerLeave",b="onPointerEnter",E="pointer"),D=S==null?_:Rs(S),T=C==null?_:Rs(C),_=new k(V,E+"leave",S,n,p),_.target=D,_.relatedTarget=T,V=null,Vi(p)===d&&(k=new k(b,E+"enter",C,n,p),k.target=T,k.relatedTarget=D,V=k),D=V,S&&C)t:{for(k=S,b=C,E=0,T=k;T;T=vs(T))E++;for(T=0,V=b;V;V=vs(V))T++;for(;0<E-T;)k=vs(k),E--;for(;0<T-E;)b=vs(b),T--;for(;E--;){if(k===b||b!==null&&k===b.alternate)break t;k=vs(k),b=vs(b)}k=null}else k=null;S!==null&&cm(y,_,S,k,!1),C!==null&&D!==null&&cm(y,D,C,k,!0)}}e:{if(_=d?Rs(d):window,S=_.nodeName&&_.nodeName.toLowerCase(),S==="select"||S==="input"&&_.type==="file")var N=yS;else if(nm(_))if(m0)N=wS;else{N=_S;var M=vS}else(S=_.nodeName)&&S.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(N=xS);if(N&&(N=N(t,d))){g0(y,N,n,p);break e}M&&M(t,_,d),t==="focusout"&&(M=_._wrapperState)&&M.controlled&&_.type==="number"&&Wd(_,"number",_.value)}switch(M=d?Rs(d):window,t){case"focusin":(nm(M)||M.contentEditable==="true")&&(Cs=M,nh=d,Yo=null);break;case"focusout":Yo=nh=Cs=null;break;case"mousedown":rh=!0;break;case"contextmenu":case"mouseup":case"dragend":rh=!1,am(y,n,p);break;case"selectionchange":if(IS)break;case"keydown":case"keyup":am(y,n,p)}var w;if(Sf)e:{switch(t){case"compositionstart":var f="onCompositionStart";break e;case"compositionend":f="onCompositionEnd";break e;case"compositionupdate":f="onCompositionUpdate";break e}f=void 0}else bs?f0(t,n)&&(f="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(f="onCompositionStart");f&&(h0&&n.locale!=="ko"&&(bs||f!=="onCompositionStart"?f==="onCompositionEnd"&&bs&&(w=d0()):(ei=p,xf="value"in ei?ei.value:ei.textContent,bs=!0)),M=hu(d,f),0<M.length&&(f=new Xg(f,t,null,n,p),y.push({event:f,listeners:M}),w?f.data=w:(w=p0(n),w!==null&&(f.data=w)))),(w=hS?fS(t,n):pS(t,n))&&(d=hu(d,"onBeforeInput"),0<d.length&&(p=new Xg("onBeforeInput","beforeinput",null,n,p),y.push({event:p,listeners:d}),p.data=w))}b0(y,e)})}function ma(t,e,n){return{instance:t,listener:e,currentTarget:n}}function hu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ua(t,n),s!=null&&r.unshift(ma(t,s,i)),s=ua(t,e),s!=null&&r.push(ma(t,s,i))),t=t.return}return r}function vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function cm(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var u=n,c=u.alternate,d=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&d!==null&&(u=d,i?(c=ua(n,s),c!=null&&o.unshift(ma(n,c,u))):i||(c=ua(n,s),c!=null&&o.push(ma(n,c,u)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var AS=/\r\n?/g,RS=/\u0000|\uFFFD/g;function dm(t){return(typeof t=="string"?t:""+t).replace(AS,`
`).replace(RS,"")}function bl(t,e,n){if(e=dm(e),dm(t)!==e&&n)throw Error(ee(425))}function fu(){}var ih=null,sh=null;function oh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ah=typeof setTimeout=="function"?setTimeout:void 0,kS=typeof clearTimeout=="function"?clearTimeout:void 0,hm=typeof Promise=="function"?Promise:void 0,PS=typeof queueMicrotask=="function"?queueMicrotask:typeof hm<"u"?function(t){return hm.resolve(null).then(t).catch(jS)}:ah;function jS(t){setTimeout(function(){throw t})}function cd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ha(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ha(e)}function ai(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function fm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var fo=Math.random().toString(36).slice(2),nr="__reactFiber$"+fo,ya="__reactProps$"+fo,jr="__reactContainer$"+fo,lh="__reactEvents$"+fo,NS="__reactListeners$"+fo,DS="__reactHandles$"+fo;function Vi(t){var e=t[nr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jr]||n[nr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=fm(t);t!==null;){if(n=t[nr])return n;t=fm(t)}return e}t=n,n=t.parentNode}return null}function Ma(t){return t=t[nr]||t[jr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Rs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function Zu(t){return t[ya]||null}var uh=[],ks=-1;function Si(t){return{current:t}}function it(t){0>ks||(t.current=uh[ks],uh[ks]=null,ks--)}function Xe(t,e){ks++,uh[ks]=t.current,t.current=e}var yi={},tn=Si(yi),yn=Si(!1),qi=yi;function Ys(t,e){var n=t.type.contextTypes;if(!n)return yi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vn(t){return t=t.childContextTypes,t!=null}function pu(){it(yn),it(tn)}function pm(t,e,n){if(tn.current!==yi)throw Error(ee(168));Xe(tn,e),Xe(yn,n)}function A0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,v1(t)||"Unknown",i));return ct({},n,r)}function gu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yi,qi=tn.current,Xe(tn,t),Xe(yn,yn.current),!0}function gm(t,e,n){var r=t.stateNode;if(!r)throw Error(ee(169));n?(t=A0(t,e,qi),r.__reactInternalMemoizedMergedChildContext=t,it(yn),it(tn),Xe(tn,t)):it(yn),Xe(yn,n)}var yr=null,ec=!1,dd=!1;function R0(t){yr===null?yr=[t]:yr.push(t)}function OS(t){ec=!0,R0(t)}function Ii(){if(!dd&&yr!==null){dd=!0;var t=0,e=He;try{var n=yr;for(He=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}yr=null,ec=!1}catch(i){throw yr!==null&&(yr=yr.slice(t+1)),e0(mf,Ii),i}finally{He=e,dd=!1}}return null}var Ps=[],js=0,mu=null,yu=0,Nn=[],Dn=0,Hi=null,Er=1,Sr="";function Oi(t,e){Ps[js++]=yu,Ps[js++]=mu,mu=t,yu=e}function k0(t,e,n){Nn[Dn++]=Er,Nn[Dn++]=Sr,Nn[Dn++]=Hi,Hi=t;var r=Er;t=Sr;var i=32-Kn(r)-1;r&=~(1<<i),n+=1;var s=32-Kn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Er=1<<32-Kn(e)+i|n<<i|r,Sr=s+t}else Er=1<<s|n<<i|r,Sr=t}function Tf(t){t.return!==null&&(Oi(t,1),k0(t,1,0))}function bf(t){for(;t===mu;)mu=Ps[--js],Ps[js]=null,yu=Ps[--js],Ps[js]=null;for(;t===Hi;)Hi=Nn[--Dn],Nn[Dn]=null,Sr=Nn[--Dn],Nn[Dn]=null,Er=Nn[--Dn],Nn[Dn]=null}var Tn=null,Sn=null,st=!1,Hn=null;function P0(t,e){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function mm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tn=t,Sn=ai(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tn=t,Sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Hi!==null?{id:Er,overflow:Sr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Tn=t,Sn=null,!0):!1;default:return!1}}function ch(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dh(t){if(st){var e=Sn;if(e){var n=e;if(!mm(t,e)){if(ch(t))throw Error(ee(418));e=ai(n.nextSibling);var r=Tn;e&&mm(t,e)?P0(r,n):(t.flags=t.flags&-4097|2,st=!1,Tn=t)}}else{if(ch(t))throw Error(ee(418));t.flags=t.flags&-4097|2,st=!1,Tn=t}}}function ym(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tn=t}function Cl(t){if(t!==Tn)return!1;if(!st)return ym(t),st=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!oh(t.type,t.memoizedProps)),e&&(e=Sn)){if(ch(t))throw j0(),Error(ee(418));for(;e;)P0(t,e),e=ai(e.nextSibling)}if(ym(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sn=ai(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sn=null}}else Sn=Tn?ai(t.stateNode.nextSibling):null;return!0}function j0(){for(var t=Sn;t;)t=ai(t.nextSibling)}function Js(){Sn=Tn=null,st=!1}function Cf(t){Hn===null?Hn=[t]:Hn.push(t)}var LS=Fr.ReactCurrentBatchConfig;function jo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var u=i.refs;o===null?delete u[s]:u[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,t))}return t}function Al(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vm(t){var e=t._init;return e(t._payload)}function N0(t){function e(b,E){if(t){var T=b.deletions;T===null?(b.deletions=[E],b.flags|=16):T.push(E)}}function n(b,E){if(!t)return null;for(;E!==null;)e(b,E),E=E.sibling;return null}function r(b,E){for(b=new Map;E!==null;)E.key!==null?b.set(E.key,E):b.set(E.index,E),E=E.sibling;return b}function i(b,E){return b=di(b,E),b.index=0,b.sibling=null,b}function s(b,E,T){return b.index=T,t?(T=b.alternate,T!==null?(T=T.index,T<E?(b.flags|=2,E):T):(b.flags|=2,E)):(b.flags|=1048576,E)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function u(b,E,T,V){return E===null||E.tag!==6?(E=vd(T,b.mode,V),E.return=b,E):(E=i(E,T),E.return=b,E)}function c(b,E,T,V){var N=T.type;return N===Ts?p(b,E,T.props.children,V,T.key):E!==null&&(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Yr&&vm(N)===E.type)?(V=i(E,T.props),V.ref=jo(b,E,T),V.return=b,V):(V=Yl(T.type,T.key,T.props,null,b.mode,V),V.ref=jo(b,E,T),V.return=b,V)}function d(b,E,T,V){return E===null||E.tag!==4||E.stateNode.containerInfo!==T.containerInfo||E.stateNode.implementation!==T.implementation?(E=_d(T,b.mode,V),E.return=b,E):(E=i(E,T.children||[]),E.return=b,E)}function p(b,E,T,V,N){return E===null||E.tag!==7?(E=$i(T,b.mode,V,N),E.return=b,E):(E=i(E,T),E.return=b,E)}function y(b,E,T){if(typeof E=="string"&&E!==""||typeof E=="number")return E=vd(""+E,b.mode,T),E.return=b,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case yl:return T=Yl(E.type,E.key,E.props,null,b.mode,T),T.ref=jo(b,null,E),T.return=b,T;case Is:return E=_d(E,b.mode,T),E.return=b,E;case Yr:var V=E._init;return y(b,V(E._payload),T)}if(Mo(E)||Co(E))return E=$i(E,b.mode,T,null),E.return=b,E;Al(b,E)}return null}function _(b,E,T,V){var N=E!==null?E.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return N!==null?null:u(b,E,""+T,V);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case yl:return T.key===N?c(b,E,T,V):null;case Is:return T.key===N?d(b,E,T,V):null;case Yr:return N=T._init,_(b,E,N(T._payload),V)}if(Mo(T)||Co(T))return N!==null?null:p(b,E,T,V,null);Al(b,T)}return null}function S(b,E,T,V,N){if(typeof V=="string"&&V!==""||typeof V=="number")return b=b.get(T)||null,u(E,b,""+V,N);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case yl:return b=b.get(V.key===null?T:V.key)||null,c(E,b,V,N);case Is:return b=b.get(V.key===null?T:V.key)||null,d(E,b,V,N);case Yr:var M=V._init;return S(b,E,T,M(V._payload),N)}if(Mo(V)||Co(V))return b=b.get(T)||null,p(E,b,V,N,null);Al(E,V)}return null}function C(b,E,T,V){for(var N=null,M=null,w=E,f=E=0,m=null;w!==null&&f<T.length;f++){w.index>f?(m=w,w=null):m=w.sibling;var x=_(b,w,T[f],V);if(x===null){w===null&&(w=m);break}t&&w&&x.alternate===null&&e(b,w),E=s(x,E,f),M===null?N=x:M.sibling=x,M=x,w=m}if(f===T.length)return n(b,w),st&&Oi(b,f),N;if(w===null){for(;f<T.length;f++)w=y(b,T[f],V),w!==null&&(E=s(w,E,f),M===null?N=w:M.sibling=w,M=w);return st&&Oi(b,f),N}for(w=r(b,w);f<T.length;f++)m=S(w,b,f,T[f],V),m!==null&&(t&&m.alternate!==null&&w.delete(m.key===null?f:m.key),E=s(m,E,f),M===null?N=m:M.sibling=m,M=m);return t&&w.forEach(function(R){return e(b,R)}),st&&Oi(b,f),N}function k(b,E,T,V){var N=Co(T);if(typeof N!="function")throw Error(ee(150));if(T=N.call(T),T==null)throw Error(ee(151));for(var M=N=null,w=E,f=E=0,m=null,x=T.next();w!==null&&!x.done;f++,x=T.next()){w.index>f?(m=w,w=null):m=w.sibling;var R=_(b,w,x.value,V);if(R===null){w===null&&(w=m);break}t&&w&&R.alternate===null&&e(b,w),E=s(R,E,f),M===null?N=R:M.sibling=R,M=R,w=m}if(x.done)return n(b,w),st&&Oi(b,f),N;if(w===null){for(;!x.done;f++,x=T.next())x=y(b,x.value,V),x!==null&&(E=s(x,E,f),M===null?N=x:M.sibling=x,M=x);return st&&Oi(b,f),N}for(w=r(b,w);!x.done;f++,x=T.next())x=S(w,b,f,x.value,V),x!==null&&(t&&x.alternate!==null&&w.delete(x.key===null?f:x.key),E=s(x,E,f),M===null?N=x:M.sibling=x,M=x);return t&&w.forEach(function(j){return e(b,j)}),st&&Oi(b,f),N}function D(b,E,T,V){if(typeof T=="object"&&T!==null&&T.type===Ts&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case yl:e:{for(var N=T.key,M=E;M!==null;){if(M.key===N){if(N=T.type,N===Ts){if(M.tag===7){n(b,M.sibling),E=i(M,T.props.children),E.return=b,b=E;break e}}else if(M.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Yr&&vm(N)===M.type){n(b,M.sibling),E=i(M,T.props),E.ref=jo(b,M,T),E.return=b,b=E;break e}n(b,M);break}else e(b,M);M=M.sibling}T.type===Ts?(E=$i(T.props.children,b.mode,V,T.key),E.return=b,b=E):(V=Yl(T.type,T.key,T.props,null,b.mode,V),V.ref=jo(b,E,T),V.return=b,b=V)}return o(b);case Is:e:{for(M=T.key;E!==null;){if(E.key===M)if(E.tag===4&&E.stateNode.containerInfo===T.containerInfo&&E.stateNode.implementation===T.implementation){n(b,E.sibling),E=i(E,T.children||[]),E.return=b,b=E;break e}else{n(b,E);break}else e(b,E);E=E.sibling}E=_d(T,b.mode,V),E.return=b,b=E}return o(b);case Yr:return M=T._init,D(b,E,M(T._payload),V)}if(Mo(T))return C(b,E,T,V);if(Co(T))return k(b,E,T,V);Al(b,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,E!==null&&E.tag===6?(n(b,E.sibling),E=i(E,T),E.return=b,b=E):(n(b,E),E=vd(T,b.mode,V),E.return=b,b=E),o(b)):n(b,E)}return D}var Xs=N0(!0),D0=N0(!1),vu=Si(null),_u=null,Ns=null,Af=null;function Rf(){Af=Ns=_u=null}function kf(t){var e=vu.current;it(vu),t._currentValue=e}function hh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function zs(t,e){_u=t,Af=Ns=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mn=!0),t.firstContext=null)}function Fn(t){var e=t._currentValue;if(Af!==t)if(t={context:t,memoizedValue:e,next:null},Ns===null){if(_u===null)throw Error(ee(308));Ns=t,_u.dependencies={lanes:0,firstContext:t}}else Ns=Ns.next=t;return e}var Fi=null;function Pf(t){Fi===null?Fi=[t]:Fi.push(t)}function O0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Pf(e)):(n.next=i.next,i.next=n),e.interleaved=n,Nr(t,r)}function Nr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Jr=!1;function jf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function L0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Cr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function li(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Nr(t,n)}return i=r.interleaved,i===null?(e.next=e,Pf(r)):(e.next=i.next,i.next=e),r.interleaved=e,Nr(t,n)}function Wl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yf(t,n)}}function _m(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xu(t,e,n,r){var i=t.updateQueue;Jr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var p=t.alternate;p!==null&&(p=p.updateQueue,u=p.lastBaseUpdate,u!==o&&(u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=c))}if(s!==null){var y=i.baseState;o=0,p=d=c=null,u=s;do{var _=u.lane,S=u.eventTime;if((r&_)===_){p!==null&&(p=p.next={eventTime:S,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=t,k=u;switch(_=e,S=n,k.tag){case 1:if(C=k.payload,typeof C=="function"){y=C.call(S,y,_);break e}y=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=k.payload,_=typeof C=="function"?C.call(S,y,_):C,_==null)break e;y=ct({},y,_);break e;case 2:Jr=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,_=i.effects,_===null?i.effects=[u]:_.push(u))}else S={eventTime:S,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},p===null?(d=p=S,c=y):p=p.next=S,o|=_;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;_=u,u=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(p===null&&(c=y),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Gi|=o,t.lanes=o,t.memoizedState=y}}function xm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var Va={},sr=Si(Va),va=Si(Va),_a=Si(Va);function Ui(t){if(t===Va)throw Error(ee(174));return t}function Nf(t,e){switch(Xe(_a,e),Xe(va,t),Xe(sr,Va),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hd(e,t)}it(sr),Xe(sr,e)}function Zs(){it(sr),it(va),it(_a)}function M0(t){Ui(_a.current);var e=Ui(sr.current),n=Hd(e,t.type);e!==n&&(Xe(va,t),Xe(sr,n))}function Df(t){va.current===t&&(it(sr),it(va))}var lt=Si(0);function wu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hd=[];function Of(){for(var t=0;t<hd.length;t++)hd[t]._workInProgressVersionPrimary=null;hd.length=0}var ql=Fr.ReactCurrentDispatcher,fd=Fr.ReactCurrentBatchConfig,Ki=0,ut=null,Ct=null,Nt=null,Eu=!1,Jo=!1,xa=0,MS=0;function Qt(){throw Error(ee(321))}function Lf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Qn(t[n],e[n]))return!1;return!0}function Mf(t,e,n,r,i,s){if(Ki=s,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ql.current=t===null||t.memoizedState===null?BS:zS,t=n(r,i),Jo){s=0;do{if(Jo=!1,xa=0,25<=s)throw Error(ee(301));s+=1,Nt=Ct=null,e.updateQueue=null,ql.current=$S,t=n(r,i)}while(Jo)}if(ql.current=Su,e=Ct!==null&&Ct.next!==null,Ki=0,Nt=Ct=ut=null,Eu=!1,e)throw Error(ee(300));return t}function Vf(){var t=xa!==0;return xa=0,t}function tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?ut.memoizedState=Nt=t:Nt=Nt.next=t,Nt}function Un(){if(Ct===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=Ct.next;var e=Nt===null?ut.memoizedState:Nt.next;if(e!==null)Nt=e,Ct=t;else{if(t===null)throw Error(ee(310));Ct=t,t={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},Nt===null?ut.memoizedState=Nt=t:Nt=Nt.next=t}return Nt}function wa(t,e){return typeof e=="function"?e(t):e}function pd(t){var e=Un(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=Ct,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=o=null,c=null,d=s;do{var p=d.lane;if((Ki&p)===p)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var y={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=y,o=r):c=c.next=y,ut.lanes|=p,Gi|=p}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=u,Qn(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ut.lanes|=s,Gi|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gd(t){var e=Un(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Qn(s,e.memoizedState)||(mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function V0(){}function F0(t,e){var n=ut,r=Un(),i=e(),s=!Qn(r.memoizedState,i);if(s&&(r.memoizedState=i,mn=!0),r=r.queue,Ff(z0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,Ea(9,B0.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(ee(349));Ki&30||U0(n,e,i)}return i}function U0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function B0(t,e,n,r){e.value=n,e.getSnapshot=r,$0(e)&&W0(t)}function z0(t,e,n){return n(function(){$0(e)&&W0(t)})}function $0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Qn(t,n)}catch{return!0}}function W0(t){var e=Nr(t,1);e!==null&&Gn(e,t,1,-1)}function wm(t){var e=tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:t},e.queue=t,t=t.dispatch=US.bind(null,ut,t),[e.memoizedState,t]}function Ea(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function q0(){return Un().memoizedState}function Hl(t,e,n,r){var i=tr();ut.flags|=t,i.memoizedState=Ea(1|e,n,void 0,r===void 0?null:r)}function tc(t,e,n,r){var i=Un();r=r===void 0?null:r;var s=void 0;if(Ct!==null){var o=Ct.memoizedState;if(s=o.destroy,r!==null&&Lf(r,o.deps)){i.memoizedState=Ea(e,n,s,r);return}}ut.flags|=t,i.memoizedState=Ea(1|e,n,s,r)}function Em(t,e){return Hl(8390656,8,t,e)}function Ff(t,e){return tc(2048,8,t,e)}function H0(t,e){return tc(4,2,t,e)}function K0(t,e){return tc(4,4,t,e)}function G0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Q0(t,e,n){return n=n!=null?n.concat([t]):null,tc(4,4,G0.bind(null,e,t),n)}function Uf(){}function Y0(t,e){var n=Un();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function J0(t,e){var n=Un();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function X0(t,e,n){return Ki&21?(Qn(n,e)||(n=r0(),ut.lanes|=n,Gi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=n)}function VS(t,e){var n=He;He=n!==0&&4>n?n:4,t(!0);var r=fd.transition;fd.transition={};try{t(!1),e()}finally{He=n,fd.transition=r}}function Z0(){return Un().memoizedState}function FS(t,e,n){var r=ci(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},e_(t))t_(e,n);else if(n=O0(t,e,n,r),n!==null){var i=ln();Gn(n,t,r,i),n_(n,e,r)}}function US(t,e,n){var r=ci(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(e_(t))t_(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,u=s(o,n);if(i.hasEagerState=!0,i.eagerState=u,Qn(u,o)){var c=e.interleaved;c===null?(i.next=i,Pf(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=O0(t,e,i,r),n!==null&&(i=ln(),Gn(n,t,r,i),n_(n,e,r))}}function e_(t){var e=t.alternate;return t===ut||e!==null&&e===ut}function t_(t,e){Jo=Eu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function n_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yf(t,n)}}var Su={readContext:Fn,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},BS={readContext:Fn,useCallback:function(t,e){return tr().memoizedState=[t,e===void 0?null:e],t},useContext:Fn,useEffect:Em,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hl(4194308,4,G0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hl(4,2,t,e)},useMemo:function(t,e){var n=tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FS.bind(null,ut,t),[r.memoizedState,t]},useRef:function(t){var e=tr();return t={current:t},e.memoizedState=t},useState:wm,useDebugValue:Uf,useDeferredValue:function(t){return tr().memoizedState=t},useTransition:function(){var t=wm(!1),e=t[0];return t=VS.bind(null,t[1]),tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ut,i=tr();if(st){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=e(),Ot===null)throw Error(ee(349));Ki&30||U0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Em(z0.bind(null,r,s,t),[t]),r.flags|=2048,Ea(9,B0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=tr(),e=Ot.identifierPrefix;if(st){var n=Sr,r=Er;n=(r&~(1<<32-Kn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=MS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zS={readContext:Fn,useCallback:Y0,useContext:Fn,useEffect:Ff,useImperativeHandle:Q0,useInsertionEffect:H0,useLayoutEffect:K0,useMemo:J0,useReducer:pd,useRef:q0,useState:function(){return pd(wa)},useDebugValue:Uf,useDeferredValue:function(t){var e=Un();return X0(e,Ct.memoizedState,t)},useTransition:function(){var t=pd(wa)[0],e=Un().memoizedState;return[t,e]},useMutableSource:V0,useSyncExternalStore:F0,useId:Z0,unstable_isNewReconciler:!1},$S={readContext:Fn,useCallback:Y0,useContext:Fn,useEffect:Ff,useImperativeHandle:Q0,useInsertionEffect:H0,useLayoutEffect:K0,useMemo:J0,useReducer:gd,useRef:q0,useState:function(){return gd(wa)},useDebugValue:Uf,useDeferredValue:function(t){var e=Un();return Ct===null?e.memoizedState=t:X0(e,Ct.memoizedState,t)},useTransition:function(){var t=gd(wa)[0],e=Un().memoizedState;return[t,e]},useMutableSource:V0,useSyncExternalStore:F0,useId:Z0,unstable_isNewReconciler:!1};function Wn(t,e){if(t&&t.defaultProps){e=ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var nc={isMounted:function(t){return(t=t._reactInternals)?ss(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),i=ci(t),s=Cr(r,i);s.payload=e,n!=null&&(s.callback=n),e=li(t,s,i),e!==null&&(Gn(e,t,i,r),Wl(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),i=ci(t),s=Cr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=li(t,s,i),e!==null&&(Gn(e,t,i,r),Wl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=ci(t),i=Cr(n,r);i.tag=2,e!=null&&(i.callback=e),e=li(t,i,r),e!==null&&(Gn(e,t,r,n),Wl(e,t,r))}};function Sm(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!pa(n,r)||!pa(i,s):!0}function r_(t,e,n){var r=!1,i=yi,s=e.contextType;return typeof s=="object"&&s!==null?s=Fn(s):(i=vn(e)?qi:tn.current,r=e.contextTypes,s=(r=r!=null)?Ys(t,i):yi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Im(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&nc.enqueueReplaceState(e,e.state,null)}function ph(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},jf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Fn(s):(s=vn(e)?qi:tn.current,i.context=Ys(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(fh(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&nc.enqueueReplaceState(i,i.state,null),xu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function eo(t,e){try{var n="",r=e;do n+=y1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function md(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function gh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WS=typeof WeakMap=="function"?WeakMap:Map;function i_(t,e,n){n=Cr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Tu||(Tu=!0,Th=r),gh(t,e)},n}function s_(t,e,n){n=Cr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){gh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){gh(t,e),typeof r!="function"&&(ui===null?ui=new Set([this]):ui.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Tm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WS;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=iI.bind(null,t,e,n),e.then(t,t))}function bm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Cm(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Cr(-1,1),e.tag=2,li(n,e,1))),n.lanes|=1),t)}var qS=Fr.ReactCurrentOwner,mn=!1;function an(t,e,n,r){e.child=t===null?D0(e,null,n,r):Xs(e,t.child,n,r)}function Am(t,e,n,r,i){n=n.render;var s=e.ref;return zs(e,i),r=Mf(t,e,n,r,s,i),n=Vf(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Dr(t,e,i)):(st&&n&&Tf(e),e.flags|=1,an(t,e,r,i),e.child)}function Rm(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Gf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,o_(t,e,s,r,i)):(t=Yl(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:pa,n(o,r)&&t.ref===e.ref)return Dr(t,e,i)}return e.flags|=1,t=di(s,r),t.ref=e.ref,t.return=e,e.child=t}function o_(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(pa(s,r)&&t.ref===e.ref)if(mn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(mn=!0);else return e.lanes=t.lanes,Dr(t,e,i)}return mh(t,e,n,r,i)}function a_(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(Os,En),En|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xe(Os,En),En|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Xe(Os,En),En|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Xe(Os,En),En|=r;return an(t,e,i,n),e.child}function l_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mh(t,e,n,r,i){var s=vn(n)?qi:tn.current;return s=Ys(e,s),zs(e,i),n=Mf(t,e,n,r,s,i),r=Vf(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Dr(t,e,i)):(st&&r&&Tf(e),e.flags|=1,an(t,e,n,i),e.child)}function km(t,e,n,r,i){if(vn(n)){var s=!0;gu(e)}else s=!1;if(zs(e,i),e.stateNode===null)Kl(t,e),r_(e,n,r),ph(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,u=e.memoizedProps;o.props=u;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Fn(d):(d=vn(n)?qi:tn.current,d=Ys(e,d));var p=n.getDerivedStateFromProps,y=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";y||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||c!==d)&&Im(e,o,r,d),Jr=!1;var _=e.memoizedState;o.state=_,xu(e,r,o,i),c=e.memoizedState,u!==r||_!==c||yn.current||Jr?(typeof p=="function"&&(fh(e,n,p,r),c=e.memoizedState),(u=Jr||Sm(e,n,u,r,_,c,d))?(y||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=u):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,L0(t,e),u=e.memoizedProps,d=e.type===e.elementType?u:Wn(e.type,u),o.props=d,y=e.pendingProps,_=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Fn(c):(c=vn(n)?qi:tn.current,c=Ys(e,c));var S=n.getDerivedStateFromProps;(p=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==y||_!==c)&&Im(e,o,r,c),Jr=!1,_=e.memoizedState,o.state=_,xu(e,r,o,i);var C=e.memoizedState;u!==y||_!==C||yn.current||Jr?(typeof S=="function"&&(fh(e,n,S,r),C=e.memoizedState),(d=Jr||Sm(e,n,d,r,_,C,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),r=!1)}return yh(t,e,n,r,s,i)}function yh(t,e,n,r,i,s){l_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&gm(e,n,!1),Dr(t,e,s);r=e.stateNode,qS.current=e;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Xs(e,t.child,null,s),e.child=Xs(e,null,u,s)):an(t,e,u,s),e.memoizedState=r.state,i&&gm(e,n,!0),e.child}function u_(t){var e=t.stateNode;e.pendingContext?pm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&pm(t,e.context,!1),Nf(t,e.containerInfo)}function Pm(t,e,n,r,i){return Js(),Cf(i),e.flags|=256,an(t,e,n,r),e.child}var vh={dehydrated:null,treeContext:null,retryLane:0};function _h(t){return{baseLanes:t,cachePool:null,transitions:null}}function c_(t,e,n){var r=e.pendingProps,i=lt.current,s=!1,o=(e.flags&128)!==0,u;if((u=o)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Xe(lt,i&1),t===null)return dh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=sc(o,r,0,null),t=$i(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=_h(n),e.memoizedState=vh,t):Bf(e,o));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return HS(t,e,o,r,u,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=di(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=di(u,s):(s=$i(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?_h(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=vh,r}return s=t.child,t=s.sibling,r=di(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bf(t,e){return e=sc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rl(t,e,n,r){return r!==null&&Cf(r),Xs(e,t.child,null,n),t=Bf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HS(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=md(Error(ee(422))),Rl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=sc({mode:"visible",children:r.children},i,0,null),s=$i(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Xs(e,t.child,null,o),e.child.memoizedState=_h(o),e.memoizedState=vh,s);if(!(e.mode&1))return Rl(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(ee(419)),r=md(s,r,void 0),Rl(t,e,o,r)}if(u=(o&t.childLanes)!==0,mn||u){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Nr(t,i),Gn(r,t,i,-1))}return Kf(),r=md(Error(ee(421))),Rl(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=sI.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Sn=ai(i.nextSibling),Tn=e,st=!0,Hn=null,t!==null&&(Nn[Dn++]=Er,Nn[Dn++]=Sr,Nn[Dn++]=Hi,Er=t.id,Sr=t.overflow,Hi=e),e=Bf(e,r.children),e.flags|=4096,e)}function jm(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hh(t.return,e,n)}function yd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function d_(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(an(t,e,r.children,n),r=lt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jm(t,n,e);else if(t.tag===19)jm(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Xe(lt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&wu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),yd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}yd(e,!0,n,null,s);break;case"together":yd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Dr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,n=di(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=di(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KS(t,e,n){switch(e.tag){case 3:u_(e),Js();break;case 5:M0(e);break;case 1:vn(e.type)&&gu(e);break;case 4:Nf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Xe(vu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xe(lt,lt.current&1),e.flags|=128,null):n&e.child.childLanes?c_(t,e,n):(Xe(lt,lt.current&1),t=Dr(t,e,n),t!==null?t.sibling:null);Xe(lt,lt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return d_(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xe(lt,lt.current),r)break;return null;case 22:case 23:return e.lanes=0,a_(t,e,n)}return Dr(t,e,n)}var h_,xh,f_,p_;h_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xh=function(){};f_=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ui(sr.current);var s=null;switch(n){case"input":i=zd(t,i),r=zd(t,r),s=[];break;case"select":i=ct({},i,{value:void 0}),r=ct({},r,{value:void 0}),s=[];break;case"textarea":i=qd(t,i),r=qd(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fu)}Kd(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var u=i[d];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(aa.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(u=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(aa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&nt("scroll",t),s||u===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};p_=function(t,e,n,r){n!==r&&(e.flags|=4)};function No(t,e){if(!st)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GS(t,e,n){var r=e.pendingProps;switch(bf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(e),null;case 1:return vn(e.type)&&pu(),Yt(e),null;case 3:return r=e.stateNode,Zs(),it(yn),it(tn),Of(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Cl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hn!==null&&(Ah(Hn),Hn=null))),xh(t,e),Yt(e),null;case 5:Df(e);var i=Ui(_a.current);if(n=e.type,t!==null&&e.stateNode!=null)f_(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return Yt(e),null}if(t=Ui(sr.current),Cl(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[nr]=e,r[ya]=s,t=(e.mode&1)!==0,n){case"dialog":nt("cancel",r),nt("close",r);break;case"iframe":case"object":case"embed":nt("load",r);break;case"video":case"audio":for(i=0;i<Fo.length;i++)nt(Fo[i],r);break;case"source":nt("error",r);break;case"img":case"image":case"link":nt("error",r),nt("load",r);break;case"details":nt("toggle",r);break;case"input":Bg(r,s),nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},nt("invalid",r);break;case"textarea":$g(r,s),nt("invalid",r)}Kd(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&bl(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&bl(r.textContent,u,t),i=["children",""+u]):aa.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&nt("scroll",r)}switch(n){case"input":vl(r),zg(r,s,!0);break;case"textarea":vl(r),Wg(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=fu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[nr]=e,t[ya]=r,h_(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gd(n,r),n){case"dialog":nt("cancel",t),nt("close",t),i=r;break;case"iframe":case"object":case"embed":nt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Fo.length;i++)nt(Fo[i],t);i=r;break;case"source":nt("error",t),i=r;break;case"img":case"image":case"link":nt("error",t),nt("load",t),i=r;break;case"details":nt("toggle",t),i=r;break;case"input":Bg(t,r),i=zd(t,r),nt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ct({},r,{value:void 0}),nt("invalid",t);break;case"textarea":$g(t,r),i=qd(t,r),nt("invalid",t);break;default:i=r}Kd(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var c=u[s];s==="style"?qv(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$v(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&la(t,c):typeof c=="number"&&la(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(aa.hasOwnProperty(s)?c!=null&&s==="onScroll"&&nt("scroll",t):c!=null&&df(t,s,c,o))}switch(n){case"input":vl(t),zg(t,r,!1);break;case"textarea":vl(t),Wg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+mi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Vs(t,!!r.multiple,s,!1):r.defaultValue!=null&&Vs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=fu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yt(e),null;case 6:if(t&&e.stateNode!=null)p_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(n=Ui(_a.current),Ui(sr.current),Cl(e)){if(r=e.stateNode,n=e.memoizedProps,r[nr]=e,(s=r.nodeValue!==n)&&(t=Tn,t!==null))switch(t.tag){case 3:bl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bl(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nr]=e,e.stateNode=r}return Yt(e),null;case 13:if(it(lt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(st&&Sn!==null&&e.mode&1&&!(e.flags&128))j0(),Js(),e.flags|=98560,s=!1;else if(s=Cl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[nr]=e}else Js(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yt(e),s=!1}else Hn!==null&&(Ah(Hn),Hn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||lt.current&1?At===0&&(At=3):Kf())),e.updateQueue!==null&&(e.flags|=4),Yt(e),null);case 4:return Zs(),xh(t,e),t===null&&ga(e.stateNode.containerInfo),Yt(e),null;case 10:return kf(e.type._context),Yt(e),null;case 17:return vn(e.type)&&pu(),Yt(e),null;case 19:if(it(lt),s=e.memoizedState,s===null)return Yt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)No(s,!1);else{if(At!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wu(t),o!==null){for(e.flags|=128,No(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xe(lt,lt.current&1|2),e.child}t=t.sibling}s.tail!==null&&mt()>to&&(e.flags|=128,r=!0,No(s,!1),e.lanes=4194304)}else{if(!r)if(t=wu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),No(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!st)return Yt(e),null}else 2*mt()-s.renderingStartTime>to&&n!==1073741824&&(e.flags|=128,r=!0,No(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=mt(),e.sibling=null,n=lt.current,Xe(lt,r?n&1|2:n&1),e):(Yt(e),null);case 22:case 23:return Hf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?En&1073741824&&(Yt(e),e.subtreeFlags&6&&(e.flags|=8192)):Yt(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function QS(t,e){switch(bf(e),e.tag){case 1:return vn(e.type)&&pu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zs(),it(yn),it(tn),Of(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Df(e),null;case 13:if(it(lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));Js()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return it(lt),null;case 4:return Zs(),null;case 10:return kf(e.type._context),null;case 22:case 23:return Hf(),null;case 24:return null;default:return null}}var kl=!1,Zt=!1,YS=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Ds(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pt(t,e,r)}else n.current=null}function wh(t,e,n){try{n()}catch(r){pt(t,e,r)}}var Nm=!1;function JS(t,e){if(ih=cu,t=_0(),If(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,u=-1,c=-1,d=0,p=0,y=t,_=null;t:for(;;){for(var S;y!==n||i!==0&&y.nodeType!==3||(u=o+i),y!==s||r!==0&&y.nodeType!==3||(c=o+r),y.nodeType===3&&(o+=y.nodeValue.length),(S=y.firstChild)!==null;)_=y,y=S;for(;;){if(y===t)break t;if(_===n&&++d===i&&(u=o),_===s&&++p===r&&(c=o),(S=y.nextSibling)!==null)break;y=_,_=y.parentNode}y=S}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(sh={focusedElem:t,selectionRange:n},cu=!1,ce=e;ce!==null;)if(e=ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ce=t;else for(;ce!==null;){e=ce;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var k=C.memoizedProps,D=C.memoizedState,b=e.stateNode,E=b.getSnapshotBeforeUpdate(e.elementType===e.type?k:Wn(e.type,k),D);b.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(V){pt(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ce=t;break}ce=e.return}return C=Nm,Nm=!1,C}function Xo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&wh(e,n,s)}i=i.next}while(i!==r)}}function rc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Eh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function g_(t){var e=t.alternate;e!==null&&(t.alternate=null,g_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nr],delete e[ya],delete e[lh],delete e[NS],delete e[DS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function m_(t){return t.tag===5||t.tag===3||t.tag===4}function Dm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||m_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fu));else if(r!==4&&(t=t.child,t!==null))for(Sh(t,e,n),t=t.sibling;t!==null;)Sh(t,e,n),t=t.sibling}function Ih(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ih(t,e,n),t=t.sibling;t!==null;)Ih(t,e,n),t=t.sibling}var Ft=null,qn=!1;function Gr(t,e,n){for(n=n.child;n!==null;)y_(t,e,n),n=n.sibling}function y_(t,e,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(Qu,n)}catch{}switch(n.tag){case 5:Zt||Ds(n,e);case 6:var r=Ft,i=qn;Ft=null,Gr(t,e,n),Ft=r,qn=i,Ft!==null&&(qn?(t=Ft,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ft.removeChild(n.stateNode));break;case 18:Ft!==null&&(qn?(t=Ft,n=n.stateNode,t.nodeType===8?cd(t.parentNode,n):t.nodeType===1&&cd(t,n),ha(t)):cd(Ft,n.stateNode));break;case 4:r=Ft,i=qn,Ft=n.stateNode.containerInfo,qn=!0,Gr(t,e,n),Ft=r,qn=i;break;case 0:case 11:case 14:case 15:if(!Zt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&wh(n,e,o),i=i.next}while(i!==r)}Gr(t,e,n);break;case 1:if(!Zt&&(Ds(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){pt(n,e,u)}Gr(t,e,n);break;case 21:Gr(t,e,n);break;case 22:n.mode&1?(Zt=(r=Zt)||n.memoizedState!==null,Gr(t,e,n),Zt=r):Gr(t,e,n);break;default:Gr(t,e,n)}}function Om(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YS),e.forEach(function(r){var i=oI.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function $n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,u=o;e:for(;u!==null;){switch(u.tag){case 5:Ft=u.stateNode,qn=!1;break e;case 3:Ft=u.stateNode.containerInfo,qn=!0;break e;case 4:Ft=u.stateNode.containerInfo,qn=!0;break e}u=u.return}if(Ft===null)throw Error(ee(160));y_(s,o,i),Ft=null,qn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){pt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)v_(e,t),e=e.sibling}function v_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($n(e,t),er(t),r&4){try{Xo(3,t,t.return),rc(3,t)}catch(k){pt(t,t.return,k)}try{Xo(5,t,t.return)}catch(k){pt(t,t.return,k)}}break;case 1:$n(e,t),er(t),r&512&&n!==null&&Ds(n,n.return);break;case 5:if($n(e,t),er(t),r&512&&n!==null&&Ds(n,n.return),t.flags&32){var i=t.stateNode;try{la(i,"")}catch(k){pt(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&Uv(i,s),Gd(u,o);var d=Gd(u,s);for(o=0;o<c.length;o+=2){var p=c[o],y=c[o+1];p==="style"?qv(i,y):p==="dangerouslySetInnerHTML"?$v(i,y):p==="children"?la(i,y):df(i,p,y,d)}switch(u){case"input":$d(i,s);break;case"textarea":Bv(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var S=s.value;S!=null?Vs(i,!!s.multiple,S,!1):_!==!!s.multiple&&(s.defaultValue!=null?Vs(i,!!s.multiple,s.defaultValue,!0):Vs(i,!!s.multiple,s.multiple?[]:"",!1))}i[ya]=s}catch(k){pt(t,t.return,k)}}break;case 6:if($n(e,t),er(t),r&4){if(t.stateNode===null)throw Error(ee(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(k){pt(t,t.return,k)}}break;case 3:if($n(e,t),er(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ha(e.containerInfo)}catch(k){pt(t,t.return,k)}break;case 4:$n(e,t),er(t);break;case 13:$n(e,t),er(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Wf=mt())),r&4&&Om(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Zt=(d=Zt)||p,$n(e,t),Zt=d):$n(e,t),er(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!p&&t.mode&1)for(ce=t,p=t.child;p!==null;){for(y=ce=p;ce!==null;){switch(_=ce,S=_.child,_.tag){case 0:case 11:case 14:case 15:Xo(4,_,_.return);break;case 1:Ds(_,_.return);var C=_.stateNode;if(typeof C.componentWillUnmount=="function"){r=_,n=_.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(k){pt(r,n,k)}}break;case 5:Ds(_,_.return);break;case 22:if(_.memoizedState!==null){Mm(y);continue}}S!==null?(S.return=_,ce=S):Mm(y)}p=p.sibling}e:for(p=null,y=t;;){if(y.tag===5){if(p===null){p=y;try{i=y.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=y.stateNode,c=y.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=Wv("display",o))}catch(k){pt(t,t.return,k)}}}else if(y.tag===6){if(p===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(k){pt(t,t.return,k)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;p===y&&(p=null),y=y.return}p===y&&(p=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:$n(e,t),er(t),r&4&&Om(t);break;case 21:break;default:$n(e,t),er(t)}}function er(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(m_(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(la(i,""),r.flags&=-33);var s=Dm(t);Ih(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=Dm(t);Sh(t,u,o);break;default:throw Error(ee(161))}}catch(c){pt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function XS(t,e,n){ce=t,__(t)}function __(t,e,n){for(var r=(t.mode&1)!==0;ce!==null;){var i=ce,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||kl;if(!o){var u=i.alternate,c=u!==null&&u.memoizedState!==null||Zt;u=kl;var d=Zt;if(kl=o,(Zt=c)&&!d)for(ce=i;ce!==null;)o=ce,c=o.child,o.tag===22&&o.memoizedState!==null?Vm(i):c!==null?(c.return=o,ce=c):Vm(i);for(;s!==null;)ce=s,__(s),s=s.sibling;ce=i,kl=u,Zt=d}Lm(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ce=s):Lm(t)}}function Lm(t){for(;ce!==null;){var e=ce;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zt||rc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Wn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&xm(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xm(e,o,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var y=p.dehydrated;y!==null&&ha(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Zt||e.flags&512&&Eh(e)}catch(_){pt(e,e.return,_)}}if(e===t){ce=null;break}if(n=e.sibling,n!==null){n.return=e.return,ce=n;break}ce=e.return}}function Mm(t){for(;ce!==null;){var e=ce;if(e===t){ce=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ce=n;break}ce=e.return}}function Vm(t){for(;ce!==null;){var e=ce;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rc(4,e)}catch(c){pt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){pt(e,i,c)}}var s=e.return;try{Eh(e)}catch(c){pt(e,s,c)}break;case 5:var o=e.return;try{Eh(e)}catch(c){pt(e,o,c)}}}catch(c){pt(e,e.return,c)}if(e===t){ce=null;break}var u=e.sibling;if(u!==null){u.return=e.return,ce=u;break}ce=e.return}}var ZS=Math.ceil,Iu=Fr.ReactCurrentDispatcher,zf=Fr.ReactCurrentOwner,Ln=Fr.ReactCurrentBatchConfig,ze=0,Ot=null,wt=null,Bt=0,En=0,Os=Si(0),At=0,Sa=null,Gi=0,ic=0,$f=0,Zo=null,pn=null,Wf=0,to=1/0,mr=null,Tu=!1,Th=null,ui=null,Pl=!1,ti=null,bu=0,ea=0,bh=null,Gl=-1,Ql=0;function ln(){return ze&6?mt():Gl!==-1?Gl:Gl=mt()}function ci(t){return t.mode&1?ze&2&&Bt!==0?Bt&-Bt:LS.transition!==null?(Ql===0&&(Ql=r0()),Ql):(t=He,t!==0||(t=window.event,t=t===void 0?16:c0(t.type)),t):1}function Gn(t,e,n,r){if(50<ea)throw ea=0,bh=null,Error(ee(185));Oa(t,n,r),(!(ze&2)||t!==Ot)&&(t===Ot&&(!(ze&2)&&(ic|=n),At===4&&Zr(t,Bt)),_n(t,r),n===1&&ze===0&&!(e.mode&1)&&(to=mt()+500,ec&&Ii()))}function _n(t,e){var n=t.callbackNode;L1(t,e);var r=uu(t,t===Ot?Bt:0);if(r===0)n!==null&&Kg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Kg(n),e===1)t.tag===0?OS(Fm.bind(null,t)):R0(Fm.bind(null,t)),PS(function(){!(ze&6)&&Ii()}),n=null;else{switch(i0(r)){case 1:n=mf;break;case 4:n=t0;break;case 16:n=lu;break;case 536870912:n=n0;break;default:n=lu}n=C_(n,x_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function x_(t,e){if(Gl=-1,Ql=0,ze&6)throw Error(ee(327));var n=t.callbackNode;if($s()&&t.callbackNode!==n)return null;var r=uu(t,t===Ot?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cu(t,r);else{e=r;var i=ze;ze|=2;var s=E_();(Ot!==t||Bt!==e)&&(mr=null,to=mt()+500,zi(t,e));do try{nI();break}catch(u){w_(t,u)}while(!0);Rf(),Iu.current=s,ze=i,wt!==null?e=0:(Ot=null,Bt=0,e=At)}if(e!==0){if(e===2&&(i=Zd(t),i!==0&&(r=i,e=Ch(t,i))),e===1)throw n=Sa,zi(t,0),Zr(t,r),_n(t,mt()),n;if(e===6)Zr(t,r);else{if(i=t.current.alternate,!(r&30)&&!eI(i)&&(e=Cu(t,r),e===2&&(s=Zd(t),s!==0&&(r=s,e=Ch(t,s))),e===1))throw n=Sa,zi(t,0),Zr(t,r),_n(t,mt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:Li(t,pn,mr);break;case 3:if(Zr(t,r),(r&130023424)===r&&(e=Wf+500-mt(),10<e)){if(uu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ah(Li.bind(null,t,pn,mr),e);break}Li(t,pn,mr);break;case 4:if(Zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Kn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZS(r/1960))-r,10<r){t.timeoutHandle=ah(Li.bind(null,t,pn,mr),r);break}Li(t,pn,mr);break;case 5:Li(t,pn,mr);break;default:throw Error(ee(329))}}}return _n(t,mt()),t.callbackNode===n?x_.bind(null,t):null}function Ch(t,e){var n=Zo;return t.current.memoizedState.isDehydrated&&(zi(t,e).flags|=256),t=Cu(t,e),t!==2&&(e=pn,pn=n,e!==null&&Ah(e)),t}function Ah(t){pn===null?pn=t:pn.push.apply(pn,t)}function eI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Qn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zr(t,e){for(e&=~$f,e&=~ic,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Kn(e),r=1<<n;t[n]=-1,e&=~r}}function Fm(t){if(ze&6)throw Error(ee(327));$s();var e=uu(t,0);if(!(e&1))return _n(t,mt()),null;var n=Cu(t,e);if(t.tag!==0&&n===2){var r=Zd(t);r!==0&&(e=r,n=Ch(t,r))}if(n===1)throw n=Sa,zi(t,0),Zr(t,e),_n(t,mt()),n;if(n===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Li(t,pn,mr),_n(t,mt()),null}function qf(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(to=mt()+500,ec&&Ii())}}function Qi(t){ti!==null&&ti.tag===0&&!(ze&6)&&$s();var e=ze;ze|=1;var n=Ln.transition,r=He;try{if(Ln.transition=null,He=1,t)return t()}finally{He=r,Ln.transition=n,ze=e,!(ze&6)&&Ii()}}function Hf(){En=Os.current,it(Os)}function zi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kS(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(bf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pu();break;case 3:Zs(),it(yn),it(tn),Of();break;case 5:Df(r);break;case 4:Zs();break;case 13:it(lt);break;case 19:it(lt);break;case 10:kf(r.type._context);break;case 22:case 23:Hf()}n=n.return}if(Ot=t,wt=t=di(t.current,null),Bt=En=e,At=0,Sa=null,$f=ic=Gi=0,pn=Zo=null,Fi!==null){for(e=0;e<Fi.length;e++)if(n=Fi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Fi=null}return t}function w_(t,e){do{var n=wt;try{if(Rf(),ql.current=Su,Eu){for(var r=ut.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Eu=!1}if(Ki=0,Nt=Ct=ut=null,Jo=!1,xa=0,zf.current=null,n===null||n.return===null){At=1,Sa=e,wt=null;break}e:{var s=t,o=n.return,u=n,c=e;if(e=Bt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,p=u,y=p.tag;if(!(p.mode&1)&&(y===0||y===11||y===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var S=bm(o);if(S!==null){S.flags&=-257,Cm(S,o,u,s,e),S.mode&1&&Tm(s,d,e),e=S,c=d;var C=e.updateQueue;if(C===null){var k=new Set;k.add(c),e.updateQueue=k}else C.add(c);break e}else{if(!(e&1)){Tm(s,d,e),Kf();break e}c=Error(ee(426))}}else if(st&&u.mode&1){var D=bm(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Cm(D,o,u,s,e),Cf(eo(c,u));break e}}s=c=eo(c,u),At!==4&&(At=2),Zo===null?Zo=[s]:Zo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=i_(s,c,e);_m(s,b);break e;case 1:u=c;var E=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ui===null||!ui.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=s_(s,u,e);_m(s,V);break e}}s=s.return}while(s!==null)}I_(n)}catch(N){e=N,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(!0)}function E_(){var t=Iu.current;return Iu.current=Su,t===null?Su:t}function Kf(){(At===0||At===3||At===2)&&(At=4),Ot===null||!(Gi&268435455)&&!(ic&268435455)||Zr(Ot,Bt)}function Cu(t,e){var n=ze;ze|=2;var r=E_();(Ot!==t||Bt!==e)&&(mr=null,zi(t,e));do try{tI();break}catch(i){w_(t,i)}while(!0);if(Rf(),ze=n,Iu.current=r,wt!==null)throw Error(ee(261));return Ot=null,Bt=0,At}function tI(){for(;wt!==null;)S_(wt)}function nI(){for(;wt!==null&&!C1();)S_(wt)}function S_(t){var e=b_(t.alternate,t,En);t.memoizedProps=t.pendingProps,e===null?I_(t):wt=e,zf.current=null}function I_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QS(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{At=6,wt=null;return}}else if(n=GS(n,e,En),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);At===0&&(At=5)}function Li(t,e,n){var r=He,i=Ln.transition;try{Ln.transition=null,He=1,rI(t,e,n,r)}finally{Ln.transition=i,He=r}return null}function rI(t,e,n,r){do $s();while(ti!==null);if(ze&6)throw Error(ee(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(M1(t,s),t===Ot&&(wt=Ot=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pl||(Pl=!0,C_(lu,function(){return $s(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ln.transition,Ln.transition=null;var o=He;He=1;var u=ze;ze|=4,zf.current=null,JS(t,n),v_(n,t),SS(sh),cu=!!ih,sh=ih=null,t.current=n,XS(n),A1(),ze=u,He=o,Ln.transition=s}else t.current=n;if(Pl&&(Pl=!1,ti=t,bu=i),s=t.pendingLanes,s===0&&(ui=null),P1(n.stateNode),_n(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Tu)throw Tu=!1,t=Th,Th=null,t;return bu&1&&t.tag!==0&&$s(),s=t.pendingLanes,s&1?t===bh?ea++:(ea=0,bh=t):ea=0,Ii(),null}function $s(){if(ti!==null){var t=i0(bu),e=Ln.transition,n=He;try{if(Ln.transition=null,He=16>t?16:t,ti===null)var r=!1;else{if(t=ti,ti=null,bu=0,ze&6)throw Error(ee(331));var i=ze;for(ze|=4,ce=t.current;ce!==null;){var s=ce,o=s.child;if(ce.flags&16){var u=s.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(ce=d;ce!==null;){var p=ce;switch(p.tag){case 0:case 11:case 15:Xo(8,p,s)}var y=p.child;if(y!==null)y.return=p,ce=y;else for(;ce!==null;){p=ce;var _=p.sibling,S=p.return;if(g_(p),p===d){ce=null;break}if(_!==null){_.return=S,ce=_;break}ce=S}}}var C=s.alternate;if(C!==null){var k=C.child;if(k!==null){C.child=null;do{var D=k.sibling;k.sibling=null,k=D}while(k!==null)}}ce=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ce=o;else e:for(;ce!==null;){if(s=ce,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xo(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,ce=b;break e}ce=s.return}}var E=t.current;for(ce=E;ce!==null;){o=ce;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ce=T;else e:for(o=E;ce!==null;){if(u=ce,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:rc(9,u)}}catch(N){pt(u,u.return,N)}if(u===o){ce=null;break e}var V=u.sibling;if(V!==null){V.return=u.return,ce=V;break e}ce=u.return}}if(ze=i,Ii(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(Qu,t)}catch{}r=!0}return r}finally{He=n,Ln.transition=e}}return!1}function Um(t,e,n){e=eo(n,e),e=i_(t,e,1),t=li(t,e,1),e=ln(),t!==null&&(Oa(t,1,e),_n(t,e))}function pt(t,e,n){if(t.tag===3)Um(t,t,n);else for(;e!==null;){if(e.tag===3){Um(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ui===null||!ui.has(r))){t=eo(n,t),t=s_(e,t,1),e=li(e,t,1),t=ln(),e!==null&&(Oa(e,1,t),_n(e,t));break}}e=e.return}}function iI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&(Bt&n)===n&&(At===4||At===3&&(Bt&130023424)===Bt&&500>mt()-Wf?zi(t,0):$f|=n),_n(t,e)}function T_(t,e){e===0&&(t.mode&1?(e=wl,wl<<=1,!(wl&130023424)&&(wl=4194304)):e=1);var n=ln();t=Nr(t,e),t!==null&&(Oa(t,e,n),_n(t,n))}function sI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),T_(t,n)}function oI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),T_(t,n)}var b_;b_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yn.current)mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return mn=!1,KS(t,e,n);mn=!!(t.flags&131072)}else mn=!1,st&&e.flags&1048576&&k0(e,yu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Kl(t,e),t=e.pendingProps;var i=Ys(e,tn.current);zs(e,n),i=Mf(null,e,r,t,i,n);var s=Vf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(r)?(s=!0,gu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,jf(e),i.updater=nc,e.stateNode=i,i._reactInternals=e,ph(e,r,t,n),e=yh(null,e,r,!0,s,n)):(e.tag=0,st&&s&&Tf(e),an(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Kl(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=lI(r),t=Wn(r,t),i){case 0:e=mh(null,e,r,t,n);break e;case 1:e=km(null,e,r,t,n);break e;case 11:e=Am(null,e,r,t,n);break e;case 14:e=Rm(null,e,r,Wn(r.type,t),n);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),mh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),km(t,e,r,i,n);case 3:e:{if(u_(e),t===null)throw Error(ee(387));r=e.pendingProps,s=e.memoizedState,i=s.element,L0(t,e),xu(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=eo(Error(ee(423)),e),e=Pm(t,e,r,n,i);break e}else if(r!==i){i=eo(Error(ee(424)),e),e=Pm(t,e,r,n,i);break e}else for(Sn=ai(e.stateNode.containerInfo.firstChild),Tn=e,st=!0,Hn=null,n=D0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Js(),r===i){e=Dr(t,e,n);break e}an(t,e,r,n)}e=e.child}return e;case 5:return M0(e),t===null&&dh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,oh(r,i)?o=null:s!==null&&oh(r,s)&&(e.flags|=32),l_(t,e),an(t,e,o,n),e.child;case 6:return t===null&&dh(e),null;case 13:return c_(t,e,n);case 4:return Nf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Xs(e,null,r,n):an(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),Am(t,e,r,i,n);case 7:return an(t,e,e.pendingProps,n),e.child;case 8:return an(t,e,e.pendingProps.children,n),e.child;case 12:return an(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Xe(vu,r._currentValue),r._currentValue=o,s!==null)if(Qn(s.value,o)){if(s.children===i.children&&!yn.current){e=Dr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){o=s.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Cr(-1,n&-n),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?c.next=c:(c.next=p.next,p.next=c),d.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),hh(s.return,n,e),u.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),hh(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}an(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,zs(e,n),i=Fn(i),r=r(i),e.flags|=1,an(t,e,r,n),e.child;case 14:return r=e.type,i=Wn(r,e.pendingProps),i=Wn(r.type,i),Rm(t,e,r,i,n);case 15:return o_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),Kl(t,e),e.tag=1,vn(r)?(t=!0,gu(e)):t=!1,zs(e,n),r_(e,r,i),ph(e,r,i,n),yh(null,e,r,!0,t,n);case 19:return d_(t,e,n);case 22:return a_(t,e,n)}throw Error(ee(156,e.tag))};function C_(t,e){return e0(t,e)}function aI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(t,e,n,r){return new aI(t,e,n,r)}function Gf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lI(t){if(typeof t=="function")return Gf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ff)return 11;if(t===pf)return 14}return 2}function di(t,e){var n=t.alternate;return n===null?(n=On(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Yl(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Gf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ts:return $i(n.children,i,s,e);case hf:o=8,i|=8;break;case Vd:return t=On(12,n,e,i|2),t.elementType=Vd,t.lanes=s,t;case Fd:return t=On(13,n,e,i),t.elementType=Fd,t.lanes=s,t;case Ud:return t=On(19,n,e,i),t.elementType=Ud,t.lanes=s,t;case Mv:return sc(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ov:o=10;break e;case Lv:o=9;break e;case ff:o=11;break e;case pf:o=14;break e;case Yr:o=16,r=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=On(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function $i(t,e,n,r){return t=On(7,t,r,e),t.lanes=n,t}function sc(t,e,n,r){return t=On(22,t,r,e),t.elementType=Mv,t.lanes=n,t.stateNode={isHidden:!1},t}function vd(t,e,n){return t=On(6,t,null,e),t.lanes=n,t}function _d(t,e,n){return e=On(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uI(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zc(0),this.expirationTimes=Zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qf(t,e,n,r,i,s,o,u,c){return t=new uI(t,e,n,u,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=On(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jf(s),t}function cI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Is,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function A_(t){if(!t)return yi;t=t._reactInternals;e:{if(ss(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var n=t.type;if(vn(n))return A0(t,n,e)}return e}function R_(t,e,n,r,i,s,o,u,c){return t=Qf(n,r,!0,t,i,s,o,u,c),t.context=A_(null),n=t.current,r=ln(),i=ci(n),s=Cr(r,i),s.callback=e??null,li(n,s,i),t.current.lanes=i,Oa(t,i,r),_n(t,r),t}function oc(t,e,n,r){var i=e.current,s=ln(),o=ci(i);return n=A_(n),e.context===null?e.context=n:e.pendingContext=n,e=Cr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=li(i,e,o),t!==null&&(Gn(t,i,o,s),Wl(t,i,o)),o}function Au(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Bm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yf(t,e){Bm(t,e),(t=t.alternate)&&Bm(t,e)}function dI(){return null}var k_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jf(t){this._internalRoot=t}ac.prototype.render=Jf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));oc(t,e,null,null)};ac.prototype.unmount=Jf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qi(function(){oc(null,t,null,null)}),e[jr]=null}};function ac(t){this._internalRoot=t}ac.prototype.unstable_scheduleHydration=function(t){if(t){var e=a0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xr.length&&e!==0&&e<Xr[n].priority;n++);Xr.splice(n,0,t),n===0&&u0(t)}};function Xf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zm(){}function hI(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Au(o);s.call(d)}}var o=R_(e,r,t,0,null,!1,!1,"",zm);return t._reactRootContainer=o,t[jr]=o.current,ga(t.nodeType===8?t.parentNode:t),Qi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var d=Au(c);u.call(d)}}var c=Qf(t,0,!1,null,null,!1,!1,"",zm);return t._reactRootContainer=c,t[jr]=c.current,ga(t.nodeType===8?t.parentNode:t),Qi(function(){oc(e,c,n,r)}),c}function uc(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var u=i;i=function(){var c=Au(o);u.call(c)}}oc(e,o,t,i)}else o=hI(n,e,t,i,r);return Au(o)}s0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Vo(e.pendingLanes);n!==0&&(yf(e,n|1),_n(e,mt()),!(ze&6)&&(to=mt()+500,Ii()))}break;case 13:Qi(function(){var r=Nr(t,1);if(r!==null){var i=ln();Gn(r,t,1,i)}}),Yf(t,1)}};vf=function(t){if(t.tag===13){var e=Nr(t,134217728);if(e!==null){var n=ln();Gn(e,t,134217728,n)}Yf(t,134217728)}};o0=function(t){if(t.tag===13){var e=ci(t),n=Nr(t,e);if(n!==null){var r=ln();Gn(n,t,e,r)}Yf(t,e)}};a0=function(){return He};l0=function(t,e){var n=He;try{return He=t,e()}finally{He=n}};Yd=function(t,e,n){switch(e){case"input":if($d(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Zu(r);if(!i)throw Error(ee(90));Fv(r),$d(r,i)}}}break;case"textarea":Bv(t,n);break;case"select":e=n.value,e!=null&&Vs(t,!!n.multiple,e,!1)}};Gv=qf;Qv=Qi;var fI={usingClientEntryPoint:!1,Events:[Ma,Rs,Zu,Hv,Kv,qf]},Do={findFiberByHostInstance:Vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pI={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Xv(t),t===null?null:t.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||dI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jl.isDisabled&&jl.supportsFiber)try{Qu=jl.inject(pI),ir=jl}catch{}}An.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fI;An.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xf(e))throw Error(ee(200));return cI(t,e,null,n)};An.createRoot=function(t,e){if(!Xf(t))throw Error(ee(299));var n=!1,r="",i=k_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qf(t,1,!1,null,null,n,!1,r,i),t[jr]=e.current,ga(t.nodeType===8?t.parentNode:t),new Jf(e)};An.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=Xv(e),t=t===null?null:t.stateNode,t};An.flushSync=function(t){return Qi(t)};An.hydrate=function(t,e,n){if(!lc(e))throw Error(ee(200));return uc(null,t,e,!0,n)};An.hydrateRoot=function(t,e,n){if(!Xf(t))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=k_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=R_(e,null,t,1,n??null,i,!1,s,o),t[jr]=e.current,ga(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ac(e)};An.render=function(t,e,n){if(!lc(e))throw Error(ee(200));return uc(null,t,e,!1,n)};An.unmountComponentAtNode=function(t){if(!lc(t))throw Error(ee(40));return t._reactRootContainer?(Qi(function(){uc(null,null,t,!1,function(){t._reactRootContainer=null,t[jr]=null})}),!0):!1};An.unstable_batchedUpdates=qf;An.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lc(n))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return uc(t,e,n,!1,r)};An.version="18.3.1-next-f1338f8080-20240426";function P_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(P_)}catch(t){console.error(t)}}P_(),Pv.exports=An;var gI=Pv.exports,$m=gI;Ld.createRoot=$m.createRoot,Ld.hydrateRoot=$m.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ia(){return Ia=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ia.apply(this,arguments)}var ni;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ni||(ni={}));const Wm="popstate";function mI(t){t===void 0&&(t={});function e(i,s){let{pathname:o="/",search:u="",hash:c=""}=os(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Rh("",{pathname:o,search:u,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let o=i.document.querySelector("base"),u="";if(o&&o.getAttribute("href")){let c=i.location.href,d=c.indexOf("#");u=d===-1?c:c.slice(0,d)}return u+"#"+(typeof s=="string"?s:Ru(s))}function r(i,s){Zf(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return vI(e,n,r,t)}function It(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Zf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yI(){return Math.random().toString(36).substr(2,8)}function qm(t,e){return{usr:t.state,key:t.key,idx:e}}function Rh(t,e,n,r){return n===void 0&&(n=null),Ia({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?os(e):e,{state:n,key:e&&e.key||r||yI()})}function Ru(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function os(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function vI(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,u=ni.Pop,c=null,d=p();d==null&&(d=0,o.replaceState(Ia({},o.state,{idx:d}),""));function p(){return(o.state||{idx:null}).idx}function y(){u=ni.Pop;let D=p(),b=D==null?null:D-d;d=D,c&&c({action:u,location:k.location,delta:b})}function _(D,b){u=ni.Push;let E=Rh(k.location,D,b);n&&n(E,D),d=p()+1;let T=qm(E,d),V=k.createHref(E);try{o.pushState(T,"",V)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(V)}s&&c&&c({action:u,location:k.location,delta:1})}function S(D,b){u=ni.Replace;let E=Rh(k.location,D,b);n&&n(E,D),d=p();let T=qm(E,d),V=k.createHref(E);o.replaceState(T,"",V),s&&c&&c({action:u,location:k.location,delta:0})}function C(D){let b=i.location.origin!=="null"?i.location.origin:i.location.href,E=typeof D=="string"?D:Ru(D);return E=E.replace(/ $/,"%20"),It(b,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,b)}let k={get action(){return u},get location(){return t(i,o)},listen(D){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Wm,y),c=D,()=>{i.removeEventListener(Wm,y),c=null}},createHref(D){return e(i,D)},createURL:C,encodeLocation(D){let b=C(D);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:_,replace:S,go(D){return o.go(D)}};return k}var Hm;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Hm||(Hm={}));function _I(t,e,n){return n===void 0&&(n="/"),xI(t,e,n)}function xI(t,e,n,r){let i=typeof e=="string"?os(e):e,s=ep(i.pathname||"/",n);if(s==null)return null;let o=j_(t);wI(o);let u=null;for(let c=0;u==null&&c<o.length;++c){let d=NI(s);u=kI(o[c],d)}return u}function j_(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,u)=>{let c={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(It(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=hi([r,c.relativePath]),p=n.concat(c);s.children&&s.children.length>0&&(It(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),j_(s.children,e,p,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:AI(d,s.index),routesMeta:p})};return t.forEach((s,o)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))i(s,o);else for(let c of N_(s.path))i(s,o,c)}),e}function N_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=N_(r.join("/")),u=[];return u.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&u.push(...o),u.map(c=>t.startsWith("/")&&c===""?"/":c)}function wI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:RI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const EI=/^:[\w-]+$/,SI=3,II=2,TI=1,bI=10,CI=-2,Km=t=>t==="*";function AI(t,e){let n=t.split("/"),r=n.length;return n.some(Km)&&(r+=CI),e&&(r+=II),n.filter(i=>!Km(i)).reduce((i,s)=>i+(EI.test(s)?SI:s===""?TI:bI),r)}function RI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function kI(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let u=0;u<r.length;++u){let c=r[u],d=u===r.length-1,p=s==="/"?e:e.slice(s.length)||"/",y=PI({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},p),_=c.route;if(!y)return null;Object.assign(i,y.params),o.push({params:i,pathname:hi([s,y.pathname]),pathnameBase:MI(hi([s,y.pathnameBase])),route:_}),y.pathnameBase!=="/"&&(s=hi([s,y.pathnameBase]))}return o}function PI(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=jI(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:r.reduce((d,p,y)=>{let{paramName:_,isOptional:S}=p;if(_==="*"){let k=u[y]||"";o=s.slice(0,s.length-k.length).replace(/(.)\/+$/,"$1")}const C=u[y];return S&&!C?d[_]=void 0:d[_]=(C||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function jI(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Zf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,c)=>(r.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function NI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ep(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function DI(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?os(t):t;return{pathname:n?n.startsWith("/")?n:OI(n,e):e,search:VI(r),hash:FI(i)}}function OI(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function xd(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function D_(t,e){let n=LI(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function O_(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=os(t):(i=Ia({},t),It(!i.pathname||!i.pathname.includes("?"),xd("?","pathname","search",i)),It(!i.pathname||!i.pathname.includes("#"),xd("#","pathname","hash",i)),It(!i.search||!i.search.includes("#"),xd("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,u;if(o==null)u=n;else{let y=e.length-1;if(!r&&o.startsWith("..")){let _=o.split("/");for(;_[0]==="..";)_.shift(),y-=1;i.pathname=_.join("/")}u=y>=0?e[y]:"/"}let c=DI(i,u),d=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||p)&&(c.pathname+="/"),c}const hi=t=>t.join("/").replace(/\/\/+/g,"/"),MI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,FI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function UI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const L_=["post","put","patch","delete"];new Set(L_);const BI=["get",...L_];new Set(BI);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ta(){return Ta=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ta.apply(this,arguments)}const tp=P.createContext(null),zI=P.createContext(null),as=P.createContext(null),cc=P.createContext(null),Ti=P.createContext({outlet:null,matches:[],isDataRoute:!1}),M_=P.createContext(null);function $I(t,e){let{relative:n}=e===void 0?{}:e;Fa()||It(!1);let{basename:r,navigator:i}=P.useContext(as),{hash:s,pathname:o,search:u}=F_(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:hi([r,o])),i.createHref({pathname:c,search:u,hash:s})}function Fa(){return P.useContext(cc)!=null}function po(){return Fa()||It(!1),P.useContext(cc).location}function V_(t){P.useContext(as).static||P.useLayoutEffect(t)}function ls(){let{isDataRoute:t}=P.useContext(Ti);return t?nT():WI()}function WI(){Fa()||It(!1);let t=P.useContext(tp),{basename:e,future:n,navigator:r}=P.useContext(as),{matches:i}=P.useContext(Ti),{pathname:s}=po(),o=JSON.stringify(D_(i,n.v7_relativeSplatPath)),u=P.useRef(!1);return V_(()=>{u.current=!0}),P.useCallback(function(d,p){if(p===void 0&&(p={}),!u.current)return;if(typeof d=="number"){r.go(d);return}let y=O_(d,JSON.parse(o),s,p.relative==="path");t==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:hi([e,y.pathname])),(p.replace?r.replace:r.push)(y,p.state,p)},[e,r,o,s,t])}function dc(){let{matches:t}=P.useContext(Ti),e=t[t.length-1];return e?e.params:{}}function F_(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=P.useContext(as),{matches:i}=P.useContext(Ti),{pathname:s}=po(),o=JSON.stringify(D_(i,r.v7_relativeSplatPath));return P.useMemo(()=>O_(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function qI(t,e){return HI(t,e)}function HI(t,e,n,r){Fa()||It(!1);let{navigator:i}=P.useContext(as),{matches:s}=P.useContext(Ti),o=s[s.length-1],u=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=po(),p;if(e){var y;let D=typeof e=="string"?os(e):e;c==="/"||(y=D.pathname)!=null&&y.startsWith(c)||It(!1),p=D}else p=d;let _=p.pathname||"/",S=_;if(c!=="/"){let D=c.replace(/^\//,"").split("/");S="/"+_.replace(/^\//,"").split("/").slice(D.length).join("/")}let C=_I(t,{pathname:S}),k=JI(C&&C.map(D=>Object.assign({},D,{params:Object.assign({},u,D.params),pathname:hi([c,i.encodeLocation?i.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?c:hi([c,i.encodeLocation?i.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),s,n,r);return e&&k?P.createElement(cc.Provider,{value:{location:Ta({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:ni.Pop}},k):k}function KI(){let t=tT(),e=UI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:i},n):null,null)}const GI=P.createElement(KI,null);class QI extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?P.createElement(Ti.Provider,{value:this.props.routeContext},P.createElement(M_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YI(t){let{routeContext:e,match:n,children:r}=t,i=P.useContext(tp);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),P.createElement(Ti.Provider,{value:e},r)}function JI(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,u=(i=n)==null?void 0:i.errors;if(u!=null){let p=o.findIndex(y=>y.route.id&&(u==null?void 0:u[y.route.id])!==void 0);p>=0||It(!1),o=o.slice(0,Math.min(o.length,p+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let p=0;p<o.length;p++){let y=o[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=p),y.route.id){let{loaderData:_,errors:S}=n,C=y.route.loader&&_[y.route.id]===void 0&&(!S||S[y.route.id]===void 0);if(y.route.lazy||C){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((p,y,_)=>{let S,C=!1,k=null,D=null;n&&(S=u&&y.route.id?u[y.route.id]:void 0,k=y.route.errorElement||GI,c&&(d<0&&_===0?(rT("route-fallback"),C=!0,D=null):d===_&&(C=!0,D=y.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,_+1)),E=()=>{let T;return S?T=k:C?T=D:y.route.Component?T=P.createElement(y.route.Component,null):y.route.element?T=y.route.element:T=p,P.createElement(YI,{match:y,routeContext:{outlet:p,matches:b,isDataRoute:n!=null},children:T})};return n&&(y.route.ErrorBoundary||y.route.errorElement||_===0)?P.createElement(QI,{location:n.location,revalidation:n.revalidation,component:k,error:S,children:E(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):E()},null)}var U_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(U_||{}),B_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(B_||{});function XI(t){let e=P.useContext(tp);return e||It(!1),e}function ZI(t){let e=P.useContext(zI);return e||It(!1),e}function eT(t){let e=P.useContext(Ti);return e||It(!1),e}function z_(t){let e=eT(),n=e.matches[e.matches.length-1];return n.route.id||It(!1),n.route.id}function tT(){var t;let e=P.useContext(M_),n=ZI(),r=z_();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function nT(){let{router:t}=XI(U_.UseNavigateStable),e=z_(B_.UseNavigateStable),n=P.useRef(!1);return V_(()=>{n.current=!0}),P.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ta({fromRouteId:e},s)))},[t,e])}const Gm={};function rT(t,e,n){Gm[t]||(Gm[t]=!0)}function iT(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Pt(t){It(!1)}function sT(t){let{basename:e="/",children:n=null,location:r,navigationType:i=ni.Pop,navigator:s,static:o=!1,future:u}=t;Fa()&&It(!1);let c=e.replace(/^\/*/,"/"),d=P.useMemo(()=>({basename:c,navigator:s,static:o,future:Ta({v7_relativeSplatPath:!1},u)}),[c,u,s,o]);typeof r=="string"&&(r=os(r));let{pathname:p="/",search:y="",hash:_="",state:S=null,key:C="default"}=r,k=P.useMemo(()=>{let D=ep(p,c);return D==null?null:{location:{pathname:D,search:y,hash:_,state:S,key:C},navigationType:i}},[c,p,y,_,S,C,i]);return k==null?null:P.createElement(as.Provider,{value:d},P.createElement(cc.Provider,{children:n,value:k}))}function oT(t){let{children:e,location:n}=t;return qI(kh(e),n)}new Promise(()=>{});function kh(t,e){e===void 0&&(e=[]);let n=[];return P.Children.forEach(t,(r,i)=>{if(!P.isValidElement(r))return;let s=[...e,i];if(r.type===P.Fragment){n.push.apply(n,kh(r.props.children,s));return}r.type!==Pt&&It(!1),!r.props.index||!r.props.children||It(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=kh(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ph(){return Ph=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ph.apply(this,arguments)}function aT(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function lT(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function uT(t,e){return t.button===0&&(!e||e==="_self")&&!lT(t)}const cT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],dT="6";try{window.__reactRouterVersion=dT}catch{}const hT="startTransition",Qm=i1[hT];function fT(t){let{basename:e,children:n,future:r,window:i}=t,s=P.useRef();s.current==null&&(s.current=mI({window:i,v5Compat:!0}));let o=s.current,[u,c]=P.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},p=P.useCallback(y=>{d&&Qm?Qm(()=>c(y)):c(y)},[c,d]);return P.useLayoutEffect(()=>o.listen(p),[o,p]),P.useEffect(()=>iT(r),[r]),P.createElement(sT,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:o,future:r})}const pT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,on=P.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:u,target:c,to:d,preventScrollReset:p,viewTransition:y}=e,_=aT(e,cT),{basename:S}=P.useContext(as),C,k=!1;if(typeof d=="string"&&gT.test(d)&&(C=d,pT))try{let T=new URL(window.location.href),V=d.startsWith("//")?new URL(T.protocol+d):new URL(d),N=ep(V.pathname,S);V.origin===T.origin&&N!=null?d=N+V.search+V.hash:k=!0}catch{}let D=$I(d,{relative:i}),b=mT(d,{replace:o,state:u,target:c,preventScrollReset:p,relative:i,viewTransition:y});function E(T){r&&r(T),T.defaultPrevented||b(T)}return P.createElement("a",Ph({},_,{href:C||D,onClick:k||s?r:E,ref:n,target:c}))});var Ym;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ym||(Ym={}));var Jm;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Jm||(Jm={}));function mT(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:u}=e===void 0?{}:e,c=ls(),d=po(),p=F_(t,{relative:o});return P.useCallback(y=>{if(uT(y,n)){y.preventDefault();let _=r!==void 0?r:Ru(d)===Ru(p);c(t,{replace:_,state:i,preventScrollReset:s,relative:o,viewTransition:u})}},[d,c,p,r,i,n,t,s,o,u])}function yT(){const[t,e]=P.useState(null),[n,r]=P.useState("");return P.useEffect(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(i=>{const s={lat:i.coords.latitude,lng:i.coords.longitude};e(s),localStorage.setItem("customerLocation",JSON.stringify(s)),console.log("✅ Location saved:",s)},i=>{console.error("❌ Location access denied:",i.message),r("Location access denied. Please enable location services.")}):r("Geolocation not supported by this browser.")},[]),a.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[a.jsx("h2",{children:"🏠 Welcome to Medcins"}),a.jsx("p",{children:"Your trusted online pharmacy."}),t?a.jsxs("p",{children:["📍 Your location: ",a.jsxs("b",{children:[t.lat.toFixed(4),", ",t.lng.toFixed(4)]})]}):a.jsx("p",{style:{color:"gray"},children:n||"Detecting your location..."}),a.jsx("div",{style:{margin:"40px 0"},children:a.jsx(on,{to:"/store",style:{display:"inline-block",padding:"18px 36px",background:"linear-gradient(90deg,#7c3aed,#4f46e5)",color:"#fff",fontSize:"1.3em",fontWeight:"bold",borderRadius:"12px",boxShadow:"0 2px 12px rgba(124,58,237,0.12)",textDecoration:"none",transition:"background 0.2s,box-shadow 0.2s"},children:"🔎 Find a pharmacy store near you"})})]})}var Xm={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},vT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],u=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},W_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,u=o?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,p=s>>2,y=(s&3)<<4|u>>4;let _=(u&15)<<2|d>>6,S=d&63;c||(S=64,o||(_=64)),r.push(n[p],n[y],n[_],n[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):vT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const y=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||u==null||d==null||y==null)throw new _T;const _=s<<2|u>>4;if(r.push(_),d!==64){const S=u<<4&240|d>>2;if(r.push(S),y!==64){const C=d<<6&192|y;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class _T extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xT=function(t){const e=$_(t);return W_.encodeByteArray(e,!0)},ku=function(t){return xT(t).replace(/\./g,"")},q_=function(t){try{return W_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET=()=>wT().__FIREBASE_DEFAULTS__,ST=()=>{if(typeof process>"u"||typeof Xm>"u")return;const t=Xm.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},IT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&q_(t[1]);return e&&JSON.parse(e)},hc=()=>{try{return ET()||ST()||IT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},H_=t=>{var e,n;return(n=(e=hc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},TT=t=>{const e=H_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},K_=()=>{var t;return(t=hc())===null||t===void 0?void 0:t.config},G_=t=>{var e;return(e=hc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ku(JSON.stringify(n)),ku(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nn())}function RT(){var t;const e=(t=hc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NT(){const t=nn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function DT(){return!RT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OT(){try{return typeof indexedDB=="object"}catch{return!1}}function LT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="FirebaseError";class Ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=MT,Object.setPrototypeOf(this,Ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ua.prototype.create)}}class Ua{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?VT(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new Ur(i,u,r)}}function VT(t,e){return t.replace(FT,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const FT=/\{\$([^}]+)}/g;function UT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Pu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Zm(s)&&Zm(o)){if(!Pu(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Zm(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Uo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Bo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function BT(t,e){const n=new zT(t,e);return n.subscribe.bind(n)}class zT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");$T(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=wd),i.error===void 0&&(i.error=wd),i.complete===void 0&&(i.complete=wd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $T(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function wd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t){return t&&t._delegate?t._delegate:t}class Yi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new bT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HT(e))try{this.getOrInitializeService({instanceIdentifier:Mi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mi){return this.instances.has(e)}getOptions(e=Mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:qT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Mi){return this.component?this.component.multipleInstances?e:Mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qT(t){return t===Mi?void 0:t}function HT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new WT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const GT={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},QT=Ve.INFO,YT={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},JT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=YT[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class np{constructor(e){this.name=e,this._logLevel=QT,this._logHandler=JT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const XT=(t,e)=>e.some(n=>t instanceof n);let ey,ty;function ZT(){return ey||(ey=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eb(){return ty||(ty=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Q_=new WeakMap,jh=new WeakMap,Y_=new WeakMap,Ed=new WeakMap,rp=new WeakMap;function tb(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(fi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Q_.set(n,t)}).catch(()=>{}),rp.set(e,t),e}function nb(t){if(jh.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});jh.set(t,e)}let Nh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Y_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return fi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rb(t){Nh=t(Nh)}function ib(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Sd(this),e,...n);return Y_.set(r,e.sort?e.sort():[e]),fi(r)}:eb().includes(t)?function(...e){return t.apply(Sd(this),e),fi(Q_.get(this))}:function(...e){return fi(t.apply(Sd(this),e))}}function sb(t){return typeof t=="function"?ib(t):(t instanceof IDBTransaction&&nb(t),XT(t,ZT())?new Proxy(t,Nh):t)}function fi(t){if(t instanceof IDBRequest)return tb(t);if(Ed.has(t))return Ed.get(t);const e=sb(t);return e!==t&&(Ed.set(t,e),rp.set(e,t)),e}const Sd=t=>rp.get(t);function ob(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),u=fi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(fi(o.result),c.oldVersion,c.newVersion,fi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const ab=["get","getKey","getAll","getAllKeys","count"],lb=["put","add","delete","clear"],Id=new Map;function ny(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Id.get(e))return Id.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=lb.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ab.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[n](...u),i&&c.done]))[0]};return Id.set(e,s),s}rb(t=>({...t,get:(e,n,r)=>ny(e,n)||t.get(e,n,r),has:(e,n)=>!!ny(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cb(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function cb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Dh="@firebase/app",ry="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new np("@firebase/app"),db="@firebase/app-compat",hb="@firebase/analytics-compat",fb="@firebase/analytics",pb="@firebase/app-check-compat",gb="@firebase/app-check",mb="@firebase/auth",yb="@firebase/auth-compat",vb="@firebase/database",_b="@firebase/data-connect",xb="@firebase/database-compat",wb="@firebase/functions",Eb="@firebase/functions-compat",Sb="@firebase/installations",Ib="@firebase/installations-compat",Tb="@firebase/messaging",bb="@firebase/messaging-compat",Cb="@firebase/performance",Ab="@firebase/performance-compat",Rb="@firebase/remote-config",kb="@firebase/remote-config-compat",Pb="@firebase/storage",jb="@firebase/storage-compat",Nb="@firebase/firestore",Db="@firebase/vertexai-preview",Ob="@firebase/firestore-compat",Lb="firebase",Mb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh="[DEFAULT]",Vb={[Dh]:"fire-core",[db]:"fire-core-compat",[fb]:"fire-analytics",[hb]:"fire-analytics-compat",[gb]:"fire-app-check",[pb]:"fire-app-check-compat",[mb]:"fire-auth",[yb]:"fire-auth-compat",[vb]:"fire-rtdb",[_b]:"fire-data-connect",[xb]:"fire-rtdb-compat",[wb]:"fire-fn",[Eb]:"fire-fn-compat",[Sb]:"fire-iid",[Ib]:"fire-iid-compat",[Tb]:"fire-fcm",[bb]:"fire-fcm-compat",[Cb]:"fire-perf",[Ab]:"fire-perf-compat",[Rb]:"fire-rc",[kb]:"fire-rc-compat",[Pb]:"fire-gcs",[jb]:"fire-gcs-compat",[Nb]:"fire-fst",[Ob]:"fire-fst-compat",[Db]:"fire-vertex","fire-js":"fire-js",[Lb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ju=new Map,Fb=new Map,Lh=new Map;function iy(t,e){try{t.container.addComponent(e)}catch(n){Or.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function no(t){const e=t.name;if(Lh.has(e))return Or.debug(`There were multiple attempts to register component ${e}.`),!1;Lh.set(e,t);for(const n of ju.values())iy(n,t);for(const n of Fb.values())iy(n,t);return!0}function ip(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function rr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pi=new Ua("app","Firebase",Ub);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go=Mb;function J_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Oh,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw pi.create("bad-app-name",{appName:String(i)});if(n||(n=K_()),!n)throw pi.create("no-options");const s=ju.get(i);if(s){if(Pu(n,s.options)&&Pu(r,s.config))return s;throw pi.create("duplicate-app",{appName:i})}const o=new KT(i);for(const c of Lh.values())o.addComponent(c);const u=new Bb(n,r,o);return ju.set(i,u),u}function X_(t=Oh){const e=ju.get(t);if(!e&&t===Oh&&K_())return J_();if(!e)throw pi.create("no-app",{appName:t});return e}function gi(t,e,n){var r;let i=(r=Vb[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Or.warn(u.join(" "));return}no(new Yi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb="firebase-heartbeat-database",$b=1,ba="firebase-heartbeat-store";let Td=null;function Z_(){return Td||(Td=ob(zb,$b,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ba)}catch(n){console.warn(n)}}}}).catch(t=>{throw pi.create("idb-open",{originalErrorMessage:t.message})})),Td}async function Wb(t){try{const n=(await Z_()).transaction(ba),r=await n.objectStore(ba).get(ex(t));return await n.done,r}catch(e){if(e instanceof Ur)Or.warn(e.message);else{const n=pi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Or.warn(n.message)}}}async function sy(t,e){try{const r=(await Z_()).transaction(ba,"readwrite");await r.objectStore(ba).put(e,ex(t)),await r.done}catch(n){if(n instanceof Ur)Or.warn(n.message);else{const r=pi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Or.warn(r.message)}}}function ex(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=1024,Hb=30*24*60*60*1e3;class Kb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Qb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=oy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const u=new Date(o.date).valueOf();return Date.now()-u<=Hb}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=oy(),{heartbeatsToSend:r,unsentEntries:i}=Gb(this._heartbeatsCache.heartbeats),s=ku(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Or.warn(n),""}}}function oy(){return new Date().toISOString().substring(0,10)}function Gb(t,e=qb){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),ay(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ay(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Qb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OT()?LT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Wb(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return sy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return sy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ay(t){return ku(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(t){no(new Yi("platform-logger",e=>new ub(e),"PRIVATE")),no(new Yi("heartbeat",e=>new Kb(e),"PRIVATE")),gi(Dh,ry,t),gi(Dh,ry,"esm2017"),gi("fire-js","")}Yb("");var Jb="firebase",Xb="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gi(Jb,Xb,"app");var ly=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wi,tx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,f){function m(){}m.prototype=f.prototype,w.D=f.prototype,w.prototype=new m,w.prototype.constructor=w,w.C=function(x,R,j){for(var A=Array(arguments.length-2),te=2;te<arguments.length;te++)A[te-2]=arguments[te];return f.prototype[R].apply(x,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,f,m){m||(m=0);var x=Array(16);if(typeof f=="string")for(var R=0;16>R;++R)x[R]=f.charCodeAt(m++)|f.charCodeAt(m++)<<8|f.charCodeAt(m++)<<16|f.charCodeAt(m++)<<24;else for(R=0;16>R;++R)x[R]=f[m++]|f[m++]<<8|f[m++]<<16|f[m++]<<24;f=w.g[0],m=w.g[1],R=w.g[2];var j=w.g[3],A=f+(j^m&(R^j))+x[0]+3614090360&4294967295;f=m+(A<<7&4294967295|A>>>25),A=j+(R^f&(m^R))+x[1]+3905402710&4294967295,j=f+(A<<12&4294967295|A>>>20),A=R+(m^j&(f^m))+x[2]+606105819&4294967295,R=j+(A<<17&4294967295|A>>>15),A=m+(f^R&(j^f))+x[3]+3250441966&4294967295,m=R+(A<<22&4294967295|A>>>10),A=f+(j^m&(R^j))+x[4]+4118548399&4294967295,f=m+(A<<7&4294967295|A>>>25),A=j+(R^f&(m^R))+x[5]+1200080426&4294967295,j=f+(A<<12&4294967295|A>>>20),A=R+(m^j&(f^m))+x[6]+2821735955&4294967295,R=j+(A<<17&4294967295|A>>>15),A=m+(f^R&(j^f))+x[7]+4249261313&4294967295,m=R+(A<<22&4294967295|A>>>10),A=f+(j^m&(R^j))+x[8]+1770035416&4294967295,f=m+(A<<7&4294967295|A>>>25),A=j+(R^f&(m^R))+x[9]+2336552879&4294967295,j=f+(A<<12&4294967295|A>>>20),A=R+(m^j&(f^m))+x[10]+4294925233&4294967295,R=j+(A<<17&4294967295|A>>>15),A=m+(f^R&(j^f))+x[11]+2304563134&4294967295,m=R+(A<<22&4294967295|A>>>10),A=f+(j^m&(R^j))+x[12]+1804603682&4294967295,f=m+(A<<7&4294967295|A>>>25),A=j+(R^f&(m^R))+x[13]+4254626195&4294967295,j=f+(A<<12&4294967295|A>>>20),A=R+(m^j&(f^m))+x[14]+2792965006&4294967295,R=j+(A<<17&4294967295|A>>>15),A=m+(f^R&(j^f))+x[15]+1236535329&4294967295,m=R+(A<<22&4294967295|A>>>10),A=f+(R^j&(m^R))+x[1]+4129170786&4294967295,f=m+(A<<5&4294967295|A>>>27),A=j+(m^R&(f^m))+x[6]+3225465664&4294967295,j=f+(A<<9&4294967295|A>>>23),A=R+(f^m&(j^f))+x[11]+643717713&4294967295,R=j+(A<<14&4294967295|A>>>18),A=m+(j^f&(R^j))+x[0]+3921069994&4294967295,m=R+(A<<20&4294967295|A>>>12),A=f+(R^j&(m^R))+x[5]+3593408605&4294967295,f=m+(A<<5&4294967295|A>>>27),A=j+(m^R&(f^m))+x[10]+38016083&4294967295,j=f+(A<<9&4294967295|A>>>23),A=R+(f^m&(j^f))+x[15]+3634488961&4294967295,R=j+(A<<14&4294967295|A>>>18),A=m+(j^f&(R^j))+x[4]+3889429448&4294967295,m=R+(A<<20&4294967295|A>>>12),A=f+(R^j&(m^R))+x[9]+568446438&4294967295,f=m+(A<<5&4294967295|A>>>27),A=j+(m^R&(f^m))+x[14]+3275163606&4294967295,j=f+(A<<9&4294967295|A>>>23),A=R+(f^m&(j^f))+x[3]+4107603335&4294967295,R=j+(A<<14&4294967295|A>>>18),A=m+(j^f&(R^j))+x[8]+1163531501&4294967295,m=R+(A<<20&4294967295|A>>>12),A=f+(R^j&(m^R))+x[13]+2850285829&4294967295,f=m+(A<<5&4294967295|A>>>27),A=j+(m^R&(f^m))+x[2]+4243563512&4294967295,j=f+(A<<9&4294967295|A>>>23),A=R+(f^m&(j^f))+x[7]+1735328473&4294967295,R=j+(A<<14&4294967295|A>>>18),A=m+(j^f&(R^j))+x[12]+2368359562&4294967295,m=R+(A<<20&4294967295|A>>>12),A=f+(m^R^j)+x[5]+4294588738&4294967295,f=m+(A<<4&4294967295|A>>>28),A=j+(f^m^R)+x[8]+2272392833&4294967295,j=f+(A<<11&4294967295|A>>>21),A=R+(j^f^m)+x[11]+1839030562&4294967295,R=j+(A<<16&4294967295|A>>>16),A=m+(R^j^f)+x[14]+4259657740&4294967295,m=R+(A<<23&4294967295|A>>>9),A=f+(m^R^j)+x[1]+2763975236&4294967295,f=m+(A<<4&4294967295|A>>>28),A=j+(f^m^R)+x[4]+1272893353&4294967295,j=f+(A<<11&4294967295|A>>>21),A=R+(j^f^m)+x[7]+4139469664&4294967295,R=j+(A<<16&4294967295|A>>>16),A=m+(R^j^f)+x[10]+3200236656&4294967295,m=R+(A<<23&4294967295|A>>>9),A=f+(m^R^j)+x[13]+681279174&4294967295,f=m+(A<<4&4294967295|A>>>28),A=j+(f^m^R)+x[0]+3936430074&4294967295,j=f+(A<<11&4294967295|A>>>21),A=R+(j^f^m)+x[3]+3572445317&4294967295,R=j+(A<<16&4294967295|A>>>16),A=m+(R^j^f)+x[6]+76029189&4294967295,m=R+(A<<23&4294967295|A>>>9),A=f+(m^R^j)+x[9]+3654602809&4294967295,f=m+(A<<4&4294967295|A>>>28),A=j+(f^m^R)+x[12]+3873151461&4294967295,j=f+(A<<11&4294967295|A>>>21),A=R+(j^f^m)+x[15]+530742520&4294967295,R=j+(A<<16&4294967295|A>>>16),A=m+(R^j^f)+x[2]+3299628645&4294967295,m=R+(A<<23&4294967295|A>>>9),A=f+(R^(m|~j))+x[0]+4096336452&4294967295,f=m+(A<<6&4294967295|A>>>26),A=j+(m^(f|~R))+x[7]+1126891415&4294967295,j=f+(A<<10&4294967295|A>>>22),A=R+(f^(j|~m))+x[14]+2878612391&4294967295,R=j+(A<<15&4294967295|A>>>17),A=m+(j^(R|~f))+x[5]+4237533241&4294967295,m=R+(A<<21&4294967295|A>>>11),A=f+(R^(m|~j))+x[12]+1700485571&4294967295,f=m+(A<<6&4294967295|A>>>26),A=j+(m^(f|~R))+x[3]+2399980690&4294967295,j=f+(A<<10&4294967295|A>>>22),A=R+(f^(j|~m))+x[10]+4293915773&4294967295,R=j+(A<<15&4294967295|A>>>17),A=m+(j^(R|~f))+x[1]+2240044497&4294967295,m=R+(A<<21&4294967295|A>>>11),A=f+(R^(m|~j))+x[8]+1873313359&4294967295,f=m+(A<<6&4294967295|A>>>26),A=j+(m^(f|~R))+x[15]+4264355552&4294967295,j=f+(A<<10&4294967295|A>>>22),A=R+(f^(j|~m))+x[6]+2734768916&4294967295,R=j+(A<<15&4294967295|A>>>17),A=m+(j^(R|~f))+x[13]+1309151649&4294967295,m=R+(A<<21&4294967295|A>>>11),A=f+(R^(m|~j))+x[4]+4149444226&4294967295,f=m+(A<<6&4294967295|A>>>26),A=j+(m^(f|~R))+x[11]+3174756917&4294967295,j=f+(A<<10&4294967295|A>>>22),A=R+(f^(j|~m))+x[2]+718787259&4294967295,R=j+(A<<15&4294967295|A>>>17),A=m+(j^(R|~f))+x[9]+3951481745&4294967295,w.g[0]=w.g[0]+f&4294967295,w.g[1]=w.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,w.g[2]=w.g[2]+R&4294967295,w.g[3]=w.g[3]+j&4294967295}r.prototype.u=function(w,f){f===void 0&&(f=w.length);for(var m=f-this.blockSize,x=this.B,R=this.h,j=0;j<f;){if(R==0)for(;j<=m;)i(this,w,j),j+=this.blockSize;if(typeof w=="string"){for(;j<f;)if(x[R++]=w.charCodeAt(j++),R==this.blockSize){i(this,x),R=0;break}}else for(;j<f;)if(x[R++]=w[j++],R==this.blockSize){i(this,x),R=0;break}}this.h=R,this.o+=f},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var f=1;f<w.length-8;++f)w[f]=0;var m=8*this.o;for(f=w.length-8;f<w.length;++f)w[f]=m&255,m/=256;for(this.u(w),w=Array(16),f=m=0;4>f;++f)for(var x=0;32>x;x+=8)w[m++]=this.g[f]>>>x&255;return w};function s(w,f){var m=u;return Object.prototype.hasOwnProperty.call(m,w)?m[w]:m[w]=f(w)}function o(w,f){this.h=f;for(var m=[],x=!0,R=w.length-1;0<=R;R--){var j=w[R]|0;x&&j==f||(m[R]=j,x=!1)}this.g=m}var u={};function c(w){return-128<=w&&128>w?s(w,function(f){return new o([f|0],0>f?-1:0)}):new o([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return y;if(0>w)return D(d(-w));for(var f=[],m=1,x=0;w>=m;x++)f[x]=w/m|0,m*=4294967296;return new o(f,0)}function p(w,f){if(w.length==0)throw Error("number format error: empty string");if(f=f||10,2>f||36<f)throw Error("radix out of range: "+f);if(w.charAt(0)=="-")return D(p(w.substring(1),f));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=d(Math.pow(f,8)),x=y,R=0;R<w.length;R+=8){var j=Math.min(8,w.length-R),A=parseInt(w.substring(R,R+j),f);8>j?(j=d(Math.pow(f,j)),x=x.j(j).add(d(A))):(x=x.j(m),x=x.add(d(A)))}return x}var y=c(0),_=c(1),S=c(16777216);t=o.prototype,t.m=function(){if(k(this))return-D(this).m();for(var w=0,f=1,m=0;m<this.g.length;m++){var x=this.i(m);w+=(0<=x?x:4294967296+x)*f,f*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(C(this))return"0";if(k(this))return"-"+D(this).toString(w);for(var f=d(Math.pow(w,6)),m=this,x="";;){var R=V(m,f).g;m=b(m,R.j(f));var j=((0<m.g.length?m.g[0]:m.h)>>>0).toString(w);if(m=R,C(m))return j+x;for(;6>j.length;)j="0"+j;x=j+x}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function C(w){if(w.h!=0)return!1;for(var f=0;f<w.g.length;f++)if(w.g[f]!=0)return!1;return!0}function k(w){return w.h==-1}t.l=function(w){return w=b(this,w),k(w)?-1:C(w)?0:1};function D(w){for(var f=w.g.length,m=[],x=0;x<f;x++)m[x]=~w.g[x];return new o(m,~w.h).add(_)}t.abs=function(){return k(this)?D(this):this},t.add=function(w){for(var f=Math.max(this.g.length,w.g.length),m=[],x=0,R=0;R<=f;R++){var j=x+(this.i(R)&65535)+(w.i(R)&65535),A=(j>>>16)+(this.i(R)>>>16)+(w.i(R)>>>16);x=A>>>16,j&=65535,A&=65535,m[R]=A<<16|j}return new o(m,m[m.length-1]&-2147483648?-1:0)};function b(w,f){return w.add(D(f))}t.j=function(w){if(C(this)||C(w))return y;if(k(this))return k(w)?D(this).j(D(w)):D(D(this).j(w));if(k(w))return D(this.j(D(w)));if(0>this.l(S)&&0>w.l(S))return d(this.m()*w.m());for(var f=this.g.length+w.g.length,m=[],x=0;x<2*f;x++)m[x]=0;for(x=0;x<this.g.length;x++)for(var R=0;R<w.g.length;R++){var j=this.i(x)>>>16,A=this.i(x)&65535,te=w.i(R)>>>16,$=w.i(R)&65535;m[2*x+2*R]+=A*$,E(m,2*x+2*R),m[2*x+2*R+1]+=j*$,E(m,2*x+2*R+1),m[2*x+2*R+1]+=A*te,E(m,2*x+2*R+1),m[2*x+2*R+2]+=j*te,E(m,2*x+2*R+2)}for(x=0;x<f;x++)m[x]=m[2*x+1]<<16|m[2*x];for(x=f;x<2*f;x++)m[x]=0;return new o(m,0)};function E(w,f){for(;(w[f]&65535)!=w[f];)w[f+1]+=w[f]>>>16,w[f]&=65535,f++}function T(w,f){this.g=w,this.h=f}function V(w,f){if(C(f))throw Error("division by zero");if(C(w))return new T(y,y);if(k(w))return f=V(D(w),f),new T(D(f.g),D(f.h));if(k(f))return f=V(w,D(f)),new T(D(f.g),f.h);if(30<w.g.length){if(k(w)||k(f))throw Error("slowDivide_ only works with positive integers.");for(var m=_,x=f;0>=x.l(w);)m=N(m),x=N(x);var R=M(m,1),j=M(x,1);for(x=M(x,2),m=M(m,2);!C(x);){var A=j.add(x);0>=A.l(w)&&(R=R.add(m),j=A),x=M(x,1),m=M(m,1)}return f=b(w,R.j(f)),new T(R,f)}for(R=y;0<=w.l(f);){for(m=Math.max(1,Math.floor(w.m()/f.m())),x=Math.ceil(Math.log(m)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),j=d(m),A=j.j(f);k(A)||0<A.l(w);)m-=x,j=d(m),A=j.j(f);C(j)&&(j=_),R=R.add(j),w=b(w,A)}return new T(R,w)}t.A=function(w){return V(this,w).h},t.and=function(w){for(var f=Math.max(this.g.length,w.g.length),m=[],x=0;x<f;x++)m[x]=this.i(x)&w.i(x);return new o(m,this.h&w.h)},t.or=function(w){for(var f=Math.max(this.g.length,w.g.length),m=[],x=0;x<f;x++)m[x]=this.i(x)|w.i(x);return new o(m,this.h|w.h)},t.xor=function(w){for(var f=Math.max(this.g.length,w.g.length),m=[],x=0;x<f;x++)m[x]=this.i(x)^w.i(x);return new o(m,this.h^w.h)};function N(w){for(var f=w.g.length+1,m=[],x=0;x<f;x++)m[x]=w.i(x)<<1|w.i(x-1)>>>31;return new o(m,w.h)}function M(w,f){var m=f>>5;f%=32;for(var x=w.g.length-m,R=[],j=0;j<x;j++)R[j]=0<f?w.i(j+m)>>>f|w.i(j+m+1)<<32-f:w.i(j+m);return new o(R,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,tx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Wi=o}).apply(typeof ly<"u"?ly:typeof self<"u"?self:typeof window<"u"?window:{});var Nl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nx,zo,rx,Jl,Mh,ix,sx,ox;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,g){return l==Array.prototype||l==Object.prototype||(l[h]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nl=="object"&&Nl];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(l,h){if(h)e:{var g=r;l=l.split(".");for(var I=0;I<l.length-1;I++){var U=l[I];if(!(U in g))break e;g=g[U]}l=l[l.length-1],I=g[l],h=h(I),h!=I&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var g=0,I=!1,U={next:function(){if(!I&&g<l.length){var q=g++;return{value:h(q,l[q]),done:!1}}return I=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function p(l,h,g){return l.call.apply(l.bind,arguments)}function y(l,h,g){if(!l)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,I),l.apply(h,U)}}return function(){return l.apply(h,arguments)}}function _(l,h,g){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,_.apply(null,arguments)}function S(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var I=g.slice();return I.push.apply(I,arguments),l.apply(this,I)}}function C(l,h){function g(){}g.prototype=h.prototype,l.aa=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(I,U,q){for(var ie=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)ie[Je-2]=arguments[Je];return h.prototype[U].apply(I,ie)}}function k(l){const h=l.length;if(0<h){const g=Array(h);for(let I=0;I<h;I++)g[I]=l[I];return g}return[]}function D(l,h){for(let g=1;g<arguments.length;g++){const I=arguments[g];if(c(I)){const U=l.length||0,q=I.length||0;l.length=U+q;for(let ie=0;ie<q;ie++)l[U+ie]=I[ie]}else l.push(I)}}class b{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function E(l){return/^[\s\xa0]*$/.test(l)}function T(){var l=u.navigator;return l&&(l=l.userAgent)?l:""}function V(l){return V[" "](l),l}V[" "]=function(){};var N=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function M(l,h,g){for(const I in l)h.call(g,l[I],I,l)}function w(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function f(l){const h={};for(const g in l)h[g]=l[g];return h}const m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(l,h){let g,I;for(let U=1;U<arguments.length;U++){I=arguments[U];for(g in I)l[g]=I[g];for(let q=0;q<m.length;q++)g=m[q],Object.prototype.hasOwnProperty.call(I,g)&&(l[g]=I[g])}}function R(l){var h=1;l=l.split(":");const g=[];for(;0<h&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function j(l){u.setTimeout(()=>{throw l},0)}function A(){var l=F;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class te{constructor(){this.h=this.g=null}add(h,g){const I=$.get();I.set(h,g),this.h?this.h.next=I:this.g=I,this.h=I}}var $=new b(()=>new ne,l=>l.reset());class ne{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let X,L=!1,F=new te,W=()=>{const l=u.Promise.resolve(void 0);X=()=>{l.then(H)}};var H=()=>{for(var l;l=A();){try{l.h.call(l.g)}catch(g){j(g)}var h=$;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}L=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var Z=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};u.addEventListener("test",g,h),u.removeEventListener("test",g,h)}catch{}return l}();function z(l,h){if(O.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,I=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(N){e:{try{V(h.nodeName);var U=!0;break e}catch{}U=!1}U||(h=null)}}else g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement);this.relatedTarget=h,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:se[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&z.aa.h.call(this)}}C(z,O);var se={2:"touch",3:"pen",4:"mouse"};z.prototype.h=function(){z.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),re=0;function be(l,h,g,I,U){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!I,this.ha=U,this.key=++re,this.da=this.fa=!1}function Oe(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function _e(l){this.src=l,this.g={},this.h=0}_e.prototype.add=function(l,h,g,I,U){var q=l.toString();l=this.g[q],l||(l=this.g[q]=[],this.h++);var ie=Fe(l,h,I,U);return-1<ie?(h=l[ie],g||(h.fa=!1)):(h=new be(h,this.src,q,!!I,U),h.fa=g,l.push(h)),h};function je(l,h){var g=h.type;if(g in l.g){var I=l.g[g],U=Array.prototype.indexOf.call(I,h,void 0),q;(q=0<=U)&&Array.prototype.splice.call(I,U,1),q&&(Oe(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function Fe(l,h,g,I){for(var U=0;U<l.length;++U){var q=l[U];if(!q.da&&q.listener==h&&q.capture==!!g&&q.ha==I)return U}return-1}var De="closure_lm_"+(1e6*Math.random()|0),Re={};function ye(l,h,g,I,U){if(Array.isArray(h)){for(var q=0;q<h.length;q++)ye(l,h[q],g,I,U);return null}return g=vt(g),l&&l[fe]?l.K(h,g,d(I)?!!I.capture:!1,U):Ge(l,h,g,!1,I,U)}function Ge(l,h,g,I,U,q){if(!h)throw Error("Invalid event type");var ie=d(U)?!!U.capture:!!U,Je=bt(l);if(Je||(l[De]=Je=new _e(l)),g=Je.add(h,g,I,ie,q),g.proxy)return g;if(I=ve(),g.proxy=I,I.src=l,I.listener=g,l.addEventListener)Z||(U=ie),U===void 0&&(U=!1),l.addEventListener(h.toString(),I,U);else if(l.attachEvent)l.attachEvent(qt(h.toString()),I);else if(l.addListener&&l.removeListener)l.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ve(){function l(g){return h.call(l.src,l.listener,g)}const h=ht;return l}function ke(l,h,g,I,U){if(Array.isArray(h))for(var q=0;q<h.length;q++)ke(l,h[q],g,I,U);else I=d(I)?!!I.capture:!!I,g=vt(g),l&&l[fe]?(l=l.i,h=String(h).toString(),h in l.g&&(q=l.g[h],g=Fe(q,g,I,U),-1<g&&(Oe(q[g]),Array.prototype.splice.call(q,g,1),q.length==0&&(delete l.g[h],l.h--)))):l&&(l=bt(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Fe(h,g,I,U)),(g=-1<l?h[l]:null)&&Pe(g))}function Pe(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[fe])je(h.i,l);else{var g=l.type,I=l.proxy;h.removeEventListener?h.removeEventListener(g,I,l.capture):h.detachEvent?h.detachEvent(qt(g),I):h.addListener&&h.removeListener&&h.removeListener(I),(g=bt(h))?(je(g,l),g.h==0&&(g.src=null,h[De]=null)):Oe(l)}}}function qt(l){return l in Re?Re[l]:Re[l]="on"+l}function ht(l,h){if(l.da)l=!0;else{h=new z(h,this);var g=l.listener,I=l.ha||l.src;l.fa&&Pe(l),l=g.call(I,h)}return l}function bt(l){return l=l[De],l instanceof _e?l:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function vt(l){return typeof l=="function"?l:(l[Qe]||(l[Qe]=function(h){return l.handleEvent(h)}),l[Qe])}function Ee(){Q.call(this),this.i=new _e(this),this.M=this,this.F=null}C(Ee,Q),Ee.prototype[fe]=!0,Ee.prototype.removeEventListener=function(l,h,g,I){ke(this,l,h,g,I)};function Ne(l,h){var g,I=l.F;if(I)for(g=[];I;I=I.F)g.push(I);if(l=l.M,I=h.type||h,typeof h=="string")h=new O(h,l);else if(h instanceof O)h.target=h.target||l;else{var U=h;h=new O(I,l),x(h,U)}if(U=!0,g)for(var q=g.length-1;0<=q;q--){var ie=h.g=g[q];U=Ze(ie,I,!0,h)&&U}if(ie=h.g=l,U=Ze(ie,I,!0,h)&&U,U=Ze(ie,I,!1,h)&&U,g)for(q=0;q<g.length;q++)ie=h.g=g[q],U=Ze(ie,I,!1,h)&&U}Ee.prototype.N=function(){if(Ee.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var g=l.g[h],I=0;I<g.length;I++)Oe(g[I]);delete l.g[h],l.h--}}this.F=null},Ee.prototype.K=function(l,h,g,I){return this.i.add(String(l),h,!1,g,I)},Ee.prototype.L=function(l,h,g,I){return this.i.add(String(l),h,!0,g,I)};function Ze(l,h,g,I){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var U=!0,q=0;q<h.length;++q){var ie=h[q];if(ie&&!ie.da&&ie.capture==g){var Je=ie.listener,Vt=ie.ha||ie.src;ie.fa&&je(l.i,ie),U=Je.call(Vt,I)!==!1&&U}}return U&&!I.defaultPrevented}function kn(l,h,g){if(typeof l=="function")g&&(l=_(l,g));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(l,h||0)}function rn(l){l.g=kn(()=>{l.g=null,l.i&&(l.i=!1,rn(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class sn extends Q{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:rn(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qe(l){Q.call(this),this.h=l,this.g={}}C(qe,Q);var fn=[];function Zn(l){M(l.g,function(h,g){this.g.hasOwnProperty(g)&&Pe(h)},l),l.g={}}qe.prototype.N=function(){qe.aa.N.call(this),Zn(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ye=u.JSON.stringify,ki=u.JSON.parse,Br=class{stringify(l){return u.JSON.stringify(l,void 0)}parse(l){return u.JSON.parse(l,void 0)}};function Pi(){}Pi.prototype.h=null;function zr(l){return l.h||(l.h=l.i())}function fs(){}var Pn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $r(){O.call(this,"d")}C($r,O);function Wr(){O.call(this,"c")}C(Wr,O);var jn={},v=null;function Y(){return v=v||new Ee}jn.La="serverreachability";function le(l){O.call(this,jn.La,l)}C(le,O);function xe(l){const h=Y();Ne(h,new le(h))}jn.STAT_EVENT="statevent";function B(l,h){O.call(this,jn.STAT_EVENT,l),this.stat=h}C(B,O);function oe(l){const h=Y();Ne(h,new B(h,l))}jn.Ma="timingevent";function pe(l,h){O.call(this,jn.Ma,l),this.size=h}C(pe,O);function ae(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){l()},h)}function Ie(){this.g=!0}Ie.prototype.xa=function(){this.g=!1};function Ht(l,h,g,I,U,q){l.info(function(){if(l.g)if(q)for(var ie="",Je=q.split("&"),Vt=0;Vt<Je.length;Vt++){var $e=Je[Vt].split("=");if(1<$e.length){var Kt=$e[0];$e=$e[1];var Gt=Kt.split("_");ie=2<=Gt.length&&Gt[1]=="type"?ie+(Kt+"="+$e+"&"):ie+(Kt+"=redacted&")}}else ie=null;else ie=q;return"XMLHTTP REQ ("+I+") [attempt "+U+"]: "+h+`
`+g+`
`+ie})}function xn(l,h,g,I,U,q,ie){l.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+U+"]: "+h+`
`+g+`
`+q+" "+ie})}function Mt(l,h,g,I){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+ot(l,g)+(I?" "+I:"")})}function et(l,h){l.info(function(){return"TIMEOUT: "+h})}Ie.prototype.info=function(){};function ot(l,h){if(!l.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var I=g[l];if(!(2>I.length)){var U=I[1];if(Array.isArray(U)&&!(1>U.length)){var q=U[0];if(q!="noop"&&q!="stop"&&q!="close")for(var ie=1;ie<U.length;ie++)U[ie]=""}}}}return Ye(g)}catch{return h}}var fr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},me={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},at;function ps(){}C(ps,Pi),ps.prototype.g=function(){return new XMLHttpRequest},ps.prototype.i=function(){return{}},at=new ps;function qr(l,h,g,I){this.j=l,this.i=h,this.l=g,this.R=I||1,this.U=new qe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Jp}function Jp(){this.i=null,this.g="",this.h=!1}var Xp={},Mc={};function Vc(l,h,g){l.L=1,l.v=al(pr(h)),l.m=g,l.P=!0,Zp(l,null)}function Zp(l,h){l.F=Date.now(),il(l),l.A=pr(l.v);var g=l.A,I=l.R;Array.isArray(I)||(I=[String(I)]),fg(g.i,"t",I),l.C=0,g=l.j.J,l.h=new Jp,l.g=Pg(l.j,g?h:null,!l.m),0<l.O&&(l.M=new sn(_(l.Y,l,l.g),l.O)),h=l.U,g=l.g,I=l.ca;var U="readystatechange";Array.isArray(U)||(U&&(fn[0]=U.toString()),U=fn);for(var q=0;q<U.length;q++){var ie=ye(g,U[q],I||h.handleEvent,!1,h.h||h);if(!ie)break;h.g[ie.key]=ie}h=l.H?f(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),xe(),Ht(l.i,l.u,l.A,l.l,l.R,l.m)}qr.prototype.ca=function(l){l=l.target;const h=this.M;h&&gr(l)==3?h.j():this.Y(l)},qr.prototype.Y=function(l){try{if(l==this.g)e:{const Gt=gr(this.g);var h=this.g.Ba();const ys=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||xg(this.g)))){this.J||Gt!=4||h==7||(h==8||0>=ys?xe(3):xe(2)),Fc(this);var g=this.g.Z();this.X=g;t:if(eg(this)){var I=xg(this.g);l="";var U=I.length,q=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ji(this),_o(this);var ie="";break t}this.h.i=new u.TextDecoder}for(h=0;h<U;h++)this.h.h=!0,l+=this.h.i.decode(I[h],{stream:!(q&&h==U-1)});I.length=0,this.h.g+=l,this.C=0,ie=this.h.g}else ie=this.g.oa();if(this.o=g==200,xn(this.i,this.u,this.A,this.l,this.R,Gt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Je,Vt=this.g;if((Je=Vt.g?Vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(Je)){var $e=Je;break t}}$e=null}if(g=$e)Mt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Uc(this,g);else{this.o=!1,this.s=3,oe(12),ji(this),_o(this);break e}}if(this.P){g=!0;let zn;for(;!this.J&&this.C<ie.length;)if(zn=EE(this,ie),zn==Mc){Gt==4&&(this.s=4,oe(14),g=!1),Mt(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==Xp){this.s=4,oe(15),Mt(this.i,this.l,ie,"[Invalid Chunk]"),g=!1;break}else Mt(this.i,this.l,zn,null),Uc(this,zn);if(eg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||ie.length!=0||this.h.h||(this.s=1,oe(16),g=!1),this.o=this.o&&g,!g)Mt(this.i,this.l,ie,"[Invalid Chunked Response]"),ji(this),_o(this);else if(0<ie.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+ie.length),Hc(Kt),Kt.M=!0,oe(11))}}else Mt(this.i,this.l,ie,null),Uc(this,ie);Gt==4&&ji(this),this.o&&!this.J&&(Gt==4?Cg(this.j,this):(this.o=!1,il(this)))}else FE(this.g),g==400&&0<ie.indexOf("Unknown SID")?(this.s=3,oe(12)):(this.s=0,oe(13)),ji(this),_o(this)}}}catch{}finally{}};function eg(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function EE(l,h){var g=l.C,I=h.indexOf(`
`,g);return I==-1?Mc:(g=Number(h.substring(g,I)),isNaN(g)?Xp:(I+=1,I+g>h.length?Mc:(h=h.slice(I,I+g),l.C=I+g,h)))}qr.prototype.cancel=function(){this.J=!0,ji(this)};function il(l){l.S=Date.now()+l.I,tg(l,l.I)}function tg(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ae(_(l.ba,l),h)}function Fc(l){l.B&&(u.clearTimeout(l.B),l.B=null)}qr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(et(this.i,this.A),this.L!=2&&(xe(),oe(17)),ji(this),this.s=2,_o(this)):tg(this,this.S-l)};function _o(l){l.j.G==0||l.J||Cg(l.j,l)}function ji(l){Fc(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Zn(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Uc(l,h){try{var g=l.j;if(g.G!=0&&(g.g==l||Bc(g.h,l))){if(!l.K&&Bc(g.h,l)&&g.G==3){try{var I=g.Da.g.parse(h)}catch{I=null}if(Array.isArray(I)&&I.length==3){var U=I;if(U[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)fl(g),dl(g);else break e;qc(g),oe(18)}}else g.za=U[1],0<g.za-g.T&&37500>U[2]&&g.F&&g.v==0&&!g.C&&(g.C=ae(_(g.Za,g),6e3));if(1>=ig(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Di(g,11)}else if((l.K||g.g==l)&&fl(g),!E(h))for(U=g.Da.g.parse(h),h=0;h<U.length;h++){let $e=U[h];if(g.T=$e[0],$e=$e[1],g.G==2)if($e[0]=="c"){g.K=$e[1],g.ia=$e[2];const Kt=$e[3];Kt!=null&&(g.la=Kt,g.j.info("VER="+g.la));const Gt=$e[4];Gt!=null&&(g.Aa=Gt,g.j.info("SVER="+g.Aa));const ys=$e[5];ys!=null&&typeof ys=="number"&&0<ys&&(I=1.5*ys,g.L=I,g.j.info("backChannelRequestTimeoutMs_="+I)),I=g;const zn=l.g;if(zn){const gl=zn.g?zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gl){var q=I.h;q.g||gl.indexOf("spdy")==-1&&gl.indexOf("quic")==-1&&gl.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(zc(q,q.h),q.h=null))}if(I.D){const Kc=zn.g?zn.g.getResponseHeader("X-HTTP-Session-Id"):null;Kc&&(I.ya=Kc,tt(I.I,I.D,Kc))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),I=g;var ie=l;if(I.qa=kg(I,I.J?I.ia:null,I.W),ie.K){sg(I.h,ie);var Je=ie,Vt=I.L;Vt&&(Je.I=Vt),Je.B&&(Fc(Je),il(Je)),I.g=ie}else Tg(I);0<g.i.length&&hl(g)}else $e[0]!="stop"&&$e[0]!="close"||Di(g,7);else g.G==3&&($e[0]=="stop"||$e[0]=="close"?$e[0]=="stop"?Di(g,7):Wc(g):$e[0]!="noop"&&g.l&&g.l.ta($e),g.v=0)}}xe(4)}catch{}}var SE=class{constructor(l,h){this.g=l,this.map=h}};function ng(l){this.l=l||10,u.PerformanceNavigationTiming?(l=u.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function rg(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function ig(l){return l.h?1:l.g?l.g.size:0}function Bc(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function zc(l,h){l.g?l.g.add(h):l.h=h}function sg(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}ng.prototype.cancel=function(){if(this.i=og(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function og(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.D);return h}return k(l.i)}function IE(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],g=l.length,I=0;I<g;I++)h.push(l[I]);return h}h=[],g=0;for(I in l)h[g++]=l[I];return h}function TE(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var g=0;g<l;g++)h.push(g);return h}h=[],g=0;for(const I in l)h[g++]=I;return h}}}function ag(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var g=TE(l),I=IE(l),U=I.length,q=0;q<U;q++)h.call(void 0,I[q],g&&g[q],l)}var lg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bE(l,h){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var I=l[g].indexOf("="),U=null;if(0<=I){var q=l[g].substring(0,I);U=l[g].substring(I+1)}else q=l[g];h(q,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Ni(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Ni){this.h=l.h,sl(this,l.j),this.o=l.o,this.g=l.g,ol(this,l.s),this.l=l.l;var h=l.i,g=new Eo;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),ug(this,g),this.m=l.m}else l&&(h=String(l).match(lg))?(this.h=!1,sl(this,h[1]||"",!0),this.o=xo(h[2]||""),this.g=xo(h[3]||"",!0),ol(this,h[4]),this.l=xo(h[5]||"",!0),ug(this,h[6]||"",!0),this.m=xo(h[7]||"")):(this.h=!1,this.i=new Eo(null,this.h))}Ni.prototype.toString=function(){var l=[],h=this.j;h&&l.push(wo(h,cg,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(wo(h,cg,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(wo(g,g.charAt(0)=="/"?RE:AE,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",wo(g,PE)),l.join("")};function pr(l){return new Ni(l)}function sl(l,h,g){l.j=g?xo(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function ol(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function ug(l,h,g){h instanceof Eo?(l.i=h,jE(l.i,l.h)):(g||(h=wo(h,kE)),l.i=new Eo(h,l.h))}function tt(l,h,g){l.i.set(h,g)}function al(l){return tt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function xo(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function wo(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,CE),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function CE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var cg=/[#\/\?@]/g,AE=/[#\?:]/g,RE=/[#\?]/g,kE=/[#\?@]/g,PE=/#/g;function Eo(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Hr(l){l.g||(l.g=new Map,l.h=0,l.i&&bE(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Eo.prototype,t.add=function(l,h){Hr(this),this.i=null,l=gs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function dg(l,h){Hr(l),h=gs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function hg(l,h){return Hr(l),h=gs(l,h),l.g.has(h)}t.forEach=function(l,h){Hr(this),this.g.forEach(function(g,I){g.forEach(function(U){l.call(h,U,I,this)},this)},this)},t.na=function(){Hr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let I=0;I<h.length;I++){const U=l[I];for(let q=0;q<U.length;q++)g.push(h[I])}return g},t.V=function(l){Hr(this);let h=[];if(typeof l=="string")hg(this,l)&&(h=h.concat(this.g.get(gs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)h=h.concat(l[g])}return h},t.set=function(l,h){return Hr(this),this.i=null,l=gs(this,l),hg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function fg(l,h,g){dg(l,h),0<g.length&&(l.i=null,l.g.set(gs(l,h),k(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var I=h[g];const q=encodeURIComponent(String(I)),ie=this.V(I);for(I=0;I<ie.length;I++){var U=q;ie[I]!==""&&(U+="="+encodeURIComponent(String(ie[I]))),l.push(U)}}return this.i=l.join("&")};function gs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function jE(l,h){h&&!l.j&&(Hr(l),l.i=null,l.g.forEach(function(g,I){var U=I.toLowerCase();I!=U&&(dg(this,I),fg(this,U,g))},l)),l.j=h}function NE(l,h){const g=new Ie;if(u.Image){const I=new Image;I.onload=S(Kr,g,"TestLoadImage: loaded",!0,h,I),I.onerror=S(Kr,g,"TestLoadImage: error",!1,h,I),I.onabort=S(Kr,g,"TestLoadImage: abort",!1,h,I),I.ontimeout=S(Kr,g,"TestLoadImage: timeout",!1,h,I),u.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=l}else h(!1)}function DE(l,h){const g=new Ie,I=new AbortController,U=setTimeout(()=>{I.abort(),Kr(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:I.signal}).then(q=>{clearTimeout(U),q.ok?Kr(g,"TestPingServer: ok",!0,h):Kr(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(U),Kr(g,"TestPingServer: error",!1,h)})}function Kr(l,h,g,I,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),I(g)}catch{}}function OE(){this.g=new Br}function LE(l,h,g){const I=g||"";try{ag(l,function(U,q){let ie=U;d(U)&&(ie=Ye(U)),h.push(I+q+"="+encodeURIComponent(ie))})}catch(U){throw h.push(I+"type="+encodeURIComponent("_badmap")),U}}function ll(l){this.l=l.Ub||null,this.j=l.eb||!1}C(ll,Pi),ll.prototype.g=function(){return new ul(this.l,this.j)},ll.prototype.i=function(l){return function(){return l}}({});function ul(l,h){Ee.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(ul,Ee),t=ul.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Io(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,So(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Io(this)),this.g&&(this.readyState=3,Io(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pg(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function pg(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?So(this):Io(this),this.readyState==3&&pg(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,So(this))},t.Qa=function(l){this.g&&(this.response=l,So(this))},t.ga=function(){this.g&&So(this)};function So(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Io(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function Io(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ul.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function gg(l){let h="";return M(l,function(g,I){h+=I,h+=":",h+=g,h+=`\r
`}),h}function $c(l,h,g){e:{for(I in g){var I=!1;break e}I=!0}I||(g=gg(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):tt(l,h,g))}function ft(l){Ee.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(ft,Ee);var ME=/^https?$/i,VE=["POST","PUT"];t=ft.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,g,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():at.g(),this.v=this.o?zr(this.o):zr(at),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(q){mg(this,q);return}if(l=g||"",g=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var U in I)g.set(U,I[U]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const q of I.keys())g.set(q,I.get(q));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(g.keys()).find(q=>q.toLowerCase()=="content-type"),U=u.FormData&&l instanceof u.FormData,!(0<=Array.prototype.indexOf.call(VE,h,void 0))||I||U||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,ie]of g)this.g.setRequestHeader(q,ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_g(this),this.u=!0,this.g.send(l),this.u=!1}catch(q){mg(this,q)}};function mg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,yg(l),cl(l)}function yg(l){l.A||(l.A=!0,Ne(l,"complete"),Ne(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Ne(this,"complete"),Ne(this,"abort"),cl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cl(this,!0)),ft.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?vg(this):this.bb())},t.bb=function(){vg(this)};function vg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||gr(l)!=4||l.Z()!=2)){if(l.u&&gr(l)==4)kn(l.Ea,0,l);else if(Ne(l,"readystatechange"),gr(l)==4){l.h=!1;try{const ie=l.Z();e:switch(ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var I;if(I=ie===0){var U=String(l.D).match(lg)[1]||null;!U&&u.self&&u.self.location&&(U=u.self.location.protocol.slice(0,-1)),I=!ME.test(U?U.toLowerCase():"")}g=I}if(g)Ne(l,"complete"),Ne(l,"success");else{l.m=6;try{var q=2<gr(l)?l.g.statusText:""}catch{q=""}l.l=q+" ["+l.Z()+"]",yg(l)}}finally{cl(l)}}}}function cl(l,h){if(l.g){_g(l);const g=l.g,I=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Ne(l,"ready");try{g.onreadystatechange=I}catch{}}}function _g(l){l.I&&(u.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function gr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),ki(h)}};function xg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function FE(l){const h={};l=(l.g&&2<=gr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<l.length;I++){if(E(l[I]))continue;var g=R(l[I]);const U=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const q=h[U]||[];h[U]=q,q.push(g)}w(h,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function To(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function wg(l){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=To("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=To("baseRetryDelayMs",5e3,l),this.cb=To("retryDelaySeedMs",1e4,l),this.Wa=To("forwardChannelMaxRetries",2,l),this.wa=To("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new ng(l&&l.concurrentRequestLimit),this.Da=new OE,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=wg.prototype,t.la=8,t.G=1,t.connect=function(l,h,g,I){oe(0),this.W=l,this.H=h||{},g&&I!==void 0&&(this.H.OSID=g,this.H.OAID=I),this.F=this.X,this.I=kg(this,null,this.W),hl(this)};function Wc(l){if(Eg(l),l.G==3){var h=l.U++,g=pr(l.I);if(tt(g,"SID",l.K),tt(g,"RID",h),tt(g,"TYPE","terminate"),bo(l,g),h=new qr(l,l.j,h),h.L=2,h.v=al(pr(g)),g=!1,u.navigator&&u.navigator.sendBeacon)try{g=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&u.Image&&(new Image().src=h.v,g=!0),g||(h.g=Pg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),il(h)}Rg(l)}function dl(l){l.g&&(Hc(l),l.g.cancel(),l.g=null)}function Eg(l){dl(l),l.u&&(u.clearTimeout(l.u),l.u=null),fl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&u.clearTimeout(l.s),l.s=null)}function hl(l){if(!rg(l.h)&&!l.s){l.s=!0;var h=l.Ga;X||W(),L||(X(),L=!0),F.add(h,l),l.B=0}}function UE(l,h){return ig(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ae(_(l.Ga,l,h),Ag(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const U=new qr(this,this.j,l);let q=this.o;if(this.S&&(q?(q=f(q),x(q,this.S)):q=this.S),this.m!==null||this.O||(U.H=q,q=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var I=this.i[g];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(h+=I,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=Ig(this,U,h),g=pr(this.I),tt(g,"RID",l),tt(g,"CVER",22),this.D&&tt(g,"X-HTTP-Session-Id",this.D),bo(this,g),q&&(this.O?h="headers="+encodeURIComponent(String(gg(q)))+"&"+h:this.m&&$c(g,this.m,q)),zc(this.h,U),this.Ua&&tt(g,"TYPE","init"),this.P?(tt(g,"$req",h),tt(g,"SID","null"),U.T=!0,Vc(U,g,null)):Vc(U,g,h),this.G=2}}else this.G==3&&(l?Sg(this,l):this.i.length==0||rg(this.h)||Sg(this))};function Sg(l,h){var g;h?g=h.l:g=l.U++;const I=pr(l.I);tt(I,"SID",l.K),tt(I,"RID",g),tt(I,"AID",l.T),bo(l,I),l.m&&l.o&&$c(I,l.m,l.o),g=new qr(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Ig(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),zc(l.h,g),Vc(g,I,h)}function bo(l,h){l.H&&M(l.H,function(g,I){tt(h,I,g)}),l.l&&ag({},function(g,I){tt(h,I,g)})}function Ig(l,h,g){g=Math.min(l.i.length,g);var I=l.l?_(l.l.Na,l.l,l):null;e:{var U=l.i;let q=-1;for(;;){const ie=["count="+g];q==-1?0<g?(q=U[0].g,ie.push("ofs="+q)):q=0:ie.push("ofs="+q);let Je=!0;for(let Vt=0;Vt<g;Vt++){let $e=U[Vt].g;const Kt=U[Vt].map;if($e-=q,0>$e)q=Math.max(0,U[Vt].g-100),Je=!1;else try{LE(Kt,ie,"req"+$e+"_")}catch{I&&I(Kt)}}if(Je){I=ie.join("&");break e}}}return l=l.i.splice(0,g),h.D=l,I}function Tg(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;X||W(),L||(X(),L=!0),F.add(h,l),l.v=0}}function qc(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ae(_(l.Fa,l),Ag(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,bg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ae(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,oe(10),dl(this),bg(this))};function Hc(l){l.A!=null&&(u.clearTimeout(l.A),l.A=null)}function bg(l){l.g=new qr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=pr(l.qa);tt(h,"RID","rpc"),tt(h,"SID",l.K),tt(h,"AID",l.T),tt(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&tt(h,"TO",l.ja),tt(h,"TYPE","xmlhttp"),bo(l,h),l.m&&l.o&&$c(h,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=al(pr(h)),g.m=null,g.P=!0,Zp(g,l)}t.Za=function(){this.C!=null&&(this.C=null,dl(this),qc(this),oe(19))};function fl(l){l.C!=null&&(u.clearTimeout(l.C),l.C=null)}function Cg(l,h){var g=null;if(l.g==h){fl(l),Hc(l),l.g=null;var I=2}else if(Bc(l.h,h))g=h.D,sg(l.h,h),I=1;else return;if(l.G!=0){if(h.o)if(I==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var U=l.B;I=Y(),Ne(I,new pe(I,g)),hl(l)}else Tg(l);else if(U=h.s,U==3||U==0&&0<h.X||!(I==1&&UE(l,h)||I==2&&qc(l)))switch(g&&0<g.length&&(h=l.h,h.i=h.i.concat(g)),U){case 1:Di(l,5);break;case 4:Di(l,10);break;case 3:Di(l,6);break;default:Di(l,2)}}}function Ag(l,h){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*h}function Di(l,h){if(l.j.info("Error code "+h),h==2){var g=_(l.fb,l),I=l.Xa;const U=!I;I=new Ni(I||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||sl(I,"https"),al(I),U?NE(I.toString(),g):DE(I.toString(),g)}else oe(2);l.G=0,l.l&&l.l.sa(h),Rg(l),Eg(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),oe(2)):(this.j.info("Failed to ping google.com"),oe(1))};function Rg(l){if(l.G=0,l.ka=[],l.l){const h=og(l.h);(h.length!=0||l.i.length!=0)&&(D(l.ka,h),D(l.ka,l.i),l.h.i.length=0,k(l.i),l.i.length=0),l.l.ra()}}function kg(l,h,g){var I=g instanceof Ni?pr(g):new Ni(g);if(I.g!="")h&&(I.g=h+"."+I.g),ol(I,I.s);else{var U=u.location;I=U.protocol,h=h?h+"."+U.hostname:U.hostname,U=+U.port;var q=new Ni(null);I&&sl(q,I),h&&(q.g=h),U&&ol(q,U),g&&(q.l=g),I=q}return g=l.D,h=l.ya,g&&h&&tt(I,g,h),tt(I,"VER",l.la),bo(l,I),I}function Pg(l,h,g){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new ft(new ll({eb:g})):new ft(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jg(){}t=jg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function pl(){}pl.prototype.g=function(l,h){return new wn(l,h)};function wn(l,h){Ee.call(this),this.g=new wg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!E(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!E(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new ms(this)}C(wn,Ee),wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){Wc(this.g)},wn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=Ye(l),l=g);h.i.push(new SE(h.Ya++,l)),h.G==3&&hl(h)},wn.prototype.N=function(){this.g.l=null,delete this.j,Wc(this.g),delete this.g,wn.aa.N.call(this)};function Ng(l){$r.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}C(Ng,$r);function Dg(){Wr.call(this),this.status=1}C(Dg,Wr);function ms(l){this.g=l}C(ms,jg),ms.prototype.ua=function(){Ne(this.g,"a")},ms.prototype.ta=function(l){Ne(this.g,new Ng(l))},ms.prototype.sa=function(l){Ne(this.g,new Dg)},ms.prototype.ra=function(){Ne(this.g,"b")},pl.prototype.createWebChannel=pl.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,ox=function(){return new pl},sx=function(){return Y()},ix=jn,Mh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},fr.NO_ERROR=0,fr.TIMEOUT=8,fr.HTTP_ERROR=6,Jl=fr,me.COMPLETE="complete",rx=me,fs.EventType=Pn,Pn.OPEN="a",Pn.CLOSE="b",Pn.ERROR="c",Pn.MESSAGE="d",Ee.prototype.listen=Ee.prototype.K,zo=fs,ft.prototype.listenOnce=ft.prototype.L,ft.prototype.getLastError=ft.prototype.Ka,ft.prototype.getLastErrorCode=ft.prototype.Ba,ft.prototype.getStatus=ft.prototype.Z,ft.prototype.getResponseJson=ft.prototype.Oa,ft.prototype.getResponseText=ft.prototype.oa,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Ha,nx=ft}).apply(typeof Nl<"u"?Nl:typeof self<"u"?self:typeof window<"u"?window:{});const uy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji=new np("@firebase/firestore");function Oo(){return Ji.logLevel}function de(t,...e){if(Ji.logLevel<=Ve.DEBUG){const n=e.map(sp);Ji.debug(`Firestore (${mo}): ${t}`,...n)}}function Lr(t,...e){if(Ji.logLevel<=Ve.ERROR){const n=e.map(sp);Ji.error(`Firestore (${mo}): ${t}`,...n)}}function Xi(t,...e){if(Ji.logLevel<=Ve.WARN){const n=e.map(sp);Ji.warn(`Firestore (${mo}): ${t}`,...n)}}function sp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(t="Unexpected state"){const e=`FIRESTORE (${mo}) INTERNAL ASSERTION FAILED: `+t;throw Lr(e),new Error(e)}function Ke(t,e){t||Te()}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends Ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class Zb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class eC{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ke(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new Ar;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ar,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ar)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ke(typeof r.accessToken=="string"),new ax(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string"),new Xt(e)}}class tC{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class nC{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new tC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ke(this.o===void 0);const r=s=>{s.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,de("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ke(typeof n.token=="string"),this.R=n.token,new rC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=sC(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function We(t,e){return t<e?-1:t>e?1:0}function ro(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ue(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ue(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ue(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Tt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?We(this.nanoseconds,e.nanoseconds):We(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ce(e)}static min(){return new Ce(new Tt(0,0))}static max(){return new Ce(new Tt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,n,r){n===void 0?n=0:n>e.length&&Te(),r===void 0?r=e.length-n:r>e.length-n&&Te(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ca.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ca?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class rt extends Ca{construct(e,n,r){return new rt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new rt(n)}static emptyPath(){return new rt([])}}const oC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends Ca{construct(e,n,r){return new Dt(e,n,r)}static isValidIdentifier(e){return oC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Dt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ue(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new ue(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ue(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new ue(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dt(n)}static emptyPath(){return new Dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.path=e}static fromPath(e){return new ge(rt.fromString(e))}static fromName(e){return new ge(rt.fromString(e).popFirst(5))}static empty(){return new ge(rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return rt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new rt(e.slice()))}}function aC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ce.fromTimestamp(r===1e9?new Tt(n+1,0):new Tt(n,r));return new vi(i,ge.empty(),e)}function lC(t){return new vi(t.readTime,t.key,-1)}class vi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new vi(Ce.min(),ge.empty(),-1)}static max(){return new vi(Ce.max(),ge.empty(),-1)}}function uC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ge.comparator(t.documentKey,e.documentKey),n!==0?n:We(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function za(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==cC)throw t;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new J((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof J?n:J.resolve(n)}catch(n){return J.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):J.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):J.reject(n)}static resolve(e){return new J((n,r)=>{n(e)})}static reject(e){return new J((n,r)=>{r(e)})}static waitFor(e){return new J((n,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=J.resolve(!1);for(const r of e)n=n.next(i=>i?J.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new J((r,i)=>{const s=e.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const d=c;n(e[d]).next(p=>{o[d]=p,++u,u===s&&r(o)},p=>i(p))}})}static doWhile(e,n){return new J((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function hC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function $a(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ap.oe=-1;function fc(t){return t==null}function Nu(t){return t===0&&1/t==-1/0}function fC(t){return typeof t=="number"&&Number.isInteger(t)&&!Nu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function us(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ux(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||Ut.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dl(this.root,e,this.comparator,!0)}}class Dl{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ut{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ut.RED,this.left=i??Ut.EMPTY,this.right=s??Ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ut(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ut.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Te();const e=this.left.check();if(e!==this.right.check())throw Te();return e+(this.isRed()?0:1)}}Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1;Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw Te()}get value(){throw Te()}get color(){throw Te()}get left(){throw Te()}get right(){throw Te()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ut(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new dy(this.data.getIterator())}getIteratorFrom(e){return new dy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof zt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new zt(this.comparator);return n.data=e,n}}class dy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.fields=e,e.sort(Dt.comparator)}static empty(){return new In([])}unionWith(e){let n=new zt(Dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new In(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ro(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new cx("Invalid base64 string: "+s):s}}(e);return new Lt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Lt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return We(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lt.EMPTY_BYTE_STRING=new Lt("");const pC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _i(t){if(Ke(!!t),typeof t=="string"){let e=0;const n=pC.exec(t);if(Ke(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gt(t.seconds),nanos:gt(t.nanos)}}function gt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zi(t){return typeof t=="string"?Lt.fromBase64String(t):Lt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function up(t){const e=t.mapValue.fields.__previous_value__;return lp(e)?up(e):e}function Aa(t){const e=_i(t.mapValue.fields.__local_write_time__.timestampValue);return new Tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n,r,i,s,o,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}}class io{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new io("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof io&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol={mapValue:{}};function es(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lp(t)?4:yC(t)?9007199254740991:mC(t)?10:11:Te()}function cr(t,e){if(t===e)return!0;const n=es(t);if(n!==es(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Aa(t).isEqual(Aa(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=_i(i.timestampValue),u=_i(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Zi(i.bytesValue).isEqual(Zi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return gt(i.geoPointValue.latitude)===gt(s.geoPointValue.latitude)&&gt(i.geoPointValue.longitude)===gt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return gt(i.integerValue)===gt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=gt(i.doubleValue),u=gt(s.doubleValue);return o===u?Nu(o)===Nu(u):isNaN(o)&&isNaN(u)}return!1}(t,e);case 9:return ro(t.arrayValue.values||[],e.arrayValue.values||[],cr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(cy(o)!==cy(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!cr(o[c],u[c])))return!1;return!0}(t,e);default:return Te()}}function Ra(t,e){return(t.values||[]).find(n=>cr(n,e))!==void 0}function so(t,e){if(t===e)return 0;const n=es(t),r=es(e);if(n!==r)return We(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return We(t.booleanValue,e.booleanValue);case 2:return function(s,o){const u=gt(s.integerValue||s.doubleValue),c=gt(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return hy(t.timestampValue,e.timestampValue);case 4:return hy(Aa(t),Aa(e));case 5:return We(t.stringValue,e.stringValue);case 6:return function(s,o){const u=Zi(s),c=Zi(o);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let d=0;d<u.length&&d<c.length;d++){const p=We(u[d],c[d]);if(p!==0)return p}return We(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const u=We(gt(s.latitude),gt(o.latitude));return u!==0?u:We(gt(s.longitude),gt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return fy(t.arrayValue,e.arrayValue);case 10:return function(s,o){var u,c,d,p;const y=s.fields||{},_=o.fields||{},S=(u=y.value)===null||u===void 0?void 0:u.arrayValue,C=(c=_.value)===null||c===void 0?void 0:c.arrayValue,k=We(((d=S==null?void 0:S.values)===null||d===void 0?void 0:d.length)||0,((p=C==null?void 0:C.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:fy(S,C)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ol.mapValue&&o===Ol.mapValue)return 0;if(s===Ol.mapValue)return 1;if(o===Ol.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),d=o.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let y=0;y<c.length&&y<p.length;++y){const _=We(c[y],p[y]);if(_!==0)return _;const S=so(u[c[y]],d[p[y]]);if(S!==0)return S}return We(c.length,p.length)}(t.mapValue,e.mapValue);default:throw Te()}}function hy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return We(t,e);const n=_i(t),r=_i(e),i=We(n.seconds,r.seconds);return i!==0?i:We(n.nanos,r.nanos)}function fy(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=so(n[i],r[i]);if(s)return s}return We(n.length,r.length)}function oo(t){return Vh(t)}function Vh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=_i(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Zi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ge.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Vh(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Vh(n.fields[o])}`;return i+"}"}(t.mapValue):Te()}function py(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Fh(t){return!!t&&"integerValue"in t}function cp(t){return!!t&&"arrayValue"in t}function gy(t){return!!t&&"nullValue"in t}function my(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xl(t){return!!t&&"mapValue"in t}function mC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ta(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return us(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ta(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ta(t.arrayValue.values[n]);return e}return Object.assign({},t)}function yC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.value=e}static empty(){return new gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Xl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ta(n)}setAll(e){let n=Dt.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=ta(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Xl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return cr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Xl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){us(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new gn(ta(this.value))}}function dx(t){const e=[];return us(t.fields,(n,r)=>{const i=new Dt([n]);if(Xl(r)){const s=dx(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new In(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,n,r,i,s,o,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new en(e,0,Ce.min(),Ce.min(),Ce.min(),gn.empty(),0)}static newFoundDocument(e,n,r,i){return new en(e,1,n,Ce.min(),r,i,0)}static newNoDocument(e,n){return new en(e,2,n,Ce.min(),Ce.min(),gn.empty(),0)}static newUnknownDocument(e,n){return new en(e,3,n,Ce.min(),Ce.min(),gn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n){this.position=e,this.inclusive=n}}function yy(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ge.comparator(ge.fromName(o.referenceValue),n.key):r=so(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function vy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!cr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n="asc"){this.field=e,this.dir=n}}function vC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{}class Et extends hx{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new xC(e,n,r):n==="array-contains"?new SC(e,r):n==="in"?new IC(e,r):n==="not-in"?new TC(e,r):n==="array-contains-any"?new bC(e,r):new Et(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new wC(e,r):new EC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(so(n,this.value)):n!==null&&es(this.value)===es(n)&&this.matchesComparison(so(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yn extends hx{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Yn(e,n)}matches(e){return fx(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fx(t){return t.op==="and"}function px(t){return _C(t)&&fx(t)}function _C(t){for(const e of t.filters)if(e instanceof Yn)return!1;return!0}function Uh(t){if(t instanceof Et)return t.field.canonicalString()+t.op.toString()+oo(t.value);if(px(t))return t.filters.map(e=>Uh(e)).join(",");{const e=t.filters.map(n=>Uh(n)).join(",");return`${t.op}(${e})`}}function gx(t,e){return t instanceof Et?function(r,i){return i instanceof Et&&r.op===i.op&&r.field.isEqual(i.field)&&cr(r.value,i.value)}(t,e):t instanceof Yn?function(r,i){return i instanceof Yn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&gx(o,i.filters[u]),!0):!1}(t,e):void Te()}function mx(t){return t instanceof Et?function(n){return`${n.field.canonicalString()} ${n.op} ${oo(n.value)}`}(t):t instanceof Yn?function(n){return n.op.toString()+" {"+n.getFilters().map(mx).join(" ,")+"}"}(t):"Filter"}class xC extends Et{constructor(e,n,r){super(e,n,r),this.key=ge.fromName(r.referenceValue)}matches(e){const n=ge.comparator(e.key,this.key);return this.matchesComparison(n)}}class wC extends Et{constructor(e,n){super(e,"in",n),this.keys=yx("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class EC extends Et{constructor(e,n){super(e,"not-in",n),this.keys=yx("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function yx(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ge.fromName(r.referenceValue))}class SC extends Et{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return cp(n)&&Ra(n.arrayValue,this.value)}}class IC extends Et{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ra(this.value.arrayValue,n)}}class TC extends Et{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ra(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ra(this.value.arrayValue,n)}}class bC extends Et{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!cp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ra(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}}function _y(t,e=null,n=[],r=[],i=null,s=null,o=null){return new CC(t,e,n,r,i,s,o)}function dp(t){const e=Ae(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Uh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),fc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>oo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>oo(r)).join(",")),e.ue=n}return e.ue}function hp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!vC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!gx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vy(t.startAt,e.startAt)&&vy(t.endAt,e.endAt)}function Bh(t){return ge.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function AC(t,e,n,r,i,s,o,u){return new Wa(t,e,n,r,i,s,o,u)}function pc(t){return new Wa(t)}function xy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function vx(t){return t.collectionGroup!==null}function na(t){const e=Ae(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new zt(Dt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ou(s,r))}),n.has(Dt.keyField().canonicalString())||e.ce.push(new Ou(Dt.keyField(),r))}return e.ce}function or(t){const e=Ae(t);return e.le||(e.le=RC(e,na(t))),e.le}function RC(t,e){if(t.limitType==="F")return _y(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ou(i.field,s)});const n=t.endAt?new Du(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Du(t.startAt.position,t.startAt.inclusive):null;return _y(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function zh(t,e){const n=t.filters.concat([e]);return new Wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function $h(t,e,n){return new Wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gc(t,e){return hp(or(t),or(e))&&t.limitType===e.limitType}function _x(t){return`${dp(or(t))}|lt:${t.limitType}`}function ws(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>mx(i)).join(", ")}]`),fc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>oo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>oo(i)).join(",")),`Target(${r})`}(or(t))}; limitType=${t.limitType})`}function mc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ge.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of na(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,u,c){const d=yy(o,u,c);return o.inclusive?d<=0:d<0}(r.startAt,na(r),i)||r.endAt&&!function(o,u,c){const d=yy(o,u,c);return o.inclusive?d>=0:d>0}(r.endAt,na(r),i))}(t,e)}function kC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xx(t){return(e,n)=>{let r=!1;for(const i of na(t)){const s=PC(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function PC(t,e,n){const r=t.field.isKeyField()?ge.comparator(e.key,n.key):function(s,o,u){const c=o.data.field(s),d=u.data.field(s);return c!==null&&d!==null?so(c,d):Te()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Te()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){us(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return ux(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=new dt(ge.comparator);function Mr(){return jC}const wx=new dt(ge.comparator);function $o(...t){let e=wx;for(const n of t)e=e.insert(n.key,n);return e}function Ex(t){let e=wx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Bi(){return ra()}function Sx(){return ra()}function ra(){return new yo(t=>t.toString(),(t,e)=>t.isEqual(e))}const NC=new dt(ge.comparator),DC=new zt(ge.comparator);function Me(...t){let e=DC;for(const n of t)e=e.add(n);return e}const OC=new zt(We);function LC(){return OC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nu(e)?"-0":e}}function Ix(t){return{integerValue:""+t}}function MC(t,e){return fC(e)?Ix(e):fp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(){this._=void 0}}function VC(t,e,n){return t instanceof Lu?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&lp(s)&&(s=up(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ka?bx(t,e):t instanceof Pa?Cx(t,e):function(i,s){const o=Tx(i,s),u=wy(o)+wy(i.Pe);return Fh(o)&&Fh(i.Pe)?Ix(u):fp(i.serializer,u)}(t,e)}function FC(t,e,n){return t instanceof ka?bx(t,e):t instanceof Pa?Cx(t,e):n}function Tx(t,e){return t instanceof Mu?function(r){return Fh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Lu extends yc{}class ka extends yc{constructor(e){super(),this.elements=e}}function bx(t,e){const n=Ax(e);for(const r of t.elements)n.some(i=>cr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Pa extends yc{constructor(e){super(),this.elements=e}}function Cx(t,e){let n=Ax(e);for(const r of t.elements)n=n.filter(i=>!cr(i,r));return{arrayValue:{values:n}}}class Mu extends yc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function wy(t){return gt(t.integerValue||t.doubleValue)}function Ax(t){return cp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function UC(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ka&&i instanceof ka||r instanceof Pa&&i instanceof Pa?ro(r.elements,i.elements,cr):r instanceof Mu&&i instanceof Mu?cr(r.Pe,i.Pe):r instanceof Lu&&i instanceof Lu}(t.transform,e.transform)}class BC{constructor(e,n){this.version=e,this.transformResults=n}}class Mn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Mn}static exists(e){return new Mn(void 0,e)}static updateTime(e){return new Mn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vc{}function Rx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new pp(t.key,Mn.none()):new qa(t.key,t.data,Mn.none());{const n=t.data,r=gn.empty();let i=new zt(Dt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new bi(t.key,r,new In(i.toArray()),Mn.none())}}function zC(t,e,n){t instanceof qa?function(i,s,o){const u=i.value.clone(),c=Sy(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):t instanceof bi?function(i,s,o){if(!Zl(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=Sy(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(kx(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ia(t,e,n,r){return t instanceof qa?function(s,o,u,c){if(!Zl(s.precondition,o))return u;const d=s.value.clone(),p=Iy(s.fieldTransforms,c,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof bi?function(s,o,u,c){if(!Zl(s.precondition,o))return u;const d=Iy(s.fieldTransforms,c,o),p=o.data;return p.setAll(kx(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(s,o,u){return Zl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(t,e,n)}function $C(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Tx(r.transform,i||null);s!=null&&(n===null&&(n=gn.empty()),n.set(r.field,s))}return n||null}function Ey(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ro(r,i,(s,o)=>UC(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class qa extends vc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bi extends vc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function kx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Sy(t,e,n){const r=new Map;Ke(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,FC(o,u,n[i]))}return r}function Iy(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,VC(s,o,e))}return r}class pp extends vc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class WC extends vc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&zC(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ia(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ia(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Sx();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=Rx(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Me())}isEqual(e){return this.batchId===e.batchId&&ro(this.mutations,e.mutations,(n,r)=>Ey(n,r))&&ro(this.baseMutations,e.baseMutations,(n,r)=>Ey(n,r))}}class gp{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ke(e.mutations.length===r.length);let i=function(){return NC}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new gp(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t,Ue;function GC(t){switch(t){default:return Te();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function Px(t){if(t===void 0)return Lr("GRPC error has no .code"),K.UNKNOWN;switch(t){case _t.OK:return K.OK;case _t.CANCELLED:return K.CANCELLED;case _t.UNKNOWN:return K.UNKNOWN;case _t.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case _t.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case _t.INTERNAL:return K.INTERNAL;case _t.UNAVAILABLE:return K.UNAVAILABLE;case _t.UNAUTHENTICATED:return K.UNAUTHENTICATED;case _t.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case _t.NOT_FOUND:return K.NOT_FOUND;case _t.ALREADY_EXISTS:return K.ALREADY_EXISTS;case _t.PERMISSION_DENIED:return K.PERMISSION_DENIED;case _t.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case _t.ABORTED:return K.ABORTED;case _t.OUT_OF_RANGE:return K.OUT_OF_RANGE;case _t.UNIMPLEMENTED:return K.UNIMPLEMENTED;case _t.DATA_LOSS:return K.DATA_LOSS;default:return Te()}}(Ue=_t||(_t={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new Wi([4294967295,4294967295],0);function Ty(t){const e=QC().encode(t),n=new tx;return n.update(e),new Uint8Array(n.digest())}function by(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wi([n,r],0),new Wi([i,s],0)]}class mp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Wo(`Invalid padding: ${n}`);if(r<0)throw new Wo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Wo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Wi.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Wi.fromNumber(r)));return i.compare(YC)===1&&(i=new Wi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ty(e),[r,i]=by(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new mp(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;const n=Ty(e),[r,i]=by(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Wo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Ha.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new _c(Ce.min(),i,new dt(We),Mr(),Me())}}class Ha{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ha(r,n,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class jx{constructor(e,n){this.targetId=e,this.me=n}}class Nx{constructor(e,n,r=Lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Cy{constructor(){this.fe=0,this.ge=Ry(),this.pe=Lt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Me(),n=Me(),r=Me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Te()}}),new Ha(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Ry()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ke(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class JC{constructor(e){this.Le=e,this.Be=new Map,this.ke=Mr(),this.qe=Ay(),this.Qe=new dt(We)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Te()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Bh(s))if(r===0){const o=new ge(s.path);this.Ue(n,o,en.newNoDocument(o,Ce.min()))}else Ke(r===1);else{const o=this.Ye(n);if(o!==r){const u=this.Ze(e),c=u?this.Xe(u,e,o):1;if(c!==0){this.je(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=Zi(r).toUint8Array()}catch(c){if(c instanceof cx)return Xi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new mp(o,i,s)}catch(c){return Xi(c instanceof Wo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const u=this.Je(o);if(u){if(s.current&&Bh(u.target)){const c=new ge(u.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,en.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Me();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new _c(e,n,this.Qe,this.ke,r);return this.ke=Mr(),this.qe=Ay(),this.Qe=new dt(We),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Cy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new zt(We),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||de("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Cy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Ay(){return new dt(ge.comparator)}function Ry(){return new dt(ge.comparator)}const XC={asc:"ASCENDING",desc:"DESCENDING"},ZC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eA={and:"AND",or:"OR"};class tA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wh(t,e){return t.useProto3Json||fc(e)?e:{value:e}}function Vu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function nA(t,e){return Vu(t,e.toTimestamp())}function ar(t){return Ke(!!t),Ce.fromTimestamp(function(n){const r=_i(n);return new Tt(r.seconds,r.nanos)}(t))}function yp(t,e){return qh(t,e).canonicalString()}function qh(t,e){const n=function(i){return new rt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Ox(t){const e=rt.fromString(t);return Ke(Ux(e)),e}function Hh(t,e){return yp(t.databaseId,e.path)}function bd(t,e){const n=Ox(e);if(n.get(1)!==t.databaseId.projectId)throw new ue(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ue(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ge(Mx(n))}function Lx(t,e){return yp(t.databaseId,e)}function rA(t){const e=Ox(t);return e.length===4?rt.emptyPath():Mx(e)}function Kh(t){return new rt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Mx(t){return Ke(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ky(t,e,n){return{name:Hh(t,e),fields:n.value.mapValue.fields}}function iA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Te()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Ke(p===void 0||typeof p=="string"),Lt.fromBase64String(p||"")):(Ke(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Lt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(d){const p=d.code===void 0?K.UNKNOWN:Px(d.code);return new ue(p,d.message||"")}(o);n=new Nx(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=bd(t,r.document.name),s=ar(r.document.updateTime),o=r.document.createTime?ar(r.document.createTime):Ce.min(),u=new gn({mapValue:{fields:r.document.fields}}),c=en.newFoundDocument(i,s,o,u),d=r.targetIds||[],p=r.removedTargetIds||[];n=new eu(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=bd(t,r.document),s=r.readTime?ar(r.readTime):Ce.min(),o=en.newNoDocument(i,s),u=r.removedTargetIds||[];n=new eu([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=bd(t,r.document),s=r.removedTargetIds||[];n=new eu([],s,i,null)}else{if(!("filter"in e))return Te();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new KC(i,s),u=r.targetId;n=new jx(u,o)}}return n}function sA(t,e){let n;if(e instanceof qa)n={update:ky(t,e.key,e.value)};else if(e instanceof pp)n={delete:Hh(t,e.key)};else if(e instanceof bi)n={update:ky(t,e.key,e.data),updateMask:pA(e.fieldMask)};else{if(!(e instanceof WC))return Te();n={verify:Hh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Lu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ka)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Pa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Mu)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw Te()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:nA(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Te()}(t,e.precondition)),n}function oA(t,e){return t&&t.length>0?(Ke(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ar(i.updateTime):ar(s);return o.isEqual(Ce.min())&&(o=ar(s)),new BC(o,i.transformResults||[])}(n,e))):[]}function aA(t,e){return{documents:[Lx(t,e.path)]}}function lA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Lx(t,i);const s=function(d){if(d.length!==0)return Fx(Yn.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(p=>function(_){return{field:Es(_.field),direction:dA(_.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const u=Wh(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:i}}function uA(t){let e=rA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ke(r===1);const p=n.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(y){const _=Vx(y);return _ instanceof Yn&&px(_)?_.getFilters():[_]}(n.where));let o=[];n.orderBy&&(o=function(y){return y.map(_=>function(C){return new Ou(Ss(C.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(_))}(n.orderBy));let u=null;n.limit&&(u=function(y){let _;return _=typeof y=="object"?y.value:y,fc(_)?null:_}(n.limit));let c=null;n.startAt&&(c=function(y){const _=!!y.before,S=y.values||[];return new Du(S,_)}(n.startAt));let d=null;return n.endAt&&(d=function(y){const _=!y.before,S=y.values||[];return new Du(S,_)}(n.endAt)),AC(e,i,o,s,u,"F",c,d)}function cA(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Vx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ss(n.unaryFilter.field);return Et.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ss(n.unaryFilter.field);return Et.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ss(n.unaryFilter.field);return Et.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ss(n.unaryFilter.field);return Et.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Te()}}(t):t.fieldFilter!==void 0?function(n){return Et.create(Ss(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Te()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Yn.create(n.compositeFilter.filters.map(r=>Vx(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Te()}}(n.compositeFilter.op))}(t):Te()}function dA(t){return XC[t]}function hA(t){return ZC[t]}function fA(t){return eA[t]}function Es(t){return{fieldPath:t.canonicalString()}}function Ss(t){return Dt.fromServerFormat(t.fieldPath)}function Fx(t){return t instanceof Et?function(n){if(n.op==="=="){if(my(n.value))return{unaryFilter:{field:Es(n.field),op:"IS_NAN"}};if(gy(n.value))return{unaryFilter:{field:Es(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(my(n.value))return{unaryFilter:{field:Es(n.field),op:"IS_NOT_NAN"}};if(gy(n.value))return{unaryFilter:{field:Es(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Es(n.field),op:hA(n.op),value:n.value}}}(t):t instanceof Yn?function(n){const r=n.getFilters().map(i=>Fx(i));return r.length===1?r[0]:{compositeFilter:{op:fA(n.op),filters:r}}}(t):Te()}function pA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ux(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,n,r,i,s=Ce.min(),o=Ce.min(),u=Lt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e){this.ct=e}}function mA(t){const e=uA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?$h(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this.un=new vA}addToCollectionParentIndex(e,n){return this.un.add(n),J.resolve()}getCollectionParents(e,n){return J.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return J.resolve()}deleteFieldIndex(e,n){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,n){return J.resolve()}getDocumentsMatchingTarget(e,n){return J.resolve(null)}getIndexType(e,n){return J.resolve(0)}getFieldIndexes(e,n){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,n){return J.resolve(vi.min())}getMinOffsetFromCollectionGroup(e,n){return J.resolve(vi.min())}updateCollectionGroup(e,n,r){return J.resolve()}updateIndexEntries(e,n){return J.resolve()}}class vA{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new zt(rt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new zt(rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ao(0)}static kn(){return new ao(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(){this.changes=new yo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?J.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&ia(r.mutation,i,In.empty(),Tt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Me()){const i=Bi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=$o();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Bi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Me()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(e,n,r,i){let s=Mr();const o=ra(),u=function(){return ra()}();return n.forEach((c,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof bi)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),ia(p.mutation,d,p.mutation.getFieldMask(),Tt.now())):o.set(d.key,In.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>o.set(d,p)),n.forEach((d,p)=>{var y;return u.set(d,new xA(p,(y=o.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,n){const r=ra();let i=new dt((o,u)=>o-u),s=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let p=r.get(c)||In.empty();p=u.applyToLocalView(d,p),r.set(c,p);const y=(i.get(u.batchId)||Me()).add(c);i=i.insert(u.batchId,y)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),d=c.key,p=c.value,y=Sx();p.forEach(_=>{if(!s.has(_)){const S=Rx(n.get(_),r.get(_));S!==null&&y.set(_,S),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,y))}return J.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ge.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):vx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):J.resolve(Bi());let u=-1,c=s;return o.next(d=>J.forEach(d,(p,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),s.get(p)?J.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{c=c.insert(p,_)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,Me())).next(p=>({batchId:u,changes:Ex(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ge(n)).next(r=>{let i=$o();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=$o();return this.indexManager.getCollectionParents(e,s).next(u=>J.forEach(u,c=>{const d=function(y,_){return new Wa(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((y,_)=>{o=o.insert(y,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,en.newInvalidDocument(p)))});let u=$o();return o.forEach((c,d)=>{const p=s.get(c);p!==void 0&&ia(p.mutation,d,In.empty(),Tt.now()),mc(n,d)&&(u=u.insert(c,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return J.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ar(i.createTime)}}(n)),J.resolve()}getNamedQuery(e,n){return J.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:mA(i.bundledQuery),readTime:ar(i.readTime)}}(n)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.overlays=new dt(ge.comparator),this.Ir=new Map}getOverlay(e,n){return J.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Bi();return J.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),J.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),J.resolve()}getOverlaysForCollection(e,n,r){const i=Bi(),s=n.length+1,o=new ge(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return J.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new dt((d,p)=>d-p);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Bi(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=Bi(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return J.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new HC(n,r));let s=this.Ir.get(n);s===void 0&&(s=Me(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(){this.sessionToken=Lt.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(){this.Tr=new zt(jt.Er),this.dr=new zt(jt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new jt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new jt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ge(new rt([])),r=new jt(n,e),i=new jt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ge(new rt([])),r=new jt(n,e),i=new jt(n,e+1);let s=Me();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new jt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class jt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ge.comparator(e.key,n.key)||We(e.wr,n.wr)}static Ar(e,n){return We(e.wr,n.wr)||ge.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new zt(jt.Er)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qC(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.br=this.br.add(new jt(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,n){return J.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return J.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new jt(n,0),i=new jt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const u=this.Dr(o.wr);s.push(u)}),J.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new zt(We);return n.forEach(i=>{const s=new jt(i,0),o=new jt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],u=>{r=r.add(u.wr)})}),J.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ge.isDocumentKey(s)||(s=s.child(""));const o=new jt(new ge(s),0);let u=new zt(We);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},o),J.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ke(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return J.forEach(n.mutations,i=>{const s=new jt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new jt(n,0),i=this.br.firstAfterOrEqual(r);return J.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e){this.Mr=e,this.docs=function(){return new dt(ge.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return J.resolve(r?r.document.mutableCopy():en.newInvalidDocument(n))}getEntries(e,n){let r=Mr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():en.newInvalidDocument(i))}),J.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Mr();const o=n.path,u=new ge(o.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:d,value:{document:p}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||uC(lC(p),r)<=0||(i.has(p.key)||mc(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return J.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Te()}Or(e,n){return J.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new CA(this)}getSize(e){return J.resolve(this.size)}}class CA extends _A{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),J.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.persistence=e,this.Nr=new yo(n=>dp(n),hp),this.lastRemoteSnapshotVersion=Ce.min(),this.highestTargetId=0,this.Lr=0,this.Br=new vp,this.targetCount=0,this.kr=ao.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),J.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ao(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,J.resolve()}updateTargetData(e,n){return this.Kn(n),J.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),J.waitFor(s).next(()=>i)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return J.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),J.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),J.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),J.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return J.resolve(r)}containsKey(e,n){return J.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,n){this.qr={},this.overlays={},this.Qr=new ap(0),this.Kr=!1,this.Kr=!0,this.$r=new IA,this.referenceDelegate=e(this),this.Ur=new AA(this),this.indexManager=new yA,this.remoteDocumentCache=function(i){return new bA(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new gA(n),this.Gr=new EA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new SA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new TA(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){de("MemoryPersistence","Starting transaction:",e);const i=new kA(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return J.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class kA extends dC{constructor(e){super(),this.currentSequenceNumber=e}}class _p{constructor(e){this.persistence=e,this.Jr=new vp,this.Yr=null}static Zr(e){return new _p(e)}get Xr(){if(this.Yr)return this.Yr;throw Te()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),J.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),J.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.Xr,r=>{const i=ge.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ce.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return J.or([()=>J.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Me(),i=Me();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new xp(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return DT()?8:hC(nn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new PA;return this.Xi(e,n,o).next(u=>{if(s.result=u,this.zi)return this.es(e,n,o,u.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Oo()<=Ve.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",ws(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),J.resolve()):(Oo()<=Ve.DEBUG&&de("QueryEngine","Query:",ws(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Oo()<=Ve.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",ws(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,or(n))):J.resolve())}Yi(e,n){if(xy(n))return J.resolve(null);let r=or(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=$h(n,null,"F"),r=or(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Me(...s);return this.Ji.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(n,u);return this.ns(n,d,o,c.readTime)?this.Yi(e,$h(n,null,"F")):this.rs(e,d,n,c)}))})))}Zi(e,n,r,i){return xy(n)||i.isEqual(Ce.min())?J.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?J.resolve(null):(Oo()<=Ve.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ws(n)),this.rs(e,o,n,aC(i,-1)).next(u=>u))})}ts(e,n){let r=new zt(xx(e));return n.forEach((i,s)=>{mc(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Oo()<=Ve.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",ws(n)),this.Ji.getDocumentsMatchingQuery(e,n,vi.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new dt(We),this._s=new yo(s=>dp(s),hp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function DA(t,e,n,r){return new NA(t,e,n,r)}async function Bx(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=Me();for(const d of i){o.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}for(const d of s){u.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:u}))})})}function OA(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,p){const y=d.batch,_=y.keys();let S=J.resolve();return _.forEach(C=>{S=S.next(()=>p.getEntry(c,C)).next(k=>{const D=d.docVersions.get(C);Ke(D!==null),k.version.compareTo(D)<0&&(y.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),p.addEntry(k)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(c,y))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=Me();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function zx(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function LA(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((p,y)=>{const _=i.get(y);if(!_)return;u.push(n.Ur.removeMatchingKeys(s,p.removedDocuments,y).next(()=>n.Ur.addMatchingKeys(s,p.addedDocuments,y)));let S=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(Lt.EMPTY_BYTE_STRING,Ce.min()).withLastLimboFreeSnapshotVersion(Ce.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(y,S),function(k,D,b){return k.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(_,S,p)&&u.push(n.Ur.updateTargetData(s,S))});let c=Mr(),d=Me();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(MA(s,o,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(Ce.min())){const p=n.Ur.getLastRemoteSnapshotVersion(s).next(y=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return J.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(n.os=i,s))}function MA(t,e,n){let r=Me(),i=Me();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Mr();return n.forEach((u,c)=>{const d=s.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Ce.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):de("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function VA(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function FA(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,J.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new ri(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Gh(t,e,n){const r=Ae(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!$a(o))throw o;de("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Py(t,e,n){const r=Ae(t);let i=Ce.min(),s=Me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,p){const y=Ae(c),_=y._s.get(p);return _!==void 0?J.resolve(y.os.get(_)):y.Ur.getTargetData(d,p)}(r,o,or(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:Ce.min(),n?s:Me())).next(u=>(UA(r,kC(e),u),{documents:u,Ts:s})))}function UA(t,e,n){let r=t.us.get(e)||Ce.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class jy{constructor(){this.activeTargetIds=LC()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BA{constructor(){this.so=new jy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new jy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){de("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){de("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ll=null;function Cd(){return Ll===null?Ll=function(){return 268435456+Math.round(2147483648*Math.random())}():Ll++,"0x"+Ll.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class qA extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const u=Cd(),c=this.xo(n,r.toUriEncodedString());de("RestConnection",`Sending RPC '${n}' ${u}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,o),this.No(n,c,d,i).then(p=>(de("RestConnection",`Received RPC '${n}' ${u}: `,p),p),p=>{throw Xi("RestConnection",`RPC '${n}' ${u} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(n,r,i,s,o,u){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=$A[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Cd();return new Promise((o,u)=>{const c=new nx;c.setWithCredentials(!0),c.listenOnce(rx.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Jl.NO_ERROR:const p=c.getResponseJson();de(Jt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case Jl.TIMEOUT:de(Jt,`RPC '${e}' ${s} timed out`),u(new ue(K.DEADLINE_EXCEEDED,"Request time out"));break;case Jl.HTTP_ERROR:const y=c.getStatus();if(de(Jt,`RPC '${e}' ${s} failed with status:`,y,"response text:",c.getResponseText()),y>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const S=_==null?void 0:_.error;if(S&&S.status&&S.message){const C=function(D){const b=D.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(b)>=0?b:K.UNKNOWN}(S.status);u(new ue(C,S.message))}else u(new ue(K.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new ue(K.UNAVAILABLE,"Connection failed."));break;default:Te()}}finally{de(Jt,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);de(Jt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",d,r,15)})}Bo(e,n,r){const i=Cd(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ox(),u=sx(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=s.join("");de(Jt,`Creating RPC '${e}' stream ${i}: ${p}`,c);const y=o.createWebChannel(p,c);let _=!1,S=!1;const C=new WA({Io:D=>{S?de(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(_||(de(Jt,`Opening RPC '${e}' stream ${i} transport.`),y.open(),_=!0),de(Jt,`RPC '${e}' stream ${i} sending:`,D),y.send(D))},To:()=>y.close()}),k=(D,b,E)=>{D.listen(b,T=>{try{E(T)}catch(V){setTimeout(()=>{throw V},0)}})};return k(y,zo.EventType.OPEN,()=>{S||(de(Jt,`RPC '${e}' stream ${i} transport opened.`),C.yo())}),k(y,zo.EventType.CLOSE,()=>{S||(S=!0,de(Jt,`RPC '${e}' stream ${i} transport closed`),C.So())}),k(y,zo.EventType.ERROR,D=>{S||(S=!0,Xi(Jt,`RPC '${e}' stream ${i} transport errored:`,D),C.So(new ue(K.UNAVAILABLE,"The operation could not be completed")))}),k(y,zo.EventType.MESSAGE,D=>{var b;if(!S){const E=D.data[0];Ke(!!E);const T=E,V=T.error||((b=T[0])===null||b===void 0?void 0:b.error);if(V){de(Jt,`RPC '${e}' stream ${i} received error:`,V);const N=V.status;let M=function(m){const x=_t[m];if(x!==void 0)return Px(x)}(N),w=V.message;M===void 0&&(M=K.INTERNAL,w="Unknown error status: "+N+" with message "+V.message),S=!0,C.So(new ue(M,w)),y.close()}else de(Jt,`RPC '${e}' stream ${i} received:`,E),C.bo(E)}}),k(u,ix.STAT_EVENT,D=>{D.stat===Mh.PROXY?de(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Mh.NOPROXY&&de(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}function Ad(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){return new tA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&de("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,r,i,s,o,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new $x(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ue(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return de("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(de("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class HA extends Wx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=iA(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ce.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ce.min():o.readTime?ar(o.readTime):Ce.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Kh(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=Bh(c)?{documents:aA(s,c)}:{query:lA(s,c)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=Dx(s,o.resumeToken);const d=Wh(s,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ce.min())>0){u.readTime=Vu(s,o.snapshotVersion.toTimestamp());const d=Wh(s,o.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const r=cA(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Kh(this.serializer),n.removeTarget=e,this.a_(n)}}class KA extends Wx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ke(!!e.streamToken),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=oA(e.writeResults,e.commitTime),r=ar(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Kh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>sA(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ue(K.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,qh(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(K.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Lo(e,qh(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(K.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class QA{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Lr(n),this.D_=!1):de("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{cs(this)&&(de("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=Ae(c);d.L_.add(4),await Ka(d),d.q_.set("Unknown"),d.L_.delete(4),await wc(d)}(this))})}),this.q_=new QA(r,i)}}async function wc(t){if(cs(t))for(const e of t.B_)await e(!0)}async function Ka(t){for(const e of t.B_)await e(!1)}function qx(t,e){const n=Ae(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ip(n)?Sp(n):vo(n).r_()&&Ep(n,e))}function wp(t,e){const n=Ae(t),r=vo(n);n.N_.delete(e),r.r_()&&Hx(n,e),n.N_.size===0&&(r.r_()?r.o_():cs(n)&&n.q_.set("Unknown"))}function Ep(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}vo(t).A_(e)}function Hx(t,e){t.Q_.xe(e),vo(t).R_(e)}function Sp(t){t.Q_=new JC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),vo(t).start(),t.q_.v_()}function Ip(t){return cs(t)&&!vo(t).n_()&&t.N_.size>0}function cs(t){return Ae(t).L_.size===0}function Kx(t){t.Q_=void 0}async function JA(t){t.q_.set("Online")}async function XA(t){t.N_.forEach((e,n)=>{Ep(t,e)})}async function ZA(t,e){Kx(t),Ip(t)?(t.q_.M_(e),Sp(t)):t.q_.set("Unknown")}async function eR(t,e,n){if(t.q_.set("Online"),e instanceof Nx&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){de("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Fu(t,r)}else if(e instanceof eu?t.Q_.Ke(e):e instanceof jx?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ce.min()))try{const r=await zx(t.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Q_.rt(o);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,d)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Lt.EMPTY_BYTE_STRING,p.snapshotVersion)),Hx(s,c);const y=new ri(p.target,c,d,p.sequenceNumber);Ep(s,y)}),s.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){de("RemoteStore","Failed to raise snapshot:",r),await Fu(t,r)}}async function Fu(t,e,n){if(!$a(e))throw e;t.L_.add(1),await Ka(t),t.q_.set("Offline"),n||(n=()=>zx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{de("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await wc(t)})}function Gx(t,e){return e().catch(n=>Fu(t,n,e))}async function Ec(t){const e=Ae(t),n=xi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;tR(e);)try{const i=await VA(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,nR(e,i)}catch(i){await Fu(e,i)}Qx(e)&&Yx(e)}function tR(t){return cs(t)&&t.O_.length<10}function nR(t,e){t.O_.push(e);const n=xi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Qx(t){return cs(t)&&!xi(t).n_()&&t.O_.length>0}function Yx(t){xi(t).start()}async function rR(t){xi(t).p_()}async function iR(t){const e=xi(t);for(const n of t.O_)e.m_(n.mutations)}async function sR(t,e,n){const r=t.O_.shift(),i=gp.from(r,e,n);await Gx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ec(t)}async function oR(t,e){e&&xi(t).V_&&await async function(r,i){if(function(o){return GC(o)&&o!==K.ABORTED}(i.code)){const s=r.O_.shift();xi(r).s_(),await Gx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ec(r)}}(t,e),Qx(t)&&Yx(t)}async function Dy(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),de("RemoteStore","RemoteStore received new credentials");const r=cs(n);n.L_.add(3),await Ka(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await wc(n)}async function aR(t,e){const n=Ae(t);e?(n.L_.delete(2),await wc(n)):e||(n.L_.add(2),await Ka(n),n.q_.set("Unknown"))}function vo(t){return t.K_||(t.K_=function(n,r,i){const s=Ae(n);return s.w_(),new HA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:JA.bind(null,t),Ro:XA.bind(null,t),mo:ZA.bind(null,t),d_:eR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ip(t)?Sp(t):t.q_.set("Unknown")):(await t.K_.stop(),Kx(t))})),t.K_}function xi(t){return t.U_||(t.U_=function(n,r,i){const s=Ae(n);return s.w_(),new KA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:rR.bind(null,t),mo:oR.bind(null,t),f_:iR.bind(null,t),g_:sR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Ec(t)):(await t.U_.stop(),t.O_.length>0&&(de("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,u=new Tp(e,n,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bp(t,e){if(Lr("AsyncQueue",`${e}: ${t}`),$a(t))return new ue(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ge.comparator(n.key,r.key):(n,r)=>ge.comparator(n.key,r.key),this.keyedMap=$o(),this.sortedSet=new dt(this.comparator)}static emptySet(e){return new Ws(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ws)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ws;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(){this.W_=new dt(ge.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Te():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class lo{constructor(e,n,r,i,s,o,u,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new lo(e,n,Ws.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class uR{constructor(){this.queries=Ly(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=Ly(),s.forEach((o,u)=>{for(const c of u.j_)c.onError(r)})})(this,new ue(K.ABORTED,"Firestore shutting down"))}}function Ly(){return new yo(t=>_x(t),gc)}async function Cp(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new lR,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=bp(o,`Initialization of query '${ws(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Rp(n)}async function Ap(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function cR(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.j_)u.X_(i)&&(r=!0);o.z_=i}}r&&Rp(n)}function dR(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Rp(t){t.Y_.forEach(e=>{e.next()})}var Qh,My;(My=Qh||(Qh={})).ea="default",My.Cache="cache";class kp{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new lo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Qh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(e){this.key=e}}class Xx{constructor(e){this.key=e}}class hR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Me(),this.mutatedKeys=Me(),this.Aa=xx(e),this.Ra=new Ws(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Oy,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,y)=>{const _=i.get(p),S=mc(this.query,y)?y:null,C=!!_&&this.mutatedKeys.has(_.key),k=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let D=!1;_&&S?_.data.isEqual(S.data)?C!==k&&(r.track({type:3,doc:S}),D=!0):this.ga(_,S)||(r.track({type:2,doc:S}),D=!0,(c&&this.Aa(S,c)>0||d&&this.Aa(S,d)<0)&&(u=!0)):!_&&S?(r.track({type:0,doc:S}),D=!0):_&&!S&&(r.track({type:1,doc:_}),D=!0,(c||d)&&(u=!0)),D&&(S?(o=o.add(S),s=k?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:u,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,y)=>function(S,C){const k=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te()}};return k(S)-k(C)}(p.type,y.type)||this.Aa(p.doc,y.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new lo(this.query,e.Ra,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Oy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Xx(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Jx(r))}),n}ba(e){this.Ta=e.Ts,this.da=Me();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return lo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class fR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class pR{constructor(e){this.key=e,this.va=!1}}class gR{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new yo(u=>_x(u),gc),this.Ma=new Map,this.xa=new Set,this.Oa=new dt(ge.comparator),this.Na=new Map,this.La=new vp,this.Ba={},this.ka=new Map,this.qa=ao.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function mR(t,e,n=!0){const r=iw(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Zx(r,e,n,!0),i}async function yR(t,e){const n=iw(t);await Zx(n,e,!0,!1)}async function Zx(t,e,n,r){const i=await FA(t.localStore,or(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await vR(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&qx(t.remoteStore,i),u}async function vR(t,e,n,r,i){t.Ka=(y,_,S)=>async function(k,D,b,E){let T=D.view.ma(b);T.ns&&(T=await Py(k.localStore,D.query,!1).then(({documents:w})=>D.view.ma(w,T)));const V=E&&E.targetChanges.get(D.targetId),N=E&&E.targetMismatches.get(D.targetId)!=null,M=D.view.applyChanges(T,k.isPrimaryClient,V,N);return Fy(k,D.targetId,M.wa),M.snapshot}(t,y,_,S);const s=await Py(t.localStore,e,!0),o=new hR(e,s.Ts),u=o.ma(s.documents),c=Ha.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(u,t.isPrimaryClient,c);Fy(t,n,d.wa);const p=new fR(e,n,o);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function _R(t,e,n){const r=Ae(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!gc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Gh(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&wp(r.remoteStore,i.targetId),Yh(r,i.targetId)}).catch(za)):(Yh(r,i.targetId),await Gh(r.localStore,i.targetId,!0))}async function xR(t,e){const n=Ae(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),wp(n.remoteStore,r.targetId))}async function wR(t,e,n){const r=AR(t);try{const i=await function(o,u){const c=Ae(o),d=Tt.now(),p=u.reduce((S,C)=>S.add(C.key),Me());let y,_;return c.persistence.runTransaction("Locally write mutations","readwrite",S=>{let C=Mr(),k=Me();return c.cs.getEntries(S,p).next(D=>{C=D,C.forEach((b,E)=>{E.isValidDocument()||(k=k.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(S,C)).next(D=>{y=D;const b=[];for(const E of u){const T=$C(E,y.get(E.key).overlayedDocument);T!=null&&b.push(new bi(E.key,T,dx(T.value.mapValue),Mn.exists(!0)))}return c.mutationQueue.addMutationBatch(S,d,b,u)}).next(D=>{_=D;const b=D.applyToLocalDocumentSet(y,k);return c.documentOverlayCache.saveOverlays(S,D.batchId,b)})}).then(()=>({batchId:_.batchId,changes:Ex(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new dt(We)),d=d.insert(u,c),o.Ba[o.currentUser.toKey()]=d}(r,i.batchId,n),await Ga(r,i.changes),await Ec(r.remoteStore)}catch(i){const s=bp(i,"Failed to persist write");n.reject(s)}}async function ew(t,e){const n=Ae(t);try{const r=await LA(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(Ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ke(o.va):i.removedDocuments.size>0&&(Ke(o.va),o.va=!1))}),await Ga(n,r,e)}catch(r){await za(r)}}function Vy(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const u=o.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=Ae(o);c.onlineState=u;let d=!1;c.queries.forEach((p,y)=>{for(const _ of y.j_)_.Z_(u)&&(d=!0)}),d&&Rp(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ER(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new dt(ge.comparator);o=o.insert(s,en.newNoDocument(s,Ce.min()));const u=Me().add(s),c=new _c(Ce.min(),new Map,new dt(We),o,u);await ew(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Pp(r)}else await Gh(r.localStore,e,!1).then(()=>Yh(r,e,n)).catch(za)}async function SR(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await OA(n.localStore,e);nw(n,r,null),tw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ga(n,i)}catch(i){await za(i)}}async function IR(t,e,n){const r=Ae(t);try{const i=await function(o,u){const c=Ae(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,u).next(y=>(Ke(y!==null),p=y.keys(),c.mutationQueue.removeMutationBatch(d,y))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);nw(r,e,n),tw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ga(r,i)}catch(i){await za(i)}}function tw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function nw(t,e,n){const r=Ae(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Yh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||rw(t,r)})}function rw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(wp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Pp(t))}function Fy(t,e,n){for(const r of n)r instanceof Jx?(t.La.addReference(r.key,e),TR(t,r)):r instanceof Xx?(de("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||rw(t,r.key)):Te()}function TR(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(de("SyncEngine","New document in limbo: "+n),t.xa.add(r),Pp(t))}function Pp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ge(rt.fromString(e)),r=t.qa.next();t.Na.set(r,new pR(n)),t.Oa=t.Oa.insert(n,r),qx(t.remoteStore,new ri(or(pc(n.path)),r,"TargetPurposeLimboResolution",ap.oe))}}async function Ga(t,e,n){const r=Ae(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{o.push(r.Ka(c,e,n).then(d=>{var p;if((d||n)&&r.isPrimaryClient){const y=d?!d.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,y?"current":"not-current")}if(d){i.push(d);const y=xp.Wi(c.targetId,d);s.push(y)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,d){const p=Ae(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>J.forEach(d,_=>J.forEach(_.$i,S=>p.persistence.referenceDelegate.addReference(y,_.targetId,S)).next(()=>J.forEach(_.Ui,S=>p.persistence.referenceDelegate.removeReference(y,_.targetId,S)))))}catch(y){if(!$a(y))throw y;de("LocalStore","Failed to update sequence numbers: "+y)}for(const y of d){const _=y.targetId;if(!y.fromCache){const S=p.os.get(_),C=S.snapshotVersion,k=S.withLastLimboFreeSnapshotVersion(C);p.os=p.os.insert(_,k)}}}(r.localStore,s))}async function bR(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){de("SyncEngine","User change. New user:",e.toKey());const r=await Bx(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(u=>{u.forEach(c=>{c.reject(new ue(K.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ga(n,r.hs)}}function CR(t,e){const n=Ae(t),r=n.Na.get(e);if(r&&r.va)return Me().add(r.key);{let i=Me();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const u=n.Fa.get(o);i=i.unionWith(u.view.Va)}return i}}function iw(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ew.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ER.bind(null,e),e.Ca.d_=cR.bind(null,e.eventManager),e.Ca.$a=dR.bind(null,e.eventManager),e}function AR(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IR.bind(null,e),e}class Uu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return DA(this.persistence,new jA,e.initialUser,this.serializer)}Ga(e){return new RA(_p.Zr,this.serializer)}Wa(e){return new BA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uu.provider={build:()=>new Uu};class Jh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Vy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bR.bind(null,this.syncEngine),await aR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uR}()}createDatastore(e){const n=xc(e.databaseInfo.databaseId),r=function(s){return new qA(s)}(e.databaseInfo);return function(s,o,u,c){return new GA(s,o,u,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,u){return new YA(r,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,n=>Vy(this.syncEngine,n,0),function(){return Ny.D()?new Ny:new zA}())}createSyncEngine(e,n){return function(i,s,o,u,c,d,p){const y=new gR(i,s,o,u,c,d);return p&&(y.Qa=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);de("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ka(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Jh.provider={build:()=>new Jh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Lr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=op.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{de("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(de("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=bp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rd(t,e){t.asyncQueue.verifyOperationInProgress(),de("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Bx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Uy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await kR(t);de("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Dy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Dy(e.remoteStore,i)),t._onlineComponents=e}async function kR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){de("FirestoreClient","Using user provided OfflineComponentProvider");try{await Rd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Xi("Error using user provided cache. Falling back to memory cache: "+n),await Rd(t,new Uu)}}else de("FirestoreClient","Using default OfflineComponentProvider"),await Rd(t,new Uu);return t._offlineComponents}async function sw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(de("FirestoreClient","Using user provided OnlineComponentProvider"),await Uy(t,t._uninitializedComponentsProvider._online)):(de("FirestoreClient","Using default OnlineComponentProvider"),await Uy(t,new Jh))),t._onlineComponents}function PR(t){return sw(t).then(e=>e.syncEngine)}async function Bu(t){const e=await sw(t),n=e.eventManager;return n.onListen=mR.bind(null,e.syncEngine),n.onUnlisten=_R.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=yR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=xR.bind(null,e.syncEngine),n}function jR(t,e,n={}){const r=new Ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,d){const p=new jp({next:_=>{p.Za(),o.enqueueAndForget(()=>Ap(s,y));const S=_.docs.has(u);!S&&_.fromCache?d.reject(new ue(K.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&_.fromCache&&c&&c.source==="server"?d.reject(new ue(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),y=new kp(pc(u.path),p,{includeMetadataChanges:!0,_a:!0});return Cp(s,y)}(await Bu(t),t.asyncQueue,e,n,r)),r.promise}function NR(t,e,n={}){const r=new Ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,d){const p=new jp({next:_=>{p.Za(),o.enqueueAndForget(()=>Ap(s,y)),_.fromCache&&c.source==="server"?d.reject(new ue(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),y=new kp(u,p,{includeMetadataChanges:!0,_a:!0});return Cp(s,y)}(await Bu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t,e,n){if(!n)throw new ue(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function lw(t,e,n,r){if(e===!0&&r===!0)throw new ue(K.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zy(t){if(!ge.isDocumentKey(t))throw new ue(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $y(t){if(ge.isDocumentKey(t))throw new ue(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Sc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Te()}function un(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ue(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sc(t);throw new ue(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ue(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ow((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ic{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lx;switch(r.type){case"firstParty":return new nC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=By.get(n);r&&(de("ComponentProvider","Removing Datastore"),By.delete(n),r.terminate())}(this),Promise.resolve()}}function uw(t,e,n,r={}){var i;const s=(t=un(t,Ic))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Xi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=Xt.MOCK_USER;else{u=CT(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ue(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Xt(d)}t._authCredentials=new Zb(new ax(u,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ci(this.firestore,e,this._query)}}class $t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $t(this.firestore,e,this._key)}}class Rr extends Ci{constructor(e,n,r){super(e,n,pc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $t(this.firestore,null,new ge(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function we(t,e,...n){if(t=kt(t),aw("collection","path",e),t instanceof Ic){const r=rt.fromString(e,...n);return $y(r),new Rr(t,null,r)}{if(!(t instanceof $t||t instanceof Rr))throw new ue(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(rt.fromString(e,...n));return $y(r),new Rr(t.firestore,null,r)}}function he(t,e,...n){if(t=kt(t),arguments.length===1&&(e=op.newId()),aw("doc","path",e),t instanceof Ic){const r=rt.fromString(e,...n);return zy(r),new $t(t,null,new ge(r))}{if(!(t instanceof $t||t instanceof Rr))throw new ue(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(rt.fromString(e,...n));return zy(r),new $t(t.firestore,t instanceof Rr?t.converter:null,new ge(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new $x(this,"async_queue_retry"),this.Vu=()=>{const r=Ad();r&&de("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Ad();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Ad();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ar;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!$a(e))throw e;de("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw Lr("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Tp.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Te()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Hy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class dr extends Ic{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new qy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qy(e),this._firestoreClient=void 0,await e}}}function cw(t,e){const n=typeof t=="object"?t:X_(),r=typeof t=="string"?t:"(default)",i=ip(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=TT("firestore");s&&uw(i,...s)}return i}function Qa(t){if(t._terminated)throw new ue(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||DR(t),t._firestoreClient}function DR(t){var e,n,r;const i=t._freezeSettings(),s=function(u,c,d,p){return new gC(u,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,ow(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new RR(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ts(Lt.fromBase64String(e))}catch(n){throw new ue(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ts(Lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ue(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ue(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ue(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return We(this._lat,e._lat)||We(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR=/^__.*__$/;class LR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bi(e,this.data,this.fieldMask,n,this.fieldTransforms):new qa(e,this.data,n,this.fieldTransforms)}}class dw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new bi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function hw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te()}}class Np{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Np(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return zu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(hw(this.Cu)&&OR.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class MR{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||xc(e)}Qu(e,n,r,i=!1){return new Np({Cu:e,methodName:n,qu:r,path:Dt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ac(t){const e=t._freezeSettings(),n=xc(t._databaseId);return new MR(t._databaseId,!!e.ignoreUndefinedProperties,n)}function fw(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);Dp("Data must be an object, but it was:",o,r);const u=pw(r,o);let c,d;if(s.merge)c=new In(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const y of s.mergeFields){const _=Xh(e,y,n);if(!o.contains(_))throw new ue(K.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);mw(p,_)||p.push(_)}c=new In(p),d=o.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,d=o.fieldTransforms;return new LR(new gn(u),c,d)}class Rc extends Tc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rc}}function VR(t,e,n,r){const i=t.Qu(1,e,n);Dp("Data must be an object, but it was:",i,r);const s=[],o=gn.empty();us(r,(c,d)=>{const p=Op(e,c,n);d=kt(d);const y=i.Nu(p);if(d instanceof Rc)s.push(p);else{const _=Ja(d,y);_!=null&&(s.push(p),o.set(p,_))}});const u=new In(s);return new dw(o,u,i.fieldTransforms)}function FR(t,e,n,r,i,s){const o=t.Qu(1,e,n),u=[Xh(e,r,n)],c=[i];if(s.length%2!=0)throw new ue(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)u.push(Xh(e,s[_])),c.push(s[_+1]);const d=[],p=gn.empty();for(let _=u.length-1;_>=0;--_)if(!mw(d,u[_])){const S=u[_];let C=c[_];C=kt(C);const k=o.Nu(S);if(C instanceof Rc)d.push(S);else{const D=Ja(C,k);D!=null&&(d.push(S),p.set(S,D))}}const y=new In(d);return new dw(p,y,o.fieldTransforms)}function UR(t,e,n,r=!1){return Ja(n,t.Qu(r?4:3,e))}function Ja(t,e){if(gw(t=kt(t)))return Dp("Unsupported field value:",e,t),pw(t,e);if(t instanceof Tc)return function(r,i){if(!hw(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=Ja(u,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=kt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return MC(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Tt.fromDate(r);return{timestampValue:Vu(i.serializer,s)}}if(r instanceof Tt){const s=new Tt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vu(i.serializer,s)}}if(r instanceof bc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ts)return{bytesValue:Dx(i.serializer,r._byteString)};if(r instanceof $t){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:yp(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Cc)return function(o,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return fp(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Sc(r)}`)}(t,e)}function pw(t,e){const n={};return ux(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):us(t,(r,i)=>{const s=Ja(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function gw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof bc||t instanceof ts||t instanceof $t||t instanceof Tc||t instanceof Cc)}function Dp(t,e,n){if(!gw(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Sc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Xh(t,e,n){if((e=kt(e))instanceof Ya)return e._internalPath;if(typeof e=="string")return Op(t,e);throw zu("Field path arguments must be of type string or ",t,!1,void 0,n)}const BR=new RegExp("[~\\*/\\[\\]]");function Op(t,e,n){if(e.search(BR)>=0)throw zu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ya(...e.split("."))._internalPath}catch{throw zu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function zu(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ue(K.INVALID_ARGUMENT,u+t+c)}function mw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Lp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class zR extends yw{data(){return super.data()}}function Lp(t,e){return typeof e=="string"?Op(t,e):e instanceof Ya?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ue(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mp{}class _w extends Mp{}function hr(t,e,...n){let r=[];e instanceof Mp&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof kc).length,u=s.filter(c=>c instanceof Xa).length;if(o>1||o>0&&u>0)throw new ue(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Xa extends _w{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Xa(e,n,r)}_apply(e){const n=this._parse(e);return xw(e._query,n),new Ci(e.firestore,e.converter,zh(e._query,n))}_parse(e){const n=Ac(e.firestore);return function(s,o,u,c,d,p,y){let _;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ue(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Gy(y,p);const S=[];for(const C of y)S.push(Ky(c,s,C));_={arrayValue:{values:S}}}else _=Ky(c,s,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Gy(y,p),_=UR(u,o,y,p==="in"||p==="not-in");return Et.create(d,p,_)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Jn(t,e,n){const r=e,i=Lp("where",t);return Xa._create(i,r,n)}class kc extends Mp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new kc(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Yn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)xw(o,c),o=zh(o,c)}(e._query,n),new Ci(e.firestore,e.converter,zh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Ky(t,e,n){if(typeof(n=kt(n))=="string"){if(n==="")throw new ue(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vx(e)&&n.indexOf("/")!==-1)throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(rt.fromString(n));if(!ge.isDocumentKey(r))throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return py(t,new ge(r))}if(n instanceof $t)return py(t,n._key);throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sc(n)}.`)}function Gy(t,e){if(!Array.isArray(t)||t.length===0)throw new ue(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function xw(t,e){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ue(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class ww{convertValue(e,n="none"){switch(es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Te()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return us(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>gt(o.doubleValue));return new Cc(s)}convertGeoPoint(e){return new bc(gt(e.latitude),gt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=up(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Aa(e));default:return null}}convertTimestamp(e){const n=_i(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=rt.fromString(e);Ke(Ux(r));const i=new io(r.get(1),r.get(3)),s=new ge(r.popFirst(5));return i.isEqual(n)||Lr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vp extends yw{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Lp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class sa extends Vp{data(e={}){return super.data(e)}}class Fp{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ls(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sa(this._firestore,this._userDataWriter,r.key,r,new Ls(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ue(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new sa(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ls(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new sa(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ls(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:$R(u.type),doc:c,oldIndex:d,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function $R(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t){t=un(t,$t);const e=un(t.firestore,dr);return jR(Qa(e),t._key).then(n=>Sw(e,t,n))}class Up extends ww{constructor(e){super(),this.firestore=e}convertBytes(e){return new ts(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new $t(this.firestore,null,n)}}function St(t){t=un(t,Ci);const e=un(t.firestore,dr),n=Qa(e),r=new Up(e);return vw(t._query),NR(n,t._query).then(i=>new Fp(e,r,t,i))}function Cn(t,e,n){t=un(t,$t);const r=un(t.firestore,dr),i=Ew(t.converter,e,n);return Za(r,[fw(Ac(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Mn.none())])}function xt(t,e,n,...r){t=un(t,$t);const i=un(t.firestore,dr),s=Ac(i);let o;return o=typeof(e=kt(e))=="string"||e instanceof Ya?FR(s,"updateDoc",t._key,e,n,r):VR(s,"updateDoc",t._key,e),Za(i,[o.toMutation(t._key,Mn.exists(!0))])}function Vn(t){return Za(un(t.firestore,dr),[new pp(t._key,Mn.none())])}function ns(t,e){const n=un(t.firestore,dr),r=he(t),i=Ew(t.converter,e);return Za(n,[fw(Ac(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Mn.exists(!1))]).then(()=>r)}function yt(t,...e){var n,r,i;t=kt(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Hy(e[o])||(s=e[o],o++);const u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Hy(e[o])){const y=e[o];e[o]=(n=y.next)===null||n===void 0?void 0:n.bind(y),e[o+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[o+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let c,d,p;if(t instanceof $t)d=un(t.firestore,dr),p=pc(t._key.path),c={next:y=>{e[o]&&e[o](Sw(d,t,y))},error:e[o+1],complete:e[o+2]};else{const y=un(t,Ci);d=un(y.firestore,dr),p=y._query;const _=new Up(d);c={next:S=>{e[o]&&e[o](new Fp(d,_,y,S))},error:e[o+1],complete:e[o+2]},vw(t._query)}return function(_,S,C,k){const D=new jp(k),b=new kp(S,D,C);return _.asyncQueue.enqueueAndForget(async()=>Cp(await Bu(_),b)),()=>{D.Za(),_.asyncQueue.enqueueAndForget(async()=>Ap(await Bu(_),b))}}(Qa(d),p,u,c)}function Za(t,e){return function(r,i){const s=new Ar;return r.asyncQueue.enqueueAndForget(async()=>wR(await PR(r),i,s)),s.promise}(Qa(t),e)}function Sw(t,e,n){const r=n.docs.get(e._key),i=new Up(t);return new Vp(t,i,e._key,r,new Ls(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){mo=i})(go),no(new Yi("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new dr(new eC(r.getProvider("auth-internal")),new iC(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ue(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new io(d.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),gi(uy,"4.7.3",e),gi(uy,"4.7.3","esm2017")})();const Bp=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:ww,Bytes:ts,CollectionReference:Rr,DocumentReference:$t,DocumentSnapshot:Vp,FieldPath:Ya,FieldValue:Tc,Firestore:dr,FirestoreError:ue,GeoPoint:bc,Query:Ci,QueryCompositeFilterConstraint:kc,QueryConstraint:_w,QueryDocumentSnapshot:sa,QueryFieldFilterConstraint:Xa,QuerySnapshot:Fp,SnapshotMetadata:Ls,Timestamp:Tt,VectorValue:Cc,_AutoId:op,_ByteString:Lt,_DatabaseId:io,_DocumentKey:ge,_EmptyAuthCredentialsProvider:lx,_FieldPath:Dt,_cast:un,_logWarn:Xi,_validateIsNotUsedTogether:lw,addDoc:ns,collection:we,connectFirestoreEmulator:uw,deleteDoc:Vn,doc:he,ensureFirestoreConfigured:Qa,executeWrite:Za,getDoc:Rt,getDocs:St,getFirestore:cw,onSnapshot:yt,query:hr,setDoc:Cn,updateDoc:xt,where:Jn},Symbol.toStringTag,{value:"Module"}));function zp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Iw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tw=Iw,bw=new Ua("auth","Firebase",Iw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=new np("@firebase/auth");function WR(t,...e){$u.logLevel<=Ve.WARN&&$u.warn(`Auth (${go}): ${t}`,...e)}function tu(t,...e){$u.logLevel<=Ve.ERROR&&$u.error(`Auth (${go}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(t,...e){throw $p(t,...e)}function lr(t,...e){return $p(t,...e)}function Cw(t,e,n){const r=Object.assign(Object.assign({},Tw()),{[e]:n});return new Ua("auth","Firebase",r).create(e,{appName:t.name})}function kr(t){return Cw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $p(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return bw.create(t,...e)}function Se(t,e,...n){if(!t)throw $p(e,...n)}function Ir(t){const e="INTERNAL ASSERTION FAILED: "+t;throw tu(e),new Error(e)}function Vr(t,e){t||Ir(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function qR(){return Qy()==="http:"||Qy()==="https:"}function Qy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qR()||PT()||"connection"in navigator)?navigator.onLine:!0}function KR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,n){this.shortDelay=e,this.longDelay=n,Vr(n>e,"Short delay should be less than long delay!"),this.isMobile=AT()||jT()}get(){return HR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(t,e){Vr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ir("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ir("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ir("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=new el(3e4,6e4);function Ai(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ri(t,e,n,r,i={}){return Rw(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const u=Ba(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},s);return kT()||(d.referrerPolicy="no-referrer"),Aw.fetch()(kw(t,t.config.apiHost,n,u),d)})}async function Rw(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},GR),e);try{const i=new JR(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ml(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const u=s.ok?o.errorMessage:o.error.message,[c,d]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ml(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ml(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ml(t,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Cw(t,p,d);Xn(t,p)}}catch(i){if(i instanceof Ur)throw i;Xn(t,"network-request-failed",{message:String(i)})}}async function tl(t,e,n,r,i={}){const s=await Ri(t,e,n,r,i);return"mfaPendingCredential"in s&&Xn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function kw(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Wp(t.config,i):`${t.config.apiScheme}://${i}`}function YR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class JR{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(lr(this.auth,"network-request-failed")),QR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ml(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=lr(t,e,r);return i.customData._tokenResponse=n,i}function Yy(t){return t!==void 0&&t.enterprise!==void 0}class XR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return YR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function ZR(t,e){return Ri(t,"GET","/v2/recaptchaConfig",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ek(t,e){return Ri(t,"POST","/v1/accounts:delete",e)}async function Pw(t,e){return Ri(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jw(t,e=!1){const n=kt(t),r=await n.getIdToken(e),i=qp(r);Se(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:oa(kd(i.auth_time)),issuedAtTime:oa(kd(i.iat)),expirationTime:oa(kd(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function kd(t){return Number(t)*1e3}function qp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return tu("JWT malformed, contained fewer than 3 sections"),null;try{const i=q_(n);return i?JSON.parse(i):(tu("Failed to decode base64 JWT payload"),null)}catch(i){return tu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Jy(t){const e=qp(t);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ur&&tk(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=oa(this.lastLoginAt),this.creationTime=oa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wu(t){var e;const n=t.auth,r=await t.getIdToken(),i=await ja(t,Pw(n,{idToken:r}));Se(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Dw(s.providerUserInfo):[],u=rk(t.providerData,o),c=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),p=c?d:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new ef(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(t,y)}async function Nw(t){const e=kt(t);await Wu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rk(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Dw(t){return t.map(e=>{var{providerId:n}=e,r=zp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ik(t,e){const n=await Rw(t,{},async()=>{const r=Ba({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=kw(t,i,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Aw.fetch()(o,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sk(t,e){return Ri(t,"POST","/v2/accounts:revokeToken",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const n=Jy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await ik(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new qs;return r&&(Se(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Se(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Se(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qs,this.toJSON())}_performRefresh(){return Ir("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(t,e){Se(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Tr{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=zp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ef(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ja(this,this.stsTokenManager.getToken(this.auth,e));return Se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return jw(this,e)}reload(){return Nw(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Tr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Wu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rr(this.auth.app))return Promise.reject(kr(this.auth));const e=await this.getIdToken();return await ja(this,ek(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,u,c,d,p;const y=(r=n.displayName)!==null&&r!==void 0?r:void 0,_=(i=n.email)!==null&&i!==void 0?i:void 0,S=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,C=(o=n.photoURL)!==null&&o!==void 0?o:void 0,k=(u=n.tenantId)!==null&&u!==void 0?u:void 0,D=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(d=n.createdAt)!==null&&d!==void 0?d:void 0,E=(p=n.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:T,emailVerified:V,isAnonymous:N,providerData:M,stsTokenManager:w}=n;Se(T&&w,e,"internal-error");const f=qs.fromJSON(this.name,w);Se(typeof T=="string",e,"internal-error"),Qr(y,e.name),Qr(_,e.name),Se(typeof V=="boolean",e,"internal-error"),Se(typeof N=="boolean",e,"internal-error"),Qr(S,e.name),Qr(C,e.name),Qr(k,e.name),Qr(D,e.name),Qr(b,e.name),Qr(E,e.name);const m=new Tr({uid:T,auth:e,email:_,emailVerified:V,displayName:y,isAnonymous:N,photoURL:C,phoneNumber:S,tenantId:k,stsTokenManager:f,createdAt:b,lastLoginAt:E});return M&&Array.isArray(M)&&(m.providerData=M.map(x=>Object.assign({},x))),D&&(m._redirectEventId=D),m}static async _fromIdTokenResponse(e,n,r=!1){const i=new qs;i.updateFromServerResponse(n);const s=new Tr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Wu(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Se(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Dw(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),u=new qs;u.updateFromIdToken(r);const c=new Tr({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ef(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;function br(t){Vr(t instanceof Function,"Expected a class definition");let e=Xy.get(t);return e?(Vr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Xy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Ow.type="NONE";const tf=Ow;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(t,e,n){return`firebase:${t}:${e}:${n}`}class Hs{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=nu(this.userKey,i.apiKey,s),this.fullPersistenceKey=nu("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Tr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Hs(br(tf),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||br(tf);const o=nu(r,e.config.apiKey,e.name);let u=null;for(const d of n)try{const p=await d._get(o);if(p){const y=Tr._fromJSON(e,p);d!==s&&(u=y),s=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Hs(s,e,r):(s=c[0],u&&await s._set(o,u.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Hs(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bw(e))return"Blackberry";if(zw(e))return"Webos";if(Mw(e))return"Safari";if((e.includes("chrome/")||Vw(e))&&!e.includes("edge/"))return"Chrome";if(Uw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Lw(t=nn()){return/firefox\//i.test(t)}function Mw(t=nn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Vw(t=nn()){return/crios\//i.test(t)}function Fw(t=nn()){return/iemobile/i.test(t)}function Uw(t=nn()){return/android/i.test(t)}function Bw(t=nn()){return/blackberry/i.test(t)}function zw(t=nn()){return/webos/i.test(t)}function Hp(t=nn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ok(t=nn()){var e;return Hp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ak(){return NT()&&document.documentMode===10}function $w(t=nn()){return Hp(t)||Uw(t)||zw(t)||Bw(t)||/windows phone/i.test(t)||Fw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(t,e=[]){let n;switch(t){case"Browser":n=Zy(nn());break;case"Worker":n=`${Zy(nn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${go}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,u)=>{try{const c=e(s);o(c)}catch(c){u(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uk(t,e={}){return Ri(t,"GET","/v2/passwordPolicy",Ai(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=6;class dk{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:ck,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,u;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ev(this),this.idTokenSubscription=new ev(this),this.beforeStateQueue=new lk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=br(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Hs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Pw(this,{idToken:e}),r=await Tr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(rr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===u)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Wu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=KR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rr(this.app))return Promise.reject(kr(this));const n=e?kt(e):null;return n&&Se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rr(this.app)?Promise.reject(kr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rr(this.app)?Promise.reject(kr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(br(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uk(this),n=new dk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ua("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&br(e)||this._popupRedirectResolver;Se(n,this,"argument-error"),this.redirectPersistenceManager=await Hs.create(this,[br(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(u,this,"internal-error"),u.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ww(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&WR(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ds(t){return kt(t)}class ev{constructor(e){this.auth=e,this.observer=null,this.addObserver=BT(n=>this.observer=n)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fk(t){Pc=t}function qw(t){return Pc.loadJS(t)}function pk(){return Pc.recaptchaEnterpriseScript}function gk(){return Pc.gapiScript}function mk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const yk="recaptcha-enterprise",vk="NO_RECAPTCHA";class _k{constructor(e){this.type=yk,this.auth=ds(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,u)=>{ZR(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new XR(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{u(c)})})}function i(s,o,u){const c=window.grecaptcha;Yy(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(vk)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(u=>{if(!n&&Yy(window.grecaptcha))i(u,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=pk();c.length!==0&&(c+=u),qw(c).then(()=>{i(u,s,o)}).catch(d=>{o(d)})}}).catch(u=>{o(u)})})}}async function tv(t,e,n,r=!1){const i=new _k(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function nf(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await tv(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await tv(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t,e){const n=ip(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Pu(s,e??{}))return i;Xn(i,"already-initialized")}return n.initialize({options:e})}function xk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(br);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Kw(t,e,n){const r=ds(t);Se(r._canInitEmulator,r,"emulator-config-failed"),Se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Gw(e),{host:o,port:u}=wk(e),c=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Ek()}function Gw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wk(t){const e=Gw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:nv(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:nv(o)}}}function nv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ek(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ir("not implemented")}_getIdTokenResponse(e){return Ir("not implemented")}_linkToIdToken(e,n){return Ir("not implemented")}_getReauthenticationResolver(e){return Ir("not implemented")}}async function Sk(t,e){return Ri(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ik(t,e){return tl(t,"POST","/v1/accounts:signInWithPassword",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(t,e){return tl(t,"POST","/v1/accounts:signInWithEmailLink",Ai(t,e))}async function bk(t,e){return tl(t,"POST","/v1/accounts:signInWithEmailLink",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo extends jc{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new uo(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new uo(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nf(e,n,"signInWithPassword",Ik);case"emailLink":return Tk(e,{email:this._email,oobCode:this._password});default:Xn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nf(e,r,"signUpPassword",Sk);case"emailLink":return bk(e,{idToken:n,email:this._email,oobCode:this._password});default:Xn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ks(t,e){return tl(t,"POST","/v1/accounts:signInWithIdp",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="http://localhost";class wi extends jc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Xn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=zp(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new wi(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ks(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ks(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ks(e,n)}buildRequest(){const e={requestUri:Ck,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ba(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Rk(t){const e=Uo(Bo(t)).link,n=e?Uo(Bo(e)).deep_link_id:null,r=Uo(Bo(t)).deep_link_id;return(r?Uo(Bo(r)).link:null)||r||n||e||t}class Nc{constructor(e){var n,r,i,s,o,u;const c=Uo(Bo(e)),d=(n=c.apiKey)!==null&&n!==void 0?n:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,y=Ak((i=c.mode)!==null&&i!==void 0?i:null);Se(d&&p&&y,"argument-error"),this.apiKey=d,this.operation=y,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(u=c.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=Rk(e);try{return new Nc(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(){this.providerId=hs.PROVIDER_ID}static credential(e,n){return uo._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Nc.parseLink(n);return Se(r,"argument-error"),uo._fromEmailAndCode(e,r.code,r.tenantId)}}hs.PROVIDER_ID="password";hs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";hs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl extends Qw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends nl{constructor(){super("facebook.com")}static credential(e){return wi._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vr.credential(e.oauthAccessToken)}catch{return null}}}vr.FACEBOOK_SIGN_IN_METHOD="facebook.com";vr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends nl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return wi._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return _r.credential(n,r)}catch{return null}}}_r.GOOGLE_SIGN_IN_METHOD="google.com";_r.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends nl{constructor(){super("github.com")}static credential(e){return wi._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xr.credential(e.oauthAccessToken)}catch{return null}}}xr.GITHUB_SIGN_IN_METHOD="github.com";xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends nl{constructor(){super("twitter.com")}static credential(e,n){return wi._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wr.credential(n,r)}catch{return null}}}wr.TWITTER_SIGN_IN_METHOD="twitter.com";wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kk(t,e){return tl(t,"POST","/v1/accounts:signUp",Ai(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Tr._fromIdTokenResponse(e,r,i),o=rv(r);return new rs({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=rv(r);return new rs({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function rv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu extends Ur{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,qu.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new qu(e,n,r,i)}}function Yw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?qu._fromErrorAndOperation(t,s,e,r):s})}async function Pk(t,e,n=!1){const r=await ja(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return rs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk(t,e,n=!1){const{auth:r}=t;if(rr(r.app))return Promise.reject(kr(r));const i="reauthenticate";try{const s=await ja(t,Yw(r,i,e,t),n);Se(s.idToken,r,"internal-error");const o=qp(s.idToken);Se(o,r,"internal-error");const{sub:u}=o;return Se(t.uid===u,r,"user-mismatch"),rs._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jw(t,e,n=!1){if(rr(t.app))return Promise.reject(kr(t));const r="signIn",i=await Yw(t,r,e),s=await rs._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Xw(t,e){return Jw(ds(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zw(t){const e=ds(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function qo(t,e,n){if(rr(t.app))return Promise.reject(kr(t));const r=ds(t),o=await nf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kk).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Zw(t),c}),u=await rs._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(u.user),u}function eE(t,e,n){return rr(t.app)?Promise.reject(kr(t)):Xw(kt(t),hs.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zw(t),r})}function tE(t,e,n,r){return kt(t).onIdTokenChanged(e,n,r)}function nE(t,e,n){return kt(t).beforeAuthStateChanged(e,n)}function Bn(t,e,n,r){return kt(t).onAuthStateChanged(e,n,r)}function rE(t){return kt(t).signOut()}const Hu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Hu,"1"),this.storage.removeItem(Hu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk=1e3,Dk=10;class sE extends iE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$w(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,u,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);ak()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Dk):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Nk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}sE.type="LOCAL";const oE=sE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE extends iE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}aE.type="SESSION";const Kp=aE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Dc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(o).map(async d=>d(n.origin,s)),c=await Ok(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((u,c)=>{const d=Gp("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(y){const _=y;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(){return window}function Mk(t){ur().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(){return typeof ur().WorkerGlobalScope<"u"&&typeof ur().importScripts=="function"}async function Vk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Fk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Uk(){return lE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="firebaseLocalStorageDb",Bk=1,Ku="firebaseLocalStorage",cE="fbase_key";class rl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Oc(t,e){return t.transaction([Ku],e?"readwrite":"readonly").objectStore(Ku)}function zk(){const t=indexedDB.deleteDatabase(uE);return new rl(t).toPromise()}function rf(){const t=indexedDB.open(uE,Bk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ku,{keyPath:cE})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ku)?e(r):(r.close(),await zk(),e(await rf()))})})}async function iv(t,e,n){const r=Oc(t,!0).put({[cE]:e,value:n});return new rl(r).toPromise()}async function $k(t,e){const n=Oc(t,!1).get(e),r=await new rl(n).toPromise();return r===void 0?null:r.value}function sv(t,e){const n=Oc(t,!0).delete(e);return new rl(n).toPromise()}const Wk=800,qk=3;class dE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>qk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dc._getInstance(Uk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Vk(),!this.activeServiceWorker)return;this.sender=new Lk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Fk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rf();return await iv(e,Hu,"1"),await sv(e,Hu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>iv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$k(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Oc(i,!1).getAll();return new rl(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dE.type="LOCAL";const hE=dE;new el(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(t,e){return e?br(e):(Se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp extends jc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ks(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ks(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ks(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Kk(t){return Jw(t.auth,new Qp(t),t.bypassAuthState)}function Gk(t){const{auth:e,user:n}=t;return Se(n,e,"internal-error"),jk(n,new Qp(t),t.bypassAuthState)}async function Qk(t){const{auth:e,user:n}=t;return Se(n,e,"internal-error"),Pk(n,new Qp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:u}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Kk;case"linkViaPopup":case"linkViaRedirect":return Qk;case"reauthViaPopup":case"reauthViaRedirect":return Gk;default:Xn(this.auth,"internal-error")}}resolve(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=new el(2e3,1e4);class Ms extends fE{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ms.currentPopupAction&&Ms.currentPopupAction.cancel(),Ms.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){Vr(this.filter.length===1,"Popup operations only handle one event");const e=Gp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ms.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Yk.get())};e()}}Ms.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk="pendingRedirect",ru=new Map;class Xk extends fE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ru.get(this.auth._key());if(!e){try{const r=await Zk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ru.set(this.auth._key(),e)}return this.bypassAuthState||ru.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Zk(t,e){const n=nP(e),r=tP(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function eP(t,e){ru.set(t._key(),e)}function tP(t){return br(t._redirectPersistence)}function nP(t){return nu(Jk,t.config.apiKey,t.name)}async function rP(t,e,n=!1){if(rr(t.app))return Promise.reject(kr(t));const r=ds(t),i=Hk(r,e),o=await new Xk(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=10*60*1e3;class sP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!pE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(lr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iP&&this.cachedEventUids.clear(),this.cachedEventUids.has(ov(e))}saveEventToCache(e){this.cachedEventUids.add(ov(e)),this.lastProcessedEventTime=Date.now()}}function ov(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function pE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aP(t,e={}){return Ri(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uP=/^https?/;async function cP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await aP(t);for(const n of e)try{if(dP(n))return}catch{}Xn(t,"unauthorized-domain")}function dP(t){const e=Zh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!uP.test(n))return!1;if(lP.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=new el(3e4,6e4);function av(){const t=ur().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function fP(t){return new Promise((e,n)=>{var r,i,s;function o(){av(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{av(),n(lr(t,"network-request-failed"))},timeout:hP.get()})}if(!((i=(r=ur().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ur().gapi)===null||s===void 0)&&s.load)o();else{const u=mk("iframefcb");return ur()[u]=()=>{gapi.load?o():n(lr(t,"network-request-failed"))},qw(`${gk()}?onload=${u}`).catch(c=>n(c))}}).catch(e=>{throw iu=null,e})}let iu=null;function pP(t){return iu=iu||fP(t),iu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=new el(5e3,15e3),mP="__/auth/iframe",yP="emulator/auth/iframe",vP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_P=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xP(t){const e=t.config;Se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Wp(e,yP):`https://${t.config.authDomain}/${mP}`,r={apiKey:e.apiKey,appName:t.name,v:go},i=_P.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ba(r).slice(1)}`}async function wP(t){const e=await pP(t),n=ur().gapi;return Se(n,t,"internal-error"),e.open({where:document.body,url:xP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vP,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=lr(t,"network-request-failed"),u=ur().setTimeout(()=>{s(o)},gP.get());function c(){ur().clearTimeout(u),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},SP=500,IP=600,TP="_blank",bP="http://localhost";class lv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CP(t,e,n,r=SP,i=IP){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const c=Object.assign(Object.assign({},EP),{width:r.toString(),height:i.toString(),top:s,left:o}),d=nn().toLowerCase();n&&(u=Vw(d)?TP:n),Lw(d)&&(e=e||bP,c.scrollbars="yes");const p=Object.entries(c).reduce((_,[S,C])=>`${_}${S}=${C},`,"");if(ok(d)&&u!=="_self")return AP(e||"",u),new lv(null);const y=window.open(e||"",u,p);Se(y,t,"popup-blocked");try{y.focus()}catch{}return new lv(y)}function AP(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP="__/auth/handler",kP="emulator/auth/handler",PP=encodeURIComponent("fac");async function uv(t,e,n,r,i,s){Se(t.config.authDomain,t,"auth-domain-config-required"),Se(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:go,eventId:i};if(e instanceof Qw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",UT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,y]of Object.entries({}))o[p]=y}if(e instanceof nl){const p=e.getScopes().filter(y=>y!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const c=await t._getAppCheckToken(),d=c?`#${PP}=${encodeURIComponent(c)}`:"";return`${jP(t)}?${Ba(u).slice(1)}${d}`}function jP({config:t}){return t.emulator?Wp(t,kP):`https://${t.authDomain}/${RP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd="webStorageSupport";class NP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kp,this._completeRedirectFn=rP,this._overrideRedirectResult=eP}async _openPopup(e,n,r,i){var s;Vr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await uv(e,n,r,Zh(),i);return CP(e,o,Gp())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await uv(e,n,r,Zh(),i);return Mk(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Vr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await wP(e),r=new sP(e);return n.register("authEvent",i=>(Se(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Pd,{type:Pd},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Pd];o!==void 0&&n(!!o),Xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return $w()||Mw()||Hp()}}const gE=NP;var cv="@firebase/auth",dv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function LP(t){no(new Yi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=r.options;Se(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ww(t)},d=new hk(r,i,s,c);return xk(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),no(new Yi("auth-internal",e=>{const n=ds(e.getProvider("auth").getImmediate());return(r=>new DP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),gi(cv,dv,OP(t)),gi(cv,dv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=5*60,VP=G_("authIdTokenMaxAge")||MP;let hv=null;const FP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>VP)return;const i=n==null?void 0:n.token;hv!==i&&(hv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function cn(t=X_()){const e=ip(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Hw(t,{popupRedirectResolver:gE,persistence:[hE,oE,Kp]}),r=G_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=FP(s.toString());nE(n,o,()=>o(n.currentUser)),tE(n,u=>o(u))}}const i=H_("auth");return i&&Kw(n,`http://${i}`),n}function UP(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}fk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=lr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",UP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LP("Browser");const mE=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Nc,AuthCredential:jc,EmailAuthCredential:uo,EmailAuthProvider:hs,FacebookAuthProvider:vr,GithubAuthProvider:xr,GoogleAuthProvider:_r,OAuthCredential:wi,TwitterAuthProvider:wr,beforeAuthStateChanged:nE,browserLocalPersistence:oE,browserPopupRedirectResolver:gE,browserSessionPersistence:Kp,connectAuthEmulator:Kw,createUserWithEmailAndPassword:qo,getAuth:cn,getIdTokenResult:jw,inMemoryPersistence:tf,indexedDBLocalPersistence:hE,initializeAuth:Hw,onAuthStateChanged:Bn,onIdTokenChanged:tE,prodErrorMap:Tw,reload:Nw,signInWithCredential:Xw,signInWithEmailAndPassword:eE,signOut:rE},Symbol.toStringTag,{value:"Module"})),BP={apiKey:"AIzaSyA2u0hxxVQufvInffw5PXhImFsmBRJ2YQQ",authDomain:"medcins.firebaseapp.com",projectId:"medcins",storageBucket:"medcins.firebasestorage.app",messagingSenderId:"474421452339",appId:"1:474421452339:web:22e693522ab3410bea0d46",measurementId:"G-V63YY2N057"},Lc=J_(BP),G=cw(Lc);cn(Lc);const zP=Object.freeze(Object.defineProperty({__proto__:null,app:Lc,db:G},Symbol.toStringTag,{value:"Module"})),$P="modulepreload",WP=function(t){return"/medcins/"+t},fv={},Gs=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=WP(c),c in fv)return;fv[c]=!0;const d=c.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const y=document.createElement("link");if(y.rel=d?"stylesheet":$P,d||(y.as="script"),y.crossOrigin="",y.href=c,u&&y.setAttribute("nonce",u),document.head.appendChild(y),d)return new Promise((_,S)=>{y.addEventListener("load",_),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})},_s=cn(Lc),qP=["Abia","Adamawa","Akwa Ibom","Anambra","Bauchi","Bayelsa","Benue","Borno","Cross River","Delta","Ebonyi","Edo","Ekiti","Enugu","FCT","Gombe","Imo","Jigawa","Kaduna","Kano","Katsina","Kebbi","Kogi","Kwara","Lagos","Nasarawa","Niger","Ogun","Ondo","Osun","Oyo","Plateau","Rivers","Sokoto","Taraba","Yobe","Zamfara"],pv={companyName:"",phoneNumber:"",whatsappNumber:"",rcNumber:"",businessAddress:"",email:"",coverageArea:"",operatingHours:"",logoUrl:"",state:"",city:"",landmark:""};function HP(){const t=ls(),[e,n]=P.useState(""),[r,i]=P.useState(""),[s,o]=P.useState(null),[u,c]=P.useState(!1),[d,p]=P.useState(!1),[y,_]=P.useState(!1),[S,C]=P.useState(pv),[k,D]=P.useState(!1),[b,E]=P.useState(""),[T,V]=P.useState(""),[N,M]=P.useState(""),[w,f]=P.useState(""),[m,x]=P.useState(""),[R,j]=P.useState(""),[A,te]=P.useState(""),[$,ne]=P.useState(""),[X,L]=P.useState(""),[F,W]=P.useState(""),[H,Q]=P.useState(""),[O,Z]=P.useState(""),[z,se]=P.useState(""),[fe,re]=P.useState(""),[be,Oe]=P.useState(""),[_e,je]=P.useState(""),[Fe,De]=P.useState(null),[Re,ye]=P.useState(!1),[Ge,ve]=P.useState(null),[ke,Pe]=P.useState(!1),[qt,ht]=P.useState(""),[bt,Qe]=P.useState(""),[vt,Ee]=P.useState(""),[Ne,Ze]=P.useState(""),[kn,rn]=P.useState(""),[sn,qe]=P.useState(""),fn=async()=>navigator.geolocation?(Pe(!0),new Promise((B,oe)=>{navigator.geolocation.getCurrentPosition(pe=>{const ae={latitude:pe.coords.latitude,longitude:pe.coords.longitude};ve(ae),Pe(!1),B(ae)},pe=>{Pe(!1),alert("⚠️ Location access denied or unavailable."),oe(pe)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})):(alert("❌ Geolocation is not supported by your browser."),null),Zn=async()=>{try{if(!X||!F){alert("Please provide distributor name and license number.");return}const B=await fn();if(!B){alert("📍 Location required to complete distributor signup.");return}const pe=(await qo(_s,e,r)).user,ae=await ki(X),Ie={email:pe.email,role:"distributor",businessName:X,licenseNumber:F,location:B,slug:ae,businessSlug:ae,createdAt:new Date().toISOString()};await Br(pe.uid,Ie),o({...pe,...Ie}),alert(`✅ Distributor signup successful!
Your distributor link: medcins.com/store/${ae}`),p(!1),L(""),W(""),ve(null)}catch(B){console.error("Distributor signup error:",B),alert(B.message||"Distributor signup failed")}},Ye=B=>B.toLowerCase().trim().replace(/[^a-z0-9]+/g,"").replace(/^-+|-+$/g,""),ki=async B=>{let oe=Ye(B);const pe=we(G,"users");let ae=oe,Ie=1;for(;;){const Ht=hr(pe,Jn("slug","==",ae));if((await St(Ht)).empty)break;ae=`${oe}${Ie++}`}return ae},Br=async(B,oe)=>{console.log("Writing user doc for:",B,oe),await Cn(he(G,"users",B),oe)},Pi=async()=>{try{if(!bt||!Ne||!kn){alert("Please provide address, state, and city.");return}const oe=(await qo(_s,e,r)).user,pe={email:oe.email,role:"customer",address:bt,state:Ne,city:kn,landmark:sn,createdAt:new Date().toISOString()};await Br(oe.uid,pe),o({...oe,...pe}),alert("✅ Customer signup successful!")}catch(B){console.error("Customer signup error:",B),alert(B.message)}},zr=async()=>navigator.geolocation?(ye(!0),new Promise((B,oe)=>{navigator.geolocation.getCurrentPosition(pe=>{const ae={latitude:pe.coords.latitude,longitude:pe.coords.longitude};De(ae),ye(!1),B(ae)},pe=>{ye(!1),alert("⚠️ Location access denied or unavailable."),oe(pe)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})):(alert("❌ Geolocation is not supported by your browser."),null),fs=async()=>{try{if(!b||!R||!T){alert("Please provide business name, address, and license number.");return}const B=await zr();if(!B){alert("📍 Location required to complete business signup.");return}const pe=(await qo(_s,e,r)).user;console.log("Business user created:",pe.uid);const ae=await ki(b);console.log("Generated unique slug:",ae);const Ie={email:pe.email,role:"medicine-manager",businessName:b,address:T,city:w,state:N,landmark:m,licenseNumber:R,location:B,lat:B.latitude,lng:B.longitude,slug:ae,businessSlug:ae,businessPhone:A,businessWhatsapp:$,createdAt:new Date().toISOString()};await Br(pe.uid,Ie),console.log("Firestore user record created for business:",Ie),o({...pe,...Ie}),alert(`✅ Business signup successful!
Your store link: medcins.com/store/${ae}`),c(!1),E(""),V(""),j(""),De(null)}catch(B){console.error("Business signup error:",B),alert(B.message||"Business signup failed")}},Pn=async()=>{try{const oe=(await eE(_s,e,r)).user,pe=await Rt(he(G,"users",oe.uid));pe.exists()?(o({...oe,...pe.data()}),pe.data().role==="delivery-agent"&&pe.data().slug&&t(`/agent/${pe.data().slug}`)):(alert("⚠️ No Firestore user record found. Please contact admin."),o({...oe}))}catch(B){console.error("Login error:",B),alert(B.message||"Login failed")}},$r=async()=>{await rE(_s),o(null)},Wr=async()=>{try{D(!0);const B=["companyName","phoneNumber","whatsappNumber","rcNumber","businessAddress","email","coverageArea","operatingHours","logoUrl","state","city"];for(const et of B)if(!S[et]){alert(`Please fill the ${et} field.`),D(!1);return}const pe=(await qo(_s,S.email,r)).user,ae=await ki(S.companyName),Ie={...S,role:"delivery-agent",slug:ae,createdAt:new Date().toISOString()};await Br(pe.uid,Ie);const Ht={companyName:S.companyName,phoneNumber:S.phoneNumber,whatsappNumber:S.whatsappNumber,rcNumber:S.rcNumber,businessAddress:S.businessAddress,email:S.email,coverageArea:S.coverageArea,operatingHours:S.operatingHours,logoUrl:S.logoUrl,state:S.state,city:S.city,landmark:S.landmark,userId:pe.uid,createdAt:new Date().toISOString(),slug:ae},{addDoc:xn,collection:Mt}=await Gs(async()=>{const{addDoc:et,collection:ot}=await Promise.resolve().then(()=>Bp);return{addDoc:et,collection:ot}},void 0);await xn(Mt(G,"deliveryAgents"),Ht),o({...pe,...Ie}),alert("✅ Delivery agent signup successful!"),_(!1),C(pv)}catch(B){console.error("Delivery agent signup error:",B),alert(B.message||"Delivery agent signup failed")}finally{D(!1)}},[jn,v]=P.useState(!1),[Y,le]=P.useState("customer"),xe=[{key:"customer",label:"Customer"},{key:"business",label:"Business"},{key:"distributor",label:"Distributor"},{key:"delivery-agent",label:"Delivery Agent"}];return a.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #f4f6fb 100%)",fontFamily:"Inter, Arial, sans-serif",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[a.jsx("h2",{style:{fontWeight:700,color:"#2d3748",marginBottom:24,letterSpacing:1,fontSize:32},children:"🔐 Welcome to Medcins"}),s&&a.jsx("button",{style:{position:"absolute",top:20,right:20,background:"#e53e3e",color:"#fff",border:"none",borderRadius:6,padding:"8px 18px",fontWeight:600,cursor:"pointer"},onClick:$r,children:"Logout"}),a.jsx("div",{style:{width:"100%",maxWidth:420,background:"#fff",borderRadius:18,boxShadow:"0 4px 32px #c7d2fe55",padding:36,marginTop:8},children:s?a.jsxs("div",{style:{textAlign:"center"},children:[a.jsxs("p",{style:{fontSize:22,fontWeight:700,color:"#2d3748",marginBottom:8},children:["Welcome, ",s.email," ",s.role?a.jsxs("span",{style:{color:"#6366f1"},children:["(",s.role.replace(/-/g," "),")"]}):""]}),s.role==="medicine-manager"&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{marginBottom:8},children:["Business: ",a.jsx("b",{children:s.businessName})]}),a.jsxs("p",{style:{fontSize:15},children:["🏪 Store link: "," ",a.jsxs("a",{href:`/store/${s.businessSlug}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#6366f1",textDecoration:"underline"},children:["medcins.com/store/",s.businessSlug]})]})]}),s.role==="delivery-agent"&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{marginBottom:8},children:["Delivery Agent: ",a.jsx("b",{children:s.companyName})]}),a.jsxs("p",{style:{fontSize:15},children:["Email: ",s.email]})]})]}):a.jsx(a.Fragment,{children:jn?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{marginBottom:18},children:a.jsx("select",{value:Y,onChange:B=>le(B.target.value),style:{width:"100%",padding:"10px",borderRadius:8,border:"1px solid #cbd5e1",fontSize:16},children:xe.map(B=>a.jsx("option",{value:B.key,children:B.label},B.key))})}),Y==="customer"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#2563eb",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Customer Signup"}),a.jsx("input",{type:"text",placeholder:"Full Name",value:vt,onChange:B=>Ee(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Phone Number",value:qt,onChange:B=>ht(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Address",value:bt,onChange:B=>Qe(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:Ne,onChange:B=>Ze(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:kn,onChange:B=>rn(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:sn,onChange:B=>qe(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:B=>n(B.target.value),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:B=>i(B.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:Pi,style:{padding:"10px 0",background:"#2563eb",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:Re,children:Re?"Getting Location...":"Complete Customer Signup"}),a.jsx("button",{onClick:()=>v(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]}),Fe&&a.jsxs("p",{style:{fontSize:"12px",marginTop:"8px"},children:["📍 Location captured: ",Fe.latitude.toFixed(5),", ",Fe.longitude.toFixed(5)]})]}),Y==="business"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#059669",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Business Signup"}),a.jsx("input",{type:"text",placeholder:"Business Name",value:b,onChange:B=>E(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Business Address",value:T,onChange:B=>V(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"License Number",value:R,onChange:B=>j(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("select",{value:N,onChange:B=>M(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1",background:"#f9f9f9",fontSize:16},children:[a.jsx("option",{value:"",children:"Select State"}),qP.map(B=>a.jsx("option",{value:B,children:B},B))]}),a.jsx("input",{type:"text",placeholder:"City",value:w,onChange:B=>f(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:m,onChange:B=>x(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Phone Number",value:A,onChange:B=>te(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"WhatsApp Number",value:$,onChange:B=>ne(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:B=>n(B.target.value),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:B=>i(B.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:fs,style:{padding:"10px 0",background:"#059669",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:Re,children:Re?"Getting Location...":"Complete Business Signup"}),a.jsx("button",{onClick:()=>v(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]}),Fe&&a.jsxs("p",{style:{fontSize:"12px",marginTop:"8px"},children:["📍 Location captured: ",Fe.latitude.toFixed(5),", ",Fe.longitude.toFixed(5)]})]}),Y==="distributor"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#d97706",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Distributor Signup"}),a.jsx("input",{type:"text",placeholder:"Distributor Name",value:X,onChange:B=>L(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"License Number",value:F,onChange:B=>W(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:H,onChange:B=>Q(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:O,onChange:B=>Z(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:z,onChange:B=>se(B.target.value),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:B=>n(B.target.value),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:B=>i(B.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:Zn,style:{padding:"10px 0",background:"#d97706",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:ke,children:ke?"Getting Location...":"Complete Distributor Signup"}),a.jsx("button",{onClick:()=>v(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]}),Ge&&a.jsxs("p",{style:{fontSize:"12px",marginTop:"8px"},children:["📍 Location captured: ",Ge.latitude.toFixed(5),", ",Ge.longitude.toFixed(5)]})]}),Y==="delivery-agent"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#059669",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Delivery Agent Signup"}),a.jsx("input",{type:"text",placeholder:"Company Name",value:S.companyName,onChange:B=>C(oe=>({...oe,companyName:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Phone Number",value:S.phoneNumber,onChange:B=>C(oe=>({...oe,phoneNumber:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"WhatsApp Phone Number",value:S.whatsappNumber,onChange:B=>C(oe=>({...oe,whatsappNumber:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"RC Number",value:S.rcNumber,onChange:B=>C(oe=>({...oe,rcNumber:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Business Address",value:S.businessAddress,onChange:B=>C(oe=>({...oe,businessAddress:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"State",value:S.state,onChange:B=>C(oe=>({...oe,state:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"City",value:S.city,onChange:B=>C(oe=>({...oe,city:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Nearest Landmark",value:S.landmark,onChange:B=>C(oe=>({...oe,landmark:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Coverage Area",value:S.coverageArea,onChange:B=>C(oe=>({...oe,coverageArea:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Operating Hours (e.g. 8am-6pm)",value:S.operatingHours,onChange:B=>C(oe=>({...oe,operatingHours:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"text",placeholder:"Business Logo Link: Paste logo image URL here",value:S.logoUrl,onChange:B=>C(oe=>({...oe,logoUrl:B.target.value})),style:{margin:"6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"email",placeholder:"Email",value:S.email,onChange:B=>C(oe=>({...oe,email:B.target.value})),style:{margin:"18px 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:B=>i(B.target.value),style:{margin:"0 0 6px 0",padding:"10px",width:"100%",borderRadius:8,border:"1px solid #cbd5e1"}}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("button",{onClick:Wr,style:{padding:"10px 0",background:"#059669",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:16,cursor:"pointer",width:"100%"},disabled:k,children:k?"Signing Up...":"Complete Delivery Agent Signup"}),a.jsx("button",{onClick:()=>v(!1),style:{marginTop:8,width:"100%",background:"#64748b",color:"#fff",border:"none",borderRadius:8,padding:"10px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Back to Login"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h3",{style:{color:"#6366f1",fontWeight:700,marginBottom:18,fontSize:20,letterSpacing:.5},children:"Login"}),a.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:B=>n(B.target.value),style:{margin:"10px 0",padding:"12px",borderRadius:8,border:"1px solid #cbd5e1",width:"100%",fontSize:16}}),a.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:B=>i(B.target.value),style:{margin:"10px 0",padding:"12px",borderRadius:8,border:"1px solid #cbd5e1",width:"100%",fontSize:16}}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:18},children:[a.jsx("button",{onClick:Pn,style:{flex:1,background:"#6366f1",color:"#fff",border:"none",borderRadius:8,padding:"12px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Login"}),a.jsx("button",{onClick:()=>v(!0),style:{flex:1,background:"#2d3748",color:"#fff",border:"none",borderRadius:8,padding:"12px 0",fontWeight:600,fontSize:16,cursor:"pointer"},children:"Sign Up"})]})]})})})]})}const KP=["Abia","Adamawa","Akwa Ibom","Anambra","Bauchi","Bayelsa","Benue","Borno","Cross River","Delta","Ebonyi","Edo","Ekiti","Enugu","FCT","Gombe","Imo","Jigawa","Kaduna","Kano","Katsina","Kebbi","Kogi","Kwara","Lagos","Nasarawa","Niger","Ogun","Ondo","Osun","Oyo","Plateau","Rivers","Sokoto","Taraba","Yobe","Zamfara"];function GP(){const[t,e]=P.useState(!1),{slug:n}=dc(),[r,i]=P.useState(null),[s,o]=P.useState([]),[u,c]=P.useState([]),[d,p]=P.useState(""),[y,_]=P.useState(null),[S,C]=P.useState(null),[k,D]=P.useState(""),b=cn(),E=(N,M,w,f)=>{const m=$=>$*Math.PI/180,R=m(w-N),j=m(f-M),A=Math.sin(R/2)**2+Math.cos(m(N))*Math.cos(m(w))*Math.sin(j/2)**2;return 6371*(2*Math.atan2(Math.sqrt(A),Math.sqrt(1-A)))},T=N=>{const f=N*1.64,m=Math.max(1,Math.round(f/25*60));return{drivingKm:f,minutes:m}};P.useEffect(()=>{if(!navigator.geolocation){C("denied");return}navigator.geolocation.getCurrentPosition(N=>{const M={lat:N.coords.latitude,lng:N.coords.longitude};C(M);const w=b.currentUser;if(w){const f=he(G,"users",w.uid);Rt(f).then(m=>{const x=m.data();x&&x.role==="customer"&&Cn(f,{lat:M.lat,lng:M.lng},{merge:!0})})}},()=>C("denied"))},[b]),P.useEffect(()=>{const N=Bn(b,M=>{i(M)});return()=>N()},[b]),P.useEffect(()=>{const N=yt(we(G,"products"),async M=>{const f=(await Promise.all(M.docs.map(async m=>{var R,j;const x={id:m.id,...m.data()};if(x.ownerId){const A=he(G,"users",x.ownerId),te=await Rt(A);if(te.exists()){const $=te.data();x.businessName=$.businessName||"Unknown Pharmacy",x.ownerSlug=$.slug||null,x.ownerRole=$.role||null,(R=$.location)!=null&&R.latitude&&((j=$.location)!=null&&j.longitude)&&(x.businessLat=$.location.latitude,x.businessLng=$.location.longitude),x.businessState=$.businessState||$.state||""}}return x}))).filter(m=>m.ownerRole!=="distributor");o(f)});return()=>N()},[]),P.useEffect(()=>{if(s.length===0)return;let N=n?s.filter(te=>te.ownerSlug===n):s;k&&(N=N.filter(te=>te.businessState===k));const M={};for(const te of N){const $=(te.normalizedName||te.name||"").toLowerCase().trim();M[$]||(M[$]=[]),M[$].push(te)}const w=Object.values(M).map(te=>(S&&S!=="denied"&&(te=te.map($=>{if($.businessLat&&$.businessLng){const ne=E(S.lat,S.lng,$.businessLat,$.businessLng),{minutes:X}=T(ne);return{...$,minutesAway:X}}return{...$,minutesAway:1/0}}),te.sort(($,ne)=>$.minutesAway-ne.minutesAway)),te)).flat(),f=(te="")=>te.toLowerCase().trim().replace(/\s+/g," "),m={pcm:"paracetamol",flagyl:"metronidazole",vit:"vitamin",ibucap:"ibuprofen",amox:"amoxicillin",diclo:"diclofenac",cipro:"ciprofloxacin",emzor:"paracetamol",fever:"paracetamol antipyretic",pain:"analgesic ibuprofen diclofenac paracetamol",headache:"paracetamol ibuprofen analgesic",infection:"antibiotic amoxicillin ciprofloxacin metronidazole",cough:"cough-suppressant expectorant syrup",cold:"decongestant antihistamine vitamin",flu:"antihistamine decongestant vitamin",malaria:"antimalarial artemether lumefantrine",stomach:"antacid omeprazole metronidazole",ulcer:"omeprazole antacid pantoprazole",diarrhea:"antidiarrheal loperamide",worm:"deworming mebendazole albendazole",allergy:"antihistamine loratadine cetirizine",inflammation:"anti-inflammatory ibuprofen diclofenac",hypertension:"antihypertensive amlodipine lisinopril",diabetes:"metformin insulin antidiabetic"},x=f(d),R=(m[x]||x).split(" "),j=(te,$)=>te.includes($)||$.length>3&&te.startsWith($.slice(0,3))||$.length>3&&te.endsWith($.slice(-3)),A=w.filter(te=>{const $=f(te.name),ne=f(te.ingredient),X=f(te.class);return R.some(L=>$.includes(L)||ne.includes(L)||X.includes(L)||j($,L)||j(ne,L)||j(X,L))});c(A)},[s,S,d,n]);const V=async N=>{if(!r)return alert("Please log in first");let M={...N};if((!M.businessPhone||!M.businessWhatsapp)&&M.ownerId)try{const R=he(G,"users",M.ownerId),j=await Rt(R);if(j.exists()){const A=j.data();M.businessPhone=A.businessPhone||"",M.businessWhatsapp=A.businessWhatsapp||""}}catch{}const w=he(G,"carts",r.uid),f=await Rt(w);let m=f.exists()?f.data().items||[]:[];const x=m.findIndex(R=>R.name===M.name);x>=0?m[x].quantity+=1:m.push({...M,quantity:1}),await Cn(w,{items:m}),_(N.id),e(!0),setTimeout(()=>e(!1),1800),setTimeout(()=>_(null),1e3)};return console.log("Visible medicines:",u.map(N=>N.businessName)),a.jsxs("div",{style:{padding:"30px",position:"relative"},children:[t&&a.jsxs("div",{style:{position:"fixed",top:"30px",right:"30px",background:"#7c3aed",color:"#fff",padding:"12px 24px",borderRadius:"10px",boxShadow:"0 2px 12px rgba(124,58,237,0.15)",fontWeight:"bold",fontSize:"16px",zIndex:2e3,opacity:.97,transition:"opacity 0.3s"},children:["Added to cart! ",a.jsx("a",{href:"/cart",style:{color:"#fff",textDecoration:"underline",marginLeft:10},children:"View Cart"})]}),a.jsxs("h2",{children:["🩺 ",n?`${n}'s Pharmacy`:"Pharmacy Shop"]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,margin:"15px 0"},children:[a.jsx("input",{type:"text",placeholder:"Search medicines, ingredients, or class...",value:d,onChange:N=>p(N.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc"}}),a.jsxs("select",{value:k,onChange:N=>D(N.target.value),style:{padding:"10px",borderRadius:8,border:"1px solid #ccc",fontSize:16,minWidth:180,background:"#f9f9f9",color:"#222",outline:"none"},children:[a.jsx("option",{value:"",children:"Sort by state"}),KP.map(N=>a.jsx("option",{value:N,children:N},N))]})]}),u.length===0?a.jsx("p",{style:{color:"gray"},children:n?"No medicines found for this pharmacy. Please check the link or select a valid business.":"No medicines found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"20px"},children:u.map(N=>a.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"10px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.1)",position:"relative",minHeight:"220px"},children:[N.registeredOnly&&a.jsx("span",{style:{position:"absolute",top:"10px",left:"10px",background:"#7c3aed",color:"#fff",padding:"2px 10px",borderRadius:"8px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",letterSpacing:"1px"},children:"Registered Only"}),N.isPOM&&a.jsx("span",{style:{position:"absolute",top:N.registeredOnly?"38px":"10px",left:"10px",background:"#e53935",color:"#fff",padding:"2px 10px",borderRadius:"8px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",letterSpacing:"1px"},children:"POM"}),N.image&&a.jsx("img",{src:N.image,alt:N.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"10px"}}),a.jsx("strong",{children:N.name||"Unnamed Drug"}),a.jsx("p",{children:a.jsx("em",{children:N.ingredient||"No ingredient listed"})}),a.jsxs("p",{children:["Class: ",N.class||"No class listed"]}),a.jsxs("p",{children:["Price: ₦",N.price!==void 0?N.price:"N/A"]}),a.jsxs("p",{style:{fontSize:"0.9em",color:"#555"},children:["🏥 ",N.ownerSlug?a.jsx("a",{href:`/store/${N.ownerSlug}`,style:{color:"#7c3aed",textDecoration:"underline",cursor:"pointer",fontWeight:500},children:N.businessName&&N.businessName.trim()?N.businessName:"Unknown Pharmacy"}):N.businessName&&N.businessName.trim()?N.businessName:"Unknown Pharmacy"]}),a.jsx("button",{onClick:()=>V(N),style:{marginTop:"10px"},disabled:typeof V!="function",children:"Add to Cart"}),N.minutesAway&&N.minutesAway!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500"},children:N.minutesAway<=1?"📍 Right here":`💨 ~${N.minutesAway} mins away`}),y===N.id&&a.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",background:"#4caf50",color:"#fff",padding:"3px 6px",borderRadius:"4px",fontSize:"12px"},children:"Added!"})]},N.id))})]})}function yE(){const[t,e]=P.useState(null),[n,r]=P.useState([]),[i,s]=P.useState(0),[o,u]=P.useState(!1),[c,d]=P.useState({}),[p,y]=P.useState([]),[_,S]=P.useState(null),C=cn(),k=ls();P.useEffect(()=>{t&&Rt(he(G,"users",t.uid)).then(M=>{M.exists()&&S(M.data())})},[t]),P.useEffect(()=>{const M=Array.from(new Set(n.filter(w=>w.registeredOnly&&w.ownerId).map(w=>w.ownerId)));y(M),u(M.length>0)},[n]);const D=async M=>{M.preventDefault();for(const w of p)await Cn(he(G,"businessRegistrations",`${w}_${t.uid}`),{distributorId:w,businessId:t.uid,businessInfo:_,cart:n.filter(f=>f.ownerId===w),status:"pending",date:new Date().toISOString()});alert("Registration request(s) sent to distributor(s). Await approval before completing your order."),u(!1)};P.useEffect(()=>Bn(C,w=>{e(w),w&&b(w.uid)}),[C]);const b=async M=>{try{const w=he(G,"carts",M),f=await Rt(w);f.exists()?r(f.data().items||[]):r([])}catch(w){console.error("Error loading cart:",w)}},E=async(M,w)=>{try{await Cn(he(G,"carts",M),{items:w})}catch(f){console.error("Error saving cart:",f)}};P.useEffect(()=>{const M=n.reduce((w,f)=>w+f.price*(f.quantity||1),0);s(M)},[n]);const T=M=>{if(!t)return alert("Please login first");const w=[...n],f=w.findIndex(m=>m.name===M.name);f>=0?w[f].quantity+=1:w.push({...M,quantity:1}),r(w),E(t.uid,w)},V=M=>{if(!t)return alert("Please login first");const w=[...n],f=w.findIndex(m=>m.name===M);f>=0&&(w[f].quantity>1?w[f].quantity-=1:w.splice(f,1)),r(w),E(t.uid,w)},N=()=>{if(!t)return alert("Please login to proceed to payment");if(n.length===0)return alert("Cart is empty");k("/payment",{state:{cart:n,total:i}})};return a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:"🛒 Your Cart"}),t?a.jsxs("p",{children:["Logged in as: ",t.email]}):a.jsx("p",{children:"Please log in."}),n.length===0?a.jsx("p",{children:"No items in cart."}):o?a.jsxs("form",{onSubmit:D,style:{background:"#f3f0ff",padding:24,borderRadius:10,margin:"20px 0"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Distributor Registration Required"}),a.jsx("p",{children:"Some items in your cart require registration with the distributor before purchase. Please confirm your business details below for each distributor."}),p.map((M,w)=>a.jsxs("div",{style:{marginBottom:24,padding:16,background:"#fff",borderRadius:8,boxShadow:"0 1px 4px #e0e0e0"},children:[a.jsxs("h4",{style:{color:"#7c3aed"},children:["Distributor ",w+1]}),a.jsxs("label",{children:["Business Name:",a.jsx("br",{}),a.jsx("input",{type:"text",value:(_==null?void 0:_.businessName)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsx("br",{}),a.jsxs("label",{children:["Email:",a.jsx("br",{}),a.jsx("input",{type:"email",value:(_==null?void 0:_.email)||(t==null?void 0:t.email)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsx("br",{}),a.jsxs("label",{children:["Phone:",a.jsx("br",{}),a.jsx("input",{type:"text",value:(_==null?void 0:_.phone)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsx("br",{}),a.jsxs("label",{children:["Address:",a.jsx("br",{}),a.jsx("input",{type:"text",value:(_==null?void 0:_.address)||"",readOnly:!0,style:{width:"100%",marginBottom:8}})]}),a.jsxs("p",{style:{fontSize:14,color:"#555"},children:["Products from this distributor: ",n.filter(f=>f.ownerId===M).map(f=>f.name).join(", ")]})]},M)),a.jsx("button",{type:"submit",style:{background:"#7c3aed",color:"#fff",padding:"10px 24px",borderRadius:6,fontWeight:"bold"},children:"Submit Registration"})]}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{style:{listStyle:"none",padding:0},children:n.map((M,w)=>a.jsxs("li",{style:{margin:"8px 0",display:"flex",alignItems:"center",gap:"10px"},children:[M.image&&a.jsx("img",{src:M.image,alt:M.name,style:{width:"50px",height:"50px",objectFit:"cover",borderRadius:"5px"}}),a.jsxs("div",{children:[a.jsx("strong",{children:M.name})," – ₦",M.price," x ",M.quantity]}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>T(M),style:{marginLeft:"10px"},children:"+"}),a.jsx("button",{onClick:()=>V(M.name),style:{marginLeft:"5px"},children:"-"})]})]},w))}),n.some(M=>M.isPOM)&&a.jsxs("div",{style:{background:"#fff3e0",color:"#b85c00",borderRadius:"6px",padding:"10px 16px",margin:"18px 0 0 0",fontSize:"15px",boxShadow:"0 1px 4px #f5e0c3"},children:[a.jsx("span",{style:{fontWeight:500},children:"Note:"})," After payment, you will be redirected to a medical professional to verify your prescription."]})]}),a.jsxs("h3",{children:["Total: ₦",i]}),!o&&a.jsx("button",{onClick:N,style:{marginTop:"20px"},children:"Checkout"})]})}const QP=t=>{if(!t)return"Unknown date";const e=new Date,n=new Date(t),r=e-n,i=Math.floor(r/1e3);if(i<60)return`${i} seconds ago`;const s=Math.floor(i/60);if(s<60)return`${s} minutes ago`;const o=Math.floor(s/60);if(o<24)return`${o} hours ago`;const u=Math.floor(o/24);return u<7?`${u} day${u>1?"s":""} ago`:n.toLocaleString()};function YP(){const[t,e]=P.useState(null),[n,r]=P.useState([]),[i,s]=P.useState("Pending"),[o,u]=P.useState({}),c=cn();if(P.useEffect(()=>{const C=Bn(c,k=>{if(e(k),k){const D=hr(we(G,"orders"),Jn("userId","==",k.uid)),b=yt(D,E=>{const T=E.docs.map(V=>({id:V.id,...V.data()}));T.sort((V,N)=>new Date(N.date)-new Date(V.date)),r(T)});return()=>b()}});return()=>C()},[c]),!t)return a.jsx("p",{children:"Please log in to view your orders."});const d=async C=>{if(!window.confirm("Are you sure you want to cancel this order?"))return;const D=he(G,"orders",C);await xt(D,{status:"Cancelled"}),alert("✅ Order cancelled and moved to Cancelled tab")},p=C=>{u(k=>({...k,[C]:!k[C]}))},y=C=>C.reduce((k,D)=>k+D.price*(D.quantity||1),0),_=["Pending","Processing","Completed","Cancelled"],S=_.reduce((C,k)=>(k==="Processing"?C[k]=n.filter(D=>{const b=D.status||"Pending";return b==="Processing"||b==="In-Progress"}):C[k]=n.filter(D=>(D.status||"Pending")===k),C),{});return a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:"📦 Your Orders"}),a.jsx("div",{style:{display:"flex",gap:"20px",marginBottom:"20px"},children:_.map(C=>{var k;return a.jsxs("button",{onClick:()=>s(C),style:{padding:"10px 20px",cursor:"pointer",borderRadius:"5px",border:"none",background:i===C?"#007bff":"#eee",color:i===C?"#fff":"#000",fontWeight:i===C?"bold":"normal"},children:[C," (",((k=S[C])==null?void 0:k.length)||0,")"]},C)})}),S[i].length===0?a.jsxs("p",{children:["No ",i.toLowerCase()," orders."]}):S[i].map(C=>{var k;return a.jsxs("div",{style:{marginBottom:"32px",padding:"0",border:"none",borderRadius:"18px",background:"#fff",boxShadow:"0 4px 24px 0 rgba(124,58,237,0.08)",overflow:"hidden",maxWidth:600,marginLeft:"auto",marginRight:"auto",position:"relative"},children:[a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",background:"linear-gradient(90deg, #ede9fe 0%, #f4f6fb 100%)",padding:"20px 28px 12px 28px",borderBottom:"1px solid #e0e7ff",borderTopLeftRadius:18,borderTopRightRadius:18,minHeight:60},children:[a.jsxs("div",{style:{fontWeight:600,color:"#7c3aed",fontSize:17,letterSpacing:.2},children:[a.jsx("span",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:"Order Date:"})," ",QP(C.date)]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2,minWidth:220},children:[a.jsxs("div",{style:{fontSize:"0.97em",marginBottom:2},children:[a.jsx("strong",{style:{color:"#6366f1"},children:"Medicines provided by:"}),C.items&&C.items.length>0?a.jsx("ul",{style:{margin:"4px 0 0 18px",padding:0},children:Array.from(C.items.reduce((D,b)=>{const E=b.businessName||"Unknown",T=b.businessPhone||b.phoneNumber||"N/A",V=b.businessWhatsapp||b.whatsappNumber||"N/A";return D.set(E+"__"+T+"__"+V,{name:E,phone:T,whatsapp:V}),D},new Map).values()).map(({name:D,phone:b,whatsapp:E})=>a.jsxs("li",{style:{margin:0,padding:0,fontSize:15,color:"#222"},children:[D," (",b&&b!=="N/A"?a.jsxs("a",{href:`tel:${b}`,style:{color:"#007bff",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:b}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M3.654 1.328a.678.678 0 0 1 .58-.326h2.222c.27 0 .513.162.608.41l1.013 2.53a.678.678 0 0 1-.145.72l-1.013 1.013a11.42 11.42 0 0 0 4.292 4.292l1.013-1.013a.678.678 0 0 1 .72-.145l2.53 1.013a.678.678 0 0 1 .41.608v2.222a.678.678 0 0 1-.326.58l-2.222 1.333a2.034 2.034 0 0 1-2.03.06c-2.29-1.19-4.13-3.03-5.32-5.32a2.034 2.034 0 0 1 .06-2.03L3.654 1.328z",stroke:"#007bff",strokeWidth:"1.2",fill:"none"})})})]}):a.jsx("span",{children:"N/A"}),", ",E&&E!=="N/A"?a.jsxs("a",{href:`https://wa.me/${E.replace(/[^\d]/g,"")}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#25D366",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:E}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M16 3C9.373 3 4 8.373 4 15c0 2.385.832 4.584 2.236 6.393L4 29l7.828-2.236A11.96 11.96 0 0 0 16 27c6.627 0 12-5.373 12-12S22.627 3 16 3zm0 21.5c-1.77 0-3.45-.46-4.91-1.26l-.35-.2-4.65 1.33 1.33-4.65-.2-.35A8.97 8.97 0 0 1 7 15c0-4.963 4.037-9 9-9s9 4.037 9 9-4.037 9-9 9zm5.07-6.36c-.28-.14-1.65-.81-1.9-.9-.25-.09-.43-.14-.61.14-.18.28-.7.9-.86 1.08-.16.18-.32.2-.6.07-.28-.14-1.18-.44-2.25-1.4-.83-.74-1.39-1.65-1.55-1.93-.16-.28-.02-.43.12-.57.13-.13.28-.32.42-.48.14-.16.18-.28.28-.46.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01-.18 0-.48.07-.73.34-.25.27-.96.94-.96 2.3 0 1.36.98 2.68 1.12 2.87.14.18 1.93 2.95 4.68 4.02.65.28 1.16.45 1.56.58.66.21 1.26.18 1.73.11.53-.08 1.65-.67 1.88-1.32.23-.65.23-1.21.16-1.32-.07-.11-.25-.18-.53-.32z",fill:"#25D366"})})})]}):a.jsx("span",{children:"N/A"}),")"]},D+b+E))}):a.jsx("span",{children:"Unknown"})]}),a.jsxs("span",{style:{fontSize:"0.97em",marginTop:6},children:[a.jsx("strong",{style:{color:"#6366f1"},children:"Delivery agent:"})," ",C.assignedAgentName||C.riderName||C.riderId||C.assignedAgentId||"Not assigned",(C.assignedAgentName||C.riderName||C.riderId||C.assignedAgentId)&&(C.agentPhoneNumber||C.agentWhatsappNumber)&&a.jsxs(a.Fragment,{children:[" (",C.agentPhoneNumber?a.jsxs("a",{href:`tel:${C.agentPhoneNumber}`,style:{color:"#007bff",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:C.agentPhoneNumber}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M3.654 1.328a.678.678 0 0 1 .58-.326h2.222c.27 0 .513.162.608.41l1.013 2.53a.678.678 0 0 1-.145.72l-1.013 1.013a11.42 11.42 0 0 0 4.292 4.292l1.013-1.013a.678.678 0 0 1 .72-.145l2.53 1.013a.678.678 0 0 1 .41.608v2.222a.678.678 0 0 1-.326.58l-2.222 1.333a2.034 2.034 0 0 1-2.03.06c-2.29-1.19-4.13-3.03-5.32-5.32a2.034 2.034 0 0 1 .06-2.03L3.654 1.328z",stroke:"#007bff",strokeWidth:"1.2",fill:"none"})})})]}):a.jsx("span",{children:"N/A"}),", ",C.agentWhatsappNumber?a.jsxs("a",{href:`https://wa.me/${C.agentWhatsappNumber.replace(/[^\d]/g,"")}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#25D366",textDecoration:"underline",display:"inline-flex",alignItems:"center",gap:2},children:[a.jsx("span",{style:{verticalAlign:"middle"},children:C.agentWhatsappNumber}),a.jsx("span",{style:{fontSize:"1em",marginLeft:2,verticalAlign:"middle"},children:a.jsx("svg",{width:"13",height:"13",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline",verticalAlign:"middle"},children:a.jsx("path",{d:"M16 3C9.373 3 4 8.373 4 15c0 2.385.832 4.584 2.236 6.393L4 29l7.828-2.236A11.96 11.96 0 0 0 16 27c6.627 0 12-5.373 12-12S22.627 3 16 3zm0 21.5c-1.77 0-3.45-.46-4.91-1.26l-.35-.2-4.65 1.33 1.33-4.65-.2-.35A8.97 8.97 0 0 1 7 15c0-4.963 4.037-9 9-9s9 4.037 9 9-4.037 9-9 9zm5.07-6.36c-.28-.14-1.65-.81-1.9-.9-.25-.09-.43-.14-.61.14-.18.28-.7.9-.86 1.08-.16.18-.32.2-.6.07-.28-.14-1.18-.44-2.25-1.4-.83-.74-1.39-1.65-1.55-1.93-.16-.28-.02-.43.12-.57.13-.13.28-.32.42-.48.14-.16.18-.28.28-.46.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01-.18 0-.48.07-.73.34-.25.27-.96.94-.96 2.3 0 1.36.98 2.68 1.12 2.87.14.18 1.93 2.95 4.68 4.02.65.28 1.16.45 1.56.58.66.21 1.26.18 1.73.11.53-.08 1.65-.67 1.88-1.32.23-.65.23-1.21.16-1.32-.07-.11-.25-.18-.53-.32z",fill:"#25D366"})})})]}):a.jsx("span",{children:"N/A"}),")"]})]})]})]}),a.jsxs("div",{style:{padding:"18px 28px 18px 28px",background:"#fff"},children:[a.jsx("button",{onClick:()=>p(C.id),style:{padding:"7px 18px",cursor:"pointer",borderRadius:"7px",border:"none",background:o[C.id]?"#ede9fe":"#7c3aed",color:o[C.id]?"#7c3aed":"#fff",fontWeight:600,fontSize:15,marginBottom:10,transition:"all 0.2s",boxShadow:o[C.id]?"0 2px 8px #ede9fe":"none"},children:o[C.id]?"Hide Items":"View Items"}),o[C.id]&&((k=C.items)==null?void 0:k.length)>0&&a.jsx("ul",{style:{marginTop:"10px"},children:C.items.map((D,b)=>a.jsxs("li",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[D.image&&a.jsx("img",{src:D.image,alt:D.name,style:{width:"50px",height:"50px",objectFit:"cover",marginRight:"10px",borderRadius:"5px",border:"1px solid #ccc"}}),a.jsxs("span",{children:[D.name," – ₦",D.price," x ",D.quantity||1]})]},b))}),a.jsxs("p",{style:{marginTop:"10px",fontWeight:600,color:"#7c3aed",fontSize:16},children:[a.jsx("strong",{children:"Total:"})," ₦",y(C.items||[])]}),(C.status||"Pending")==="Pending"&&a.jsx("button",{onClick:()=>d(C.id),style:{marginTop:"10px",padding:"7px 18px",border:"none",borderRadius:"7px",background:"red",color:"#fff",cursor:"pointer",fontWeight:600,fontSize:15},children:"Cancel Order"}),a.jsx("div",{style:{marginTop:18,color:"#6366f1",fontSize:"0.98em",fontWeight:500,textAlign:"center"},children:"You are advised to contact both the pharmacy and the delivery agents to follow up on your order."})]})]},C.id)})]})}function JP(){const[t,e]=P.useState([]),[n,r]=P.useState({code:"",percent:0,removePOM:!1,removeDelivery:!1}),[i,s]=P.useState(null);P.useEffect(()=>{const d=yt(we(G,"coupons"),p=>{e(p.docs.map(y=>({id:y.id,...y.data()})))});return()=>d()},[]);const o=async d=>{if(d.preventDefault(),!n.code)return alert("Coupon code required");i?(await xt(he(G,"coupons",i),n),s(null)):await ns(we(G,"coupons"),n),r({code:"",percent:0,removePOM:!1,removeDelivery:!1})},u=d=>{r({code:d.code,percent:d.percent,removePOM:!!d.removePOM,removeDelivery:!!d.removeDelivery}),s(d.id)},c=async d=>{window.confirm("Delete coupon?")&&await Vn(he(G,"coupons",d))};return a.jsxs("div",{style:{marginTop:30},children:[a.jsx("h3",{children:"🎟 Manage Coupons"}),a.jsxs("form",{onSubmit:o,style:{marginBottom:20},children:[a.jsx("input",{placeholder:"Code",value:n.code,onChange:d=>r({...n,code:d.target.value}),style:{marginRight:10}}),a.jsx("input",{type:"number",placeholder:"% Off",value:n.percent,min:0,max:100,onChange:d=>r({...n,percent:parseInt(d.target.value)}),style:{width:80,marginRight:10}}),a.jsxs("label",{style:{marginRight:10},children:[a.jsx("input",{type:"checkbox",checked:n.removePOM,onChange:d=>r({...n,removePOM:d.target.checked})})," Remove POM Fee"]}),a.jsxs("label",{style:{marginRight:10},children:[a.jsx("input",{type:"checkbox",checked:n.removeDelivery,onChange:d=>r({...n,removeDelivery:d.target.checked})})," Remove Delivery Fee"]}),a.jsx("button",{type:"submit",children:i?"Update":"Create"}),i&&a.jsx("button",{type:"button",onClick:()=>{s(null),r({code:"",percent:0,removePOM:!1,removeDelivery:!1})},children:"Cancel"})]}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Code"}),a.jsx("th",{children:"% Off"}),a.jsx("th",{children:"POM Fee"}),a.jsx("th",{children:"Delivery Fee"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:t.map(d=>a.jsxs("tr",{children:[a.jsx("td",{children:d.code}),a.jsxs("td",{children:[d.percent,"%"]}),a.jsx("td",{children:d.removePOM?"Removed":"-"}),a.jsx("td",{children:d.removeDelivery?"Removed":"-"}),a.jsxs("td",{children:[a.jsx("button",{onClick:()=>u(d),style:{marginRight:5},children:"Edit"}),a.jsx("button",{onClick:()=>c(d.id),children:"Delete"})]})]},d.id))})]})]})}function XP(){const[t,e]=P.useState({companyName:"",phoneNumber:"",whatsappNumber:"",rcNumber:"",businessAddress:"",email:"",coverageArea:"",operatingHours:"",logoUrl:"",slug:"",approved:!1}),[n,r]=P.useState([]),[i,s]=P.useState(null),[o,u]=P.useState({}),[c,d]=P.useState(!1),[p,y]=P.useState("");P.useEffect(()=>{const E=yt(we(G,"deliveryAgents"),T=>{r(T.docs.map(V=>({id:V.id,...V.data()})))});return()=>E()},[]),P.useEffect(()=>{async function E(){const T=hr(we(G,"deliveryAgents"));(await St(T)).forEach(async N=>{typeof N.data().approved>"u"&&await he(G,"deliveryAgents",N.id).update({approved:!1})})}E()},[]);const _=E=>{u({...o,[E.target.name]:E.target.value})},S=E=>{s(E.id),u(E)},C=async E=>{await xt(he(G,"deliveryAgents",E),o),s(null),u({})},k=async E=>{window.confirm("Delete this delivery agent?")&&await Vn(he(G,"deliveryAgents",E))},D=async E=>{d(!0),y(""),await xt(he(G,"deliveryAgents",E),{approved:!0}),d(!1),y("Agent approved and now visible to public.")},b=async E=>{d(!0),y(""),await xt(he(G,"deliveryAgents",E),{approved:!1}),d(!1),y("Agent taken offline and hidden from public.")};return a.jsx(a.Fragment,{children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"24px",marginTop:"32px"},children:[c&&a.jsx("div",{style:{color:"#7c3aed",fontWeight:"bold",marginBottom:16},children:"Processing..."}),p&&a.jsx("div",{style:{color:"#059669",fontWeight:"bold",marginBottom:16},children:p}),n.map(E=>a.jsx("div",{style:{background:"#fff",borderRadius:"10px",boxShadow:"0 1px 8px rgba(0,0,0,0.08)",padding:"18px",minWidth:"260px",maxWidth:"320px",position:"relative"},children:i===E.id?a.jsxs("form",{onSubmit:T=>{T.preventDefault(),C(E.id)},style:{display:"flex",flexDirection:"column",gap:"8px"},children:[a.jsx("input",{id:"edit-companyName",type:"text",name:"companyName",placeholder:"Company Name",value:o.companyName||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-phoneNumber",type:"text",name:"phoneNumber",placeholder:"Phone Number",value:o.phoneNumber||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-whatsappNumber",type:"text",name:"whatsappNumber",placeholder:"WhatsApp Phone Number",value:o.whatsappNumber||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-rcNumber",type:"text",name:"rcNumber",placeholder:"RC Number",value:o.rcNumber||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-businessAddress",type:"text",name:"businessAddress",placeholder:"Business Address",value:o.businessAddress||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-email",type:"email",name:"email",placeholder:"Email Address",value:o.email||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-coverageArea",type:"text",name:"coverageArea",placeholder:"Coverage Area",value:o.coverageArea||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-operatingHours",type:"text",name:"operatingHours",placeholder:"Operating Hours (e.g. 8am-6pm)",value:o.operatingHours||"",onChange:_,required:!0}),a.jsx("input",{id:"edit-logoUrl",type:"url",name:"logoUrl",placeholder:"Business Logo URL (https://...)",value:o.logoUrl||"",onChange:_,required:!0}),a.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"8px"},children:[a.jsx("button",{type:"submit",style:{background:"#1976d2",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",fontWeight:"bold"},children:"Save"}),a.jsx("button",{type:"button",onClick:()=>s(null),style:{background:"#eee",color:"#333",border:"none",borderRadius:"6px",padding:"6px 14px"},children:"Cancel"})]})]}):a.jsxs(Be.Fragment,{children:[a.jsx("img",{src:E.logoUrl,alt:E.companyName,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:10}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:"18px",marginBottom:4},children:E.companyName}),a.jsx("div",{style:{color:"#7c3aed",fontWeight:500,marginBottom:4},children:E.businessAddress}),a.jsxs("div",{children:["RC Number: ",E.rcNumber]}),a.jsxs("div",{children:["Phone: ",E.phoneNumber]}),a.jsxs("div",{children:["WhatsApp: ",E.whatsappNumber]}),a.jsxs("div",{children:["Email: ",E.email]}),a.jsxs("div",{children:["Coverage: ",E.coverageArea]}),a.jsxs("div",{children:["Hours: ",E.operatingHours]}),a.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[a.jsx("button",{onClick:()=>S(E),style:{background:"#1976d2",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",fontWeight:"bold"},children:"Edit"}),a.jsx("button",{onClick:()=>k(E.id),style:{background:"#e53935",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",fontWeight:"bold"},children:"Delete"}),!E.approved&&a.jsx("button",{onClick:()=>D(E.id),style:{background:"#10b981",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",cursor:"pointer"},children:"Approve"}),E.approved&&a.jsx("button",{onClick:()=>b(E.id),style:{background:"#f59e42",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 14px",cursor:"pointer"},children:"Take Offline"})]}),E.approved&&a.jsx("div",{style:{color:"#059669",fontWeight:"bold",marginTop:"8px"},children:"✅ Approved"})]})},E.id))]})})}function ZP(){const[t,e]=P.useState([]);P.useEffect(()=>{(async()=>{try{const Y=await St(we(G,"deliveryAgents"));e(Y.docs.map(le=>({id:le.id,...le.data()})))}catch{e([])}})()},[]);const[n,r]=P.useState({}),i=async(v,Y)=>{try{const le=t.find(B=>B.id===Y),xe=(le==null?void 0:le.userId)||"";await xt(he(G,"orders",v),{riderId:xe,assignedAgentId:xe,assignedAgentName:le?le.companyName||le.name||le.email||le.id:"",status:"In-Progress",assignedAt:new Date().toISOString()}),r(B=>({...B,[v]:!1}))}catch{alert("Failed to reassign order.")}},s=async v=>{if(window.confirm("Are you sure you want to cancel this order?"))try{await xt(he(G,"orders",v.id),{status:"cancelled",cancelledBy:"admin",cancelledAt:new Date().toISOString()})}catch{alert("Failed to cancel order.")}},[o,u]=P.useState({pending:!0,completed:!0,cancelled:!0}),[c,d]=P.useState(""),[p,y]=P.useState(""),[_,S]=P.useState(""),[C,k]=P.useState(""),[D,b]=P.useState({}),[E,T]=P.useState({}),N=window.location.pathname.match(/^\/store\/([^\/]+)/),[M,w]=Be.useState(null);if(P.useEffect(()=>{Gs(async()=>{const{getAuth:v,onAuthStateChanged:Y}=await Promise.resolve().then(()=>mE);return{getAuth:v,onAuthStateChanged:Y}},void 0).then(({getAuth:v,onAuthStateChanged:Y})=>{const le=v();Y(le,async xe=>{if(xe){const{getDoc:B,doc:oe}=await Gs(async()=>{const{getDoc:Ie,doc:Ht}=await Promise.resolve().then(()=>Bp);return{getDoc:Ie,doc:Ht}},void 0),{db:pe}=await Gs(async()=>{const{db:Ie}=await Promise.resolve().then(()=>zP);return{db:Ie}},void 0),ae=await B(oe(pe,"users",xe.uid));w(ae.exists()?ae.data().role:null)}else w(null)})})},[]),N||M==="customer")return a.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#7c3aed"},children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"This page is only for business/admin users. Please use the store features."})]});const[f,m]=P.useState([]);P.useEffect(()=>{const v=yt(we(G,"businessRegistrations"),Y=>{m(Y.docs.map(le=>({id:le.id,...le.data()})))});return()=>v()},[]);const x=async(v,Y)=>{if(await xt(he(G,"businessRegistrations",v.id),{status:Y}),Y==="declined"){const le=hr(we(G,"orders"),Jn("userId","==",v.businessId),Jn("items","array-contains-any",v.cart)),xe=await St(le);for(const B of xe.docs)await xt(he(G,"orders",B.id),{status:"Canceled",canceledReason:"Distributor declined registration"})}alert(`Registration ${Y}`)},[R,j]=P.useState(""),[A,te]=P.useState(""),[$,ne]=P.useState(""),[X,L]=P.useState(""),[F,W]=P.useState(""),H=()=>{let v=Wr;R&&(v=v.filter(ae=>new Date(ae.completedAt||ae.date)>=new Date(R))),A&&(v=v.filter(ae=>new Date(ae.completedAt||ae.date)<=new Date(A))),$&&(v=v.filter(ae=>ae.medicVerifiedBy===$)),X&&(v=v.filter(ae=>ae.items&&ae.items.some(Ie=>Ie.name&&Ie.name.toLowerCase().includes(X.toLowerCase())))),F==="true"&&(v=v.filter(ae=>ae.items&&ae.items.some(Ie=>Ie.isPOM))),F==="false"&&(v=v.filter(ae=>ae.items&&!ae.items.some(Ie=>Ie.isPOM)));const Y=["Order ID","Date","User Email","Medic Verified By","Amount","Products","POM Items"],le=v.map(ae=>[ae.id,new Date(ae.completedAt||ae.date).toLocaleString(),Ye[ae.userId]&&Ye[ae.userId].email?Ye[ae.userId].email:ae.userId,ae.medicVerifiedBy?(Ee.concat(Ze).find(Ie=>Ie.id===ae.medicVerifiedBy)||{}).name||ae.medicVerifiedBy:"",ae.total||Pn(ae.items||[]),ae.items?ae.items.map(Ie=>`${Ie.name} (${Ie.quantity||1})`).join("; "):"",ae.items?ae.items.filter(Ie=>Ie.isPOM).map(Ie=>Ie.name).join("; "):""]),xe=[Y,...le].map(ae=>ae.map(Ie=>`"${String(Ie).replace(/"/g,'""')}"`).join(",")).join(`\r
`),B=new Blob([xe],{type:"text/csv"}),oe=URL.createObjectURL(B),pe=document.createElement("a");pe.href=oe,pe.download=`orders_${Date.now()}.csv`,document.body.appendChild(pe),pe.click(),document.body.removeChild(pe),URL.revokeObjectURL(oe)},[Q,O]=P.useState(""),[Z,z]=P.useState(null),[se,fe]=P.useState(null),[re,be]=P.useState([]),[Oe,_e]=P.useState([]),[je,Fe]=P.useState(""),[De,Re]=P.useState([]),[ye,Ge]=P.useState([]),[ve,ke]=P.useState("products"),[Pe,qt]=P.useState({}),[ht,bt]=P.useState(null),[Qe,vt]=P.useState(!0),[Ee,Ne]=P.useState([]),[Ze,kn]=P.useState([]),[rn,sn]=P.useState(""),[qe,fn]=P.useState("date-desc"),Zn=cn();P.useEffect(()=>{const v=Bn(Zn,async Y=>{if(Y){z(Y);const le=await Rt(he(G,"users",Y.uid));fe(le.exists()?le.data():{role:"customer"})}else z(null),fe(null)});return()=>v()},[Zn]),P.useEffect(()=>{const v=yt(we(G,"products"),le=>be(le.docs.map(xe=>({id:xe.id,...xe.data()})))),Y=yt(we(G,"batches"),le=>{_e(le.docs.map(xe=>({id:xe.id,...xe.data()}))),vt(!1)});return()=>{v(),Y()}},[]),P.useEffect(()=>{if(!se)return;const v=yt(we(G,"users"),Y=>Re(Y.docs.map(le=>({id:le.id,...le.data()}))));return()=>v()},[se]),P.useEffect(()=>{const v=yt(we(G,"orders"),Y=>{const le=Y.docs.map(xe=>({id:xe.id,...xe.data()}));le.sort((xe,B)=>new Date(B.date)-new Date(xe.date)),Ge(le)});return()=>v()},[]);const Ye={};De.forEach(v=>Ye[v.id]=v);const ki=async v=>{if(window.confirm(`Delete medicine: ${v.name}?`))try{await Vn(he(G,"products",v.id))}catch(Y){console.error(Y),alert("Error deleting medicine")}},Br=async v=>{if(window.confirm(`Delete batch: ${v.name}?`))try{for(let Y of v.medicineIds)await Vn(he(G,"products",Y));await Vn(he(G,"batches",v.id))}catch(Y){console.error(Y),alert("Error deleting batch")}},Pi=async(v,Y)=>{try{await xt(he(G,"users",v),{role:Y}),alert("Role updated!")}catch(le){console.error(le),alert("Error updating role")}},zr=v=>qt(Y=>({...Y,[v]:!Y[v]}));P.useEffect(()=>{St(we(G,"verifyMedics")).then(v=>{Ne(v.docs.map(Y=>({id:Y.id,...Y.data(),type:"Prescription Verification"})))}),St(we(G,"consultMedics")).then(v=>{kn(v.docs.map(Y=>({id:Y.id,...Y.data(),type:"Consultation"})))})},[]);const fs=async v=>{var xe;const Y=(xe=v.items)==null?void 0:xe.some(B=>B.isPOM);let le=null;if(Y){if(!Q)return alert("Select a verifying medic before completing POM order.");le=Q}window.confirm("Mark order as completed?")&&(await xt(he(G,"orders",v.id),{status:"Completed",completedBy:Z.uid,completedAt:new Date().toISOString(),medicVerifiedBy:le||null}),alert("✅ Order marked completed"),O(""))},Pn=v=>v.reduce((Y,le)=>Y+le.price*(le.quantity||1),0);if(!Z)return a.jsx("p",{children:"Please log in to access admin."});if(!se)return a.jsx("p",{children:"Loading user data..."});if(se.role!=="admin")return a.jsx("p",{children:"Access denied. Admins only."});if(Qe)return a.jsx("p",{children:"Loading dashboard..."});const $r=ye.filter(v=>v.status==="Processing"||v.status==="In-Progress").filter(v=>{var le,xe;if(!rn)return!0;const Y=rn.toLowerCase();return(((le=Ye[v.userId])==null?void 0:le.email)||v.userId).toLowerCase().includes(Y)||((xe=v.items)==null?void 0:xe.some(B=>B.name.toLowerCase().includes(Y)))}).sort((v,Y)=>qe==="date-desc"?new Date(Y.date)-new Date(v.date):qe==="date-asc"?new Date(v.date)-new Date(Y.date):qe==="amount-desc"?(Y.total||0)-(v.total||0):qe==="amount-asc"?(v.total||0)-(Y.total||0):0),Wr=ye.filter(v=>v.status==="Completed"),jn=Wr.filter(v=>{var le,xe;if(!rn)return!0;const Y=rn.toLowerCase();return(((le=Ye[v.userId])==null?void 0:le.email)||v.userId).toLowerCase().includes(Y)||((xe=v.items)==null?void 0:xe.some(B=>B.name.toLowerCase().includes(Y)))}).sort((v,Y)=>qe==="date-desc"?new Date(Y.completedAt||Y.date)-new Date(v.completedAt||v.date):qe==="date-asc"?new Date(v.completedAt||v.date)-new Date(Y.completedAt||Y.date):qe==="amount-desc"?(Y.total||0)-(v.total||0):qe==="amount-asc"?(v.total||0)-(Y.total||0):0);return a.jsxs("div",{style:{padding:"30px",fontFamily:"sans-serif"},children:[f.length>0&&a.jsxs("div",{style:{background:"#f3f0ff",padding:24,borderRadius:10,marginBottom:30},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Distributor Registration Requests"}),f.map((v,Y)=>{var le,xe,B,oe,pe;return a.jsxs("div",{style:{marginBottom:24,padding:16,background:"#fff",borderRadius:8,boxShadow:"0 1px 4px #e0e0e0"},children:[a.jsxs("h4",{style:{color:"#7c3aed"},children:["Business: ",((le=v.businessInfo)==null?void 0:le.businessName)||v.businessId]}),a.jsxs("p",{children:["Email: ",((xe=v.businessInfo)==null?void 0:xe.email)||""]}),a.jsxs("p",{children:["Phone: ",((B=v.businessInfo)==null?void 0:B.phone)||""]}),a.jsxs("p",{children:["Address: ",((oe=v.businessInfo)==null?void 0:oe.address)||""]}),a.jsxs("p",{children:["Products: ",(pe=v.cart)==null?void 0:pe.map(ae=>ae.name).join(", ")]}),a.jsxs("p",{children:["Status: ",a.jsx("b",{children:v.status})]}),v.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>x(v,"approved"),style:{background:"#27c93f",color:"#fff",padding:"8px 18px",borderRadius:6,fontWeight:"bold",marginRight:10},children:"Approve"}),a.jsx("button",{onClick:()=>x(v,"declined"),style:{background:"#e53935",color:"#fff",padding:"8px 18px",borderRadius:6,fontWeight:"bold"},children:"Decline"})]})]},v.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"20px",margin:"20px 0",justifyContent:"center"},children:[a.jsx("button",{onClick:()=>ke("products"),style:xs(ve==="products"),children:"Manage Products"}),a.jsx("button",{onClick:()=>ke("users"),style:xs(ve==="users"),children:"Manage Users"}),a.jsx("button",{onClick:()=>ke("orders"),style:xs(ve==="orders"),children:"Manage Orders"}),a.jsx("button",{onClick:()=>ke("medics"),style:xs(ve==="medics"),children:"Manage Medics"}),a.jsx("button",{onClick:()=>ke("deliveryagents"),style:xs(ve==="deliveryagents"),children:"Manage DeliveryAgents"}),a.jsx("button",{onClick:()=>ke("coupons"),style:xs(ve==="coupons"),children:"Manage Coupons"})]}),a.jsxs("div",{style:{padding:"0 30px"},children:[a.jsx("h2",{children:"🛠 Admin Dashboard"}),a.jsxs("p",{children:["Logged in as: ",Z.email]}),ve==="deliveryagents"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"🚚 Manage Delivery Agents"}),a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("p",{children:"Here you can add, view, and manage delivery agents for your platform."}),a.jsx(XP,{})]})]})]}),ve==="products"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"📂 CSV Batches"}),a.jsx("input",{type:"text",placeholder:"Search by pharmacy name...",value:je,onChange:v=>Fe(v.target.value),style:{marginBottom:12,padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:260}}),Oe.length===0?a.jsx("p",{children:"No batches yet."}):a.jsxs("table",{style:jd,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Batch Name"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Uploaded By"}),a.jsx("th",{children:"Medicines Count"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:Oe.filter(v=>{var le;return je?(((le=Ye[v.uploadedBy])==null?void 0:le.businessName)||"").toLowerCase().includes(je.toLowerCase()):!0}).map(v=>{var Y,le;return a.jsxs("tr",{style:Nd,children:[a.jsx("td",{children:v.name}),a.jsx("td",{children:new Date(v.date).toLocaleString()}),a.jsx("td",{children:((Y=Ye[v.uploadedBy])==null?void 0:Y.businessName)||v.uploadedBy}),a.jsx("td",{children:((le=v.medicineIds)==null?void 0:le.length)||0}),a.jsx("td",{children:a.jsx("button",{onClick:()=>Br(v),children:"Delete"})})]},v.id)})})]}),a.jsx("h3",{style:{marginTop:"30px"},children:"💊 Medicines"}),a.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("input",{type:"text",placeholder:"Filter by name...",value:c||"",onChange:v=>d(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:160}}),a.jsx("input",{type:"text",placeholder:"Filter by ingredient...",value:p||"",onChange:v=>y(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:160}}),a.jsxs("select",{value:_||"",onChange:v=>S(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:140},children:[a.jsx("option",{value:"",children:"All Classes"}),[...new Set(re.map(v=>v.class).filter(Boolean))].sort().map(v=>a.jsx("option",{value:v,children:v},v))]}),a.jsxs("select",{value:C||"",onChange:v=>k(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:180},children:[a.jsx("option",{value:"",children:"All Pharmacies"}),[...new Set(re.map(v=>v.ownerId).filter(Boolean))].map(v=>{var Y;return a.jsx("option",{value:v,children:((Y=Ye[v])==null?void 0:Y.businessName)||v},v)})]})]}),re.length===0?a.jsx("p",{children:"No medicines yet."}):a.jsxs("table",{style:jd,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Ingredient"}),a.jsx("th",{children:"Class"}),a.jsx("th",{children:"Price (₦)"}),a.jsx("th",{children:"Uploaded By"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:re.filter(v=>{var Y,le;return!(c&&!((Y=v.name)!=null&&Y.toLowerCase().includes(c.toLowerCase()))||p&&!((le=v.ingredient)!=null&&le.toLowerCase().includes(p.toLowerCase()))||_&&v.class!==_||C&&v.ownerId!==C)}).map(v=>{var Y;return a.jsxs("tr",{style:Nd,children:[a.jsx("td",{children:v.name}),a.jsx("td",{children:v.ingredient}),a.jsx("td",{children:v.class}),a.jsx("td",{children:v.price}),a.jsx("td",{children:((Y=Ye[v.ownerId])==null?void 0:Y.businessName)||v.ownerId}),a.jsx("td",{children:a.jsx("button",{onClick:()=>ki(v),children:"Delete"})})]},v.id)})})]})]}),ve==="users"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"👥 All Users"}),De.length===0?a.jsx("p",{children:"No users found."}):a.jsxs("table",{style:jd,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Change Role"}),a.jsx("th",{children:"Activity"})]})}),a.jsx("tbody",{children:De.map(v=>a.jsxs("tr",{style:Nd,children:[a.jsx("td",{children:v.email}),a.jsx("td",{children:v.role}),a.jsx("td",{children:a.jsxs("select",{value:v.role||"customer",onChange:Y=>Pi(v.id,Y.target.value),children:[a.jsx("option",{value:"customer",children:"Customer"}),a.jsx("option",{value:"medicine-manager",children:"Medicine Manager"}),a.jsx("option",{value:"orders-only",children:"Orders Only"}),a.jsx("option",{value:"admin",children:"Admin"})]})}),a.jsx("td",{children:a.jsx("button",{onClick:()=>bt(v),children:"View Details"})})]},v.id))})]}),ht&&a.jsx(ej,{user:ht,medicines:re.filter(v=>v.ownerId===ht.id),orders:ye.filter(v=>v.userId===ht.id),onClose:()=>bt(null)})]}),ve==="orders"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{marginBottom:"18px",border:"1px solid #ddd",borderRadius:8,background:"#fafbfc"},children:[a.jsxs("div",{style:{cursor:"pointer",padding:"14px 18px",fontWeight:"bold",fontSize:18,display:"flex",alignItems:"center",userSelect:"none"},onClick:()=>u(v=>({...v,pending:!v.pending})),children:[a.jsx("span",{style:{marginRight:8},children:o.pending?"▼":"▶"}),"📦 Pending / Processing Orders"]}),o.pending&&a.jsxs("div",{style:{padding:"0 18px 18px 18px"},children:[a.jsxs("div",{style:{margin:"20px 0",display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by user or drug name...",value:rn,onChange:v=>sn(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:220}}),a.jsxs("select",{value:qe,onChange:v=>fn(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"date-desc",children:"Newest First"}),a.jsx("option",{value:"date-asc",children:"Oldest First"}),a.jsx("option",{value:"amount-desc",children:"Highest Amount"}),a.jsx("option",{value:"amount-asc",children:"Lowest Amount"})]}),a.jsx("input",{type:"date",value:R,onChange:v=>j(v.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"date",value:A,onChange:v=>te(v.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:$,onChange:v=>ne(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Medics"}),[...Ee,...Ze].map(v=>a.jsxs("option",{value:v.id,children:[v.name," (",v.profession,")"]},v.id))]}),a.jsx("input",{type:"text",value:X,onChange:v=>L(v.target.value),placeholder:"Product name",style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:F,onChange:v=>W(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Orders"}),a.jsx("option",{value:"true",children:"POM Only"}),a.jsx("option",{value:"false",children:"Non-POM Only"})]}),a.jsx("button",{onClick:H,style:{padding:"8px 18px",borderRadius:6,background:"#007bff",color:"#fff",fontWeight:"bold"},children:"Download CSV"})]}),$r.length===0?a.jsx("p",{children:"No pending orders."}):$r.map(v=>{var xn,Mt,et,ot,fr;const Y=(xn=v.items)==null?void 0:xn.some(me=>me.isPOM),le=v.deliveryInfo?`${v.deliveryInfo.address||""}, ${v.deliveryInfo.city||""}, ${v.deliveryInfo.state||""}`:"N/A",xe=v.deliveryInfo&&v.deliveryInfo.lat?v.deliveryInfo.lat:null,B=v.deliveryInfo&&v.deliveryInfo.lng?v.deliveryInfo.lng:null;let oe="N/A",pe=null,ae=null;if(v.businessId&&Ye[v.businessId]){const me=Ye[v.businessId];oe=`${me.address||""}, ${me.city||""}, ${me.state||""}`,pe=me.lat||null,ae=me.lng||null}const Ie=Pe[v.id]?D[v.id]?v.items:(Mt=v.items)==null?void 0:Mt.slice(0,3):[],Ht=v.items&&v.items.length>3;return a.jsxs("div",{style:Dd,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Delivery Type:"})," ",v.deliveryType?v.deliveryType.charAt(0).toUpperCase()+v.deliveryType.slice(1):"N/A"]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order Date:"})," ",new Date(v.date).toLocaleString()]}),a.jsx("button",{onClick:()=>zr(v.id),children:Pe[v.id]?"Hide Items":"Show Items"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User Email:"})," ",((et=Ye[v.userId])==null?void 0:et.email)||v.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Address:"})," ",!v.deliveryInfo||!v.deliveryInfo.address&&!v.deliveryInfo.city&&!v.deliveryInfo.state?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):le]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Coordinates:"})," ",xe&&B?`${xe}, ${B}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Address:"})," ",oe]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Coordinates:"})," ",pe&&ae?`${pe}, ${ae}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Rider assigned:"})," ",a.jsxs("span",{style:{display:"inline-flex",alignItems:"center"},children:[(()=>{const me=v.riderId||v.assignedAgentId;let at=null;return me&&Ye[me]?(at=Ye[me],`${at.companyName||at.name||at.email||me}${at.phoneNumber||at.whatsappNumber?` (${[at.phoneNumber,at.whatsappNumber].filter(Boolean).join(" / ")})`:""}`):me&&t.length?(at=t.find(ps=>ps.id===me),at?`${at.companyName||at.name||at.id}${at.phoneNumber||at.whatsappNumber?` (${[at.phoneNumber,at.whatsappNumber].filter(Boolean).join(" / ")})`:""}`:me):me||a.jsx("span",{style:{color:"#e53935"},children:"No rider assigned"})})(),a.jsxs("button",{style:{marginLeft:10,background:"none",border:"none",color:"#007bff",cursor:"pointer",display:"inline-flex",alignItems:"center",fontWeight:"bold"},onClick:()=>r(me=>({...me,[v.id]:!me[v.id]})),children:[a.jsx("span",{style:{fontSize:18,marginRight:4},children:"↻"})," reassign order"]}),n[v.id]&&a.jsxs("select",{style:{marginLeft:10,padding:"6px 12px",borderRadius:6},defaultValue:"",onChange:me=>{me.target.value&&i(v.id,me.target.value)},children:[a.jsx("option",{value:"",children:"Select new rider"}),t.map(me=>a.jsxs("option",{value:me.id,children:[me.companyName||me.name||me.email||me.id,me.phoneNumber||me.whatsappNumber?` (${[me.phoneNumber,me.whatsappNumber].filter(Boolean).join(" / ")})`:""]},me.id))]})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Order Status:"})," ",!v.riderId&&!v.assignedAgentId?a.jsx("span",{style:{color:"#e53935"},children:"Processing (no rider accepted)"}):v.status==="cancelled"&&v.cancelledBy==="rider"?a.jsx("span",{style:{color:"#e53935"},children:"Canceled by rider"}):v.deliveredByRider?a.jsx("span",{style:{color:"#27c93f"},children:"Delivered by rider"}):v.status==="Completed"?a.jsx("span",{style:{color:"#27c93f"},children:"Completed (admin)"}):(v.riderId||v.assignedAgentId)&&v.status!=="Completed"&&v.status!=="cancelled"?a.jsx("span",{style:{color:"#007bff"},children:"Progressing (rider accepted)"}):v.status]})]}),Pe[v.id]&&((ot=v.items)==null?void 0:ot.length)>0&&a.jsxs("div",{children:[a.jsx("ul",{style:{maxHeight:D[v.id]?"none":120,overflowY:Ht&&!D[v.id]?"hidden":"auto",marginBottom:4},children:Ie.map((me,at)=>a.jsxs("li",{children:[me.name," - ₦",me.price," x ",me.quantity||1]},at))}),Ht&&a.jsx("button",{style:{fontSize:12,marginBottom:8},onClick:()=>b(me=>({...me,[v.id]:!me[v.id]})),children:D[v.id]?"Show Less":`Show All (${v.items.length})`})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ₦",Pn(v.items||[]),Y&&a.jsx("span",{style:{color:"#e53935",marginLeft:10},children:"[POM]"})]}),Y&&a.jsxs("div",{style:{margin:"10px 0"},children:[a.jsx("label",{children:a.jsx("strong",{children:"Medic Verified By:"})}),a.jsxs("select",{value:Q,onChange:me=>O(me.target.value),style:{marginLeft:10},children:[a.jsx("option",{value:"",children:"Select Medic"}),[...Ee,...Ze].map(me=>a.jsxs("option",{value:me.id,children:[me.name," (",me.profession,") - ",me.type]},me.id))]})]}),a.jsx("button",{onClick:()=>fs(v),children:"Mark as Completed"}),a.jsx("button",{style:{marginLeft:8,background:"#e53935",color:"#fff",borderRadius:6,padding:"6px 14px",border:"none",fontWeight:"bold"},onClick:()=>s(v),children:"Cancel Order"}),v.completedAt&&a.jsxs("p",{style:{fontSize:13,color:"#555",marginTop:6},children:["Completed: ",new Date(v.completedAt).toLocaleString(),a.jsx("br",{}),v.medicVerifiedBy&&a.jsxs("span",{children:["Verified by: ",((fr=Ee.find(me=>me.id===v.medicVerifiedBy))==null?void 0:fr.name)||v.medicVerifiedBy]})]})]},v.id)})]})]}),a.jsxs("div",{style:{marginBottom:"18px",border:"1px solid #ddd",borderRadius:8,background:"#fafbfc"},children:[a.jsxs("div",{style:{cursor:"pointer",padding:"14px 18px",fontWeight:"bold",fontSize:18,display:"flex",alignItems:"center",userSelect:"none"},onClick:()=>u(v=>({...v,completed:!v.completed})),children:[a.jsx("span",{style:{marginRight:8},children:o.completed?"▼":"▶"}),"✅ Completed Orders (You)"]}),o.completed&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{margin:"20px 0",display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by user or drug name...",value:rn,onChange:v=>sn(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:220}}),a.jsxs("select",{value:qe,onChange:v=>fn(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"date-desc",children:"Newest First"}),a.jsx("option",{value:"date-asc",children:"Oldest First"}),a.jsx("option",{value:"amount-desc",children:"Highest Amount"}),a.jsx("option",{value:"amount-asc",children:"Lowest Amount"})]}),a.jsx("input",{type:"date",value:R,onChange:v=>j(v.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"date",value:A,onChange:v=>te(v.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:$,onChange:v=>ne(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Medics"}),[...Ee,...Ze].map(v=>a.jsxs("option",{value:v.id,children:[v.name," (",v.profession,")"]},v.id))]}),a.jsx("input",{type:"text",value:X,onChange:v=>L(v.target.value),placeholder:"Product name",style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:F,onChange:v=>W(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Orders"}),a.jsx("option",{value:"true",children:"POM Only"}),a.jsx("option",{value:"false",children:"Non-POM Only"})]}),a.jsx("button",{onClick:H,style:{padding:"8px 18px",borderRadius:6,background:"#007bff",color:"#fff",fontWeight:"bold"},children:"Download CSV"})]}),jn.length===0?a.jsx("p",{children:"No completed orders found."}):jn.map(v=>{var Ht,xn,Mt,et;const Y=v.deliveryInfo?`${v.deliveryInfo.address||""}, ${v.deliveryInfo.city||""}, ${v.deliveryInfo.state||""}`:"N/A",le=v.deliveryInfo&&v.deliveryInfo.lat?v.deliveryInfo.lat:null,xe=v.deliveryInfo&&v.deliveryInfo.lng?v.deliveryInfo.lng:null;let B="N/A",oe=null,pe=null;if(v.businessId&&Ye[v.businessId]){const ot=Ye[v.businessId];B=`${ot.address||""}, ${ot.city||""}, ${ot.state||""}`,oe=ot.lat||null,pe=ot.lng||null}const ae=Pe[v.id]?E[v.id]?v.items:(Ht=v.items)==null?void 0:Ht.slice(0,3):[],Ie=v.items&&v.items.length>3;return a.jsxs("div",{style:Dd,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Delivery Type:"})," ",v.deliveryType?v.deliveryType.charAt(0).toUpperCase()+v.deliveryType.slice(1):"N/A"]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order Date:"})," ",new Date(v.completedAt||v.date).toLocaleString()]}),a.jsx("button",{onClick:()=>zr(v.id),children:Pe[v.id]?"Hide Details":"Show Details"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User Email:"})," ",((xn=Ye[v.userId])==null?void 0:xn.email)||v.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Address:"})," ",!v.deliveryInfo||!v.deliveryInfo.address&&!v.deliveryInfo.city&&!v.deliveryInfo.state?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):Y]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Coordinates:"})," ",le&&xe?`${le}, ${xe}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Address:"})," ",B]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Coordinates:"})," ",oe&&pe?`${oe}, ${pe}`:"N/A"]}),Pe[v.id]&&((Mt=v.items)==null?void 0:Mt.length)>0&&a.jsxs("div",{children:[a.jsx("ul",{style:{maxHeight:E[v.id]?"none":120,overflowY:Ie&&!E[v.id]?"hidden":"auto",marginBottom:4},children:ae.map((ot,fr)=>a.jsxs("li",{children:[ot.name," - ₦",ot.price," x ",ot.quantity||1]},fr))}),Ie&&a.jsx("button",{style:{fontSize:12,marginBottom:8},onClick:()=>T(ot=>({...ot,[v.id]:!ot[v.id]})),children:E[v.id]?"Show Less":`Show All (${v.items.length})`})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ₦",v.total||Pn(v.items||[])]}),v.medicVerifiedBy&&a.jsxs("p",{children:[a.jsx("strong",{children:"Verified by:"})," ",((et=Ee.concat(Ze).find(ot=>ot.id===v.medicVerifiedBy))==null?void 0:et.name)||v.medicVerifiedBy]}),v.completedAt&&a.jsxs("p",{style:{fontSize:13,color:"#555",marginTop:6},children:["Completed: ",new Date(v.completedAt).toLocaleString()]})]},v.id)})]})]}),a.jsxs("div",{style:{marginBottom:"18px",border:"1px solid #ddd",borderRadius:8,background:"#fafbfc"},children:[a.jsxs("div",{style:{cursor:"pointer",padding:"14px 18px",fontWeight:"bold",fontSize:18,display:"flex",alignItems:"center",userSelect:"none"},onClick:()=>u(v=>({...v,cancelled:!v.cancelled})),children:[a.jsx("span",{style:{marginRight:8},children:o.cancelled?"▼":"▶"}),"❌ Cancelled Orders"]}),o.cancelled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{margin:"20px 0",display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by user or drug name...",value:rn,onChange:v=>sn(v.target.value),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ccc",width:220}}),a.jsxs("select",{value:qe,onChange:v=>fn(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"date-desc",children:"Newest First"}),a.jsx("option",{value:"date-asc",children:"Oldest First"}),a.jsx("option",{value:"amount-desc",children:"Highest Amount"}),a.jsx("option",{value:"amount-asc",children:"Lowest Amount"})]}),a.jsx("input",{type:"date",value:R,onChange:v=>j(v.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"date",value:A,onChange:v=>te(v.target.value),style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:$,onChange:v=>ne(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Medics"}),[...Ee,...Ze].map(v=>a.jsxs("option",{value:v.id,children:[v.name," (",v.profession,")"]},v.id))]}),a.jsx("input",{type:"text",value:X,onChange:v=>L(v.target.value),placeholder:"Product name",style:{padding:"6px 12px",borderRadius:6}}),a.jsxs("select",{value:F,onChange:v=>W(v.target.value),style:{padding:"6px 12px",borderRadius:6},children:[a.jsx("option",{value:"",children:"All Orders"}),a.jsx("option",{value:"true",children:"POM Only"}),a.jsx("option",{value:"false",children:"Non-POM Only"})]}),a.jsx("button",{onClick:H,style:{padding:"8px 18px",borderRadius:6,background:"#007bff",color:"#fff",fontWeight:"bold"},children:"Download CSV"})]}),ye.filter(v=>v.status==="cancelled"&&v.cancelledBy==="admin").length===0?a.jsx("p",{children:"No cancelled orders found."}):ye.filter(v=>v.status==="cancelled"&&v.cancelledBy==="admin").map(v=>{var Ht,xn,Mt;const Y=v.deliveryInfo?`${v.deliveryInfo.address||""}, ${v.deliveryInfo.city||""}, ${v.deliveryInfo.state||""}`:"N/A",le=v.deliveryInfo&&v.deliveryInfo.lat?v.deliveryInfo.lat:null,xe=v.deliveryInfo&&v.deliveryInfo.lng?v.deliveryInfo.lng:null;let B="N/A",oe=null,pe=null;if(v.businessId&&Ye[v.businessId]){const et=Ye[v.businessId];B=`${et.address||""}, ${et.city||""}, ${et.state||""}`,oe=et.lat||null,pe=et.lng||null}const ae=Pe[v.id]?E[v.id]?v.items:(Ht=v.items)==null?void 0:Ht.slice(0,3):[],Ie=v.items&&v.items.length>3;return a.jsxs("div",{style:Dd,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Delivery Type:"})," ",v.deliveryType?v.deliveryType.charAt(0).toUpperCase()+v.deliveryType.slice(1):"N/A"]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order Date:"})," ",new Date(v.cancelledAt||v.date).toLocaleString()]}),a.jsx("button",{onClick:()=>zr(v.id),children:Pe[v.id]?"Hide Details":"Show Details"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User Email:"})," ",((xn=Ye[v.userId])==null?void 0:xn.email)||v.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Address:"})," ",!v.deliveryInfo||!v.deliveryInfo.address&&!v.deliveryInfo.city&&!v.deliveryInfo.state?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):Y]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer Coordinates:"})," ",le&&xe?`${le}, ${xe}`:"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Address:"})," ",B]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Business Coordinates:"})," ",oe&&pe?`${oe}, ${pe}`:"N/A"]}),Pe[v.id]&&((Mt=v.items)==null?void 0:Mt.length)>0&&a.jsxs("div",{children:[a.jsx("ul",{style:{maxHeight:E[v.id]?"none":120,overflowY:Ie&&!E[v.id]?"hidden":"auto",marginBottom:4},children:ae.map((et,ot)=>a.jsxs("li",{children:[et.name," - ₦",et.price," x ",et.quantity||1]},ot))}),Ie&&a.jsx("button",{style:{fontSize:12,marginBottom:8},onClick:()=>T(et=>({...et,[v.id]:!et[v.id]})),children:E[v.id]?"Show Less":`Show All (${v.items.length})`})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ₦",v.total||Pn(v.items||[])]}),v.cancelledAt&&a.jsxs("p",{style:{fontSize:13,color:"#e53935",marginTop:6},children:["Cancelled: ",new Date(v.cancelledAt).toLocaleString()]})]},v.id)})]})]})]}),ve==="medics"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"🩺 Medical Interface Profiles"}),a.jsx(tj,{})]}),ve==="coupons"&&a.jsx(JP,{})]})}const xs=t=>({padding:"10px 20px",border:"none",borderRadius:"5px",cursor:"pointer",background:t?"#007bff":"#eee",color:t?"#fff":"#000",fontWeight:t?"bold":"normal"}),jd={width:"100%",borderCollapse:"collapse",marginBottom:"20px"},Nd={borderBottom:"1px solid #eee"},Dd={marginBottom:"20px",padding:"15px",border:"1px solid #ccc",borderRadius:"10px",background:"#f9f9f9"};function ej({user:t,medicines:e,orders:n,onClose:r}){return a.jsxs("div",{style:{padding:"20px",border:"1px solid #ccc",borderRadius:"10px",marginTop:"20px",background:"#f0f0f0"},children:[a.jsxs("h4",{children:["👤 ",t.email," Details"]}),a.jsx("button",{onClick:r,style:{marginBottom:"10px"},children:"Close"}),a.jsx("h5",{children:"📦 Products"}),e.length===0?a.jsx("p",{children:"No products."}):a.jsx("ul",{children:e.map(i=>a.jsxs("li",{children:[i.name," - ₦",i.price]},i.id))}),a.jsx("h5",{children:"🛒 Purchase History"}),n.length===0?a.jsx("p",{children:"No orders."}):a.jsx("ul",{children:n.map(i=>a.jsxs("li",{children:[i.items.map(s=>s.name).join(", ")," - ₦",i.items.reduce((s,o)=>s+o.price*(o.quantity||1),0)]},i.id))})]})}function tj(){const[t,e]=Be.useState([]),[n,r]=Be.useState([]),[i,s]=Be.useState([]),[o,u]=Be.useState({section:"verify",photo:"",name:"",profession:"",license:"",languages:"",whatsapp:""}),[c,d]=Be.useState(!1),[p,y]=Be.useState(null);Be.useEffect(()=>{(async()=>{const D=await St(we(G,"verifyMedics"));e(D.docs.map(V=>({id:V.id,...V.data()})));const b=await St(we(G,"consultMedics"));r(b.docs.map(V=>({id:V.id,...V.data()})));const E=await St(we(G,"users")),T=[];E.docs.forEach(V=>{const N=V.data();N.role==="medicine-manager"&&N.pharmacist&&T.push({...N.pharmacist,id:V.id,online:!0})}),s(T)})()},[]);const _=async(k,D)=>{await xt(he(G,k==="verify"?"verifyMedics":"consultMedics",D.id),{online:!D.online}),k==="verify"?e(E=>E.map(T=>T.id===D.id?{...T,online:!D.online}:T)):r(E=>E.map(T=>T.id===D.id?{...T,online:!D.online}:T))},S=k=>{u({...o,[k.target.name]:k.target.value})},C=async k=>{k.preventDefault(),d(!0);const D={photo:o.photo,name:o.name,profession:o.profession,license:o.license,pharmacyName:o.pharmacyName,languages:o.languages.split(",").map(E=>E.trim()),whatsapp:o.whatsapp},b=o.section==="verify"?"verifyMedics":"consultMedics";p?await xt(he(G,b,p.id),D):await ns(we(G,b),D),u({section:"verify",photo:"",name:"",profession:"",license:"",pharmacyName:"",languages:"",whatsapp:""}),y(null),d(!1),window.location.reload()};return a.jsxs("div",{style:{padding:24},children:[a.jsxs("form",{onSubmit:C,style:{marginBottom:32,background:"#f7f7f7",padding:16,borderRadius:8},children:[a.jsx("h4",{children:"Add Medic Profile"}),a.jsxs("select",{name:"section",value:o.section,onChange:S,children:[a.jsx("option",{value:"verify",children:"Verify Prescription"}),a.jsx("option",{value:"consult",children:"Get Consultation"})]}),a.jsx("input",{name:"photo",value:o.photo,onChange:S,placeholder:"Photo URL",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"name",value:o.name,onChange:S,placeholder:"Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"profession",value:o.profession,onChange:S,placeholder:"Profession",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"license",value:o.license,onChange:S,placeholder:"License Number",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"pharmacyName",value:o.pharmacyName||"",onChange:S,placeholder:"Pharmacy Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"languages",value:o.languages,onChange:S,placeholder:"Languages (comma separated)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"whatsapp",value:o.whatsapp,onChange:S,placeholder:"WhatsApp Number (e.g. 2348012345678)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("button",{type:"submit",disabled:c,style:{marginTop:10},children:"Add Medic"})]}),a.jsx("h4",{children:"Verify Prescription Medics"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[...t,...i].sort((k,D)=>(D.online===!0)-(k.online===!0)).map(k=>{let D=[];return Array.isArray(k.languages)?D=k.languages:typeof k.languages=="string"&&(D=k.languages.split(",").map(b=>b.trim()).filter(Boolean)),a.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:12,width:220,background:"#fff",position:"relative"},children:[a.jsx("span",{onClick:()=>_("verify",k),title:k.online?"Online":"Offline",style:{position:"absolute",top:8,right:32,width:14,height:14,borderRadius:"50%",background:k.online?"#27c93f":"#bbb",border:"2px solid #fff",boxShadow:"0 0 2px #888",cursor:"pointer"}}),a.jsx("img",{src:k.photo,alt:k.name,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:8}}),a.jsx("div",{children:a.jsx("b",{children:k.name})}),a.jsx("div",{children:k.profession}),a.jsxs("div",{children:["Pharmacy: ",k.pharmacyName||a.jsx("span",{style:{color:"#888"},children:"N/A"})]}),a.jsxs("div",{children:["License: ",k.license]}),a.jsxs("div",{children:["Languages: ",D.join(", ")]}),a.jsx("div",{children:a.jsx("a",{href:`https://wa.me/${k.whatsapp}`,target:"_blank",rel:"noopener noreferrer",children:"Chat on WhatsApp"})}),a.jsx("button",{style:{position:"absolute",bottom:8,right:8,fontSize:12},onClick:()=>{y({id:k.id,section:"verify"}),u({section:"verify",photo:k.photo,name:k.name,profession:k.profession,license:k.license,pharmacyName:k.pharmacyName,languages:Array.isArray(k.languages)?k.languages.join(", "):k.languages,whatsapp:k.whatsapp})},children:"Edit"})]},k.id)})}),a.jsx("h4",{style:{marginTop:24},children:"Consultation Medics"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[...n].sort((k,D)=>(D.online===!0)-(k.online===!0)).map(k=>{let D=[];return Array.isArray(k.languages)?D=k.languages:typeof k.languages=="string"&&(D=k.languages.split(",").map(b=>b.trim()).filter(Boolean)),a.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:12,width:220,background:"#fff",position:"relative"},children:[a.jsx("span",{onClick:()=>_("consult",k),title:k.online?"Online":"Offline",style:{position:"absolute",top:8,right:32,width:14,height:14,borderRadius:"50%",background:k.online?"#27c93f":"#bbb",border:"2px solid #fff",boxShadow:"0 0 2px #888",cursor:"pointer"}}),a.jsx("img",{src:k.photo,alt:k.name,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:8}}),a.jsx("div",{children:a.jsx("b",{children:k.name})}),a.jsx("div",{children:k.profession}),a.jsxs("div",{children:["License: ",k.license]}),a.jsxs("div",{children:["Languages: ",D.join(", ")]}),a.jsx("div",{children:a.jsx("a",{href:`https://wa.me/${k.whatsapp}`,target:"_blank",rel:"noopener noreferrer",children:"Chat on WhatsApp"})}),a.jsx("button",{style:{position:"absolute",bottom:8,right:8,fontSize:12},onClick:()=>{y({id:k.id,section:"consult"}),u({section:"consult",photo:k.photo,name:k.name,profession:k.profession,license:k.license,languages:Array.isArray(k.languages)?k.languages.join(", "):k.languages,whatsapp:k.whatsapp})},children:"Edit"})]},k.id)})})]})}function nj(){const[t,e]=P.useState(!1),n=()=>{if(!(d!=null&&d.pharmacist))return null;const{name:N,photo:M,whatsapp:w}=d.pharmacist;return a.jsxs("button",{onClick:()=>{w&&window.open(`https://wa.me/${w}`,"_blank")},style:{position:"fixed",top:"80px",right:"32px",background:"#fff",color:"#7c3aed",border:"1px solid #7c3aed",borderRadius:"50px",boxShadow:"0 2px 8px rgba(0,0,0,0.10)",padding:"4px 10px 4px 8px",fontWeight:"bold",fontSize:"13px",zIndex:1e3,cursor:"pointer",transition:"box-shadow 0.2s",opacity:.96,display:"flex",alignItems:"center",gap:"6px"},onMouseOver:f=>f.currentTarget.style.boxShadow="0 4px 16px rgba(124,58,237,0.18)",onMouseOut:f=>f.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",children:[M&&a.jsx("img",{src:M,alt:N,style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",marginRight:6}}),"Talk to ",N]})},[r,i]=P.useState(null),[s,o]=P.useState(null),u=cn(),{slug:c}=dc(),[d,p]=P.useState(null),[y,_]=P.useState([]),[S,C]=P.useState([]),[k,D]=P.useState(""),[b,E]=P.useState(null),T=(N,M,w,f)=>{const m=$=>$*Math.PI/180,R=m(w-N),j=m(f-M),A=Math.sin(R/2)**2+Math.cos(m(N))*Math.cos(m(w))*Math.sin(j/2)**2;return 6371*(2*Math.atan2(Math.sqrt(A),Math.sqrt(1-A)))},V=N=>{const f=N*1.64,m=Math.max(1,Math.round(f/25*60));return{drivingKm:f,minutes:m}};return P.useEffect(()=>{const N=Bn(u,M=>{i(M)});return()=>N()},[u]),P.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(N=>E({lat:N.coords.latitude,lng:N.coords.longitude}),()=>E(null))},[]),P.useEffect(()=>{if(!c)return;(async()=>{const M=hr(we(G,"users"),Jn("slug","==",c)),w=await St(M);if(w.empty)console.warn("Business not found for slug:",c),p(null);else{const f=w.docs[0];p({uid:f.id,...f.data()})}})()},[c]),P.useEffect(()=>{if(!d)return;const N=hr(we(G,"products"),Jn("ownerId","==",d.uid)),M=yt(N,w=>{const f=w.docs.map(m=>({id:m.id,...m.data()}));_(f)});return()=>M()},[d]),P.useEffect(()=>{if(!y)return;const N=(x="")=>x.toLowerCase().trim().replace(/\s+/g," "),M={pcm:"paracetamol",flagyl:"metronidazole",vit:"vitamin",ibucap:"ibuprofen",amox:"amoxicillin",diclo:"diclofenac",cipro:"ciprofloxacin",emzor:"paracetamol",fever:"paracetamol antipyretic",pain:"analgesic ibuprofen diclofenac paracetamol",headache:"paracetamol ibuprofen analgesic",infection:"antibiotic amoxicillin ciprofloxacin metronidazole",cough:"cough-suppressant expectorant syrup",cold:"decongestant antihistamine vitamin",flu:"antihistamine decongestant vitamin",malaria:"antimalarial artemether lumefantrine",stomach:"antacid omeprazole metronidazole",ulcer:"omeprazole antacid pantoprazole",diarrhea:"antidiarrheal loperamide",worm:"deworming mebendazole albendazole",allergy:"antihistamine loratadine cetirizine",inflammation:"anti-inflammatory ibuprofen diclofenac",hypertension:"antihypertensive amlodipine lisinopril",diabetes:"metformin insulin antidiabetic"},w=N(k),f=(M[w]||w).split(" "),m=y.map(x=>{var R,j;if(b&&((R=d.location)!=null&&R.latitude)&&((j=d.location)!=null&&j.longitude)){const A=T(b.lat,b.lng,d.location.latitude,d.location.longitude),{minutes:te}=V(A);return{...x,minutesAway:te}}return{...x,minutesAway:1/0}}).filter(x=>{const R=N(x.name),j=N(x.ingredient),A=N(x.class);return f.some(te=>R.includes(te)||j.includes(te)||A.includes(te))}).sort((x,R)=>x.minutesAway-R.minutesAway);C(m)},[y,k,b,d]),a.jsxs("div",{style:{padding:"30px"},children:[t&&a.jsxs("div",{style:{position:"fixed",top:"30px",right:"30px",background:"#7c3aed",color:"#fff",padding:"12px 24px",borderRadius:"10px",boxShadow:"0 2px 12px rgba(124,58,237,0.15)",fontWeight:"bold",fontSize:"16px",zIndex:2e3,opacity:.97,transition:"opacity 0.3s"},children:["Added to cart! ",a.jsx("a",{href:"/cart",style:{color:"#fff",textDecoration:"underline",marginLeft:10},children:"View Cart"})]}),a.jsx(n,{}),a.jsxs("h2",{children:["🩺 ",(d==null?void 0:d.businessName)||"Pharmacy"," Shop"]}),a.jsx("p",{children:"Browse medicines below. Login only required for purchase."}),a.jsx("div",{style:{margin:"15px 0"},children:a.jsx("input",{type:"text",placeholder:"Search by medicine name, ingredient, or class...",value:k,onChange:N=>D(N.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc"}})}),S.length===0?a.jsx("p",{children:"No medicines found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"20px"},children:S.map(N=>a.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"10px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.1)",position:"relative",minHeight:"220px"},children:[N.image&&a.jsx("img",{src:N.image,alt:N.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"10px"}}),a.jsx("strong",{children:N.name||"Unnamed Drug"}),a.jsx("p",{children:a.jsx("em",{children:N.ingredient||"No ingredient listed"})}),a.jsxs("p",{children:["Class: ",N.class||"No class listed"]}),a.jsxs("p",{children:["Price: ₦",N.price!==void 0?N.price:"N/A"]}),a.jsxs("p",{style:{fontSize:"0.9em",color:"#555"},children:["🏥 ",d!=null&&d.businessName&&d.businessName.trim()?d.businessName:"Unknown Pharmacy"]}),a.jsx("button",{onClick:async()=>{if(!r)return alert("Please log in first");const M=he(G,"carts",r.uid),w=await Rt(M);let f=w.exists()?w.data().items||[]:[];const m=f.findIndex(x=>x.name===N.name);m>=0?f[m].quantity+=1:f.push({...N,quantity:1}),await Cn(M,{items:f}),o(N.id),e(!0),setTimeout(()=>e(!1),1800),setTimeout(()=>o(null),1e3)},style:{marginTop:"10px"},children:"Add to Cart"}),s===N.id&&a.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",background:"#4caf50",color:"#fff",padding:"3px 6px",borderRadius:"4px",fontSize:"12px"},children:"Added!"}),N.minutesAway!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500",fontSize:"0.9em"},children:N.minutesAway<=1?"📍 Right here":`💨 ~${N.minutesAway} mins away`})]},N.id))})]})}function rj(){const[t,e]=P.useState([]),[n,r]=P.useState(!0),[i,s]=P.useState("");if(P.useEffect(()=>{async function u(){const c=await St(we(G,"users")),d=[];c.forEach(p=>{const y=p.data();y.role==="medicine-manager"&&y.businessName&&y.slug&&d.push({id:p.id,name:y.businessName,slug:y.slug,image:y.businessImage||null,address:y.businessAddress||"",phone:y.businessPhone||""})}),e(d),r(!1)}u()},[]),n)return a.jsx("div",{style:{textAlign:"center",marginTop:40},children:"Loading stores..."});const o=t.filter(u=>u.name.toLowerCase().includes(i.toLowerCase()));return a.jsxs("div",{style:{padding:"32px"},children:[a.jsx("h2",{style:{textAlign:"center",marginBottom:24},children:"All Stores"}),a.jsx("div",{style:{textAlign:"center",marginBottom:32},children:a.jsx("input",{type:"text",placeholder:"Search by pharmacy name...",value:i,onChange:u=>s(u.target.value),style:{padding:"12px 18px",borderRadius:8,border:"1px solid #e0e7ff",fontSize:16,width:320,maxWidth:"90%",outline:"none",boxShadow:"0 1px 4px #ede9fe",margin:"0 auto"}})}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:32},children:o.map(u=>a.jsxs(on,{to:`/store/${u.slug}`,style:{textDecoration:"none",color:"#222",background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #ede9fe",padding:24,display:"flex",flexDirection:"column",alignItems:"center",transition:"box-shadow 0.2s",border:"1px solid #f3f3f3",minHeight:220},children:[u.image?a.jsx("img",{src:u.image,alt:u.name,style:{width:80,height:80,objectFit:"cover",borderRadius:12,marginBottom:16,border:"1px solid #e0e7ff"}}):a.jsx("div",{style:{width:80,height:80,background:"#ede9fe",borderRadius:12,marginBottom:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:32,color:"#7c3aed"},children:"🏪"}),a.jsx("div",{style:{fontWeight:600,fontSize:20,marginBottom:8},children:u.name}),a.jsx("div",{style:{fontSize:15,color:"#6366f1",marginBottom:6},children:u.address}),a.jsx("div",{style:{fontSize:14,color:"#64748b"},children:u.phone})]},u.id))})]})}function ij(t,e,n,r){const i=p=>p*Math.PI/180,o=i(n-t),u=i(r-e),c=Math.sin(o/2)**2+Math.cos(i(t))*Math.cos(i(n))*Math.sin(u/2)**2;return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function sj(){const[t,e]=P.useState([]),[n,r]=P.useState(null),[i,s]=P.useState(""),o=ls();P.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(d=>r({lat:d.coords.latitude,lng:d.coords.longitude}),()=>r(null))},[]),P.useEffect(()=>{async function d(){const y=(await St(we(G,"users"))).docs.map(_=>({id:_.id,..._.data()})).filter(_=>_.role==="medicine-manager");e(y)}d()},[]);const c=t.map(d=>{let p=1/0;return n&&d.location&&d.location.latitude&&d.location.longitude&&(p=ij(n.lat,n.lng,d.location.latitude,d.location.longitude)),{...d,distance:p}}).sort((d,p)=>d.distance-p.distance).filter(d=>{var p;return(p=d.businessName)==null?void 0:p.toLowerCase().includes(i.toLowerCase())});return a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:"Registered Medicine Retailers"}),a.jsx("p",{style:{color:"#7c3aed",fontWeight:"bold",marginBottom:"10px"},children:t.length>0?`${t.length} businesses found`:"No businesses loaded yet."}),a.jsx("input",{type:"text",placeholder:"Search by business name...",value:i,onChange:d=>s(d.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc",marginBottom:"20px"}}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:"24px"},children:c.map(d=>a.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"12px",padding:"18px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.08)",cursor:d.slug?"pointer":"not-allowed",opacity:d.slug?1:.6,transition:"box-shadow 0.2s"},onClick:()=>d.slug&&o(`/store/${d.slug}`),children:[a.jsx("h3",{style:{marginBottom:"8px",color:"#7c3aed"},children:d.businessName||a.jsx("span",{style:{color:"#e53935"},children:"No name"})}),a.jsx("p",{style:{marginBottom:"6px",color:"#555"},children:d.address||a.jsx("span",{style:{color:"#888"},children:"No address provided"})}),d.distance!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500"},children:d.distance<1?"📍 Very close":`~${d.distance.toFixed(1)} km away`}),a.jsxs("p",{style:{fontSize:"0.9em",color:"#888"},children:["Role: ",d.role||a.jsx("span",{style:{color:"#e53935"},children:"No role"})]}),!d.slug&&a.jsx("p",{style:{color:"#e53935",fontSize:"0.9em",marginTop:"8px"},children:"No store link available"})]},d.id))}),c.length===0&&a.jsxs("p",{style:{color:"gray",marginTop:"30px"},children:["No businesses match your search.",a.jsx("br",{}),t.length===0&&a.jsx("span",{children:"Check if any businesses are registered in Firestore."})]})]})}var vE={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(zE,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,s=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,u={},c=0,d={};function p(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var x=N(m);x.chunkSize=parseInt(x.chunkSize),m.step||m.chunk||(x.chunkSize=null),this._handle=new k(x),(this._handle.streamer=this)._config=x}).call(this,f),this.parseChunk=function(m,x){var R=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<R){let A=this._config.newline;A||(j=this._config.quoteChar||'"',A=this._handle.guessLineEndings(m,j)),m=[...m.split(A).slice(R)].join(A)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&(j=this._config.beforeFirstChunk(m))!==void 0&&(m=j),this.isFirstChunk=!1,this._halted=!1;var R=this._partialLine+m,j=(this._partialLine="",this._handle.parse(R,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(m=j.meta.cursor,R=(this._finished||(this._partialLine=R.substring(m-this._baseIndex),this._baseIndex=m),j&&j.data&&(this._rowCount+=j.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:j,workerId:d.WORKER_ID,finished:R});else if(w(this._config.chunk)&&!x){if(this._config.chunk(j,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=j=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(j.data),this._completeResults.errors=this._completeResults.errors.concat(j.errors),this._completeResults.meta=j.meta),this._completed||!R||!w(this._config.complete)||j&&j.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||j&&j.meta.paused||this._nextChunk(),j}this._halted=!0},this._sendError=function(m){w(this._config.error)?this._config.error(m):o&&this._config.error&&r.postMessage({workerId:d.WORKER_ID,error:m,finished:!1})}}function y(f){var m;(f=f||{}).chunkSize||(f.chunkSize=d.RemoteChunkSize),p.call(this,f),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(x){this._input=x,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),s||(m.onload=M(this._chunkLoaded,this),m.onerror=M(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var x,R=this._config.downloadRequestHeaders;for(x in R)m.setRequestHeader(x,R[x])}var j;this._config.chunkSize&&(j=this._start+this._config.chunkSize-1,m.setRequestHeader("Range","bytes="+this._start+"-"+j));try{m.send(this._config.downloadRequestBody)}catch(A){this._chunkError(A.message)}s&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize||m.responseText.length,this._finished=!this._config.chunkSize||this._start>=(x=>(x=x.getResponseHeader("Content-Range"))!==null?parseInt(x.substring(x.lastIndexOf("/")+1)):-1)(m),this.parseChunk(m.responseText)))},this._chunkError=function(x){x=m.statusText||x,this._sendError(new Error(x))}}function _(f){(f=f||{}).chunkSize||(f.chunkSize=d.LocalChunkSize),p.call(this,f);var m,x,R=typeof FileReader<"u";this.stream=function(j){this._input=j,x=j.slice||j.webkitSlice||j.mozSlice,R?((m=new FileReader).onload=M(this._chunkLoaded,this),m.onerror=M(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input,A=(this._config.chunkSize&&(A=Math.min(this._start+this._config.chunkSize,this._input.size),j=x.call(j,this._start,A)),m.readAsText(j,this._config.encoding));R||this._chunkLoaded({target:{result:A}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(m.error)}}function S(f){var m;p.call(this,f=f||{}),this.stream=function(x){return m=x,this._nextChunk()},this._nextChunk=function(){var x,R;if(!this._finished)return x=this._config.chunkSize,m=x?(R=m.substring(0,x),m.substring(x)):(R=m,""),this._finished=!m,this.parseChunk(R)}}function C(f){p.call(this,f=f||{});var m=[],x=!0,R=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){R&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):x=!0},this._streamData=M(function(j){try{m.push(typeof j=="string"?j:j.toString(this._config.encoding)),x&&(x=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(A){this._streamError(A)}},this),this._streamError=M(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=M(function(){this._streamCleanUp(),R=!0,this._streamData("")},this),this._streamCleanUp=M(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(f){var m,x,R,j,A=Math.pow(2,53),te=-A,$=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ne=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,X=this,L=0,F=0,W=!1,H=!1,Q=[],O={data:[],errors:[],meta:{}};function Z(re){return f.skipEmptyLines==="greedy"?re.join("").trim()==="":re.length===1&&re[0].length===0}function z(){if(O&&R&&(fe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),R=!1),f.skipEmptyLines&&(O.data=O.data.filter(function(je){return!Z(je)})),se()){let je=function(Fe,De){w(f.transformHeader)&&(Fe=f.transformHeader(Fe,De)),Q.push(Fe)};var _e=je;if(O)if(Array.isArray(O.data[0])){for(var re=0;se()&&re<O.data.length;re++)O.data[re].forEach(je);O.data.splice(0,1)}else O.data.forEach(je)}function be(je,Fe){for(var De=f.header?{}:[],Re=0;Re<je.length;Re++){var ye=Re,Ge=je[Re],Ge=((ve,ke)=>(Pe=>(f.dynamicTypingFunction&&f.dynamicTyping[Pe]===void 0&&(f.dynamicTyping[Pe]=f.dynamicTypingFunction(Pe)),(f.dynamicTyping[Pe]||f.dynamicTyping)===!0))(ve)?ke==="true"||ke==="TRUE"||ke!=="false"&&ke!=="FALSE"&&((Pe=>{if($.test(Pe)&&(Pe=parseFloat(Pe),te<Pe&&Pe<A))return 1})(ke)?parseFloat(ke):ne.test(ke)?new Date(ke):ke===""?null:ke):ke)(ye=f.header?Re>=Q.length?"__parsed_extra":Q[Re]:ye,Ge=f.transform?f.transform(Ge,ye):Ge);ye==="__parsed_extra"?(De[ye]=De[ye]||[],De[ye].push(Ge)):De[ye]=Ge}return f.header&&(Re>Q.length?fe("FieldMismatch","TooManyFields","Too many fields: expected "+Q.length+" fields but parsed "+Re,F+Fe):Re<Q.length&&fe("FieldMismatch","TooFewFields","Too few fields: expected "+Q.length+" fields but parsed "+Re,F+Fe)),De}var Oe;O&&(f.header||f.dynamicTyping||f.transform)&&(Oe=1,!O.data.length||Array.isArray(O.data[0])?(O.data=O.data.map(be),Oe=O.data.length):O.data=be(O.data,0),f.header&&O.meta&&(O.meta.fields=Q),F+=Oe)}function se(){return f.header&&Q.length===0}function fe(re,be,Oe,_e){re={type:re,code:be,message:Oe},_e!==void 0&&(re.row=_e),O.errors.push(re)}w(f.step)&&(j=f.step,f.step=function(re){O=re,se()?z():(z(),O.data.length!==0&&(L+=re.data.length,f.preview&&L>f.preview?x.abort():(O.data=O.data[0],j(O,X))))}),this.parse=function(re,be,Oe){var _e=f.quoteChar||'"',_e=(f.newline||(f.newline=this.guessLineEndings(re,_e)),R=!1,f.delimiter?w(f.delimiter)&&(f.delimiter=f.delimiter(re),O.meta.delimiter=f.delimiter):((_e=((je,Fe,De,Re,ye)=>{var Ge,ve,ke,Pe;ye=ye||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var qt=0;qt<ye.length;qt++){for(var ht,bt=ye[qt],Qe=0,vt=0,Ee=0,Ne=(ke=void 0,new b({comments:Re,delimiter:bt,newline:Fe,preview:10}).parse(je)),Ze=0;Ze<Ne.data.length;Ze++)De&&Z(Ne.data[Ze])?Ee++:(ht=Ne.data[Ze].length,vt+=ht,ke===void 0?ke=ht:0<ht&&(Qe+=Math.abs(ht-ke),ke=ht));0<Ne.data.length&&(vt/=Ne.data.length-Ee),(ve===void 0||Qe<=ve)&&(Pe===void 0||Pe<vt)&&1.99<vt&&(ve=Qe,Ge=bt,Pe=vt)}return{successful:!!(f.delimiter=Ge),bestDelimiter:Ge}})(re,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess)).successful?f.delimiter=_e.bestDelimiter:(R=!0,f.delimiter=d.DefaultDelimiter),O.meta.delimiter=f.delimiter),N(f));return f.preview&&f.header&&_e.preview++,m=re,x=new b(_e),O=x.parse(m,be,Oe),z(),W?{meta:{paused:!0}}:O||{meta:{paused:!1}}},this.paused=function(){return W},this.pause=function(){W=!0,x.abort(),m=w(f.chunk)?"":m.substring(x.getCharIndex())},this.resume=function(){X.streamer._halted?(W=!1,X.streamer.parseChunk(m,!0)):setTimeout(X.resume,3)},this.aborted=function(){return H},this.abort=function(){H=!0,x.abort(),O.meta.aborted=!0,w(f.complete)&&f.complete(O),m=""},this.guessLineEndings=function(je,_e){je=je.substring(0,1048576);var _e=new RegExp(D(_e)+"([^]*?)"+D(_e),"gm"),Oe=(je=je.replace(_e,"")).split("\r"),_e=je.split(`
`),je=1<_e.length&&_e[0].length<Oe[0].length;if(Oe.length===1||je)return`
`;for(var Fe=0,De=0;De<Oe.length;De++)Oe[De][0]===`
`&&Fe++;return Fe>=Oe.length/2?`\r
`:"\r"}}function D(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(f){var m=(f=f||{}).delimiter,x=f.newline,R=f.comments,j=f.step,A=f.preview,te=f.fastMode,$=null,ne=!1,X=f.quoteChar==null?'"':f.quoteChar,L=X;if(f.escapeChar!==void 0&&(L=f.escapeChar),(typeof m!="string"||-1<d.BAD_DELIMITERS.indexOf(m))&&(m=","),R===m)throw new Error("Comment character same as delimiter");R===!0?R="#":(typeof R!="string"||-1<d.BAD_DELIMITERS.indexOf(R))&&(R=!1),x!==`
`&&x!=="\r"&&x!==`\r
`&&(x=`
`);var F=0,W=!1;this.parse=function(H,Q,O){if(typeof H!="string")throw new Error("Input must be a string");var Z=H.length,z=m.length,se=x.length,fe=R.length,re=w(j),be=[],Oe=[],_e=[],je=F=0;if(!H)return Qe();if(te||te!==!1&&H.indexOf(X)===-1){for(var Fe=H.split(x),De=0;De<Fe.length;De++){if(_e=Fe[De],F+=_e.length,De!==Fe.length-1)F+=x.length;else if(O)return Qe();if(!R||_e.substring(0,fe)!==R){if(re){if(be=[],Pe(_e.split(m)),vt(),W)return Qe()}else Pe(_e.split(m));if(A&&A<=De)return be=be.slice(0,A),Qe(!0)}}return Qe()}for(var Re=H.indexOf(m,F),ye=H.indexOf(x,F),Ge=new RegExp(D(L)+D(X),"g"),ve=H.indexOf(X,F);;)if(H[F]===X)for(ve=F,F++;;){if((ve=H.indexOf(X,ve+1))===-1)return O||Oe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:be.length,index:F}),ht();if(ve===Z-1)return ht(H.substring(F,ve).replace(Ge,X));if(X===L&&H[ve+1]===L)ve++;else if(X===L||ve===0||H[ve-1]!==L){Re!==-1&&Re<ve+1&&(Re=H.indexOf(m,ve+1));var ke=qt((ye=ye!==-1&&ye<ve+1?H.indexOf(x,ve+1):ye)===-1?Re:Math.min(Re,ye));if(H.substr(ve+1+ke,z)===m){_e.push(H.substring(F,ve).replace(Ge,X)),H[F=ve+1+ke+z]!==X&&(ve=H.indexOf(X,F)),Re=H.indexOf(m,F),ye=H.indexOf(x,F);break}if(ke=qt(ye),H.substring(ve+1+ke,ve+1+ke+se)===x){if(_e.push(H.substring(F,ve).replace(Ge,X)),bt(ve+1+ke+se),Re=H.indexOf(m,F),ve=H.indexOf(X,F),re&&(vt(),W))return Qe();if(A&&be.length>=A)return Qe(!0);break}Oe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:be.length,index:F}),ve++}}else if(R&&_e.length===0&&H.substring(F,F+fe)===R){if(ye===-1)return Qe();F=ye+se,ye=H.indexOf(x,F),Re=H.indexOf(m,F)}else if(Re!==-1&&(Re<ye||ye===-1))_e.push(H.substring(F,Re)),F=Re+z,Re=H.indexOf(m,F);else{if(ye===-1)break;if(_e.push(H.substring(F,ye)),bt(ye+se),re&&(vt(),W))return Qe();if(A&&be.length>=A)return Qe(!0)}return ht();function Pe(Ee){be.push(Ee),je=F}function qt(Ee){var Ne=0;return Ne=Ee!==-1&&(Ee=H.substring(ve+1,Ee))&&Ee.trim()===""?Ee.length:Ne}function ht(Ee){return O||(Ee===void 0&&(Ee=H.substring(F)),_e.push(Ee),F=Z,Pe(_e),re&&vt()),Qe()}function bt(Ee){F=Ee,Pe(_e),_e=[],ye=H.indexOf(x,F)}function Qe(Ee){if(f.header&&!Q&&be.length&&!ne){var Ne=be[0],Ze=Object.create(null),kn=new Set(Ne);let rn=!1;for(let sn=0;sn<Ne.length;sn++){let qe=Ne[sn];if(Ze[qe=w(f.transformHeader)?f.transformHeader(qe,sn):qe]){let fn,Zn=Ze[qe];for(;fn=qe+"_"+Zn,Zn++,kn.has(fn););kn.add(fn),Ne[sn]=fn,Ze[qe]++,rn=!0,($=$===null?{}:$)[fn]=qe}else Ze[qe]=1,Ne[sn]=qe;kn.add(qe)}rn&&console.warn("Duplicate headers found and renamed."),ne=!0}return{data:be,errors:Oe,meta:{delimiter:m,linebreak:x,aborted:W,truncated:!!Ee,cursor:je+(Q||0),renamedHeaders:$}}}function vt(){j(Qe()),be=[],Oe=[]}},this.abort=function(){W=!0},this.getCharIndex=function(){return F}}function E(f){var m=f.data,x=u[m.workerId],R=!1;if(m.error)x.userError(m.error,m.file);else if(m.results&&m.results.data){var j={abort:function(){R=!0,T(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:V,resume:V};if(w(x.userStep)){for(var A=0;A<m.results.data.length&&(x.userStep({data:m.results.data[A],errors:m.results.errors,meta:m.results.meta},j),!R);A++);delete m.results}else w(x.userChunk)&&(x.userChunk(m.results,j,m.file),delete m.results)}m.finished&&!R&&T(m.workerId,m.results)}function T(f,m){var x=u[f];w(x.userComplete)&&x.userComplete(m),x.terminate(),delete u[f]}function V(){throw new Error("Not implemented.")}function N(f){if(typeof f!="object"||f===null)return f;var m,x=Array.isArray(f)?[]:{};for(m in f)x[m]=N(f[m]);return x}function M(f,m){return function(){f.apply(m,arguments)}}function w(f){return typeof f=="function"}return d.parse=function(f,m){var x=(m=m||{}).dynamicTyping||!1;if(w(x)&&(m.dynamicTypingFunction=x,x={}),m.dynamicTyping=x,m.transform=!!w(m.transform)&&m.transform,!m.worker||!d.WORKERS_SUPPORTED)return x=null,d.NODE_STREAM_INPUT,typeof f=="string"?(f=(R=>R.charCodeAt(0)!==65279?R:R.slice(1))(f),x=new(m.download?y:S)(m)):f.readable===!0&&w(f.read)&&w(f.on)?x=new C(m):(r.File&&f instanceof File||f instanceof Object)&&(x=new _(m)),x.stream(f);(x=(()=>{var R;return!!d.WORKERS_SUPPORTED&&(R=(()=>{var j=r.URL||r.webkitURL||null,A=n.toString();return d.BLOB_URL||(d.BLOB_URL=j.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",A,")();"],{type:"text/javascript"})))})(),(R=new r.Worker(R)).onmessage=E,R.id=c++,u[R.id]=R)})()).userStep=m.step,x.userChunk=m.chunk,x.userComplete=m.complete,x.userError=m.error,m.step=w(m.step),m.chunk=w(m.chunk),m.complete=w(m.complete),m.error=w(m.error),delete m.worker,x.postMessage({input:f,config:m,workerId:x.id})},d.unparse=function(f,m){var x=!1,R=!0,j=",",A=`\r
`,te='"',$=te+te,ne=!1,X=null,L=!1,F=((()=>{if(typeof m=="object"){if(typeof m.delimiter!="string"||d.BAD_DELIMITERS.filter(function(Q){return m.delimiter.indexOf(Q)!==-1}).length||(j=m.delimiter),typeof m.quotes!="boolean"&&typeof m.quotes!="function"&&!Array.isArray(m.quotes)||(x=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(ne=m.skipEmptyLines),typeof m.newline=="string"&&(A=m.newline),typeof m.quoteChar=="string"&&(te=m.quoteChar),typeof m.header=="boolean"&&(R=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");X=m.columns}m.escapeChar!==void 0&&($=m.escapeChar+te),m.escapeFormulae instanceof RegExp?L=m.escapeFormulae:typeof m.escapeFormulae=="boolean"&&m.escapeFormulae&&(L=/^[=+\-@\t\r].*$/)}})(),new RegExp(D(te),"g"));if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return W(null,f,ne);if(typeof f[0]=="object")return W(X||Object.keys(f[0]),f,ne)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||X),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),W(f.fields||[],f.data||[],ne);throw new Error("Unable to serialize unrecognized input");function W(Q,O,Z){var z="",se=(typeof Q=="string"&&(Q=JSON.parse(Q)),typeof O=="string"&&(O=JSON.parse(O)),Array.isArray(Q)&&0<Q.length),fe=!Array.isArray(O[0]);if(se&&R){for(var re=0;re<Q.length;re++)0<re&&(z+=j),z+=H(Q[re],re);0<O.length&&(z+=A)}for(var be=0;be<O.length;be++){var Oe=(se?Q:O[be]).length,_e=!1,je=se?Object.keys(O[be]).length===0:O[be].length===0;if(Z&&!se&&(_e=Z==="greedy"?O[be].join("").trim()==="":O[be].length===1&&O[be][0].length===0),Z==="greedy"&&se){for(var Fe=[],De=0;De<Oe;De++){var Re=fe?Q[De]:De;Fe.push(O[be][Re])}_e=Fe.join("").trim()===""}if(!_e){for(var ye=0;ye<Oe;ye++){0<ye&&!je&&(z+=j);var Ge=se&&fe?Q[ye]:ye;z+=H(O[be][Ge],ye)}be<O.length-1&&(!Z||0<Oe&&!je)&&(z+=A)}}return z}function H(Q,O){var Z,z;return Q==null?"":Q.constructor===Date?JSON.stringify(Q).slice(1,25):(z=!1,L&&typeof Q=="string"&&L.test(Q)&&(Q="'"+Q,z=!0),Z=Q.toString().replace(F,$),(z=z||x===!0||typeof x=="function"&&x(Q,O)||Array.isArray(x)&&x[O]||((se,fe)=>{for(var re=0;re<fe.length;re++)if(-1<se.indexOf(fe[re]))return!0;return!1})(Z,d.BAD_DELIMITERS)||-1<Z.indexOf(j)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?te+Z+te:Z)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!s&&!!r.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=b,d.ParserHandle=k,d.NetworkStreamer=y,d.FileStreamer=_,d.StringStreamer=S,d.ReadableStreamStreamer=C,r.jQuery&&((i=r.jQuery).fn.parse=function(f){var m=f.config||{},x=[];return this.each(function(A){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var te=0;te<this.files.length;te++)x.push({file:this.files[te],inputElem:this,instanceConfig:i.extend({},m)})}),R(),this;function R(){if(x.length===0)w(f.complete)&&f.complete();else{var A,te,$,ne,X=x[0];if(w(f.before)){var L=f.before(X.file,X.inputElem);if(typeof L=="object"){if(L.action==="abort")return A="AbortError",te=X.file,$=X.inputElem,ne=L.reason,void(w(f.error)&&f.error({name:A},te,$,ne));if(L.action==="skip")return void j();typeof L.config=="object"&&(X.instanceConfig=i.extend(X.instanceConfig,L.config))}else if(L==="skip")return void j()}var F=X.instanceConfig.complete;X.instanceConfig.complete=function(W){w(F)&&F(W,X.file,X.inputElem),j()},d.parse(X.file,X.instanceConfig)}}function j(){x.splice(0,1),R()}}),o&&(r.onmessage=function(f){f=f.data,d.WORKER_ID===void 0&&f&&(d.WORKER_ID=f.workerId),typeof f.input=="string"?r.postMessage({workerId:d.WORKER_ID,results:d.parse(f.input,f.config),finished:!0}):(r.File&&f.input instanceof File||f.input instanceof Object)&&(f=d.parse(f.input,f.config))&&r.postMessage({workerId:d.WORKER_ID,results:f,finished:!0})}),(y.prototype=Object.create(p.prototype)).constructor=y,(_.prototype=Object.create(p.prototype)).constructor=_,(S.prototype=Object.create(S.prototype)).constructor=S,(C.prototype=Object.create(p.prototype)).constructor=C,d})})(vE);var oj=vE.exports;const _E=_v(oj),Od=["name","ingredient","class","price","image"];function aj(){const[t,e]=P.useState(""),[n,r]=P.useState("add"),s=window.location.pathname.match(/^\/store\/([^\/]+)/),[o,u]=P.useState(null);if(P.useEffect(()=>{Gs(async()=>{const{getAuth:$,onAuthStateChanged:ne}=await Promise.resolve().then(()=>mE);return{getAuth:$,onAuthStateChanged:ne}},void 0).then(({getAuth:$,onAuthStateChanged:ne})=>{const X=$();ne(X,async L=>{if(L){const{getDoc:F,doc:W}=await Gs(async()=>{const{getDoc:Q,doc:O}=await Promise.resolve().then(()=>Bp);return{getDoc:Q,doc:O}},void 0),H=await F(W(G,"users",L.uid));u(H.exists()?H.data().role:null)}else u(null)})})},[]),s||o==="customer")return a.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#7c3aed"},children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"This page is only for business/admin users. Please use the store features."})]});const[c,d]=P.useState(null),[p,y]=P.useState(null),[_,S]=P.useState([]),[C,k]=P.useState({name:"",ingredient:"",class:"",price:"",image:"",isPOM:!1,registeredOnly:!1}),[D,b]=P.useState(null),[E,T]=P.useState([]),[V,N]=P.useState([]),M=_.filter($=>{var X,L,F;const ne=t.toLowerCase();return((X=$.name)==null?void 0:X.toLowerCase().includes(ne))||((L=$.ingredient)==null?void 0:L.toLowerCase().includes(ne))||((F=$.class)==null?void 0:F.toLowerCase().includes(ne))}),w=cn();P.useEffect(()=>{const $=Bn(w,async ne=>{if(ne){d(ne);try{const X=await Rt(he(G,"users",ne.uid));X.exists()?y(X.data()):y({role:"customer"})}catch(X){console.error("Error fetching user doc:",X),y({role:"customer"})}}else d(null),y(null)});return()=>$()},[w]),P.useEffect(()=>{if(!c)return;const $=yt(we(G,"products"),ne=>{const X=ne.docs.map(L=>({id:L.id,...L.data()})).filter(L=>L.ownerId===c.uid);S(X)});return()=>$()},[c]),P.useEffect(()=>{if(!c)return;const $=yt(we(G,"batches"),ne=>{const X=ne.docs.map(L=>({id:L.id,...L.data()})).filter(L=>L.uploadedBy===c.uid);N(X)});return()=>$()},[c]);const f=()=>({ownerSlug:(p==null?void 0:p.slug)||null,businessName:(p==null?void 0:p.businessName)||null}),m=async $=>{if($.preventDefault(),!c)return alert("Please log in first");if(!p)return alert("Loading user data...");const{name:ne,ingredient:X,class:L,price:F,image:W}=C;if(!ne||!X||!L||!F)return alert("Please fill all required fields");const H=parseInt(F,10);if(isNaN(H)||H<0)return alert("Price must be a positive number");const{ownerSlug:Q,businessName:O}=f(),Z=(p==null?void 0:p.pharmacist)||null;try{D?(await xt(he(G,"products",D),{name:ne,ingredient:X,class:L,price:H,image:W||"",ownerSlug:Q||"",businessName:O||"",isPOM:!!C.isPOM,registeredOnly:!!C.registeredOnly,pharmacist:Z||null}),b(null)):await ns(we(G,"products"),{name:ne,ingredient:X,class:L,price:H,image:W||"",ownerId:c.uid,ownerSlug:Q||"",businessName:O||"",isPOM:!!C.isPOM,registeredOnly:!!C.registeredOnly,pharmacist:Z||null}),k({name:"",ingredient:"",class:"",price:"",image:"",isPOM:!1,registeredOnly:!1})}catch(z){console.error(z),alert("Error saving medicine")}},x=$=>{const ne=$.target.files[0];ne&&_E.parse(ne,{header:!0,skipEmptyLines:!0,complete:X=>{const L=X.data.map(F=>{const W={};return Od.forEach(H=>W[H]=F[H]||(H==="price"?0:"N/A")),W});T(L)}})},R=async()=>{if(!E.length)return alert("No CSV data to upload");if(!c)return alert("Please log in first");if(!p)return alert("Loading user data...");const $=he(we(G,"batches")),ne=[],{ownerSlug:X,businessName:L}=f(),F=(p==null?void 0:p.pharmacist)||null;for(let W of E)try{const H=await ns(we(G,"products"),{name:W.name,ingredient:W.ingredient,class:W.class,price:parseInt(W.price,10)||0,image:W.image==="N/A"?"":W.image,batchId:$.id,ownerId:c.uid,ownerSlug:X||"",businessName:L||"",isPOM:!!W.isPOM,pharmacist:F||null});ne.push(H.id)}catch(H){console.error("CSV upload error for row:",W,H)}try{await Cn($,{name:`CSV Upload - ${new Date().toLocaleString()}`,uploadedBy:c.uid,date:new Date().toISOString(),medicineIds:ne})}catch(W){console.error("Failed to create batch doc:",W)}alert(`✅ ${ne.length} medicines uploaded`),T([])},j=$=>{k({name:$.name,ingredient:$.ingredient,class:$.class,price:$.price,image:$.image||"",isPOM:!!$.isPOM}),b($.id),r("add")},A=async $=>{if(window.confirm("Delete this medicine?"))try{await Vn(he(G,"products",$.id))}catch(ne){console.error(ne),alert("Error deleting medicine")}},te=async $=>{if(window.confirm("Delete this batch and its medicines?"))try{for(let ne of $.medicineIds)await Vn(he(G,"products",ne));await Vn(he(G,"batches",$.id))}catch(ne){console.error(ne),alert("Error deleting batch")}};return c?p?p.role!=="medicine-manager"&&p.role!=="admin"?a.jsx("p",{children:"Access denied. Medicine managers only."}):a.jsxs("div",{style:{padding:"30px",maxWidth:"1200px",margin:"auto"},children:[a.jsx("h2",{children:"Medicine Management"}),a.jsxs("p",{children:["Logged in as: ",c.email]}),a.jsxs("div",{style:{display:"flex",marginTop:30,gap:20},children:[a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:n==="add"?"2px solid #1976d2":"1px solid #ccc",background:n==="add"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>r("add"),children:"Add Medicines"}),a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:n==="manage"?"2px solid #1976d2":"1px solid #ccc",background:n==="manage"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>r("manage"),children:"Manage Products"}),a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:n==="pharmacist"?"2px solid #1976d2":"1px solid #ccc",background:n==="pharmacist"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>r("pharmacist"),children:"Pharmacist Management"})]}),a.jsxs("div",{style:{marginTop:30},children:[n==="add"&&a.jsxs("div",{style:{background:"#f8f8ff",padding:"24px",borderRadius:"12px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Add Medicines"}),a.jsxs("form",{onSubmit:m,style:{marginBottom:"20px"},children:[a.jsx("h4",{children:D?"Edit Medicine":"Add Medicine"}),a.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Name",value:C.name,onChange:$=>k({...C,name:$.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"text",placeholder:"Ingredient",value:C.ingredient,onChange:$=>k({...C,ingredient:$.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"text",placeholder:"Class",value:C.class,onChange:$=>k({...C,class:$.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"number",placeholder:"Price (₦)",value:C.price,onChange:$=>k({...C,price:$.target.value}),required:!0,style:{flex:1}}),a.jsx("input",{type:"text",placeholder:"Image URL",value:C.image,onChange:$=>k({...C,image:$.target.value}),style:{flex:1}})]}),a.jsx("div",{style:{marginTop:"10px"},children:a.jsxs("label",{style:{marginRight:"20px"},children:[a.jsx("input",{type:"checkbox",checked:C.isPOM,onChange:$=>k({...C,isPOM:$.target.checked})})," Prescription Only (POM)"]})}),a.jsx("button",{type:"submit",style:{marginTop:"15px",background:"#7c3aed",color:"#fff",padding:"8px 16px",borderRadius:"6px"},children:D?"Update Medicine":"Add Medicine"}),D&&a.jsx("button",{type:"button",style:{marginLeft:"10px"},onClick:()=>{b(null),k({name:"",ingredient:"",class:"",price:"",image:"",isPOM:!1,registeredOnly:!1})},children:"Cancel"})]}),a.jsxs("div",{children:[a.jsx("h4",{children:"Bulk Add Medicines via CSV"}),a.jsx("input",{type:"file",accept:".csv",onChange:x,style:{marginBottom:"10px"}}),E.length>0&&a.jsxs("div",{children:[a.jsx("h5",{children:"CSV Preview"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"10px"},children:[a.jsx("thead",{children:a.jsx("tr",{children:Od.map($=>a.jsx("th",{children:$},$))})}),a.jsx("tbody",{children:E.map(($,ne)=>a.jsx("tr",{children:Od.map(X=>a.jsx("td",{children:$[X]},X))},ne))})]}),a.jsx("button",{onClick:R,style:{background:"#7c3aed",color:"#fff",padding:"8px 16px",borderRadius:"6px"},children:"Upload Medicines"})]})]})]}),n==="manage"&&a.jsxs("div",{style:{background:"#f4f4fa",padding:"24px",borderRadius:"12px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Manage Products"}),a.jsx("h4",{children:"Uploaded CSV Batches"}),V.length===0?a.jsx("p",{children:"No CSV batches uploaded yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Batch Name"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Medicines Count"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:V.map($=>{var ne;return a.jsxs("tr",{children:[a.jsx("td",{children:$.name}),a.jsx("td",{children:new Date($.date).toLocaleString()}),a.jsx("td",{children:((ne=$.medicineIds)==null?void 0:ne.length)||0}),a.jsx("td",{children:a.jsx("button",{onClick:()=>te($),style:{background:"#e53935",color:"#fff",padding:"6px 12px",borderRadius:"6px"},children:"Delete Batch"})})]},$.id)})})]}),a.jsx("h4",{style:{marginTop:"32px"},children:"Your Medicines"}),a.jsx("input",{type:"text",placeholder:"Search by name, ingredient, or class...",style:{width:"100%",marginBottom:16,padding:8,borderRadius:6,border:"1px solid #ccc"},value:t,onChange:$=>e($.target.value)}),M.length===0?a.jsx("p",{children:"No medicines found."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{borderBottom:"1px solid #ccc"},children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Ingredient"}),a.jsx("th",{children:"Class"}),a.jsx("th",{children:"Price (₦)"}),a.jsx("th",{children:"POM"}),a.jsx("th",{children:"Image"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:M.map($=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{children:$.name}),a.jsx("td",{children:$.ingredient}),a.jsx("td",{children:$.class}),a.jsx("td",{children:$.price}),a.jsx("td",{children:$.isPOM?a.jsx("span",{style:{background:"#e53935",color:"#fff",padding:"2px 8px",borderRadius:"6px",fontSize:"12px"},children:"POM"}):null}),a.jsx("td",{children:$.image&&a.jsx("img",{src:$.image,alt:$.name,style:{width:"50px",height:"50px",objectFit:"cover"}})}),a.jsxs("td",{children:[a.jsx("button",{onClick:()=>j($),style:{marginRight:"5px"},children:"Edit"}),a.jsx("button",{onClick:()=>A($),children:"Delete"})]})]},$.id))})]})]}),n==="pharmacist"&&a.jsxs("div",{style:{background:"#f8f8ff",padding:"24px",borderRadius:"12px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Pharmacist Management"}),(p==null?void 0:p.role)==="medicine-manager"&&a.jsx(lj,{userId:c.uid})]})]})]}):a.jsx("p",{children:"Loading user data..."}):a.jsx("p",{children:"Please log in to access this page."})}function lj({userId:t}){const[e,n]=Be.useState(null),[r,i]=Be.useState({photo:"",name:"",profession:"Pharmacist",license:"",pharmacyName:"",languages:"",whatsapp:""}),[s,o]=Be.useState(!1),[u,c]=Be.useState(!1);Be.useEffect(()=>{const y=he(G,"users",t);Rt(y).then(_=>{const S=_.data();S&&S.pharmacist&&(n(S.pharmacist),i({...S.pharmacist}),o(!0))})},[t]);const d=y=>{i({...r,[y.target.name]:y.target.value})},p=async y=>{y.preventDefault(),c(!0),await xt(he(G,"users",t),{pharmacist:{...r}}),n({...r}),o(!0),c(!1),alert("Pharmacist info saved!")};return a.jsxs("div",{style:{marginTop:40,background:"#f7f7f7",padding:24,borderRadius:10},children:[a.jsx("h3",{style:{color:"#7c3aed"},children:"Manage Pharmacist"}),a.jsxs("form",{onSubmit:p,style:{marginBottom:16},children:[a.jsx("input",{name:"photo",value:r.photo,onChange:d,placeholder:"Photo URL",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"name",value:r.name,onChange:d,placeholder:"Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"profession",value:r.profession,onChange:d,placeholder:"Profession",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"license",value:r.license,onChange:d,placeholder:"License Number",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"pharmacyName",value:r.pharmacyName,onChange:d,placeholder:"Pharmacy Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"languages",value:r.languages,onChange:d,placeholder:"Languages (comma separated)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"whatsapp",value:r.whatsapp,onChange:d,placeholder:"WhatsApp Number (e.g. 2348012345678)",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("button",{type:"submit",disabled:u,style:{marginTop:10},children:s?"Update Pharmacist":"Add Pharmacist"})]}),e&&a.jsxs("div",{style:{marginTop:16,background:"#fff",padding:16,borderRadius:8,boxShadow:"0 1px 4px #e0e0e0"},children:[a.jsx("img",{src:e.photo,alt:e.name,style:{width:60,height:60,borderRadius:"50%",objectFit:"cover",marginBottom:8}}),a.jsx("div",{children:a.jsx("b",{children:e.name})}),a.jsx("div",{children:e.profession}),a.jsxs("div",{children:["Pharmacy: ",e.pharmacyName]}),a.jsxs("div",{children:["License: ",e.license]}),a.jsxs("div",{children:["Languages: ",e.languages]}),a.jsx("div",{children:a.jsx("a",{href:`https://wa.me/${e.whatsapp}`,target:"_blank",rel:"noopener noreferrer",children:"Chat on WhatsApp"})})]})]})}var Na=function(){return Na=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Na.apply(this,arguments)};function Yp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}var Vl=[];function uj(){var t="https://js.paystack.co/v1/inline.js",e=P.useState({loaded:!1,error:!1}),n=e[0],r=e[1];return P.useEffect(function(){if(Vl.includes(t))r({loaded:!0,error:!1});else{Vl.push(t);var i=document.createElement("script");i.src=t,i.async=!0;var s=function(){r({loaded:!0,error:!1})},o=function(){var u=Vl.indexOf(t);u>=0&&Vl.splice(u,1),i.remove(),r({loaded:!0,error:!0})};return i.addEventListener("load",s),i.addEventListener("complete",s),i.addEventListener("error",o),document.body.appendChild(i),function(){i.removeEventListener("load",s),i.removeEventListener("error",o)}}},[t]),[n.loaded,n.error]}var cj=function(t){var e=window.PaystackPop&&window.PaystackPop.setup(t);e&&e.openIframe()};function xE(t){var e=uj(),n=e[0],r=e[1];function i(s){var o=s.config,u=s.onSuccess,c=s.onClose;if(r)throw new Error("Unable to load paystack inline script");var d=Na(Na({},t),o),p=d.publicKey,y=d.firstname,_=d.lastname,S=d.phone,C=d.email,k=d.amount,D=d.reference,b=d.metadata,E=b===void 0?{}:b,T=d.currency,V=T===void 0?"NGN":T,N=d.channels,M=d.label,w=M===void 0?"":M,f=d.plan,m=f===void 0?"":f,x=d.quantity,R=x===void 0?"":x,j=d.subaccount,A=j===void 0?"":j,te=d.transaction_charge,$=te===void 0?0:te,ne=d.bearer,X=ne===void 0?"account":ne,L=d.split,F=d.split_code;if(n){var W={callback:u||function(){return null},onClose:c||function(){return null},key:p,ref:D,email:C,firstname:y,lastname:_,phone:S,amount:k,currency:V,plan:m,quantity:R,channels:N,subaccount:A,transaction_charge:$,bearer:X,label:w,metadata:E,split:L,split_code:F,"data-custom-button":d["data-custom-button"]||""};cj(W)}}return P.useEffect(function(){if(r)throw new Error("Unable to load paystack inline script")},[r]),i}var dj=function(t){var e=t.text,n=t.className,r=t.children,i=t.onSuccess,s=t.onClose,o=Yp(t,["text","className","children","onSuccess","onClose"]),u=xE(o);return Be.createElement("button",{className:n,onClick:function(){return u({config:o,onSuccess:i,onClose:s})}},e||r)},wE=P.createContext({config:{},initializePayment:function(){return null},onSuccess:function(){return null},onClose:function(){return null}}),hj=function(t){var e=t.children,n=t.onSuccess,r=t.onClose,i=Yp(t,["children","onSuccess","onClose"]),s=xE(i);return Be.createElement(wE.Provider,{value:{config:i,initializePayment:s,onSuccess:n,onClose:r}},e)},fj=function(t){var e=t.children,n=t.ref,r=P.useContext(wE),i=r.config,s=r.initializePayment,o=r.onSuccess,u=r.onClose,c=function(){return s({config:i,onSuccess:o,onClose:u})};return e({initializePayment:c,ref:n})};P.forwardRef(function(t,e){var n=t.children,r=t.onSuccess,i=t.onClose,s=Yp(t,["children","onSuccess","onClose"]),o=r||function(){return null},u=i||function(){return null};return Be.createElement(hj,Na({},s,{onSuccess:o,onClose:u}),Be.createElement(fj,{ref:e},n))});async function pj(t){if(!t)return null;const e=hr(we(G,"coupons"),Jn("code","==",t)),n=await St(e);return n.empty?null:n.docs[0].data()}function gj(){var X,L;const[t,e]=P.useState(""),[n,r]=P.useState(null),[i,s]=P.useState(""),o=cn(),u=ls(),c=po(),[d,p]=P.useState(null),[y,_]=P.useState(((X=c.state)==null?void 0:X.cart)||[]),[S,C]=P.useState(((L=c.state)==null?void 0:L.total)||0),[k,D]=P.useState("standard"),[b,E]=P.useState(500),[T,V]=P.useState(1e3),[N,M]=P.useState(S+b),[w,f]=P.useState({name:"",phone:"",address:"",city:"",state:"",instructions:""}),m="pk_live_2d4df84806ccc14243f39a9df0bb0a38373ffcc8";P.useEffect(()=>Bn(o,async W=>{if(!W)return u("/auth");if(p(W),y.length===0){const H=he(G,"carts",W.uid),Q=await Rt(H);if(Q.exists()){const O=Q.data().items||[];_(O);const Z=O.reduce((z,se)=>z+se.price*(se.quantity||1),0);C(Z),M(Z+b)}}}),[o,y.length,b,u]),P.useEffect(()=>{let F=y.some(O=>O.isPOM)?500:0,W=b,H=S,Q=0;n&&(n.removePOM&&(F=0),n.removeDelivery&&(W=0),n.percent>0&&(Q=Math.round((H+F+W)*(n.percent/100)))),V(F),M(H+F+W-Q)},[S,b,y,n]),P.useEffect(()=>{E(k==="standard"?500:3e3)},[k]);const x=async()=>{s("");const F=await pj(t.trim().toUpperCase());F?(r(F),s("")):(r(null),s("Invalid coupon code"))},R=()=>["name","phone","address","city","state"].every(W=>{var H;return(H=w[W])==null?void 0:H.trim()}),j={reference:new Date().getTime().toString(),email:d==null?void 0:d.email,amount:N*100,publicKey:m},A=async F=>{if(!d||y.length===0)return;const W=he(we(G,"orders"));await Cn(W,{userId:d.uid,items:y,subtotal:S,deliveryFee:b,pomFee:T,total:N,status:"Processing",date:new Date().toISOString(),paymentReference:(F==null?void 0:F.reference)||"COUPON_FREE",deliveryInfo:w,coupon:n||null,deliveryType:k}),await Cn(he(G,"carts",d.uid),{items:[]}),_([]),C(0),M(0),alert("✅ Payment successful! Order created."),y.some(H=>H.isPOM)?u("/medinterface"):u("/orders")},te=()=>{alert("Payment cancelled.")},$=F=>{f({...w,[F.target.name]:F.target.value})},ne=()=>{alert("⚠️ Please complete all delivery information before proceeding.")};return d?a.jsxs("div",{style:{padding:"30px",maxWidth:"600px",margin:"auto"},children:[a.jsx("h2",{children:"💳 Checkout"}),y.length===0?a.jsx("p",{children:"No items in cart."}):a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"🛒 Order Summary"}),a.jsx("ul",{style:{listStyle:"none",padding:0},children:y.map((F,W)=>a.jsxs("li",{style:{marginBottom:"8px"},children:[F.name," – ₦",F.price," x ",F.quantity||1," = ₦",F.price*(F.quantity||1)]},W))}),a.jsxs("p",{children:["Subtotal: ₦",S]}),a.jsxs("div",{style:{marginBottom:10},children:[a.jsx("label",{style:{fontWeight:500},children:"Delivery Type:"}),a.jsxs("select",{value:k,onChange:F=>D(F.target.value),style:{marginLeft:10,padding:"6px",borderRadius:"5px"},children:[a.jsx("option",{value:"standard",children:"Standard Delivery (1-2 days) - ₦500"}),a.jsx("option",{value:"express",children:"Express Delivery (30mins-3hrs) - ₦3000"})]})]}),a.jsxs("p",{children:["Delivery Fee: ₦",n!=null&&n.removeDelivery?0:b]}),a.jsxs("p",{style:{color:T>0?"#e53935":void 0,fontWeight:T>0?500:void 0},children:["POM Fee: ₦",n!=null&&n.removePOM?0:T]}),(n==null?void 0:n.percent)>0&&a.jsxs("p",{style:{color:"#007bff"},children:["Discount: -₦",Math.round((S+T+(n!=null&&n.removeDelivery?0:b))*(n.percent/100))]}),a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("input",{type:"text",placeholder:"Coupon code",value:t,onChange:F=>e(F.target.value),style:{marginRight:10}}),a.jsx("button",{type:"button",onClick:x,children:"Apply Coupon"}),i&&a.jsx("span",{style:{color:"#e53935",marginLeft:10},children:i}),n&&a.jsxs("span",{style:{color:"#007bff",marginLeft:10},children:["Applied: ",n.code," (",n.percent,"% off",n.removePOM?", no POM fee":"",n.removeDelivery?", no delivery fee":"",")"]})]}),a.jsx("p",{children:a.jsxs("strong",{children:["Grand Total: ₦",N]})}),a.jsx("h3",{children:"📍 Delivery Information"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsx("input",{type:"text",name:"name",placeholder:"Full Name",value:w.name,onChange:$}),a.jsx("input",{type:"text",name:"phone",placeholder:"Phone Number",value:w.phone,onChange:$}),a.jsx("input",{type:"text",name:"address",placeholder:"Street Address",value:w.address,onChange:$}),a.jsx("input",{type:"text",name:"city",placeholder:"City",value:w.city,onChange:$}),a.jsx("input",{type:"text",name:"state",placeholder:"State",value:w.state,onChange:$}),a.jsx("textarea",{name:"instructions",placeholder:"Delivery Instructions (optional)",value:w.instructions,onChange:$})]}),R()?N>0?a.jsx(dj,{text:"Pay Now 💳",className:"paystack-button",...j,callback:A,close:te,style:{marginTop:"20px"}}):a.jsx("button",{onClick:()=>A({reference:"COUPON_FREE"}),style:{marginTop:"20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",padding:"10px 20px",fontWeight:"bold"},children:"Complete Order (Free)"}):a.jsx("button",{onClick:ne,style:{marginTop:"20px",cursor:"not-allowed"},children:"Pay Now 💳"})]})]}):a.jsx("p",{children:"Loading..."})}function mj(){const{slug:t}=dc();return a.jsxs("div",{children:[a.jsxs("h2",{children:["Cart for ",t||"this store"]}),a.jsx(yE,{storeSlug:t})]})}const yj=(t,e,n,r)=>{const i=p=>p*Math.PI/180,o=i(n-t),u=i(r-e),c=Math.sin(o/2)**2+Math.cos(i(t))*Math.cos(i(n))*Math.sin(u/2)**2;return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},vj=t=>{const r=t*1.64,i=Math.max(1,Math.round(r/25*60));return{drivingKm:r,minutes:i}},gv=["admin","medicine-manager","distributor"],mv=["admin","distributor"];function _j(){const[t,e]=P.useState(null),[n,r]=P.useState(null),[i,s]=P.useState("shop"),[o,u]=P.useState([]),[c,d]=P.useState([]),[p,y]=P.useState(""),[_,S]=P.useState(null),[C,k]=P.useState(null);P.useEffect(()=>{if(!navigator.geolocation){S("denied");return}navigator.geolocation.getCurrentPosition(T=>S({lat:T.coords.latitude,lng:T.coords.longitude}),()=>S("denied"))},[]),P.useEffect(()=>{const T=yt(we(G,"products"),async V=>{const N=await Promise.all(V.docs.map(async M=>{var f,m;const w={id:M.id,...M.data()};if(w.ownerId){const x=he(G,"users",w.ownerId),R=await Rt(x);if(R.exists()){const j=R.data();w.businessName=j.businessName||"Unknown Distributor",w.ownerSlug=j.slug||null,w.ownerRole=j.role||null,(f=j.location)!=null&&f.latitude&&((m=j.location)!=null&&m.longitude)&&(w.businessLat=j.location.latitude,w.businessLng=j.location.longitude)}}return w}));u(N.filter(M=>M.ownerRole==="distributor"))});return()=>T()},[]),P.useEffect(()=>{if(o.length===0)return;let T=o;if(p.trim()){const V=p.toLowerCase();T=o.filter(N=>N.name&&N.name.toLowerCase().includes(V)||N.ingredient&&N.ingredient.toLowerCase().includes(V)||N.class&&N.class.toLowerCase().includes(V))}_&&_!=="denied"&&(T=T.map(V=>{if(V.businessLat&&V.businessLng){const N=yj(_.lat,_.lng,V.businessLat,V.businessLng),{minutes:M}=vj(N);return{...V,minutesAway:M}}return{...V,minutesAway:1/0}}),T.sort((V,N)=>V.minutesAway-N.minutesAway)),d(T)},[o,p,_]);const D=async T=>{if(!t)return alert("Please login first");try{const V=he(G,"carts",t.uid),N=await Rt(V);let M=[];N.exists()&&(M=N.data().items||[]);const w=M.findIndex(f=>f.id===T.id);w>=0?M[w].quantity+=1:M.push({...T,quantity:1}),await Cn(V,{items:M}),k(`Added ${T.name} to cart!`),setTimeout(()=>k(null),1500)}catch{alert("Error adding to cart")}};if(P.useEffect(()=>{const T=cn(),V=Bn(T,async N=>{if(!N){e(null),r(null);return}e(N);const M=he(G,"users",N.uid),w=await Rt(M);r(w.exists()?w.data().role:null)});return()=>V()},[]),!t)return a.jsx("div",{children:"Please log in to access this page."});if(!gv.includes(n)&&!mv.includes(n))return a.jsx("div",{style:{background:"#fff",minHeight:"100vh"}});const b=gv.includes(n),E=mv.includes(n);return i==="shop"&&!b||i==="add"&&!E?a.jsx("div",{style:{background:"#fff",minHeight:"100vh"}}):a.jsxs("div",{style:{padding:"30px"},children:[a.jsx("h2",{children:"Restock"}),a.jsxs("div",{style:{marginBottom:"24px",display:"flex",gap:"16px"},children:[b&&a.jsx("button",{style:{padding:"10px 24px",borderRadius:"6px",border:i==="shop"?"2px solid #1976d2":"1px solid #ccc",background:i==="shop"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("shop"),children:"Shop Stock"}),E&&a.jsx("button",{style:{padding:"10px 24px",borderRadius:"6px",border:i==="add"?"2px solid #1976d2":"1px solid #ccc",background:i==="add"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("add"),children:"Add Stock"})]}),i==="shop"&&b&&a.jsxs("section",{style:{marginBottom:"40px"},children:[a.jsx("h3",{children:"Shop Stock"}),a.jsx("div",{style:{margin:"15px 0"},children:a.jsx("input",{type:"text",placeholder:"Search by medicine name, ingredient, or class...",value:p,onChange:T=>y(T.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc"}})}),C&&a.jsx("div",{style:{color:"green",marginBottom:10},children:C}),c.length===0?a.jsx("p",{children:"No medicines found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"20px"},children:c.map(T=>a.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"10px",background:"#fff",boxShadow:"0 1px 6px rgba(0,0,0,0.1)",position:"relative"},children:[T.registeredOnly&&T.registeredUniqueId&&a.jsx("span",{style:{position:"absolute",top:"10px",left:"10px",background:"#7c3aed",color:"#fff",padding:"2px 10px",borderRadius:"8px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",letterSpacing:"1px"},children:"Registered Only"}),T.image&&a.jsx("img",{src:T.image,alt:T.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"10px"}}),a.jsx("strong",{children:T.name}),a.jsx("p",{children:a.jsx("em",{children:T.ingredient})}),a.jsxs("p",{children:["Class: ",T.class]}),a.jsxs("p",{children:["Price: ₦",T.price]}),Array.isArray(T.moqs)&&T.moqs.length>0&&a.jsxs("div",{style:{margin:"8px 0"},children:[a.jsx("strong",{children:"MOQ:"})," ",T.moqs.map((V,N)=>a.jsx("span",{style:{marginRight:8},children:V.type},N))]}),a.jsxs("p",{style:{fontSize:"0.95em",color:"#555"},children:["Distributor: ",T.businessName]}),T.minutesAway!==1/0&&a.jsx("p",{style:{color:"#4caf50",fontWeight:"500",fontSize:"0.9em"},children:T.minutesAway<=1?"📍 Right here":`💨 ~${T.minutesAway} mins away`}),a.jsx("button",{style:{marginTop:10,padding:"8px 16px",borderRadius:"6px",background:"#1976d2",color:"#fff",border:"none",cursor:"pointer",fontWeight:"bold"},onClick:()=>D(T),children:"Add to Cart"})]},T.id))})]}),i==="add"&&E&&a.jsx(xj,{user:t,role:n})]})}function xj({user:t,role:e}){const[n,r]=Be.useState({name:"",ingredient:"",class:"",price:"",image:"",moqs:[{type:"sachet"}],registeredOnly:!1}),[i,s]=Be.useState([]),[o,u]=Be.useState(!1);Be.useEffect(()=>{if(e!=="distributor")return;const L=yt(we(G,"businessRegistrations"),F=>{s(F.docs.filter(W=>W.data().distributorId===t.uid&&W.data().status==="approved").map(W=>W.data()))});return()=>L()},[t,e]);const c=(L,F)=>{const W=n.moqs.map((H,Q)=>Q===L?{type:F.target.value}:H);r({...n,moqs:W})},d=()=>{r({...n,moqs:[...n.moqs,{type:"sachet"}]})},p=L=>{r({...n,moqs:n.moqs.filter((F,W)=>W!==L)})},[y,_]=Be.useState(null),[S,C]=Be.useState([]),[k,D]=Be.useState([]),[b,E]=Be.useState([]),[T,V]=Be.useState(!1),[N,M]=Be.useState(null),[w,f]=Be.useState(null);Be.useEffect(()=>{if(!t)return;const L=yt(we(G,"products"),F=>{let W=F.docs.map(H=>({id:H.id,...H.data()}));m()||(W=W.filter(H=>H.ownerId===t.uid)),C(W)});return()=>L()},[t]),Be.useEffect(()=>{if(!t)return;const L=yt(we(G,"batches"),F=>{let W=F.docs.map(H=>({id:H.id,...H.data()}));m()||(W=W.filter(H=>H.uploadedBy===t.uid)),D(W)});return()=>L()},[t]);function m(){var L;return(L=t==null?void 0:t.email)==null?void 0:L.includes("admin")}const x=L=>r({...n,[L.target.name]:L.target.value}),R=async()=>{const L=!n.registeredOnly;if(r({...n,registeredOnly:L}),e==="distributor"&&(t!=null&&t.uid)){const F=we(G,"products"),W=await getDocs(F),H=[];W.docs.forEach(Q=>{if(Q.data().ownerId===t.uid){const Z={registeredOnly:L};L?Z.registeredUniqueId=`${t.uid}_${Date.now()}_${Math.floor(Math.random()*1e4)}`:Z.registeredUniqueId=null,H.push(updateDoc(he(G,"products",Q.id),Z))}}),await Promise.all(H),window.location.reload()}},j=async L=>{L.preventDefault(),V(!0),f(null),M(null);try{let F=e,W=null,H=null;if(e==="distributor"){const O=he(G,"users",t.uid),Z=await Rt(O);Z.exists()&&(W=Z.data().slug||Z.data().businessSlug||null),n.registeredOnly&&(H=`${t.uid}_${Date.now()}`)}const Q={...n,ownerId:t.uid,ownerRole:F,ownerSlug:W};H&&(Q.registeredUniqueId=H),y?(await Cn(he(G,"products",y),Q,{merge:!0}),_(null),M("Medicine updated!")):(await ns(we(G,"products"),Q),M("Medicine added!")),r({name:"",ingredient:"",class:"",price:"",image:"",moqs:[{type:"sachet",value:"",price:""}],registeredOnly:!1})}catch{f("Error saving medicine")}V(!1)},A=L=>{r({name:L.name,ingredient:L.ingredient,class:L.class,price:L.price,image:L.image||"",moqs:L.moqs||[{type:"sachet",value:"",price:""}]}),_(L.id)},te=async L=>{if(window.confirm("Delete this medicine?")){V(!0);try{await Vn(he(G,"products",L.id)),M("Medicine deleted")}catch{f("Error deleting medicine")}V(!1)}},$=L=>{const F=L.target.files[0];F&&_E.parse(F,{header:!0,skipEmptyLines:!0,complete:W=>{E(W.data)},error:()=>f("Failed to parse CSV")})},ne=async()=>{if(console.log("handleCsvUpload called. user:",t,"role:",e),!b.length)return;if(!t||!e){f("User or role not loaded. Please log in again."),V(!1);return}V(!0),f(null),M(null);const L=he(we(G,"batches")),F=[];let W=e,H=null;if(e==="distributor"){const Q=he(G,"users",t.uid),O=await Rt(Q);O.exists()&&(H=O.data().slug||O.data().businessSlug||null)}for(let Q of b)try{let O=[];if(Q.moqs)try{O=JSON.parse(Q.moqs)}catch{}let Z=null;e==="distributor"&&Q.registeredOnly===!0&&(Z=`${t.uid}_${Date.now()}_${Math.floor(Math.random()*1e4)}`);const z=await ns(we(G,"products"),{name:Q.name,ingredient:Q.ingredient,class:Q.class,price:parseInt(Q.price,10)||0,image:Q.image||"",batchId:L.id,ownerId:t.uid,ownerRole:W,ownerSlug:H,moqs:O,registeredOnly:!!Q.registeredOnly,...Z?{registeredUniqueId:Z}:{}});F.push(z.id)}catch{}await Cn(L,{name:`CSV Upload - ${new Date().toLocaleString()}`,uploadedBy:t.uid,date:new Date().toISOString(),medicineIds:F}),M(`${F.length} medicines uploaded`),E([]),V(!1)},X=async L=>{if(window.confirm("Delete this batch and its medicines?")){V(!0);try{for(let F of L.medicineIds)await Vn(he(G,"products",F));await Vn(he(G,"batches",L.id)),M("Batch deleted")}catch{f("Error deleting batch")}V(!1)}};return a.jsxs("section",{style:{maxWidth:900,margin:"0 auto",background:"#fff",padding:24,borderRadius:10},children:[e==="distributor"&&a.jsxs("section",{style:{marginBottom:32,border:"1px solid #e0e0e0",borderRadius:10,background:"#f8f6ff",padding:18},children:[a.jsx("button",{type:"button",onClick:()=>u(L=>!L),style:{background:o?"#7c3aed":"#ede9fe",color:o?"#fff":"#7c3aed",border:"none",borderRadius:6,padding:"10px 18px",fontWeight:"bold",marginBottom:10,cursor:"pointer"},children:o?"Hide Registered Businesses":"Show Registered Businesses"}),o&&a.jsxs("div",{children:[a.jsx("h3",{style:{color:"#7c3aed",marginBottom:10},children:"Registered Businesses"}),a.jsx("p",{style:{fontSize:15,color:"#555",marginBottom:16},children:"These are businesses that have registered and been approved to buy from you. You can use this list to manage your relationships and track registrations."}),i.length===0?a.jsx("p",{style:{color:"#888"},children:"No businesses registered yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"#fff",borderRadius:8},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#ede9fe"},children:[a.jsx("th",{style:{padding:"8px 12px",textAlign:"left"},children:"Business Name"}),a.jsx("th",{style:{padding:"8px 12px",textAlign:"left"},children:"Email"}),a.jsx("th",{style:{padding:"8px 12px",textAlign:"left"},children:"Phone"})]})}),a.jsx("tbody",{children:i.map((L,F)=>{var W,H,Q;return a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"8px 12px"},children:a.jsx("b",{children:((W=L.businessInfo)==null?void 0:W.businessName)||L.businessId})}),a.jsx("td",{style:{padding:"8px 12px"},children:((H=L.businessInfo)==null?void 0:H.email)||""}),a.jsx("td",{style:{padding:"8px 12px"},children:((Q=L.businessInfo)==null?void 0:Q.phone)||""})]},F)})})]})]})]}),a.jsx("h3",{children:"Add Stock"}),a.jsxs("form",{onSubmit:j,style:{marginBottom:24},children:[a.jsx("input",{name:"name",value:n.name,onChange:x,placeholder:"Medicine Name",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"ingredient",value:n.ingredient,onChange:x,placeholder:"Ingredient",style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"class",value:n.class,onChange:x,placeholder:"Class",style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"price",value:n.price,onChange:x,placeholder:"Default Price",type:"number",min:"0",required:!0,style:{width:"100%",marginBottom:8}}),a.jsx("input",{name:"image",value:n.image,onChange:x,placeholder:"Image URL",style:{width:"100%",marginBottom:8}}),e==="distributor"&&a.jsx("div",{style:{marginBottom:"10px"},children:a.jsx("button",{type:"button",onClick:R,style:{background:n.registeredOnly?"#7c3aed":"#ede9fe",color:n.registeredOnly?"#fff":"#7c3aed",border:"none",borderRadius:6,padding:"10px 18px",fontWeight:"bold",cursor:"pointer"},children:n.registeredOnly?"Disable 'Only registered businesses can buy'":"Enable 'Only registered businesses can buy'"})}),a.jsxs("div",{style:{margin:"16px 0"},children:[a.jsx("strong",{children:"MOQ:"}),n.moqs.map((L,F)=>a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:6},children:[a.jsxs("select",{value:L.type,onChange:W=>c(F,W),style:{width:120},children:[a.jsx("option",{value:"sachet",children:"Sachet"}),a.jsx("option",{value:"pack",children:"Pack"}),a.jsx("option",{value:"carton",children:"Carton"})]}),n.moqs.length>1&&a.jsx("button",{type:"button",onClick:()=>p(F),style:{color:"red"},children:"✕"})]},F)),a.jsx("button",{type:"button",onClick:d,style:{marginTop:4},children:"+ Add MOQ"})]}),a.jsx("button",{type:"submit",disabled:T,style:{marginTop:10},children:y?"Update Medicine":"Add Medicine"})]}),a.jsx("h4",{children:"Bulk Add via CSV"}),a.jsx("input",{type:"file",accept:".csv",onChange:$}),b.length>0&&a.jsx("div",{style:{marginTop:10},children:a.jsxs("button",{onClick:ne,disabled:T,children:["Submit CSV (",b.length," rows)"]})}),a.jsxs("h4",{style:{marginTop:32},children:["My Medicines ",m()&&"(All Users)"]}),S.length===0?a.jsx("p",{children:"No medicines added yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{borderBottom:"1px solid #ccc"},children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Ingredient"}),a.jsx("th",{children:"Class"}),a.jsx("th",{children:"Price"}),a.jsx("th",{children:"MOQ"}),a.jsx("th",{children:"Image"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:S.map(L=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{children:L.name}),a.jsx("td",{children:L.ingredient}),a.jsx("td",{children:L.class}),a.jsx("td",{children:L.price}),a.jsx("td",{children:Array.isArray(L.moqs)&&L.moqs.length>0?L.moqs.map((F,W)=>a.jsx("span",{style:{marginRight:8},children:F.type},W)):"-"}),a.jsx("td",{children:L.image&&a.jsx("img",{src:L.image,alt:L.name,style:{width:"50px",height:"50px",objectFit:"cover"}})}),a.jsxs("td",{children:[a.jsx("button",{onClick:()=>A(L),style:{marginRight:"5px"},children:"Edit"}),a.jsx("button",{onClick:()=>te(L),children:"Delete"})]})]},L.id))})]}),a.jsxs("h4",{style:{marginTop:32},children:["My CSV Batches ",m()&&"(All Users)"]}),k.length===0?a.jsx("p",{children:"No batches uploaded yet."}):a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"20px"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{borderBottom:"1px solid #ccc"},children:[a.jsx("th",{children:"Batch Name"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Medicines Count"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:k.map(L=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{children:L.name}),a.jsx("td",{children:new Date(L.date).toLocaleString()}),a.jsx("td",{children:L.medicineIds.length}),a.jsx("td",{children:a.jsx("button",{onClick:()=>X(L),children:"Delete Batch"})})]},L.id))})]}),N&&a.jsx("div",{style:{color:"green",marginTop:10},children:N}),w&&a.jsx("div",{style:{color:"red",marginTop:10},children:w})]})}function yv({medics:t}){return a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:24,marginTop:24},children:[...t].sort((e,n)=>(n.online===!0)-(e.online===!0)).map(e=>{let n=[];return Array.isArray(e.languages)?n=e.languages:typeof e.languages=="string"&&(n=e.languages.split(",").map(r=>r.trim()).filter(Boolean)),a.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",width:220,padding:16,border:"1px solid #ccc",borderRadius:12,background:"#f9f9f9",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",cursor:"pointer"},onClick:()=>window.open(`https://wa.me/${e.whatsapp}`,"_blank"),children:[a.jsx("span",{title:e.online?"Online":"Offline",style:{position:"absolute",top:8,right:12,width:14,height:14,borderRadius:"50%",background:e.online?"#27c93f":"#bbb",border:"2px solid #fff",boxShadow:"0 0 2px #888"}}),a.jsx("img",{src:e.photo,alt:e.name,style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",marginBottom:12}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:18},children:e.name}),a.jsx("div",{children:e.profession}),e.pharmacyName&&a.jsx("div",{style:{color:"#7c3aed",fontWeight:500},children:e.pharmacyName}),a.jsxs("div",{children:["License: ",e.license]}),a.jsxs("div",{children:["Languages: ",n.join(", ")]})]},e.id)})})}function wj(){const[t,e]=P.useState([]),[n,r]=P.useState([]),[i,s]=P.useState("verify"),[o,u]=P.useState("");return P.useEffect(()=>{(async()=>{let p=(await St(we(G,"verifyMedics"))).docs.map(S=>({id:S.id,...S.data()}));(await St(we(G,"users"))).docs.forEach(S=>{const C=S.data();C.role==="medicine-manager"&&C.pharmacist&&p.push({...C.pharmacist,id:S.id,online:!0})}),e(p);const _=await St(we(G,"consultMedics"));r(_.docs.map(S=>({id:S.id,...S.data()})))})()},[]),a.jsxs("div",{style:{padding:32,maxWidth:900,margin:"0 auto"},children:[a.jsx("h2",{children:"🩺 Medical Interface"}),a.jsx("input",{type:"text",placeholder:"Search by name or pharmacy...",value:o,onChange:c=>u(c.target.value),style:{padding:"10px",width:"100%",maxWidth:"400px",borderRadius:"8px",border:"1px solid #ccc",marginBottom:"18px"}}),a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:32},children:[a.jsx("button",{style:{padding:"10px 24px",borderRadius:6,border:i==="verify"?"2px solid #1976d2":"1px solid #ccc",background:i==="verify"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("verify"),children:"Verify Prescription"}),a.jsx("button",{style:{padding:"10px 24px",borderRadius:6,border:i==="consult"?"2px solid #1976d2":"1px solid #ccc",background:i==="consult"?"#e3f2fd":"#fff",fontWeight:"bold",cursor:"pointer"},onClick:()=>s("consult"),children:"Get Consultation"})]}),i==="verify"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Verify Prescription Medics"}),a.jsx(yv,{medics:t.filter(c=>{var _,S;const d=((_=c.name)==null?void 0:_.toLowerCase())||"",p=((S=c.pharmacyName)==null?void 0:S.toLowerCase())||"",y=o.toLowerCase();return d.includes(y)||p.includes(y)})})]}),i==="consult"&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Consultation Medics"}),a.jsx(yv,{medics:n.filter(c=>{var _,S;const d=((_=c.name)==null?void 0:_.toLowerCase())||"",p=((S=c.pharmacyName)==null?void 0:S.toLowerCase())||"",y=o.toLowerCase();return d.includes(y)||p.includes(y)})})]})]})}function Ej(){ls();const[t,e]=P.useState(0);P.useEffect(()=>{const c=cn();let d=null;const p=Bn(c,y=>{if(d&&d(),y){const _=he(G,"carts",y.uid);d=yt(_,S=>{if(S.exists()){const C=S.data().items||[];e(C.length)}else e(0)})}else e(0)});return()=>{p(),d&&d()}},[]);const i=po().pathname.match(/^\/store\/([^\/]+)/),s=i?i[1]:null,[o,u]=P.useState(null);return P.useEffect(()=>{const c=cn(),d=Bn(c,async p=>{if(p){const y=await Rt(he(G,"users",p.uid));u(y.exists()?y.data().role:null)}else u(null)});return()=>d()},[]),a.jsx("nav",{style:{display:"flex",gap:"20px",padding:"20px",background:"#f8f8f8",borderBottom:"1px solid #ddd"},children:o==="delivery-agent"?a.jsxs(a.Fragment,{children:[a.jsx(on,{to:"/auth",children:"Auth"}),a.jsx("button",{onClick:async()=>{await cn().signOut(),window.location.href="/medcins/#/auth"},style:{marginLeft:12},children:"Logout"})]}):a.jsxs(a.Fragment,{children:[a.jsx(on,{to:"/",children:"Home"}),s?a.jsxs(a.Fragment,{children:[a.jsx(on,{to:`/store/${s}`,children:"Shop"}),a.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[a.jsx(on,{to:`/store/${s}/cart`,children:"Cart"}),t>0&&a.jsx("span",{style:{position:"absolute",top:"-8px",right:"-16px",background:"#e53935",color:"#fff",borderRadius:"50%",padding:"2px 7px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.10)",zIndex:10},children:t})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(on,{to:"/shop",children:"Shop"}),a.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[a.jsx(on,{to:"/cart",children:"Cart"}),t>0&&a.jsx("span",{style:{position:"absolute",top:"-8px",right:"-16px",background:"#e53935",color:"#fff",borderRadius:"50%",padding:"2px 7px",fontSize:"13px",fontWeight:"bold",boxShadow:"0 1px 4px rgba(0,0,0,0.10)",zIndex:10},children:t})]})]}),a.jsx(on,{to:"/auth",children:"Auth"}),a.jsx(on,{to:"/orders",children:"Orders"}),!s&&o!=="customer"&&a.jsxs(a.Fragment,{children:[a.jsx(on,{to:"/add-medicine",children:"Add Medicine"}),a.jsx(on,{to:"/admin",children:"Admin"}),(o==="delivery-agent"||o==="admin")&&a.jsx(a.Fragment,{children:a.jsx(on,{to:"/agents",children:"All Agents"})})]}),a.jsx(on,{to:"/medinterface",children:"Medinterface"})]})})}function Sj(){const[t,e]=P.useState("");function n(O){if(!t.trim())return O;const Z=t.trim().toLowerCase();return O.filter(z=>{var je,Fe,De,Re,ye,Ge,ve,ke,Pe,qt,ht,bt,Qe,vt,Ee,Ne;const se=(((je=u[z.userId])==null?void 0:je.email)||"").toLowerCase(),fe=(z.items&&z.items[0]&&((Fe=s[z.items[0].ownerId])==null?void 0:Fe.name)||"").toLowerCase(),re=((((De=z.deliveryInfo)==null?void 0:De.address)||"")+" "+(((Re=z.deliveryInfo)==null?void 0:Re.city)||"")+" "+(((ye=z.deliveryInfo)==null?void 0:ye.state)||"")).toLowerCase(),be=z.items&&z.items[0]&&((((Ge=s[z.items[0].ownerId])==null?void 0:Ge.address)||"")+" "+(((ve=s[z.items[0].ownerId])==null?void 0:ve.city)||"")+" "+(((ke=s[z.items[0].ownerId])==null?void 0:ke.state)||"")).toLowerCase()||"",Oe=[(Pe=z.deliveryInfo)==null?void 0:Pe.lat,(qt=z.deliveryInfo)==null?void 0:qt.lng,(Qe=s[(bt=(ht=z.items)==null?void 0:ht[0])==null?void 0:bt.ownerId])==null?void 0:Qe.lat,(Ne=s[(Ee=(vt=z.items)==null?void 0:vt[0])==null?void 0:Ee.ownerId])==null?void 0:Ne.lng].filter(Boolean).join(",").toLowerCase(),_e=(z.items||[]).map(Ze=>Ze.name).join(", ").toLowerCase();return se.includes(Z)||fe.includes(Z)||re.includes(Z)||be.includes(Z)||Oe.includes(Z)||_e.includes(Z)})}const[r,i]=Be.useState("processing"),[s,o]=P.useState({});P.useEffect(()=>{const O=yt(we(G,"users"),Z=>{const z={};Z.docs.forEach(se=>{const fe=se.data();fe.role==="medicine-manager"&&(z[se.id]={name:fe.businessName||se.id,address:fe.businessAddress||fe.address||"-",lat:fe.lat||fe.latitude||null,lng:fe.lng||fe.longitude||null})}),o(z)});return()=>O()},[]);const[u,c]=P.useState({});P.useEffect(()=>{const O=yt(we(G,"users"),Z=>{const z={};Z.docs.forEach(se=>{const fe=se.data();z[se.id]=fe.email||se.id}),c(z)});return()=>O()},[]);const[d,p]=P.useState([]),[y,_]=P.useState([]),[S,C]=P.useState([]),[k,D]=P.useState(()=>{const O=localStorage.getItem("agentCanceledOrders");return O?JSON.parse(O):[]}),[b,E]=P.useState({}),[T,V]=P.useState({}),[N,M]=P.useState(null),{slug:w}=dc(),[f,m]=P.useState(null),[x,R]=P.useState(!1),[j,A]=P.useState(!0),[te,$]=P.useState(null),[ne,X]=P.useState("availability");P.useEffect(()=>{if(!te)return;const O=yt(we(G,"orders"),Z=>{const z=Z.docs.map(se=>({id:se.id,...se.data()}));p(z.filter(se=>se.status==="Completed"&&se.assignedAgentId===te.uid)),C(z.filter(se=>se.status==="In-Progress"&&se.assignedAgentId===te.uid)),_(z.filter(se=>se.status==="Processing"&&!se.assignedAgentId&&!k.some(fe=>fe.id===se.id)))});return()=>O()},[te,k]);const L=async O=>{M(O);try{await xt(he(G,"orders",O),{assignedAgentId:te.uid,riderId:te.uid,assignedAgentSlug:f.slug,assignedAgentName:f.companyName,companyName:f.companyName,agentPhoneNumber:f.phoneNumber||"",agentWhatsappNumber:f.whatsappNumber||"",assignedAt:new Date().toISOString(),status:"In-Progress"})}catch{alert("Failed to accept order")}M(null)},F=async O=>{try{await xt(he(G,"orders",O),{deliveredByRider:!0,riderCompletedAt:new Date().toISOString()})}catch{alert("Failed to mark as delivered")}},W=async O=>{try{await xt(he(G,"orders",O),{status:"Processing",assignedAgentId:null,assignedAgentSlug:null,assignedAgentName:null,assignedAt:null})}catch{alert("Failed to move order back to processing")}},H=O=>{const Z=y.find(z=>z.id===O)||S.find(z=>z.id===O);Z&&(D(z=>{const se=[...z,Z];return localStorage.setItem("agentCanceledOrders",JSON.stringify(se)),se}),i("canceled"))};P.useEffect(()=>{const O=Z=>{Z.key==="agentCanceledOrders"&&D(Z.newValue?JSON.parse(Z.newValue):[])};return window.addEventListener("storage",O),()=>window.removeEventListener("storage",O)},[]);const Q=async()=>{if(f){R(!0);try{const O=he(G,"deliveryAgents",f.id);await xt(O,{available:!f.available}),m({...f,available:!f.available})}catch{alert("Failed to update availability")}R(!1)}};return P.useEffect(()=>{const O=cn(),Z=Bn(O,z=>{$(z)});return()=>Z()},[]),P.useEffect(()=>{async function O(){A(!0);const z=(await St(we(G,"deliveryAgents"))).docs.map(re=>re.data());console.log("All agent slugs:",z.map(re=>re.slug));const se=hr(we(G,"deliveryAgents"),Jn("slug","==",w),Jn("approved","==",!0)),fe=await St(se);fe.empty?m(null):m({id:fe.docs[0].id,...fe.docs[0].data()}),A(!1)}O()},[w]),j?a.jsx("div",{style:{padding:40},children:"Loading..."}):f?!te||te.uid!==f.userId?a.jsx("div",{style:{padding:40,color:"#e53935"},children:"Access denied. You can only view your own profile."}):a.jsxs("div",{style:{padding:"30px",maxWidth:"900px",margin:"auto"},children:[a.jsx("h2",{children:"🚚 Delivery Agent Profile"}),a.jsx("img",{src:f.logoUrl||"https://via.placeholder.com/80x80?text=Logo",alt:"Business Logo",style:{width:80,height:80,borderRadius:"10px",objectFit:"cover",marginBottom:10}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:18},children:f.companyName}),a.jsxs("div",{children:["Phone: ",f.phoneNumber]}),a.jsxs("div",{children:["WhatsApp: ",f.whatsappNumber]}),a.jsxs("div",{children:["RC Number: ",f.rcNumber]}),a.jsxs("div",{children:["Address: ",f.businessAddress]}),a.jsxs("div",{children:["Email: ",f.email]}),a.jsxs("div",{children:["Coverage: ",f.coverageArea]}),a.jsxs("div",{children:["Hours: ",f.operatingHours]}),a.jsxs("div",{style:{display:"flex",marginTop:30,gap:20},children:[a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:ne==="availability"?"2px solid #1976d2":"1px solid #ccc",background:ne==="availability"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>X("availability"),children:"Agent Availability"}),a.jsx("button",{style:{padding:"10px 30px",fontWeight:"bold",borderRadius:8,border:ne==="orders"?"2px solid #1976d2":"1px solid #ccc",background:ne==="orders"?"#e3f2fd":"#fff",cursor:"pointer"},onClick:()=>X("orders"),children:"Agent Orders"})]}),a.jsxs("div",{style:{display:"flex",marginTop:30,gap:40},children:[ne==="availability"&&a.jsxs("div",{style:{flex:1,minWidth:320},children:[a.jsx("h3",{children:"Agent Availability"}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("span",{style:{fontWeight:"bold"},children:"Status:"})," ",f.available?"✅ Available":"❌ Not Available",a.jsx("button",{style:{marginLeft:16,padding:"6px 18px",fontWeight:"bold"},onClick:Q,disabled:x,children:f.available?"Set Not Available":"Set Available"})]})]}),ne==="orders"&&(f.available?a.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",width:"100%"},children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10,minWidth:160},children:[a.jsx("div",{style:{flex:1,marginLeft:24,marginBottom:16},children:a.jsx("input",{type:"text",value:t,onChange:O=>e(O.target.value),placeholder:"Search orders by customer email, pharmacy, address, coordinates, items...",style:{width:"100%",padding:"8px 12px",border:"1px solid #bbb",borderRadius:6,fontSize:15,outline:"none",boxShadow:"0 1px 2px #0001"}})}),a.jsx("button",{onClick:()=>i("processing"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="processing"?"2px solid #1976d2":"1px solid #ccc",background:r==="processing"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:"📦 Orders (Processing)"}),a.jsx("button",{onClick:()=>i("progression"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="progression"?"2px solid #1976d2":"1px solid #ccc",background:r==="progression"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:"⏳ Order Progression"}),a.jsx("button",{onClick:()=>i("completed"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="completed"?"2px solid #1976d2":"1px solid #ccc",background:r==="completed"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:"✅ Completed Orders (You)"}),a.jsx("button",{onClick:()=>i("canceled"),style:{padding:"6px 10px",fontWeight:"bold",fontSize:13,borderRadius:6,border:r==="canceled"?"2px solid #1976d2":"1px solid #ccc",background:r==="canceled"?"#e3f2fd":"#fff",cursor:"pointer",textAlign:"left"},children:"❌ Canceled Orders"})]}),r==="canceled"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(k).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No canceled orders found."}):n(k).map(O=>{var Z;return a.jsxs("div",{style:{border:"1px solid #b91c1c",borderRadius:8,padding:16,marginBottom:16,background:"#fff0f0"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{position:"relative",width:24,display:"flex",flexDirection:"column",alignItems:"center",marginRight:12},children:[a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1976d2",marginBottom:8,marginTop:2}}),a.jsx("div",{style:{flex:1,width:2,background:"#b91c1c",minHeight:32}}),a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#b91c1c",marginTop:8}})]}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const z=s[O.items[0].ownerId],se=`${z.address||""}, ${z.city||""}, ${z.state||""}`,fe=!z.address&&!z.city&&!z.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:z.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:fe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this business"}):se}),z.lat&&z.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const z=O.deliveryInfo||{},se=`${z.address||""}, ${z.city||""}, ${z.state||""}`,fe=!z.address&&!z.city&&!z.state;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:fe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):se}),z.lat&&z.lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(Z=O.items)==null?void 0:Z.map(z=>`${z.name} x${z.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#b91c1c"},children:"Canceled (local)"})]}),a.jsx("div",{style:{marginTop:10,fontSize:13,color:"#555"},children:"Canceled (local, not global)"})]},O.id)})}),a.jsxs("div",{style:{flex:1,marginLeft:24},children:[r==="processing"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(y).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No processing orders found."}):n(y).map(O=>{var Z;return a.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:16,marginBottom:16,background:"#fcfcfc"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{position:"relative",width:24,display:"flex",flexDirection:"column",alignItems:"center",marginRight:12},children:[a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1976d2",marginBottom:8,marginTop:2}}),a.jsx("div",{style:{flex:1,width:2,background:"#d1d5db",minHeight:32}}),a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#059669",marginTop:8}})]}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const z=s[O.items[0].ownerId],se=`${z.address||""}, ${z.city||""}, ${z.state||""}`,fe=!z.address&&!z.city&&!z.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:z.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:fe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this business"}):se}),z.lat&&z.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const z=O.deliveryInfo||{},se=`${z.address||""}, ${z.city||""}, ${z.state||""}`,fe=!z.address&&!z.city&&!z.state;let re=z.lat,be=z.lng;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:fe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):se}),re&&be?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",re,", ",be]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(Z=O.items)==null?void 0:Z.map(z=>`${z.name} x${z.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#e53935"},children:O.status})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12},children:[a.jsx("button",{style:{fontWeight:"bold",background:"#1976d2",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:"pointer"},onClick:()=>L(O.id),disabled:N===O.id,children:N===O.id?"Accepting...":"Accept Order"}),a.jsx("button",{style:{fontWeight:"bold",background:"#b91c1c",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:"pointer"},onClick:()=>H(O.id),children:"Cancel Order"})]})]},O.id)})}),r==="progression"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(S).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No in-progress orders found."}):n(S).map(O=>{var fe;const Z=!!b[O.id],z=!!T[O.id],se=async()=>{await F(O.id),E(re=>({...re,[O.id]:!0})),V(re=>({...re,[O.id]:!0})),setTimeout(()=>V(re=>({...re,[O.id]:!1})),2e3)};return a.jsxs("div",{style:{border:"1px solid #f59e42",borderRadius:8,padding:16,marginBottom:16,background:"#fffbe6"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const re=s[O.items[0].ownerId],be=`${re.address||""}, ${re.city||""}, ${re.state||""}`,Oe=!re.address&&!re.city&&!re.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:re.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:Oe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this business"}):be}),re.lat&&re.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",re.lat,", ",re.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const re=O.deliveryInfo||{},be=`${re.address||""}, ${re.city||""}, ${re.state||""}`,Oe=!re.address&&!re.city&&!re.state;let _e=re.lat,je=re.lng;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:Oe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):be}),_e&&je?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",_e,", ",je]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(fe=O.items)==null?void 0:fe.map(re=>`${re.name} x${re.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#f59e42"},children:O.status})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12},children:[a.jsx("button",{style:{fontWeight:"bold",background:"#059669",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:Z?"not-allowed":"pointer",opacity:Z?.5:1},onClick:se,disabled:Z,children:"Success"}),a.jsx("button",{style:{fontWeight:"bold",background:"#e53935",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",cursor:Z?"not-allowed":"pointer",opacity:Z?.5:1},onClick:()=>W(O.id),disabled:Z,children:"Failed"})]}),z&&a.jsx("div",{style:{marginTop:8,color:"#059669",fontWeight:"bold"},children:"Order successful!"}),Z&&a.jsx("div",{style:{marginTop:8,color:"#1976d2",fontSize:13},children:"Successful order: to be confirmed by admin"})]},O.id)})}),r==="completed"&&a.jsx("div",{style:{minWidth:320,maxWidth:600,marginTop:56,marginLeft:5},children:n(d).length===0?a.jsx("div",{style:{marginBottom:20,color:"#888"},children:"No completed orders found."}):n(d).map(O=>{var Z;return a.jsxs("div",{style:{border:"1px solid #4caf50",borderRadius:8,padding:16,marginBottom:16,background:"#e8f5e9"},children:[a.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Order #",O.id]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[a.jsxs("div",{style:{position:"relative",width:24,display:"flex",flexDirection:"column",alignItems:"center",marginRight:12},children:[a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1976d2",marginBottom:8,marginTop:2}}),a.jsx("div",{style:{flex:1,width:2,background:"#b2dfdb",minHeight:32}}),a.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#059669",marginTop:8}})]}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{marginBottom:18},children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#1976d2",fontWeight:700,marginBottom:2},children:"FROM"}),O.items&&O.items.length>0&&s[O.items[0].ownerId]&&(()=>{const z=s[O.items[0].ownerId],se=`${z.address||""}, ${z.city||""}, ${z.state||""}`,fe=!z.address&&!z.city&&!z.state;return a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:z.name}),a.jsx("div",{style:{fontSize:13,color:"#555"},children:fe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this business"}):se}),z.lat&&z.lng&&a.jsxs("div",{style:{fontSize:12,color:"#1976d2",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]})]})})()]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,letterSpacing:1,color:"#059669",fontWeight:700,marginBottom:2},children:"TO"}),a.jsxs("div",{style:{marginLeft:2},children:[a.jsx("div",{style:{fontWeight:600},children:O.customerName||u[O.userId]||O.userId}),(()=>{const z=O.deliveryInfo||{},se=`${z.address||""}, ${z.city||""}, ${z.state||""}`,fe=!z.address&&!z.city&&!z.state;return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:13,color:"#555"},children:fe?a.jsx("span",{style:{color:"red",fontWeight:600},children:"⚠️ Address missing for this order"}):se}),z.lat&&z.lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",z.lat,", ",z.lng]}):u[O.userId]&&u[O.userId].lat&&u[O.userId].lng?a.jsxs("div",{style:{fontSize:12,color:"#059669",marginTop:2},children:["Coordinates: ",u[O.userId].lat,", ",u[O.userId].lng," ",a.jsx("span",{style:{color:"#888"},children:"(profile)"})]}):a.jsx("div",{style:{fontSize:12,color:"#b91c1c",marginTop:2},children:"Coordinates not available"})]})})()]})]})]})]}),a.jsxs("div",{style:{marginTop:18},children:["Items: ",(Z=O.items)==null?void 0:Z.map(z=>`${z.name} x${z.quantity||1}`).join(", ")]}),a.jsxs("div",{children:["Status: ",a.jsx("span",{style:{color:"#388e3c"},children:O.status})]}),a.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#555"},children:["Completed: ",O.completedAt?new Date(O.completedAt).toLocaleString():"-"]})]},O.id)})})]})]}):a.jsxs("div",{style:{padding:40,color:"#e53935",width:"100%"},children:["You must be ",a.jsx("b",{children:"Available"})," to view and accept orders."]}))]})]}):a.jsx("div",{style:{padding:40,color:"#e53935"},children:"No delivery agent found for this slug."})}function vv(){const[t,e]=P.useState([]),[n,r]=P.useState(!0);return P.useEffect(()=>{async function i(){r(!0);const s=hr(we(G,"deliveryAgents"),Jn("approved","==",!0)),o=await St(s);e(o.docs.map(u=>({id:u.id,...u.data()}))),r(!1)}i()},[]),n?a.jsx("div",{style:{padding:40},children:"Loading..."}):a.jsxs("div",{style:{padding:"30px",maxWidth:"1200px",margin:"auto"},children:[a.jsx("h2",{children:"🚚 All Approved Delivery Agents"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"18px",marginTop:"40px"},children:t.length===0?a.jsx("p",{children:"No delivery agents found."}):t.map(i=>a.jsx(on,{to:`/agent/${i.slug}`,style:{textDecoration:"none",color:"inherit"},children:a.jsxs("div",{style:{background:"#fff",border:"1px solid #eee",borderRadius:"10px",boxShadow:"0 1px 8px rgba(0,0,0,0.06)",padding:"18px",minWidth:"260px",maxWidth:"320px",position:"relative"},children:[a.jsx("img",{src:i.logoUrl||"https://via.placeholder.com/80x80?text=Logo",alt:"Business Logo",style:{width:80,height:80,borderRadius:"10px",objectFit:"cover",marginBottom:10}}),a.jsx("div",{style:{fontWeight:"bold",fontSize:18},children:i.companyName}),a.jsxs("div",{children:["Phone: ",i.phoneNumber]}),a.jsxs("div",{children:["Coverage: ",i.coverageArea]}),a.jsxs("div",{children:["Hours: ",i.operatingHours]})]})},i.id))})]})}Ld.createRoot(document.getElementById("root")).render(a.jsx(Be.StrictMode,{children:a.jsx(fT,{children:a.jsxs(a.Fragment,{children:[a.jsx(Ej,{}),a.jsx(Ij,{}),a.jsxs(oT,{children:[a.jsx(Pt,{path:"/agent/:slug",element:a.jsx(Sj,{})}),a.jsx(Pt,{path:"/agents",element:a.jsx(vv,{})}),a.jsx(Pt,{path:"/",element:a.jsx(yT,{})}),a.jsx(Pt,{path:"/shop",element:a.jsx(GP,{})}),a.jsx(Pt,{path:"/cart",element:a.jsx(yE,{})}),a.jsx(Pt,{path:"/auth",element:a.jsx(HP,{})}),a.jsx(Pt,{path:"/orders",element:a.jsx(YP,{})}),a.jsx(Pt,{path:"/add-medicine",element:a.jsx(aj,{})}),a.jsx(Pt,{path:"/payment",element:a.jsx(gj,{})}),a.jsx(Pt,{path:"/admin",element:a.jsx(ZP,{})}),a.jsx(Pt,{path:"/store",element:a.jsx(rj,{})}),a.jsx(Pt,{path:"/store/:slug",element:a.jsx(nj,{})}),a.jsx(Pt,{path:"/store/:slug/cart",element:a.jsx(mj,{})}),a.jsx(Pt,{path:"/restock",element:a.jsx(_j,{})}),a.jsx(Pt,{path:"/medinterface",element:a.jsx(wj,{})}),a.jsx(Pt,{path:"/businesses",element:a.jsx(sj,{})}),a.jsx(Pt,{path:"/agents",element:a.jsx(vv,{})})]})]})})}));function Ij(){const e=window.location.pathname.match(/^\/store\/([^\/]+)/),n=e?e[1]:null,r=ls();return n?a.jsx("button",{onClick:()=>r("/shop"),style:{position:"fixed",top:"80px",left:"32px",background:"#fff",color:"#7c3aed",border:"1px solid #7c3aed",borderRadius:"50px",boxShadow:"0 2px 8px rgba(0,0,0,0.10)",padding:"4px 10px",fontWeight:"bold",fontSize:"13px",zIndex:1e3,cursor:"pointer",transition:"box-shadow 0.2s",opacity:.96},onMouseOver:i=>i.currentTarget.style.boxShadow="0 4px 16px rgba(124,58,237,0.18)",onMouseOut:i=>i.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",children:"Leave Store"}):null}
